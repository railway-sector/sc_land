const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ImageryTileLayer-ahBg2tJx.js","assets/index-aRi8Xk-b.js","assets/index-ni9qn0ie.css","assets/isImageryTileGraphicOrigin-ZR-gBf9D.js","assets/xmlUtilities-BrCIVSt6.js","assets/multidimensionalUtils-DPCJo6rl.js","assets/RasterJobHandlerMixin-ZMXsKT3M.js","assets/RasterSymbolizer-B_xou3r7.js","assets/PixelBlock-D6s_WAG4.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/vectorFieldUtils-nfa_tg3e.js","assets/datasetUtils-DdDUWBI2.js","assets/ClassBreaksDefinition-DT1Dgqyb.js","assets/dataUtils-BlaM2BDe.js","assets/QueueProcessor-BBZoq4x6.js","assets/RawBlockCache-DcA_xtd5.js","assets/rasterProjectionHelper-B5cSg6T6.js","assets/clipUtils-CIPL8g4V.js","assets/rasterFunctionHelper-Dc05Qk8O.js","assets/RasterPresetRendererMixin-BCm-HQgI.js","assets/rasterFieldUtils-ewF5JZJG.js","assets/PolynomialTransform-D9daHnVQ.js"])))=>i.map(i=>d[i]);
import{c$ as g,a3 as c,d1 as p,bI as u,a5 as n,x as d,y as _}from"./index-aRi8Xk-b.js";import{i as m}from"./RasterJobHandlerMixin-ZMXsKT3M.js";import"./multidimensionalUtils-DPCJo6rl.js";import"./RasterSymbolizer-B_xou3r7.js";import"./PixelBlock-D6s_WAG4.js";import"./_commonjsHelpers-DCkdB7M8.js";import"./vectorFieldUtils-nfa_tg3e.js";import"./datasetUtils-DdDUWBI2.js";import"./ClassBreaksDefinition-DT1Dgqyb.js";import"./dataUtils-BlaM2BDe.js";let a=class extends m(g){constructor(t){super(t)}load(t){return this.addResolvingPromise(this._fetchPixels(t)),Promise.resolve(this)}destroy(){this._source=null}get height(){return this._get("height")}get width(){return this._get("width")}async _fetchPixels(t){const i=(await c(async()=>{const{default:h}=await import("./ImageryTileLayer-ahBg2tJx.js").then(l=>l.R);return{default:h}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))).default,e=await i.open({url:this.url,ioConfig:{skipExtensions:["jgw","aux.xml"],skipMapInfo:!0},signal:t?.signal});if(p(t),e==null)throw new u("depth-image-service:open-error","Failed to open depth image raster.",{url:this.url});const{width:r,height:o}=e.rasterInfo;await this._initJobHandler(),p(t),e.rasterJobHandler=this._rasterJobHandler;const{pixelBlock:s}=await e.fetchPixels(e.rasterInfo.nativeExtent.clone(),r,o,{noClip:!1,signal:t?.signal});if(p(t),s==null)throw new u("depth-image-service:fetch-error","Failed to fetch depth image pixels.");this._set("width",s.width),this._set("height",s.height),this._source=s.pixels[0]}_getDepthValue(t,i){const e=Math.max(1,Math.min(this.width,t)),r=Math.max(1,Math.min(this.height,i));return this._source[(r-1)*this.width+(e-1)]}_interpolateDepth(t,i){const e=Math.floor(i),r=Math.ceil(i),o=Math.floor(t),s=Math.ceil(t),h=i-e,l=t-o;return(this._getDepthValue(e,o)*(1-h)+this._getDepthValue(r,o)*h)*(1-l)+(this._getDepthValue(e,s)*(1-h)+this._getDepthValue(r,s)*h)*l}depthAt(t,i){if(!this.loaded||!this._source)throw new Error("DepthImageService must be loaded before sampling depth.");const e=t.x/i.width*this.width,r=t.y/i.height*this.height;return this._interpolateDepth(r,e)}};n([d({readOnly:!0,value:0})],a.prototype,"height",null),n([d()],a.prototype,"url",void 0),n([d({readOnly:!0,value:0})],a.prototype,"width",null),a=n([_("esri.widgets.OrientedImageryViewer.services.DepthImageService")],a);const b=a;export{b as default};
