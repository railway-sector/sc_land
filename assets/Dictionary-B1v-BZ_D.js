import{dJ as u,dm as f,ju as h,cJ as d,jv as m,cF as w,fW as y}from"./index-Brd6-W-v.js";import{f as v}from"./deepClone-DbPEgwiE.js";import{L as p,p as C,G as b,z as F,V as k,n as A,r as j,i as L,U as T}from"./languageUtils-VTg8aC1C.js";function l(a,t,e=!1,s=!1){if(a==null)return null;if(d(a)||m(a)||w(a)||A(a)||j(a)||L(a))return a;if(y(a)){const n=[];for(const i of a)n.push(l(i,t,e,s));return n}if(s&&T(a))return a;const r=new o;r.immutable=!1;for(const[n,i]of Object.entries(a))i!==void 0&&r.setField(n,l(i,t,e,s));return r.immutable=e,r}class o{constructor(t){this.declaredClass="esri.arcade.Dictionary",this.plain=!1,this.immutable=!0,t instanceof o?this.attributes=t.attributes:t==null?this.attributes=Object.create(null):Object.getPrototypeOf(t)!=null?this.attributes={__proto__:null,...t}:this.attributes=t}static containerEntry(t,e){return new o({__proto__:null,key:t,value:e})}static textFormatting(){const t=new o({__proto__:null,newline:`
`,tab:"	",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});return t.immutable=!1,t}field(t){const e=t.toLowerCase(),s=this.attributes[t];if(s!==void 0)return s;for(const r in this.attributes)if(r.toLowerCase()===e)return this.attributes[r];throw new u(null,"FieldNotFound",null,{key:t})}setField(t,e){if(this.immutable)throw new u(null,"Immutable",null);if(p(e))throw new u(null,"NoFunctionInDictionary",null);const s=t.toLowerCase();if(e instanceof Date&&(e=f.dateJSToArcadeDate(e)),this.attributes[t]===void 0){for(const r in this.attributes)if(r.toLowerCase()===s)return void(this.attributes[r]=e);this.attributes[t]=e}else this.attributes[t]=e}eraseField(t){if(this.immutable)throw new u(null,"Immutable",null);if(t in this.attributes)return void delete this.attributes[t];const e=t.toLowerCase();for(const s in this.attributes)if(s.toLowerCase()===e)return void delete this.attributes[s]}hasField(t){const e=t.toLowerCase();if(this.attributes[t]!==void 0)return!0;for(const s in this.attributes)if(s.toLowerCase()===e)return!0;return!1}keys(){let t=[];for(const e in this.attributes)t.push(e);return t=t.sort(),t}values(){return this.keys().map(t=>this.attributes[t])}entryCount(){return Object.keys(this.attributes).length}isEmpty(){return this.entryCount()<=0}castToText(t=!1){return C(this.attributes,{useNumbersForDates:t})}static convertObjectToArcadeDictionary(t,e,s=!0,r=!1){const n=new o;n.immutable=!1;for(const i in t){const c=t[i];c!==void 0&&n.setField(i.toString(),l(c,e,s,r))}return n.immutable=s,n}static convertJsonToArcade(t,e,s=!1,r=!1){return l(t,e,s,r)}castAsJson(t=null){const e=Object.create(null);for(let s in this.attributes){const r=this.attributes[s];r!==void 0&&(t?.keyTranslate&&(s=t.keyTranslate(s)),e[s]=b(r,t))}return e}async castDictionaryValueAsJsonAsync(t,e,s,r=null,n){const i=await F(s,r,n);return t[e]=i,i}async castAsJsonAsync(t=null,e=null){const s=Object.create(null),r=[];for(let n in this.attributes){const i=this.attributes[n];e?.keyTranslate&&(n=e.keyTranslate(n)),i!==void 0&&(k(i)||i instanceof h||i instanceof f?s[n]=b(i,e):r.push(this.castDictionaryValueAsJsonAsync(s,n,i,t,e)))}return r.length>0&&await Promise.all(r),s}deepClone(){const t=new o;t.immutable=!1;for(const e of this.keys())t.setField(e,v(this.field(e)));return t}}export{o as p};
