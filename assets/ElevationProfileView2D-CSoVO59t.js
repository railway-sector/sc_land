import{aU as m,aV as c,k6 as _,cU as u,cL as g,a2 as y,aj as f,an as v,kW as w,k as o,a3 as n,Z as p,$ as d,a0 as $,gD as D,hL as l}from"./index-Bp3GeDhQ.js";import{e as L,a as P}from"./visualizationUtils-DUFraIFd.js";import{l as M}from"./throttle-DY3N7fox.js";import{n as R}from"./GraphicsLayer-n_skBp8O.js";import{l as b}from"./customElement-Cl5wDj30.js";import"./AnchorElementViewModel-Du3Oh9aO.js";import"./createUtils-5tKs90WA.js";import"./Circle-CsXSHXzA.js";import"./distanceOperator-nvWTbr2e.js";import"./Point2D-8Py_srEd.js";import"./Distance2DCalculator-CXhBP-8I-4Klp7zPt.js";import"./ProjectionTransformation-lQCY9pCU.js";import"./Envelope2D-DQ3Tn1o-.js";import"./Transformation2D-Ckyhe4wc.js";import"./SimpleGeometryCursor-B92kdZ15.js";import"./OperatorDefinitions-DP7_WWTp.js";import"./apiConverter-jueJBHyz.js";import"./jsonConverter-DUGRtN2X.js";import"./simplifyOperator-StSk-cWv.js";import"./operatorSimplify-Dc-q6rdc.js";import"./surfaceCoordinateSystems-1qYrNKOW.js";import"./defaultUnit-Bhu2r0Gs.js";import"./traversalUtils-DmE6QkgJ.js";import"./SketchViewModel-BRoViF94.js";import"./isSupportedObject-BoTASd6h.js";import"./layerUtils-D3xv-kL2.js";import"./SketchLabelOptions-CvfS2rfH.js";import"./SketchOptions-DkZT37r7.js";import"./SnappingManager-BICxJWyY.js";import"./euclideanLengthMeasurementUtils-D9l_P3ES.js";import"./geometry2dUtils-2tpfJ_8-.js";import"./geodeticLengthOperator-i8Sfrrr_.js";import"./geodeticCurveType-CirnHLSB.js";import"./automaticAreaMeasurementUtils-DsNHnpIJ.js";import"./geodesicAreaMeasurementUtils-CpeJNyDK.js";import"./earcut-D9gy186-.js";import"./automaticLengthMeasurementUtils-B7UwQrK7.js";import"./UnitSelect-B86sTHB1.js";class k{constructor(t){this._params=t,this._highlightTask=null,this._highlightHandle=null}destroy(){this.remove()}remove(){this._highlightTask=m(this._highlightTask),this._highlightHandle=c(this._highlightHandle)}update(t){if(this.remove(),t==null||!E(t))return;const i=t.layer;this._highlightTask=_(async e=>{const s=await this._params.view.whenLayerView(i);u(e);const a=g(s)?s:null;a&&(this._highlightHandle=a.highlight(t))})}}function E(r){return r.geometry!=null&&r.geometry.type==="polyline"}let h=class extends y{constructor(r){super(r),this._chartData=null,this._graphic=new f,this._layer=new R({listMode:"hide",internal:!0,title:"Profile line"}),this._update=t=>{const{chartData:i}=t;if(i==null)return this.remove();if(!i.refined)return;const e=i.lines.find(a=>a.viewVisualizationEnabled);if(!e)return;this._graphic.geometry=L(e,t.spatialReference),this._graphic.symbol=new v({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,10],lineDashEnding:"HalfPattern",controlPointEnding:"HalfPattern"}],capStyle:"Butt",width:1.5,color:e.color.toArray()},{type:"CIMSolidStroke",capStyle:"Butt",width:2,color:w(e.color).toArray()}]}}});const s=this.view?.map?.layers;s&&!s.includes(this._layer)&&s.add(this._layer)}}initialize(){this._layer.add(this._graphic);const r=b().profileLinesUpdateThrottleMillis;let t=this._update;{const i=M(this._update,r);this.addHandles(i),t=i}this.addHandles(o(()=>({spatialReference:this.view.spatialReference,chartData:this._chartData}),t,n))}destroy(){this.remove()}remove(){this.view?.map?.remove(this._layer)}update(r){this._chartData=r}};p([d()],h.prototype,"view",void 0),p([d()],h.prototype,"_chartData",void 0),h=p([$("esri.widgets.ElevationProfile.support.ProfileLine2D")],h);class _t{constructor(t,i){this._handles=new D,this._inputRepresentation=new k({view:t}),this._hoveredPoints=new P({view:t}),this._profileLine=new h({view:t}),this._handles.add([o(()=>i.viewModel.hoveredPoints,e=>this._hoveredPoints.update(e),n),o(()=>{const{state:e,highlightEnabled:s,viewModel:a}=i;return{input:a.input,state:e,highlightEnabled:s}},e=>this._updateInputRepresentation(e),n),o(()=>i.viewModel.chartData,e=>this._profileLine.update(e),n),o(()=>i.viewModel.input?.geometry,()=>{this._profileLine.remove()},n)])}destroy(){this._handles=l(this._handles),this._inputRepresentation=l(this._inputRepresentation),this._hoveredPoints=l(this._hoveredPoints),this._profileLine=l(this._profileLine)}_updateInputRepresentation({input:t,state:i,highlightEnabled:e}){i==="selected"&&e?this._inputRepresentation.update(t):this._inputRepresentation.remove()}}export{_t as ElevationProfileView2D};
