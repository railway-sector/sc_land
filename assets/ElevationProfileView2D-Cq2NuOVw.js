import{aZ as d,a_ as _,ex as c,ds as u,db as g,Y as y,ao as f,as as v,l5 as w,f as a,Z as n,_ as p,e as m,g as $,i4 as P,j4 as l}from"./index-BrQW8HOS.js";import{e as b,a as D}from"./visualizationUtils-mqN_vAaX.js";import{l as M}from"./throttle-CTJgdIni.js";import{n as R}from"./GraphicsLayer-CtVknZ1a.js";import{l as L}from"./customElement-CfYEKQJO.js";import"./AnchorElementViewModel-Djy63Zpd.js";import"./createUtils-BntPyFG2.js";import"./Circle-CDzQBXRC.js";import"./geodesicUtils-BJZXB7Hp.js";import"./distanceOperator-BeiDdpLt.js";import"./Point2D-DNXcsliy.js";import"./Distance2DCalculator-CXhBP-8I-Dkb8-KBJ.js";import"./ProjectionTransformation-BjD312Kq.js";import"./Envelope2D-CUWyosZh.js";import"./Transformation2D-BUBnKQZf.js";import"./SimpleGeometryCursor-B92kdZ15.js";import"./OperatorDefinitions-DP7_WWTp.js";import"./apiConverter---8F7iZ4.js";import"./jsonConverter-BHYd2kGf.js";import"./simplifyOperator-BQVvn5Fy.js";import"./operatorSimplify-C16tE3lk.js";import"./surfaceCoordinateSystems-BrNYf00T.js";import"./mat2d-BbBq4Byx.js";import"./mat2df64-DJ_RMjZ3.js";import"./defaultUnit-DpiDHKcy.js";import"./getDefaultUnitForView-KDHdLbNY.js";import"./traversalUtils-DmE6QkgJ.js";import"./SketchViewModel-NRhuw9HA.js";import"./isSupportedObject-DknMXN_6.js";import"./layerUtils-CdCZXuDJ.js";import"./SketchLabelOptions-BPF5xZLI.js";import"./SketchOptions-CHLlByzL.js";import"./SnappingManager-BWOfKl0d.js";import"./euclideanLengthMeasurementUtils-B8AL_WaV.js";import"./utils-D_VO_1nP.js";import"./geometry2dUtils-kADrF-iP.js";import"./geodeticLengthOperator-DifrZujk.js";import"./geodeticCurveType-CirnHLSB.js";import"./geodesicMeasurementUtils-CQw8IWGR.js";import"./automaticAreaMeasurementUtils-dI3X5owW.js";import"./geodesicAreaMeasurementUtils-CPlOyDe5.js";import"./earcut-D9gy186-.js";import"./automaticLengthMeasurementUtils-Cr-y0OEN.js";import"./substitute-D-eLZ17Q.js";import"./UnitSelect-8DP5dFVk.js";import"./useWidget-CYtf2hFT.js";import"./useView-Cya0Zpns.js";class E{constructor(t){this._params=t,this._highlightTask=null,this._highlightHandle=null}destroy(){this.remove()}remove(){this._highlightTask=d(this._highlightTask),this._highlightHandle=_(this._highlightHandle)}update(t){if(this.remove(),t==null||!H(t))return;const e=t.layer;this._highlightTask=c(async i=>{const o=await this._params.view.whenLayerView(e);u(i);const s=g(o)?o:null;s&&(this._highlightHandle=s.highlight(t))})}}function H(r){return r.geometry!=null&&r.geometry.type==="polyline"}let h=class extends y{constructor(r){super(r),this._chartData=null,this._graphic=new f,this._layer=new R({listMode:"hide",internal:!0,title:"Profile line"}),this._update=t=>{const{chartData:e}=t;if(e==null)return this.remove();if(!e.refined)return;const i=e.lines.find(s=>s.viewVisualizationEnabled);if(!i)return;this._graphic.geometry=b(i,t.spatialReference),this._graphic.symbol=new v({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,10],lineDashEnding:"HalfPattern",controlPointEnding:"HalfPattern"}],capStyle:"Butt",width:1.5,color:i.color.toArray()},{type:"CIMSolidStroke",capStyle:"Butt",width:2,color:w(i.color).toArray()}]}}});const o=this.view?.map?.layers;o&&!o.includes(this._layer)&&o.add(this._layer)}}initialize(){this._layer.add(this._graphic);const r=L().profileLinesUpdateThrottleMillis;let t=this._update;{const e=M(this._update,r);this.addHandles(e),t=e}this.addHandles(a(()=>({spatialReference:this.view.spatialReference,chartData:this._chartData}),t,n))}destroy(){this.remove()}remove(){this.view?.map?.remove(this._layer)}update(r){this._chartData=r}};p([m()],h.prototype,"view",void 0),p([m()],h.prototype,"_chartData",void 0),h=p([$("esri.widgets.ElevationProfile.support.ProfileLine2D")],h);class bt{constructor(t,e){this._handles=new P,this._inputRepresentation=new E({view:t}),this._hoveredPoints=new D({view:t}),this._profileLine=new h({view:t}),this._handles.add([a(()=>e.viewModel.hoveredPoints,i=>this._hoveredPoints.update(i),n),a(()=>{const{state:i,highlightEnabled:o,viewModel:s}=e;return{input:s.input,state:i,highlightEnabled:o}},i=>this._updateInputRepresentation(i),n),a(()=>e.viewModel.chartData,i=>this._profileLine.update(i),n),a(()=>e.viewModel.input?.geometry,()=>{this._profileLine.remove()},n)])}destroy(){this._handles=l(this._handles),this._inputRepresentation=l(this._inputRepresentation),this._hoveredPoints=l(this._hoveredPoints),this._profileLine=l(this._profileLine)}_updateInputRepresentation({input:t,state:e,highlightEnabled:i}){e==="selected"&&i?this._inputRepresentation.update(t):this._inputRepresentation.remove()}}export{bt as ElevationProfileView2D};
