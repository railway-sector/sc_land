const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Brd6-W-v.js","assets/index-ni9qn0ie.css","assets/index-DpDkG7bA.js","assets/index-D5vtdVkD.js"])))=>i.map(i=>d[i]);
import{bT as A,a2 as I,a3 as E,a4 as m,tL as D,a7 as R,a5 as i,x as l,y as w,b_ as M,j as q,eB as C,yg as _,yh as W,cJ as x,yi as S,yj as P,od as N,lL as V,lP as F,c1 as L,c2 as k,yk as B,bI as U}from"./index-Brd6-W-v.js";import{s as H}from"./Heading-BCcHIRjP.js";import{isRelatableFeatureSupportedLayer as j}from"./featureUtils-C9FquY4Q.js";import{k as Z,o as K,g as O,C as J,Y as X,s as Y,l as z,Z as $,i as G}from"./featureFormUtils-JL6ExD4t.js";import{g as Q,J as ee,H as te}from"./dateUtils-Dxl5F42Y.js";function ie(e,t){return A(t)?t.getFieldAlias(e.name):e.alias}const le={danger:"exclamation-mark-circle",info:"information",success:"check",warning:"exclamation-mark-triangle",brand:void 0};function ye(e){if(e==null||typeof e!="object")return"layer";if("isTable"in e&&e.isTable)return"table";if("type"in e){if(e.type==="feature")return"feature-layer";if(e.type==="group")return"layers";if(e.type==="subtype-group")return"subtype";if(e.type==="knowledge-graph")return"knowledge-layer";if(e.type==="link-chart")return"knowledge-graph";if(e.type==="graphics")return"layer-graphics"}return"layer"}const b="esri-editor__prompt",c={base:b,header:`${b}__header`,heading:`${b}__header__heading`,message:`${b}__message`,divider:`${b}__divider`,actions:`${b}__actions`,halfWidthButton:`${b}__half-width-button`},me=()=>I({button:()=>E(()=>import("./index-Brd6-W-v.js").then(e=>e.OI),__vite__mapDeps([0,1])),icon:()=>E(()=>import("./index-Brd6-W-v.js").then(e=>e.Ou),__vite__mapDeps([0,1])),scrim:()=>E(()=>import("./index-Brd6-W-v.js").then(e=>e.OQ),__vite__mapDeps([0,1])),label:()=>E(()=>import("./index-Brd6-W-v.js").then(e=>e.P9),__vite__mapDeps([0,1])),"radio-button":()=>E(()=>import("./index-DpDkG7bA.js"),__vite__mapDeps([2,0,1])),"radio-button-group":()=>E(()=>import("./index-D5vtdVkD.js"),__vite__mapDeps([3,0,1]))});function he({actions:e,context:t,headingLevel:a,message:r,title:s,...p}){const{primary:d,secondary:u}=e;let o;switch(t){case"danger":o="danger";break;case"info":o="brand";break;default:o="neutral"}const h=m("calcite-button",{afterCreate:g=>D(g),appearance:"solid",classes:{[c.halfWidthButton]:!!u},"data-testid":"primary-prompt-button",key:"prompt-primary-button",kind:o,onclick:d.action,width:"full"},d.label),v=u&&m("calcite-button",{appearance:"outline",class:c.halfWidthButton,"data-testid":"secondary-prompt-button",key:"prompt-secondary-button",kind:o,onclick:u.action,width:"full"},u.label);return m("calcite-scrim",{"data-testid":"prompt",key:"prompt"},m("div",{class:`${c.base}--${t}`},m("div",{class:c.header},m("calcite-icon",{icon:le.warning}),m(H,{class:c.heading,level:a},s)),m("div",{class:c.message},r),ne(p)??m("div",{class:c.divider}),m("div",{class:c.actions},v,h)))}function ne({radios:e,onRadioSelection:t,defaultRadioSelection:a}){return e?.length?m("calcite-radio-button-group",{name:"PromptChoiceList"},e.map(r=>m("calcite-label",{layout:"inline"},m("calcite-radio-button",{checked:r.value===a,value:r.value,onCalciteRadioButtonChange:()=>t?.(r.value)}),r.label))):void 0}let y=class extends R{constructor(t){super(t),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){return this.getFormattedLabel(this.element?.description)}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:t}=this;return t!=null?!!t.lastEvaluatedValue:null}get label(){return this.getFormattedLabel(this.element?.label)}get updating(){return!1}get visible(){return this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null}getFormattedLabel(t){const{feature:a,layer:r,timeZone:s}=this;return r==null||t==null?t:Z({attributes:a.attributes,label:t,layer:r,timeZone:s})}};i([l({readOnly:!0})],y.prototype,"description",null),i([l({constructOnly:!0})],y.prototype,"element",void 0),i([l()],y.prototype,"evaluatedVisibilityExpression",null),i([l()],y.prototype,"feature",void 0),i([l()],y.prototype,"label",null),i([l()],y.prototype,"layer",void 0),i([l()],y.prototype,"timeZone",void 0),i([l()],y.prototype,"type",void 0),i([l()],y.prototype,"updating",null),i([l()],y.prototype,"visible",null),i([l()],y.prototype,"visibilityExpressionExecutor",void 0),y=i([w("esri.widgets.FeatureForm.InputBase")],y);const ae=y;let f=class extends ae{constructor(e){super(e),this.editType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get evaluatedEditableExpression(){const{editableExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:e}=this;if(!e)return!1;const t=M(e),a=t?.operations.supportsEditing,r=K(t,this.editType);return!(!a||!r)}};i([l()],f.prototype,"editType",void 0),i([l()],f.prototype,"editable",null),i([l()],f.prototype,"editableExpressionExecutor",void 0),i([l()],f.prototype,"evaluatedEditableExpression",null),i([l()],f.prototype,"layerAllowsEdits",null),f=i([w("esri.widgets.FeatureForm.EditableInput")],f);const re=f;let n=class extends re{constructor(e){super(e),this._storedValue=null,this.error=null,this.preservesValueWhenHidden=!0,this.field=null,this.group=null,this.requiredExpressionExecutor=null,this.type="field",this._fieldInputWasVisibleDuringLifetime=!1,this.valueExpressionExecutor=null}initialize(){this.addHandles(q(()=>this.feature,()=>this._fieldInputWasVisibleDuringLifetime=!1,C))}get _dateFormRange(){const{element:e,field:t}=this;if(this.dataType!=="date")return{};const a=e?.domain?_(t,e.domain):null;if(!e?.input)return a??{};const r=e.input,{type:s}=r;let p={};if(s!=="date-picker"&&s!=="time-picker"&&s!=="datetimeoffset-picker"||(p=W(t,r.max,r.min)),s==="datetime-picker"){const{max:o,min:h}=r;p={max:o!=null&&O(o)?o.getTime():null,min:h!=null&&O(h)?h.getTime():null}}const{max:d,min:u}=p;if(a){const{max:o,min:h}=a,v=x(o)&&(d==null||d!=null&&o<d),g=x(h)&&(u==null||u!=null&&h>u);return{max:v?o:d??null,min:g?h:u??null,rawMax:v?a.rawMax:p?.rawMax??null,rawMin:g?a.rawMin:p?.rawMin??null}}return{min:u,max:d,rawMax:p?.rawMax??null,rawMin:p?.rawMin??null}}get _dateRange(){const{_dateFormRange:e,field:t}=this;if(this.dataType!=="date")return{};const a=_(t);if(!a)return e;const{max:r,min:s,rawMax:p,rawMin:d}=e;if(t.type==="date"){const{max:u,min:o}=a;return{max:x(r)&&(u===null||u!=null&&r<u)?r:u??null,min:x(s)&&(o===null||o!=null&&s>o)?s:o??null}}if(t.type==="date-only"||t.type==="time-only"||t.type==="timestamp-offset"){const{max:u,min:o,rawMax:h,rawMin:v}=a,g=x(r)&&p&&(u==null||r<u),T=x(s)&&d&&(o==null||s>o);return{max:g?r:u,min:T?s:o,rawMax:g?p:h,rawMin:T?d:v}}return{max:null,min:null}}get _configAllowsEdits(){const{element:e,layer:t,name:a}=this;return e!=null?e.editableExpression?!!this.evaluatedEditableExpression:e.editable!==!1:t?.userHasUpdateItemPrivileges?!0:(t&&"popupTemplate"in t?t?.popupTemplate?.fieldInfos?.find(({fieldName:s})=>s===a):null)?.isEditable??!0}get _layerAndFieldAllowEdits(){return this.layerAllowsEdits&&this.field?.editable}get _isVisibleByDefault(){const{field:e,layer:t}=this;return!!e?.visible&&S(e,t)}get _isEditTrackingField(){return P(this.layer).includes(this.name?.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&this.valueExpressionExecutor!=null&&this.valueExpressionExecutor.initialExecutionComplete}get isSubtypeField(){const{layer:e}=this;if(e&&"subtypeField"in e){const{subtypeField:t,fieldsIndex:a}=e;return(a.get(t)?.name??t)===this.name}return!1}get valueIsOutOfDomain(){const{domain:e,value:t,field:a}=this;return!(!e||t==null)&&N(a,t,e)!==null}get alias(){return ie(this.field,this.layer)}get dataType(){const{field:e}=this;return V(e)?"number":F(e)?"text":L(e)||k(e)?"date":"unsupported"}get dateDataType(){if(this.dataType==="date")return this.field.type!=="date"?"string":"number"}get domain(){const{layer:e,feature:t,name:a,element:r}=this,s=r?.domain;return s!=null&&this._isDomainCompatible(s)?s:e.getFieldDomain(a,{feature:t})}get editable(){return!!this._layerAndFieldAllowEdits&&(this.evaluatedEditableExpression??this._configAllowsEdits)}get evaluatedRequiredExpression(){const{requiredExpressionExecutor:e}=this;return e!=null?!!e.lastEvaluatedValue:null}get evaluatedValueExpression(){const{valueExpressionExecutor:e}=this;return e!=null?e.lastEvaluatedValue:null}get hint(){return this.element?.hint}get includeDate(){return!(this.dataType!=="date"||this.field.type==="time-only")}get includeTime(){const{element:e,field:t}=this;if(this.dataType!=="date")return!1;if(t.type==="time-only")return!0;if(t.type==="date-only")return!1;const a=e?.input?.type==="datetime-picker"?e.input.includeTime:void 0;return a===void 0||a}get includeTimeOffset(){if(this.field.type!=="timestamp-offset")return!1;const e=this.element?.input;return!e||e.type==="datetimeoffset-picker"&&e.includeTimeOffset}set initialFeature(e){this._set("initialFeature",e),this.notifyChange("valid")}get inputType(){return this.element?.input?.type}get hasInvalidSwitchValue(){const{element:e}=this,t=J(e,"switch")?e.input:null;return!t||X(this.value,t)}get isRelationshipKeyField(){const{field:e,layer:t}=this;return j(t)&&!!t.relationships?.some(a=>a.keyField===e.name)}get label(){return this.getFormattedLabel(this.element?.label)||this.alias||this.field.name}get maxLength(){return Y({dataType:this.dataType,field:this.field,input:this.element?.input})}get minLength(){return z({dataType:this.dataType,field:this.field,input:this.element?.input})}get name(){return this.field?.name}get range(){const{domain:e,element:t,field:a}=this;if(this.dataType==="date")return this._dateRange;const r=_(a,e)||B(a,e),s=r?.max===Number.MAX_VALUE?null:r?.max??null,p=r?.min===-Number.MAX_VALUE?null:r?.min??null;if(!t?.domain||t.domain.type!=="range")return{max:s,min:p};const{max:d,min:u}=_(a)||{};return{max:d!=null&&(s===null||s!=null&&d<s)?d:s,min:u!=null&&(p===null||p!=null&&u>p)?u:p}}get required(){const{editable:e,evaluatedRequiredExpression:t,field:a,visible:r,isSubtypeField:s}=this;return e?a?.nullable===!1||s?!0:!(!r||this.group?.visible===!1||t==null)&&t:!1}set required(e){this._overrideIfSome("required",e)}get showNoValueOptionEnabled(){const{element:e}=this;return!this.required&&(!$(e)||e.input.showNoValueOption)}get showNoValueLabel(){const{element:e}=this;return $(e)?e.input.noValueOptionLabel:null}get submittable(){const{field:e,required:t,valid:a,value:r}=this;return(!t||r!=null)&&(!!a||this.initialFeature.getAttribute(e.name)===r)}get timeResolution(){const e=this.element?.input;if(e&&(e.type==="datetimeoffset-picker"||e.type==="time-picker"))return e.timeResolution??"minutes"}get timeStep(){return this.timeResolution!=null?Q.get(this.timeResolution):void 0}get updating(){const{editableExpressionExecutor:e,valueExpressionExecutor:t,visibilityExpressionExecutor:a,preservesValueWhenHidden:r}=this;return t!=null&&t.updating||e!=null&&e.updating||r===!1&&a!=null&&a.updating}get valid(){const e=this.editable?this._validate():null;return this._set("error",e),e===null}get value(){if(this._fieldInputWasVisibleDuringLifetime=this._fieldInputWasVisibleDuringLifetime||this.visible&&this.group?.visible!==!1,this.preservesValueWhenHidden===!1&&this._fieldInputWasVisibleDuringLifetime&&(this.visibilityExpressionExecutor?.lastEvaluatedValue===!1||this.group?.visibilityExpressionExecutor?.lastEvaluatedValue===!1))return this._storedValue!==null&&this.set("_storedValue",null),null;if(this._shouldUseValueExpression){const e=this.evaluatedValueExpression;return this.dataType==="date"?this._arcadeOutputToDateFieldValue(e):e!=null&&typeof e=="object"?`${e}`:e}return this._storedValue}set value(e){this.notifyChange("evaluatedVisibilityExpression"),this.set("_storedValue",e),this.notifyChange("value"),this.notifyChange("valid")}get visible(){return!this._isEditTrackingField&&(this.evaluatedVisibilityExpression!=null?this.evaluatedVisibilityExpression:this.element!=null&&this.field?.visible!==!1||this._isVisibleByDefault)}_arcadeOutputToDateFieldValue(e){const t=this.field.type;try{if(typeof e=="object"){if(e===null)return null;if(ee(e))return te(e,t);if("getTime"in e&&typeof e.getTime=="function"&&t==="date")return parseInt(e.getTime(),10);if(t==="date-only"||t==="time-only"||t==="timestamp-offset")return e.toString()}else{if(typeof e=="string")return t==="date"?parseInt(e,10):e;if(typeof e=="number"&&t==="date")return e}throw new U("feature-form:invalid-date-value","Date value is invalid")}catch{return t==="date"?NaN:""}}_isDomainCompatible(e){const{field:t}=this;if(e?.type==="coded-value"){const a=typeof e.codedValues[0].code;if(a==="string"&&F(t)||a==="number"&&V(t))return!0}return!!(e?.type==="range"&&V(t)||L(t)||k(t))}_validate(){const{dataType:e,domain:t,field:a,minLength:r,range:s,required:p,value:d,maxLength:u}=this;return G(d,{dataType:e,domain:t,field:a,maxLength:u,minLength:r,range:s,required:p})}};i([l()],n.prototype,"_dateFormRange",null),i([l()],n.prototype,"_dateRange",null),i([l()],n.prototype,"_storedValue",void 0),i([l()],n.prototype,"_configAllowsEdits",null),i([l()],n.prototype,"_layerAndFieldAllowEdits",null),i([l()],n.prototype,"_isVisibleByDefault",null),i([l()],n.prototype,"_isEditTrackingField",null),i([l()],n.prototype,"_shouldUseValueExpression",null),i([l()],n.prototype,"isSubtypeField",null),i([l()],n.prototype,"valueIsOutOfDomain",null),i([l()],n.prototype,"alias",null),i([l()],n.prototype,"dataType",null),i([l()],n.prototype,"dateDataType",null),i([l()],n.prototype,"domain",null),i([l()],n.prototype,"editable",null),i([l({readOnly:!0})],n.prototype,"error",void 0),i([l({constructOnly:!0})],n.prototype,"preservesValueWhenHidden",void 0),i([l()],n.prototype,"evaluatedRequiredExpression",null),i([l()],n.prototype,"evaluatedValueExpression",null),i([l()],n.prototype,"field",void 0),i([l()],n.prototype,"group",void 0),i([l({readOnly:!0})],n.prototype,"hint",null),i([l()],n.prototype,"includeDate",null),i([l()],n.prototype,"includeTime",null),i([l()],n.prototype,"includeTimeOffset",null),i([l()],n.prototype,"initialFeature",null),i([l({readOnly:!0})],n.prototype,"inputType",null),i([l()],n.prototype,"hasInvalidSwitchValue",null),i([l()],n.prototype,"isRelationshipKeyField",null),i([l()],n.prototype,"label",null),i([l()],n.prototype,"maxLength",null),i([l()],n.prototype,"minLength",null),i([l({readOnly:!0})],n.prototype,"name",null),i([l()],n.prototype,"range",null),i([l()],n.prototype,"required",null),i([l()],n.prototype,"requiredExpressionExecutor",void 0),i([l()],n.prototype,"showNoValueOptionEnabled",null),i([l()],n.prototype,"submittable",null),i([l()],n.prototype,"timeResolution",null),i([l()],n.prototype,"timeStep",null),i([l({readOnly:!0})],n.prototype,"type",void 0),i([l()],n.prototype,"updating",null),i([l()],n.prototype,"valid",null),i([l({value:null})],n.prototype,"value",null),i([l()],n.prototype,"valueExpressionExecutor",void 0),i([l()],n.prototype,"visible",null),n=i([w("esri.widgets.FeatureForm.FieldInput")],n);const fe=n;export{fe as O,ye as a,le as b,me as c,ie as e,re as p,he as r,ae as s};
