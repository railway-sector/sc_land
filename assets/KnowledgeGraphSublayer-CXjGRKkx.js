import{ll as _e,dY as je,jb as ye,Y as Le,$ as Me,f8 as _,a4 as q,eX as P,hL as Fe,fh as ee,lh as F,aV as z,b3 as te,qb as he,ae as Ce,_ as o,e as p,g as ne,tm as ke,ty as Ae,tz as Ge,tn as De,tF as Pe,BW as Qe,xA as Ue,vC as Q,j0 as V,BX as Z,dh as ce,as as We,vG as He,df as me,ja as qe,aa as ae,d$ as Be,vs as Je,vt as ze,vu as Ve,af as Ze,vr as Ke,np as Ye,ag as Xe,nq as et,h4 as tt,BY as it,eW as X,lO as W,vw as st,to as nt,nl as fe,tB as rt,dL as at,vx as ot,ad as pt,al as lt,ah as dt,aP as C,BZ as ut,B_ as yt,B$ as ht,zu as ct,C0 as mt,C1 as ft,o1 as gt,vL as bt,vM as wt,vD as Tt,C2 as It,tE as Nt,nm as Et,vE as $t,y5 as vt,cn as St,AQ as Lt,vB as Mt}from"./index-BrQW8HOS.js";import{I as ie,t as se,_ as S,E as K,S as le,o as oe}from"./constants-SxxbBSOD.js";import{S as Ct}from"./supportUtils-DrwoxJkk.js";import{i as H,l as kt,V as Dt}from"./knowledgeGraphService-DCqufs3g.js";import{p as G,a as ge,i as be}from"./GraphQueryStreaming-Bwp7fp3d.js";import{f as xt}from"./FeatureStore-BLsWQMez.js";import{W as Rt}from"./QueryEngine-C2NYE8DG.js";import{u as we}from"./clientSideDefaults-CO7iVa9s.js";import{s as Ot,t as _t}from"./QueryEngineCapabilities-DJC_YILC.js";import{L as Te}from"./utils-6_NAbAK3.js";let re=class A{constructor(){this._featureLookup=new Map}static getInstance(){return A.instance||(A.instance=new A),A.instance}static resetInstance(){A.instance&&(A.instance=null)}deleteFromStore(t){t.forEach(e=>{this._featureLookup.delete(e)})}readFromStoreByList(t){const e=[];return t.forEach(s=>{const n=this.readFromStoreById(s);n&&e.push(n)}),e}readFromStoreById(t){return this._featureLookup.get(t)??null}writeToStore(t,e,s){const n=[];return t.forEach(a=>{if(!a?.id)return;a.properties||(a.properties=[]);let d,c=null;if(s&&a.properties[s]&&(c=_e(a.properties[s])),"originId"in a&&"destinationId"in a&&(a.properties[ie]=a.originId,a.properties[se]=a.destinationId),a.properties[e]=a.id,a.id&&this._featureLookup.has(a.id)&&this._featureLookup.get(a.id).attributes){const h=this._featureLookup.get(a.id),b=JSON.parse(JSON.stringify(Object.assign(h.attributes,a.properties)));s&&a.properties[s]&&(b[s]=je(a.properties[s])),d=new ye(c?JSON.parse(JSON.stringify(c)):h?.geometry?JSON.parse(JSON.stringify(h.geometry)):null,b,null,a.properties[e])}else d=new ye(c?JSON.parse(JSON.stringify(c)):null,a.properties,null,a.properties[e]);this._featureLookup.set(`${a.typeName?`${a.typeName}__${a.id}`:a.id}`,d),n.push(d)}),n}};const pe=(i,t)=>{if(i.type==="column-reference")return i.column===t.systemOidFieldName?"ID(n)":`n.${i.column}`;if(i.type==="string")return`'${i.value}'`;if(i.type==="number")return`${i.value}`;if(i.type==="binary-expression"&&t.supportedSqlTypes.has(i.left.type)&&t.supportedSqlTypes.has(i.right.type)&&t.supportedSqlOperators.has(i.operator))return`${pe(i.left,t)} ${i.operator} ${pe(i.right,t)}`;if(i.type==="binary-expression"&&i.operator==="LIKE"){let e="";if(i.left.type==="function"&&i.left.args.value[0].type==="column-reference")e+=`lower(n.${i.left.args.value[0].column})`;else{if(i.left.type!=="column-reference")return t.unsupportedOperationFound=!0,"";e+=`lower(n.${i.left.column})`}if(e+=" CONTAINS (",i.right.type!=="string")return t.unsupportedOperationFound=!0,"";{let s=i.right.value;s.startsWith("%")&&(s=s.slice(1)),s.endsWith("%")&&(s=s.slice(0,-1)),e+=`'${s.toLowerCase()}')`}return e}return t.unsupportedOperationFound=!0,""};let D=class extends Le{constructor(t){super(t),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const e=new Map;t.knowledgeGraph.dataModel.entityTypes?.forEach(s=>{s.name&&(e.set(s.name,"entity"),this._processingCacheUpdatesLookup.set(s.name,[]),t.inclusionModeDefinition&&!t.inclusionModeDefinition?.generateAllSublayers||this.entityTypeNames.add(s.name),s.properties?.forEach(n=>{n.geometryType&&n.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(s.name,{name:n.name??"",geometryType:n.geometryType})}))}),t.knowledgeGraph.dataModel.relationshipTypes?.forEach(s=>{s.name&&(e.set(s.name,"relationship"),this._processingCacheUpdatesLookup.set(s.name,[]),t.inclusionModeDefinition&&!t.inclusionModeDefinition?.generateAllSublayers||this.relationshipTypeNames.add(s.name),s.properties?.forEach(n=>{n.geometryType&&n.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(s.name,{name:n.name??"",geometryType:n.geometryType})}))}),t.inclusionModeDefinition?.namedTypeDefinitions.forEach((s,n)=>{if(e.get(n)==="entity")this.entityTypeNames.add(n);else{if(e.get(n)!=="relationship")return Me.getLogger(this).warn(`A named type, ${n}, was in the inclusion list that wasn't in the data model and will be removed`),void t.inclusionModeDefinition?.namedTypeDefinitions.delete(n);this.relationshipTypeNames.add(n)}const a=new Map;s.members?.forEach(d=>{_(this.memberIdTypeLookup,d.id,()=>new Set).add(n)}),this.sublayerCaches.set(n,a)})}addToLayer(t){t.forEach(({typeName:e,id:s})=>{if(!this.inclusionModeDefinition)throw new q("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){const n=this.inclusionModeDefinition.namedTypeDefinitions.get(e);n.members||(n.members=new Map),n.members.set(s,{id:s}),_(this.memberIdTypeLookup,s,()=>new Set).add(e)}}else{const n=new Map;n.set(s,{id:s}),this.inclusionModeDefinition.namedTypeDefinitions.set(e,{useAllData:!1,members:n}),_(this.memberIdTypeLookup,s,()=>new Set).add(e)}})}getById(t){return re.getInstance().readFromStoreById(t)}async getData(t,e,s){if(e.objectType.name&&this.inclusionModeDefinition?.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(e.objectType.name))return[];let n;if(n=t||new P({where:"1=1",outFields:["*"]}),e.parentCompositeLayer.type==="link-chart"){const a=e.parentCompositeLayer,d=this._processingCacheUpdatesLookup.get(e.objectType.name??""),c=n.outFields;c&&c.length===1&&c[0]===S&&n.where==="1=1"||await Promise.all(d??[]);const h=this.sublayerCaches.has(e.objectType.name??"")?Array.from(this.sublayerCaches.get(e.objectType.name)?.values()):[],b=[];return h.forEach(r=>{if(this.relationshipTypeNames.has(e.objectType.name)){r.geometry=a.relationshipLinkChartDiagramLookup.get(r.attributes[e.objectIdField]);const l=this.memberIdTypeLookup.get(r.attributes[ie]),y=this.memberIdTypeLookup.get(r.attributes[se]),f=this._isEndEntitySpatial(l,r,ie),I=this._isEndEntitySpatial(y,r,se);r.attributes[K]=Number(f&&I)}else{r.geometry=a.entityLinkChartDiagramLookup.get(r.attributes[e.objectIdField]);const l=this.geographicLookup.get(e.objectType.name);l&&r.attributes[l.name]?r.attributes[K]=1:r.attributes[K]=0}r.attributes[le]=r.geometry,b.push(r)}),b}return this.retrieveDataFromService(n,e,s)}async getConnectedRecordIds(t,e,s){const n=[];let a="";const d=this._getNamedTypeIdMapFromNodeIds(t);if(e&&e?.length!==0){for(const l of e)a=a+l+"|";a=a.slice(0,-1)}const c={},h=[];for(const[l,y]of d){const f=`${l}_ids`;c[f]=y,e&&e?.length!==0?h.push(`MATCH (n:${l}) WHERE id(n) IN $${f} WITH n MATCH (n)-[r:${a}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`):h.push(`MATCH (n:${l}) WHERE id(n) IN $${f} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`)}if(!h.length)return n;const b=h.join(" UNION "),r=(await H(this.knowledgeGraph,new G({openCypherQuery:b,bindParameters:c}),{signal:s?.signal})).resultRowsStream.getReader();for(;;){const{done:l,value:y}=await r.read();if(l)break;for(let f=0;f<y.length;f++){const I=y[f];n.push({id:I[0],typeName:I[1]}),n.push({id:I[2],typeName:I[3]})}}return n}async getRelationshipsBetweenNodes(t,e,s){const n=this._getNamedTypeIdMapFromNodeIds(t);if(n.size===0)return[];const a={relationshipExclusionIds:e,possibleConnectionEntityIds:t},d=[];for(const[r,l]of n.entries()){const y=`${r}_ids`;a[y]=l,d.push(`MATCH (n:${r}) WHERE id(n) IN $${y} WITH n MATCH (n)-[r]->(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`)}const c=d.join(" UNION "),h=[],b=(await H(this.knowledgeGraph,new G({openCypherQuery:c,bindParameters:a}),{signal:s?.signal})).resultRowsStream.getReader();for(;;){const{done:r,value:l}=await b.read();if(r)break;for(let y=0;y<l.length;y++){const f=l[y];h.push({id:f[0],typeName:f[1]})}}return h}async getRelationshipsFromNodes(t,e,s,n){const a=this._getNamedTypeIdMapFromNodeIds(t);if(a.size===0||e.length===0)return[];const d={relationshipExclusionIds:s,possibleConnectionEntityIds:e},c=[];for(const[y,f]of a.entries()){const I=`${y}_ids`;d[I]=f,c.push(`MATCH (n:${y}) WHERE id(n) IN $${I} WITH n MATCH (n)-[r]-(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`)}const h=c.join(" UNION "),b=new Map,r=(await H(this.knowledgeGraph,new G({openCypherQuery:h,bindParameters:d}),{signal:n?.signal})).resultRowsStream.getReader();for(;;){const{done:y,value:f}=await r.read();if(y)break;for(let I=0;I<f.length;I++){const w=f[I];let m=b.get(w[1]);m||(m=new Set,b.set(w[1],m)),m.add(w[0])}}const l=[];for(const[y,f]of b)for(const I of f)l.push({id:I,typeName:y});return l}async refreshCacheContent(t,e,s,n=!0,a){const d=re.getInstance(),c=[],h=new Map,b=new Map;this.knowledgeGraph.dataModel.entityTypes?.forEach(r=>{r.name&&b.set(r.name,r)}),this.knowledgeGraph.dataModel.relationshipTypes?.forEach(r=>{r.name&&b.set(r.name,r)}),t||this.inclusionModeDefinition?t?t.forEach(r=>{if(this.memberIdTypeLookup.has(r))for(const l of this.memberIdTypeLookup.get(r))h.has(l)?h.get(l)?.push(r):h.set(l,[r])}):this.inclusionModeDefinition?.namedTypeDefinitions?.forEach((r,l)=>{r.useAllData?h.set(l,null):r.members&&r.members.forEach(y=>{h.has(l)&&h.get(l)!==null?h.get(l)?.push(y.id):h.set(l,[y.id])})}):(this.knowledgeGraph.dataModel.entityTypes?.forEach(r=>{r.name&&h.set(r.name,null)}),this.knowledgeGraph.dataModel.entityTypes?.forEach(r=>{r.name&&h.set(r.name,null)}));for(const[r,l]of h){const y=new Set(l),f=new Promise((I,w)=>{(async()=>{const E=new Set,N=[];let v,g="",L=!1;if(e||b.get(r)?.properties?.forEach($=>{$.name&&E.add($.name)}),s&&this.geographicLookup.has(r)){const $=this.geographicLookup.get(r)?.name;$&&E.add($)}if(this.entityTypeNames.has(r))g=`MATCH (n:${r}) ${l?"WHERE id(n) IN $ids ":""}return ID(n)`,E.forEach($=>{g+=`, n.${$}`,N.push($)});else{if(!this.relationshipTypeNames.has(r))throw new q("knowledge-graph:layer-data-manager",`The graph type of ${r} could not be determined. Was this type set in the KG data model and inclusion definition?`);L=!0,g=`MATCH ()-[n:${r}]->() ${l?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,E.forEach($=>{g+=`, n.${$}`,N.push($)})}v=new G(l?{openCypherQuery:g,bindParameters:{ids:l}}:{openCypherQuery:g});const T=(await H(this.knowledgeGraph,v,{signal:a?.signal})).resultRowsStream.getReader();for(;;){const{done:$,value:de}=await T.read();if($)break;const ue=[];for(let x=0;x<de.length;x++){const U=de[x];let R=0,Y=0;const M={properties:{}};for(M.id=U[R],R++,Y++,L&&(M.originId=U[R],R++,Y++,M.destinationId=U[R],R++,Y++,_(this.nodeConnectionsLookup,M.originId,()=>new Set).add(M.id),_(this.nodeConnectionsLookup,M.destinationId,()=>new Set).add(M.id),_(this.relationshipConnectionsLookup,M.id,()=>[M.originId,M.destinationId]));R<U.length;R++)M.properties[N[R-Y]]=U[R];y.delete(M.id),ue.push(M)}const Re=d.writeToStore(ue,S,this.geographicLookup.get(r)?.name);this.sublayerCaches.has(r)||this.sublayerCaches.set(r,new Map),n&&!this.inclusionModeDefinition?.namedTypeDefinitions.has(r)&&this.inclusionModeDefinition?.namedTypeDefinitions.set(r,{useAllData:!1,members:new Map}),n&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(r).members&&(this.inclusionModeDefinition.namedTypeDefinitions.get(r).members=new Map);const Oe=this.sublayerCaches.get(r);Re.forEach(x=>{Oe?.set(x.attributes[S],x),n&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(r).members.has(x.attributes[S])&&(this.inclusionModeDefinition?.namedTypeDefinitions.get(r).members.set(x.attributes[S],{id:x.attributes[S]}),_(this.memberIdTypeLookup,x.attributes[S],()=>new Set).add(r))})}const j=this.inclusionModeDefinition?.namedTypeDefinitions.get(r);if(j)for(const $ of y)j.members?.delete($)})().then(()=>{I(null)}).catch(E=>{E.name==="AbortError"?I(null):w(E)})});c.push(f),this._processingCacheUpdatesLookup.get(r)?.push(f)}if(await Promise.all(c),a?.signal?.aborted)throw Fe()}removeFromLayer(t){const e=new Set,s=new Set(t.map(n=>n.id));for(const n of t)e.add(n.typeName),this.memberIdTypeLookup.get(n.id)?.size===1?this.memberIdTypeLookup.delete(n.id):this.memberIdTypeLookup.get(n.id)?.delete(n.typeName),this.inclusionModeDefinition?.namedTypeDefinitions.forEach((a,d)=>{d===n.typeName&&a.members?.has(n.id)&&a.members.delete(n.id)});e.forEach(n=>{this.sublayerCaches.get(n)?.forEach((a,d)=>{s.has(d)&&this.sublayerCaches.get(n)?.delete(d)})})}async retrieveDataFromService(t,e,s){const n=re.getInstance(),a=new Set,d=[];let c,h="",b=[];const r=e.graphType==="relationship",l=this.inclusionModeDefinition?.namedTypeDefinitions?.get(e.objectType.name)?.useAllData,y=e.parentCompositeLayer.sublayerIdsCache.get(e.objectType.name);let f=!l&&y?Array.from(y).sort():null;if(this.inclusionModeDefinition?.namedTypeDefinitions?.get(e.objectType.name)?.useAllData)this.inclusionModeDefinition?.namedTypeDefinitions?.get(e.objectType.name)?.useAllData&&t.objectIds!=null&&(f=t.objectIds);else if(t.objectIds!=null&&f&&f.length>0){const w=t.objectIds;t.objectIds=f.filter(m=>w.includes(m))}else if(t.objectIds!=null)f=t.objectIds;else{if(this.inclusionModeDefinition?.namedTypeDefinitions.has(e.objectType.name)&&(!this.inclusionModeDefinition.namedTypeDefinitions.get(e.objectType.name)?.members||this.inclusionModeDefinition.namedTypeDefinitions.get(e.objectType.name)?.members?.size<1))return t.objectIds=[],[];t.objectIds=f}if(t.outFields!=null){const w=t.outFields;w.includes("*")?e.fields.forEach(m=>{a.add(m.name)}):w.forEach(m=>{m!==S&&m!==e.geometryFieldName&&a.add(m)})}if(t.geometry!=null){const w=t.geometry;let m;const E=e.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,N=E?.spatialReference,v=E?.serviceCapabilities?.geometryCapabilities;let g=v?.geometryMaxBoundingRectangleSizeX,L=v?.geometryMaxBoundingRectangleSizeY;if(w.type==="point"){let T=w;T.spatialReference?.isWGS84||(await ee(T.spatialReference,F),T=z(T,F)),m=new te({spatialReference:F,xmin:T.x-1e-4,ymin:T.y-1e-4,xmax:T.x+1e-4,ymax:T.y+1e-4})}else w?.extent?.spatialReference&&!w.spatialReference?.isWGS84?(await ee(w.extent.spatialReference,F),m=z(w.extent,F)):m=w.extent;if(g&&L&&N){if(N.wkid!==4326){const T=new te({spatialReference:N,xmax:g,ymax:L}),j=z(T,F);g=j.xmax,L=j.ymax}if(m.xmax-m.xmin>g)throw new q("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${g}° latitude, limit exceeded`);if(m.ymax-m.ymin>L)throw new q("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${L}° longitude, limit exceeded`)}if(t.where!=null&&t.where!=="1=1"){const T=await he(t.where.toUpperCase(),e.fieldsIndex);e.fields.forEach(j=>{T.fieldNames.includes(j.name)&&a.add(j.name)})}h=r?`Match ()-[n:${e.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${e.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${e.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${e.geometryFieldName}) return ID(n)`,e.geometryFieldName&&a.add(e.geometryFieldName),a.forEach(T=>{h+=`, n.${T}`,d.push(T)}),c=new G({openCypherQuery:h,bindParameters:{param_filter_geom:new Ce({rings:Ct(m)})}})}else{let w="";if(t.where!=null&&t.where!=="1=1"){const N=await he(t.where,e.fieldsIndex);e.fields.forEach(g=>{N.fieldNames.includes(g.name)&&a.add(g.name)});const v={systemOidFieldName:S,supportedSqlTypes:new Set(["column-reference","string","number","binary-expression"]),supportedSqlOperators:new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]),unsupportedOperationFound:!1};w=pe(N.parseTree,v),v.unsupportedOperationFound&&(w="")}let m="";m=r?`Match ()-[n:${e.objectType.name}]->()`:`Match (n:${e.objectType.name})`;let E=!1;f&&(E=!0,m+=" WHERE ID(n) IN $ids"),w&&(m+=E?" AND":" WHERE",m+=` ${w}`),m+=" return ID(n)",r&&(m+=", id(startNode(n)), id(endNode(n))"),t.returnGeometry&&e.geometryFieldName&&a.add(e.geometryFieldName),a.forEach(N=>{m+=`, n.${N}`,d.push(N)}),c=new G(f?{openCypherQuery:m,bindParameters:{ids:f}}:{openCypherQuery:m})}const I=(await H(e.parentCompositeLayer.dataManager.knowledgeGraph,c,s)).resultRowsStream.getReader();for(;;){const{done:w,value:m}=await I.read();if(w)break;const E=[];for(let N=0;N<m.length;N++){const v=m[N];let g=0,L=0;const T={properties:{}};for(T.id=v[g],g++,L++,r&&(T.originId=v[g],g++,L++,T.destinationId=v[g],g++,L++);g<v.length;g++)T.properties[d[g-L]]=v[g];E.push(T)}b=b.concat(n.writeToStore(E,S,e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name)?.name))}return b}_isEndEntitySpatial(t,e,s){for(const n of t??[])if(this.entityTypeNames.has(n)){const a=this.geographicLookup.get(n),d=a&&this.sublayerCaches.get(n)?.get(e.attributes[s]);if(a&&d?.attributes[a.name])return!0}return!1}_getNamedTypeIdMapFromNodeIds(t){const e=new Map;return t.forEach(s=>{if(this.memberIdTypeLookup.has(s))for(const n of this.memberIdTypeLookup.get(s)){if(!this.entityTypeNames.has(n))return;e.has(n)?e.get(n)?.push(s):e.set(n,[s])}}),e}};o([p()],D.prototype,"knowledgeGraph",void 0),o([p()],D.prototype,"inclusionModeDefinition",void 0),o([p()],D.prototype,"entityTypeNames",void 0),o([p()],D.prototype,"relationshipTypeNames",void 0),o([p()],D.prototype,"geographicLookup",void 0),o([p()],D.prototype,"sublayerCaches",void 0),o([p()],D.prototype,"nodeConnectionsLookup",void 0),o([p()],D.prototype,"relationshipConnectionsLookup",void 0),o([p()],D.prototype,"memberIdTypeLookup",void 0),D=o([ne("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],D);const jt=Symbol("isKnowledgeGraphGraphicOriginSymbol");var Ie;class Ft extends ke{get[(Ie=jt,Ae)](){return this.sublayer}get[Ge](){return this.sublayer}get[De](){return this.sublayer}constructor(t,e){super(),this[Ie]=!0,this.type="knowledge-graph",this.layer=t,this.sublayer=e}get id(){return this.layer.id}}const At=Symbol("isLinkChartGraphicOriginSymbol");var Ne;class Gt extends ke{get[(Ne=At,De)](){return this.layer}constructor(t,e){super(),this[Ne]=!0,this.type="link-chart",this.layer=t,this.sublayer=e}get id(){return`${this.layer.id}:__${this.sublayer.id}__`}}const Ee=Pe(),Pt=i=>{const t=i;let e=class extends t{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return o([p(Ee.fields)],e.prototype,"fields",void 0),o([p(Ee.fieldsIndex)],e.prototype,"fieldsIndex",void 0),e=o([ne("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],e),e},Qt=Qe;let O=class extends Le{constructor(i){super(i),this.entityAdds=void 0,this.entityUpdates=void 0,this.entityDeletes=void 0,this.relationshipAdds=void 0,this.relationshipUpdates=void 0,this.relationshipDeletes=void 0,this.options=void 0}};o([p()],O.prototype,"entityAdds",void 0),o([p()],O.prototype,"entityUpdates",void 0),o([p()],O.prototype,"entityDeletes",void 0),o([p()],O.prototype,"relationshipAdds",void 0),o([p()],O.prototype,"relationshipUpdates",void 0),o([p()],O.prototype,"relationshipDeletes",void 0),o([p()],O.prototype,"options",void 0),O=o([ne("esri.rest.knowledgeGraph.GraphApplyEdits")],O);const Ut={initializeLayersFromClientData:async(i,t,e)=>{if(t||(t=[...i.layers,...i.tables].map(a=>a.graphTypeName)),t?.length===0)return;const s=new Map;for(const a of t)s.set(a,$e(i,a));const n=await kt(i.dataManager.knowledgeGraph,Array.from(s.values()),{requestOptions:{signal:e?.signal}});for(const a of[...i.layers,...i.tables]){const d=a.objectType.name;if(d==null)continue;const c=n.get($e(i,d));if(c){const h=JSON.parse(c);h===null||typeof h!="object"||h.hasOwnProperty("showLabels")||(h.showLabels=!1),a.read(h,{origin:"service"})}}}},$e=(i,t)=>i.type==="knowledge-graph"?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;async function ci(i,t,e){return Ut.initializeLayersFromClientData(i,t,e)}const ve=["#4a0932","#b31515","#18382e","#a64f1b","#102432","#8c213f","#ed9310","#2c6954","#144d59","#ffc730","#75351e","#454f4b","#78b1c2","#191921","#8f8f82","#9be0c0","#dbb658","#87b051","#11495c","#c43541","#9c5596","#44498b","#ad9d63","#86afb3","#5c98ca","#b0bfa2","#73241f","#b86b53","#d9d78c","#3e756d","#f260a1","#a0d17d","#c27c30","#eb82eb","#ffdf3c","#ffb259","#ab52b3","#3cccb4","#0095ba","#d92b30"],Wt="#8f8f82";function Ht(i){return i<0||i>=ve.length?new ce(Wt):new ce(ve[i])}function qt(i){const t=i.toArray();return new We({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,style:"solid",width:.75,color:t},{type:"CIMVectorMarker",enable:!0,size:6,markerPlacement:{type:"CIMMarkerPlacementOnLine",angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-10,ymin:-5,xmax:0,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[-12,-3.47],[-12,3.6],[1.96,-.03],[-12,-3.47]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:t}]}}]}]}}})}function Bt(i){let t="ESRI__ID",e=4;for(const s of i)if(s.name){if(s.name.toLowerCase()==="name"){t=s.name;break}s.name.toLowerCase().includes("name")?(t=s.name,e=2):s.fieldType==="esriFieldTypeString"&&e>3&&(t=s.name,e=3)}return t}function Jt(i,t,e){const s={color:[80,80,80],haloColor:[255,255,255],haloSize:.7,font:{size:10,weight:"normal"}},n=new Q({labelExpressionInfo:new Z({expression:e==="ESRI__ID"?`${t}`:`$feature.${e}`}),labelPlacement:"above-center",symbol:new V(s)}),a=new Q({labelExpressionInfo:new Z({expression:`'${t}' + IIf($feature.ESRI__AggregationCount>1, ' (' + $feature.ESRI__AggregationCount + ')', '')`}),labelPlacement:"center-along",labelPosition:"parallel",repeatLabel:!1,symbol:new V({...s,yoffset:"12px"})});return i==="entity"?[n]:[a]}function zt(i,t,e){const s={color:[255,255,255],haloColor:[0,0,0],haloSize:.7,font:{size:10,weight:"bold"}},n=e==="ESRI__ID"?`${i}`:`$feature.${e}`;return t==="point"?[new Q({labelExpressionInfo:new Z({expression:n}),labelPlacement:"above-center",symbol:new V(s)})]:t==="polyline"?[new Q({labelExpressionInfo:new Z({expression:n}),labelPlacement:"center-along",repeatLabel:!0,symbol:new V(s)})]:t==="polygon"?[new Q({labelExpressionInfo:new Z({expression:n}),labelPlacement:"always-horizontal",symbol:new V(s)})]:null}const Vt={capabilities:[],allowGeometryUpdates:!1,serviceCapabilities:{geometryCapabilities:{supportsZValues:!1,supportsMValues:!1}}};function Zt(i){const{capabilities:t,allowGeometryUpdates:e,serviceCapabilities:{geometryCapabilities:{supportsZValues:s,supportsMValues:n}}}=i?.serviceDefinition||Vt,a=i?.dataModel.arcgisManaged?t:t.filter(c=>c==="Query"),d=new Set(a);return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:n,supportsZ:s},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:d.has("Create"),supportsDelete:d.has("Delete"),supportsEditing:d.has("Editing"),supportsChangeTracking:!1,supportsQuery:d.has("Query"),supportsQueryBins:!1,supportsQueryPivot:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:d.has("Update"),supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},query:_t,queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:Ot,editing:{supportsGeometryUpdate:!!i?.dataModel.arcgisManaged&&e,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:d.has("Delete"),supportsUpdateByAnonymous:!1,supportsUpdateByOthers:d.has("Update"),supportsAsyncApplyEdits:!1,zDefault:void 0}}}async function Kt(i,t){const e=new O,s=t.graphTypeName,n=t.graphType,a=t.parentCompositeLayer.type==="knowledge-graph"?t.geometryFieldName:null,d=!!t.fieldsIndex.get(a)?.editable,c=r=>{const l={...r};for(const y of t.fields)y.editable||delete l[y.name];for(const y of Object.keys(r))y.includes("ESRI__")&&delete l[y];return l},h=async r=>{await ee(r.spatialReference,ae.WGS84);const l=z(r,ae.WGS84);return l.type==="point"?l.normalize():(await Be(l))[0]};for(const r of i.addFeatures??[]){const l=c(r.attributes);me(r.sourceLayer)&&r.sourceLayer.graphTypeName===s&&(n==="entity"?(e.entityAdds||(e.entityAdds=[]),a&&r.geometry&&(l[a]=await h(r.geometry)),e.entityAdds.push(new ge({properties:l,typeName:s}))):(e.relationshipAdds||(e.relationshipAdds=[]),e.relationshipAdds.push(new be({properties:l,typeName:s}))))}for(const r of i.updateFeatures??[]){const l=r.attributes[S],y=c(r.attributes);me(r.sourceLayer)&&r.sourceLayer.graphTypeName===s&&(n==="entity"?(e.entityUpdates||(e.entityUpdates=[]),a&&d&&r.geometry&&(y[a]=await h(r.geometry)),e.entityUpdates.push(new ge({id:l,properties:y,typeName:s}))):(e.relationshipUpdates||(e.relationshipUpdates=[]),e.relationshipUpdates.push(new be({id:l,properties:y,typeName:s}))))}const b=new Map;for(const r of i.deleteFeatures??[])if(qe(r)){const l=r,y=_(b,l.sourceLayer.graphTypeName,()=>({typeName:l.sourceLayer.graphTypeName,ids:[]}));l.sourceLayer.graphTypeName===s&&y.ids.push(l.attributes[S])}else r.objectId&&typeof r.objectId=="string"&&_(b,s,()=>({typeName:s,ids:[]})).ids.push(r.objectId);for(const r of b.values())r.ids.length>0&&(n==="entity"?(e.entityDeletes||(e.entityDeletes=[]),e.entityDeletes.push({typeName:r.typeName,ids:r.ids})):(e.relationshipDeletes||(e.relationshipDeletes=[]),e.relationshipDeletes.push({typeName:r.typeName,ids:r.ids})));return e}function Yt(i,t){const e={addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]};for(const s of i.editResults)if(s.typeName===t){for(const n of s.adds)e.addFeatureResults.push({objectId:n.id,globalId:n.id});for(const n of s.updates)e.updateFeatureResults.push({objectId:n.id,globalId:n.id});for(const n of s.deletes)e.deleteFeatureResults.push({objectId:n.id,globalId:n.id})}return e}function Xt(i){if(!i.objectType)return null;const t=[];for(const e of i.fields)!e.name.includes("ESRI__")&&e.editable&&e.type!=="geometry"&&t.push(new Qt({fieldName:e.name}));return new Ue({elements:t})}function ei(i){if(!i.objectType)return null;let t=null;switch(i.geometryType){case"point":case"multipoint":t="point";break;case"polyline":t="line";break;case"polygon":t="polygon";break;default:t=null}return[new He({name:i.graphTypeName,drawingTool:t,prototype:{}})]}function k(i){if(!i.json)return i;i.json.write=Se(i.json.write);const t=i.json.origins;if(!t)return i;let e;for(e in t){const s=t[e];s&&(s.write=Se(s.write))}return i}function Se(i){return typeof i=="object"&&i?(i.enabled!==!1&&(i.overridePolicy=ti(i)),i):i===!0?B():i}function ti(i){const{target:t,writer:e,overridePolicy:s,...n}=i;return function(a,d){const c=xe.call(this,a,d);return c.enabled?{...n,...c}:c}}function B(){return{overridePolicy:xe}}function xe(i,t){const e=!!this.geometryType;let s={enabled:e};return e&&(s={...s,...J.call(this,i,t)}),s}function J(i,t){return{ignoreOrigin:this.originIdOf(t)>0}}let u=class extends Pt(Je(ze(Ve(Ze(Ke(Ye(Xe(et(tt(dt)))))))))){constructor(i){super(i),this.blendMode="normal",this.charts=null,this.definitionExpression=null,this.displayFilterEnabled=!0,this.displayFilterInfo=null,this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=S,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then(()=>{const t=new MessageChannel;return new it(t.port1,{channel:t,client:{queryFeatures:(e,s={})=>{const n=P.fromJSON(e);return this.queryFeaturesJSON(n,s)}}}),[t.port2]})},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get capabilities(){return this.parent?this.parent.sublayerCapabilities:Zt(null)}get userHasUpdateItemPrivileges(){return!!this.parent?.userHasUpdateItemPrivileges}get editingEnabled(){return this._isOverridden("editingEnabled")?this._get("editingEnabled"):this.capabilities.operations.supportsEditing}set editingEnabled(i){this._overrideIfSome("editingEnabled",i)}get isTable(){return this.parentCompositeLayer.type!=="link-chart"&&this.geometryFieldName==null}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(i){const t=this._normalizeFeatureReduction(i);this._set("featureReduction",t)}get fields(){const i=[];return this.objectType?.properties?.forEach(t=>{const e=t.fieldType==="esriFieldTypeOID"?"esriFieldTypeInteger":t.fieldType;i.push(X.fromJSON({name:t.name,type:e,alias:t.alias,defaultValue:t.defaultValue,editable:t.editable,nullable:t.nullable}))}),i.push(X.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),X.fromJSON({name:oe,type:"esriFieldTypeInteger",alias:oe,editable:!1}),X.fromJSON({name:K,type:"esriFieldTypeInteger",alias:K,editable:!1})),i}get formTemplate(){return this._isOverridden("formTemplate")?this._get("formTemplate"):Xt(this)}set formTemplate(i){this._overrideIfSome("formTemplate",i)}get geometryType(){if(this.parentCompositeLayer?.type==="link-chart")return this.graphType==="relationship"?"polyline":"point";const i=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=i?.geometryType;return t&&t!=="esriGeometryNull"?W.fromJSON(t):null}get geometryFieldName(){return this.parentCompositeLayer?.type==="link-chart"?le:this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name)?.name??null}get graphicOrigin(){if(!this.parent)return null;switch(this.parent.type){case"knowledge-graph":return new Ft(this.parent,this);case"link-chart":return new Gt(this.parent,this)}}get graphTypeName(){return this.objectType?.name}set graphTypeName(i){this._set("graphTypeName",i)}get hasM(){const i=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=i?.name;return(t?this.objectType?.properties?.[t]:null)?.hasM??!1}get hasZ(){const i=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=i?.name;return(t?this.objectType?.properties?.[t]:null)?.hasZ??!1}set labelingInfo(i){this._set("labelingInfo",i)}get labelingInfo(){if(this._isOverridden("labelingInfo"))return this._get("labelingInfo");if(!this.objectType||!this.parentCompositeLayer||!this.graphTypeName)return null;const i=this.objectType.properties?Bt(this.objectType.properties):"ESRI__ID";return this.parentCompositeLayer.type==="link-chart"?Jt(this.graphType,this.graphTypeName,i):zt(this.graphTypeName,this.geometryType,i)}set renderer(i){st(i,this.fieldsIndex),this._set("renderer",i)}get renderer(){if(this._isOverridden("renderer"))return this._get("renderer");const i=this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel,t=[...i?.entityTypes??[],...i?.relationshipTypes??[]].map(n=>n.name).indexOf(this.graphTypeName),e=Ht(t);if(this.parentCompositeLayer?.type==="link-chart"){if(this.graphType==="relationship")return new nt({type:"simple",symbol:qt(e)});const n=fe(we(W.toJSON("point")).renderer);return Te(n.symbol,e),n}const s=fe(we(W.toJSON(this.geometryType)).renderer);return Te(s.symbol,e),s}get spatialReference(){return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference??ae.WGS84}get templates(){return this._isOverridden("templates")?this._get("templates"):ei(this)}set templates(i){this._overrideIfSome("templates",i)}set timeInfo(i){this._set("timeInfo",i)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(i){this._set("title",i)}writeTitle(i,t){t.title=i??"Layer"}createPopupTemplate(i){return rt(this,i)}createQuery(){return new P({where:"1=1",outFields:["*"]})}getField(i){return this.fieldsIndex.get(i)}getFieldDomain(i,t){return null}async queryFeatures(i,t){await this.load();const{resolvedQuery:e,queryEngine:s}=await this._setupQueryObjects(i),n=this.graphicOrigin,a=at.fromJSON(await s.executeQuery(e.toJSON(),t?.signal));return a.features.forEach(d=>{d.sourceLayer=this,d.origin=n}),a}async queryFeaturesJSON(i,t){await this.load();const{resolvedQuery:e,queryEngine:s}=await this._setupQueryObjects(i);return await s.executeQuery(e.toJSON(),t?.signal)}async queryFeatureCount(i,t){await this.load();const{resolvedQuery:e,queryEngine:s}=await this._setupQueryObjects(i);return s.executeQueryForCount(e.toJSON(),t?.signal)}async queryExtent(i={},t){await this.load();const e={...i,returnGeometry:!0},{resolvedQuery:s,queryEngine:n}=await this._setupQueryObjects(e),a=await n.executeQueryForExtent(s.toJSON(),t?.signal);let d;return d=a.extent?.xmin!=null&&a.extent?.xmax!=null&&a.extent?.ymin!=null&&a.extent?.ymax!=null?new te(a.extent):new te,{count:a.count,extent:d}}async queryObjectIds(i,t){await this.load();const e=P.from(i);let s;if(this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)s=this._cachedQueryEngine;else{const n=await this.parentCompositeLayer.dataManager.getData(e,this,t);s=this.loadQueryEngine(n)}return await s.executeQueryForIds(e.toJSON(),t?.signal)}async applyEdits(i){if(!this.parentCompositeLayer.dataManager.knowledgeGraph)throw new q("knowledge-graph-sublayer:no-knowledge-graph","ApplyEdits cannot be executed because the parent does not have a Knowledge Graph model.  This is usually caused by the layer not yet being loaded");const t=await Kt(i,this);t.options={cascadeDelete:!0,cascadeProvenanceDelete:!!this.parent?.knowledgeGraph.serviceDefinition.supportsProvenance||void 0};const e=await Dt(this.parentCompositeLayer.dataManager.knowledgeGraph,t),s=Yt(e,this.graphTypeName),n={addedFeatures:s.addFeatureResults,updatedFeatures:s.updateFeatureResults,deletedFeatures:s.deleteFeatureResults,addedAttachments:s.addAttachmentResults,deletedAttachments:s.deleteAttachmentResults,updatedAttachments:s.updateAttachmentResults,exceededTransferLimit:!1,historicMoment:new Date,edits:void 0};return this.emit("edits",n),this.emit("apply-edits",{result:Promise.resolve(n)}),this.parentCompositeLayer.type==="link-chart"&&await this.parentCompositeLayer.refreshLinkChartCache([...n.addedFeatures.map(a=>a.globalId),...n.updatedFeatures.map(a=>a.globalId),...n.deletedFeatures.map(a=>a.globalId)]),s}loadQueryEngine(i){const t=new xt({geometryType:W.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),e=new Rt({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:W.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,featureIdInfo:{type:"object-id",fieldName:this.objectIdField},spatialReference:this.spatialReference.toJSON(),timeInfo:this.timeInfo?.toJSON(),featureStore:t});return e.featureStore.addMany(i),e}async refreshCachedQueryEngine(){const i=await this.parentCompositeLayer.dataManager.getData(new P({where:"1=1",outFields:[S]}),this);this._cachedQueryEngine=this.loadQueryEngine(i)}load(i){return this.addResolvingPromise(this.parent.load(i).then(()=>ot(this.timeInfo,this.fieldsIndex))),Promise.resolve(this)}async _setupQueryObjects(i,t){const e=P.from(i),s=e.geometry;if(s&&!s.spatialReference?.isWGS84&&(await ee(s.spatialReference,F),e.geometry=z(s instanceof Ce||s instanceof pt||s instanceof lt?s:s.extent,F)),this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)return{resolvedQuery:e,queryEngine:this._cachedQueryEngine};const n=await this.parentCompositeLayer.dataManager.getData(e,this,t);return{resolvedQuery:e,queryEngine:this.loadQueryEngine(n)}}};function ii(i,t,e){const s=[["ESRI__AGGREGATION_COUNT",oe],["ESRI__ORIGIN_ID",ie],["ESRI__DESTINATION_ID",se],["ESRI__LAYOUT_GEOMETRY",le]];try{for(const n of i)for(const[a,d]of s)n.labelExpression=n.labelExpression?.replaceAll(a,d),n.labelExpressionInfo?.expression&&(n.labelExpressionInfo.expression=n.labelExpressionInfo.expression.replaceAll(a,d))}catch(n){Me.getLogger(this).warn("Error updating labelingInfo",n)}return Mt(i,t,e)}o([p(k(C(ut)))],u.prototype,"blendMode",void 0),o([p({readOnly:!0})],u.prototype,"capabilities",null),o([p({readOnly:!0})],u.prototype,"userHasUpdateItemPrivileges",null),o([p({type:Boolean})],u.prototype,"editingEnabled",null),o([p()],u.prototype,"isTable",null),o([p({json:{origins:{"web-scene":{write:!1}},write:B()}})],u.prototype,"charts",void 0),o([p({readOnly:!0})],u.prototype,"defaultPopupTemplate",null),o([p({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],u.prototype,"definitionExpression",void 0),o([p(k(C(yt)))],u.prototype,"displayFilterEnabled",void 0),o([p(k(C(ht)))],u.prototype,"displayFilterInfo",void 0),o([p(k(C(ct)))],u.prototype,"effect",void 0),o([p()],u.prototype,"elevationInfo",void 0),o([p(k(C(mt)))],u.prototype,"featureEffect",void 0),o([p(k(C(ft)))],u.prototype,"featureReduction",null),o([p()],u.prototype,"fields",null),o([p()],u.prototype,"formTemplate",null),o([p()],u.prototype,"geometryType",null),o([p()],u.prototype,"geometryFieldName",null),o([p({readOnly:!0})],u.prototype,"graphicOrigin",null),o([p({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],u.prototype,"graphType",void 0),o([p({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],u.prototype,"graphTypeName",null),o([p()],u.prototype,"hasM",null),o([p()],u.prototype,"hasZ",null),o([p({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],u.prototype,"id",void 0),o([p({type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",default:!1,write:{overridePolicy(){return{enabled:!!this.geometryType,alwaysWriteDefaults:!0,ignoreOrigin:!0}}}}})],u.prototype,"labelsVisible",void 0),o([p({type:[Q],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:ii,write:B()}})],u.prototype,"labelingInfo",null),o([p({readOnly:!0,json:{read:!1,write:{writer(i,t){switch(this.parentCompositeLayer?.type){case"link-chart":t.layerType="LinkChartSubLayer";break;case"knowledge-graph":t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],u.prototype,"layerType",void 0),o([p(k(C(gt)))],u.prototype,"legendEnabled",void 0),o([p(k(C(bt)))],u.prototype,"maxScale",void 0),o([p(k(C(wt)))],u.prototype,"minScale",void 0),o([p()],u.prototype,"objectIdField",void 0),o([p()],u.prototype,"objectType",void 0),o([p(k(C(Tt)))],u.prototype,"opacity",void 0),o([p(k(C(It)))],u.prototype,"orderBy",void 0),o([p({clonable:!1})],u.prototype,"parent",void 0),o([p()],u.prototype,"parentCompositeLayer",void 0),o([p(k(C(Nt)))],u.prototype,"popupEnabled",void 0),o([p({type:Et,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],u.prototype,"popupTemplate",void 0),o([p({type:Number,json:{write:{overridePolicy:J}}})],u.prototype,"refreshInterval",void 0),o([p({types:$t,json:{name:"layerDefinition.drawingInfo.renderer",write:B()}})],u.prototype,"renderer",null),o([p()],u.prototype,"source",void 0),o([p()],u.prototype,"spatialReference",null),o([p()],u.prototype,"templates",null),o([p({type:vt,json:{name:"layerDefinition.timeInfo",write:{overridePolicy:J},origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:{overridePolicy:J}},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:{overridePolicy:J}}}}})],u.prototype,"timeInfo",null),o([p({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],u.prototype,"title",null),o([St("title")],u.prototype,"writeTitle",null),o([p({json:{read:!1}})],u.prototype,"type",void 0),o([p(k(C(Lt)))],u.prototype,"useViewTime",void 0),o([p({type:Boolean,json:{name:"visibility",write:B()}})],u.prototype,"visible",void 0),u=o([ne("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],u);export{Zt as F,ci as L,u as N,D as a,re as o};
