import{fc as f,k as y,a3 as d,fd as v,fe as x,cJ as m,ff as b,fg as _,fh as $,eF as z,fi as w,Q as j,Z as r,$ as n,fj as A,a0 as E}from"./index-Bp3GeDhQ.js";import{l as O,u as R}from"./LineOfSightAnalysisTarget-Cz5tzEdO.js";const u=j.ofType(O);let s=class extends f{constructor(e){super(e),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles(y(()=>this._computeExtent(),e=>{e?.pending==null&&this._set("extent",e!=null?e.extent:null)},d))}get targets(){return this._get("targets")||new u}set targets(e){this._set("targets",v(e,this.targets,u))}get spatialReference(){return this.observer?.position!=null?this.observer.position.spatialReference:null}get valid(){return this.observer?.position!=null}async waitComputeExtent(){const e=this._computeExtent();return e!=null?e.pending:Promise.resolve()}_computeExtent(){const e=this.spatialReference;if(this.observer?.position==null||e==null)return null;const o=i=>w(i.position,i.elevationInfo)==="absolute-height",t=this.observer.position,p=x(t.x,t.y,t.z,t.x,t.y,t.z);for(const i of this.targets)if(i.position!=null){const l=m(i.position,e);if(l.pending!=null)return{pending:l.pending,extent:null};if(l.geometry!=null){const{x:h,y:g,z:c}=l.geometry;b(p,[h,g,c])}}const a=_(p,e);return o(this.observer)&&this.targets.every(o)||(a.zmin=void 0,a.zmax=void 0),{pending:null,extent:a}}clear(){this.observer=null,this.targets.removeAll()}equals(e){return this===e||super.equals(e)&&$(this.observer,e.observer)&&z(this.targets.toArray(),e.targets.toArray(),(o,t)=>o.equals(t))}};r([n({type:["line-of-sight"]})],s.prototype,"type",void 0),r([n({type:R,json:{read:!0,write:!0}})],s.prototype,"observer",void 0),r([n({cast:A,type:u,nonNullable:!0,json:{read:!0,write:!0}})],s.prototype,"targets",null),r([n({value:null,readOnly:!0})],s.prototype,"extent",void 0),r([n()],s.prototype,"spatialReference",null),r([n({readOnly:!0})],s.prototype,"valid",null),s=r([E("esri.analysis.LineOfSightAnalysis")],s);export{s as j};
