import{f as c,$ as d,gw as v,gx as f,d7 as m,gy as x,gz as b,bD as _,bC as $,gA as z,O as w,_ as r,e as n,gB as A,g as E}from"./index-CgzAF5Ey.js";import{c as O}from"./Analysis-DLCfG2Mt.js";import{l as R,u as j}from"./LineOfSightAnalysisTarget-DJ1Uv0gg.js";const u=w.ofType(R);let s=class extends O{constructor(e){super(e),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles(c(()=>this._computeExtent(),e=>{e?.pending==null&&this._set("extent",e!=null?e.extent:null)},d))}get targets(){return this._get("targets")||new u}set targets(e){this._set("targets",v(e,this.targets,u))}get spatialReference(){return this.observer?.position!=null?this.observer.position.spatialReference:null}get valid(){return this.observer?.position!=null}async waitComputeExtent(){const e=this._computeExtent();return e!=null?e.pending:Promise.resolve()}_computeExtent(){const e=this.spatialReference;if(this.observer?.position==null||e==null)return null;const i=o=>z(o.position,o.elevationInfo)==="absolute-height",t=this.observer.position,p=f(t.x,t.y,t.z,t.x,t.y,t.z);for(const o of this.targets)if(o.position!=null){const l=m(o.position,e);if(l.pending!=null)return{pending:l.pending,extent:null};if(l.geometry!=null){const{x:g,y:h,z:y}=l.geometry;x(p,[g,h,y])}}const a=b(p,e);return i(this.observer)&&this.targets.every(i)||(a.zmin=void 0,a.zmax=void 0),{pending:null,extent:a}}clear(){this.observer=null,this.targets.removeAll()}equals(e){return this===e||super.equals(e)&&_(this.observer,e.observer)&&$(this.targets.toArray(),e.targets.toArray(),(i,t)=>i.equals(t))}};r([n({type:["line-of-sight"]})],s.prototype,"type",void 0),r([n({type:j,json:{read:!0,write:!0}})],s.prototype,"observer",void 0),r([n({cast:A,type:u,nonNullable:!0,json:{read:!0,write:!0}})],s.prototype,"targets",null),r([n({value:null,readOnly:!0})],s.prototype,"extent",void 0),r([n()],s.prototype,"spatialReference",null),r([n({readOnly:!0})],s.prototype,"valid",null),s=r([E("esri.analysis.LineOfSightAnalysis")],s);export{s as j};
