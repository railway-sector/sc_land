import{bC as c,j as d,a8 as f,fj as v,fk as x,cS as b,fl as m,fm as _,bE as $,bD as z,fn as j,Y as w,a5 as r,x as n,fo as E,y as A}from"./index-Brd6-W-v.js";import{l as O,u as R}from"./LineOfSightAnalysisTarget-BS8JBfHs.js";const u=w.ofType(O);let s=class extends c{constructor(e){super(e),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles(d(()=>this._computeExtent(),e=>{e?.pending==null&&this._set("extent",e!=null?e.extent:null)},f))}get targets(){return this._get("targets")||new u}set targets(e){this._set("targets",v(e,this.targets,u))}get spatialReference(){return this.observer?.position!=null?this.observer.position.spatialReference:null}get valid(){return this.observer?.position!=null}async waitComputeExtent(){const e=this._computeExtent();return e!=null?e.pending:Promise.resolve()}_computeExtent(){const e=this.spatialReference;if(this.observer?.position==null||e==null)return null;const i=o=>j(o.position,o.elevationInfo)==="absolute-height",t=this.observer.position,p=x(t.x,t.y,t.z,t.x,t.y,t.z);for(const o of this.targets)if(o.position!=null){const l=b(o.position,e);if(l.pending!=null)return{pending:l.pending,extent:null};if(l.geometry!=null){const{x:h,y:g,z:y}=l.geometry;m(p,[h,g,y])}}const a=_(p,e);return i(this.observer)&&this.targets.every(i)||(a.zmin=void 0,a.zmax=void 0),{pending:null,extent:a}}clear(){this.observer=null,this.targets.removeAll()}equals(e){return this===e||super.equals(e)&&$(this.observer,e.observer)&&z(this.targets.toArray(),e.targets.toArray(),(i,t)=>i.equals(t))}};r([n({type:["line-of-sight"]})],s.prototype,"type",void 0),r([n({type:R,json:{read:!0,write:!0}})],s.prototype,"observer",void 0),r([n({cast:E,type:u,nonNullable:!0,json:{read:!0,write:!0}})],s.prototype,"targets",null),r([n({value:null,readOnly:!0})],s.prototype,"extent",void 0),r([n()],s.prototype,"spatialReference",null),r([n({readOnly:!0})],s.prototype,"valid",null),s=r([A("esri.analysis.LineOfSightAnalysis")],s);export{s as j};
