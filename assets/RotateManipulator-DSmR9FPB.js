import{jh as p,f as v,bI as H,dh as y,kO as w,aE as f,l6 as x,l5 as M,h5 as G,q0 as P,q1 as _}from"./index-BrQW8HOS.js";import{b as T,d as $,s as j,k as D,q as g}from"./sliceToolConfig-jSIjxwYF.js";import{b as k,C as b,k as R,x as q}from"./SlicePlaneMaterial.glsl-DGjh4vnt.js";import{Y as C,h as A,t as h,f as O}from"./ShadedColorMaterial.glsl-o8eJ5IM8.js";import{g as B}from"./ImageMaterial.glsl-BvhURRa1.js";let Y=class extends C{constructor(e,i){const t=k(i),r=t?T:$,c=r*j,o=$,u={renderOccluded:4,isDecoration:!0},d=new p({...u,width:r},e.state.isGlobal),a=new p({...u,width:c},e.state.isGlobal),s=new p({...u,width:o},e.state.isGlobal);super({view:e,...A,...I({isCorner:t,unfocusedMaterial:d,focusedMaterial:a,outlineMaterial:s})}),this._themeHandle=v(()=>e.effectiveTheme.accentColor,m=>{const l=y.toUnitRGBA(m);d.setParameters({color:l}),a.setParameters({color:l}),s.setParameters({color:l})},H)}destroy(){this._themeHandle.remove(),super.destroy()}};function I({isCorner:n,unfocusedMaterial:e,focusedMaterial:i,outlineMaterial:t}){const r=n?[f(1,0,0),f(0,0,0),f(0,1,0)]:[f(1,0,0),f(-1,0,0)];return{renderObjects:[new h(w(e,r),1|b),new h(w(i,r),2|b),new h(w(t,r),R)],collisionType:{type:"line",paths:[r]},radius:n?D:g,state:b}}class F extends C{constructor(e,i){const t=x(e.effectiveTheme.accentColor,.5),r=M(e.effectiveTheme.accentColor),c=i(t,r),o=new B({draped:!1,texture:c.texture,writeDepth:!1,renderOccluded:16,isDecoration:!0}),u=O.calloutWidth,d=new p({width:u,renderOccluded:4,isDecoration:!0},e.state.isGlobal);super({view:e,...U({imageMaterial:o,calloutMaterial:d})}),this._material=o,this._textureHandle=c,this._themeHandle=v(()=>e.effectiveTheme.accentColor,a=>{const s=x(a,.5),m=M(a),l=this._textureHandle;this._textureHandle=i(s,m),o.setParameters({texture:this._textureHandle.texture}),l?.release(),d.setParameters({color:y.toUnitRGBA(a)})},H)}destroy(){this._textureHandle=G(this._textureHandle),this._themeHandle.remove(),this._material.dispose(),super.destroy()}}function U({imageMaterial:n,calloutMaterial:e}){const{focusMultiplier:i,calloutLength:t,discRadius:r}=O,c=r*i,o=(s,m)=>{const l=[0,1,2,2,3,0];return new P(m,[["position",new _([t-s,-s,0,t+s,-s,0,t+s,s,0,t-s,s,0],l,3,!0)],["uv0",new _([0,0,1,0,1,1,0,1],l,2,!0)]])},u=w(e,[[0,0,0],[t-r,0,0]]),d=w(e,[[0,0,0],[t-c,0,0]]),a=q;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[t,0,0]},focusMultiplier:i,radius:r,renderObjects:[new h(o(r,n),1|a),new h(u,1|a),new h(o(c,n),2|a),new h(d,2|a)],state:a}}export{Y as b,F as h};
