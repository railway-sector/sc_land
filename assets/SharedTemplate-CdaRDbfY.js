import{mZ as b,jN as O,ch as I,a4 as $,_ as t,e,cm as N,cn as D,g as y,d6 as j,cE as k,dY as L,iT as F,al as J,aa as C,oV as V}from"./index-BrQW8HOS.js";import{c as P,i as B,t as E}from"./FeatureTemplates-Y1q8_xKC.js";import{o as R,T as M,d as G,i as q,c as U}from"./customElement-aPQS1Oaw.js";import"./FeatureService-DdnMPQJQ.js";import"./applyEditsUtils-Bdi3ieC8.js";import"./MeshTransform-wQhxY5y6.js";import"./editingSupport-5GkCZdaM.js";import"./utils-D5_eym7P.js";import"./Heading-Bx03M7LB.js";import"./symbolUtils-C3MaPSzp.js";import"./gfxUtils-DDSu4Luj.js";import"./cimSymbolUtils-CmFYUdpV.js";import"./svgUtils-BB2umWtg.js";import"./mat2df32-Dpt2CT5P.js";import"./mat2d-BbBq4Byx.js";import"./utils-6_NAbAK3.js";import"./vmEvent-CsrnYMSK.js";import"./substitute-D-eLZ17Q.js";import"./SketchOptions-CHLlByzL.js";import"./SketchLabelOptions-BPF5xZLI.js";import"./Attachments-_aarC56Q.js";import"./AttachmentsViewModel-BorO2JWS.js";import"./AttachmentInfo-Be-qgHMP.js";import"./featureUtils-D2UmGJHI.js";import"./utils-BJ7fw6dI.js";import"./attachmentUtils-CREavg3W.js";import"./legacyIcon-BpbXCnGp.js";import"./featureFormUtils-NJdl1KAp.js";import"./dateUtils-DCwqoPkL.js";import"./arcade-BYoSEge4.js";import"./arcadeEnvironment-Dyzp2elj.js";import"./ImmutableArray-BPVd6ESQ.js";import"./FeatureForm-ek6TUJN1.js";import"./FieldInput-BRbP2Bp9.js";import"./FeatureRelationshipViewModel-BmyR0OK6.js";import"./Spinner-Csmzl8Du.js";import"./AnchorElementViewModel-Djy63Zpd.js";import"./GraphicsLayer-CtVknZ1a.js";import"./SnappingManager-BWOfKl0d.js";import"./euclideanLengthMeasurementUtils-B8AL_WaV.js";import"./utils-D_VO_1nP.js";import"./geodesicUtils-BJZXB7Hp.js";import"./geometry2dUtils-kADrF-iP.js";import"./geodeticLengthOperator-DifrZujk.js";import"./geodeticCurveType-CirnHLSB.js";import"./geodesicMeasurementUtils-CQw8IWGR.js";import"./helpMessageUtils-2XpUG8Xk.js";import"./HighlightHelper-RFagfZex.js";import"./layerUtils-CdCZXuDJ.js";import"./GraphicState-C2r3pgB3.js";import"./DrawingMode-Cvvf0VVz.js";import"./SketchViewModel-NRhuw9HA.js";import"./isSupportedObject-DknMXN_6.js";import"./automaticAreaMeasurementUtils-dI3X5owW.js";import"./geodesicAreaMeasurementUtils-CPlOyDe5.js";import"./earcut-D9gy186-.js";import"./automaticLengthMeasurementUtils-Cr-y0OEN.js";import"./utils-BvM7qP9G.js";import"./splitCurveAtPoint-DXLcvmHe.js";import"./coordinateHelper-DrvFu3jL.js";import"./SelectionToolbar-CmU2zF-u.js";import"./directionModeIcons-Br5woIHu.js";import"./layerListUtils-CrO8uhQ1.js";import"./LayerListViewModel-VEwfK75C.js";import"./utils-BQBvadb7.js";import"./ListItem-BTKwElC0.js";import"./widget-lSGAz9tN.js";import"./uploadAssetErrors-CCLQcdnt.js";import"./useWidget-CYtf2hFT.js";import"./useView-Cya0Zpns.js";let a=class extends b(O(I)){constructor(){super(...arguments),this.excludedTools=[],this.featureService=null,this.makeSharedTemplateFromJSON=null,this.view=null}readExcludedTools(o){const i=o.map(n=>P.fromJSON(n));return Array.from(new Set(i))}writeExcludedTools(o,i){o?.length&&(i.excludedTools=o.map(n=>P.toJSON(n.toLowerCase())))}load(o){return this.addResolvingPromise(this._load(o)),Promise.resolve(this)}async _load(o){const i=this.allParts,{featureService:n,makeSharedTemplateFromJSON:s,view:l}=this;if(n==null||s==null||l==null)throw new R;for(const r of i)r.assertIsSupportedPart();const w=M(l,{makeSharedTemplateFromJSON:s}),_=i.filter(r=>r.template==null),h=await w.getTemplates({templateIds:_.map(r=>r.templateId),featureService:n,signal:o?.signal}),A=new Map(h.map(r=>[r.templateId,r]));for(const r of _){const T=A.get(r.templateId);if(T==null)throw new $("internal:missing-template",`Failed to retrieve template for template ID ${r.templateId}`);r.template=T}await Promise.all(i.map(r=>r.template?.load(o)))}};t([e({readOnly:!0})],a.prototype,"type",void 0),t([e({constructOnly:!0})],a.prototype,"excludedTools",void 0),t([N("excludedTools")],a.prototype,"readExcludedTools",null),t([D("excludedTools")],a.prototype,"writeExcludedTools",null),t([e()],a.prototype,"featureService",void 0),t([e()],a.prototype,"makeSharedTemplateFromJSON",void 0),t([e()],a.prototype,"view",void 0),a=t([y("esri.editing.sharedTemplates.templateDefinitions.TemplateDefinitionBase")],a);let m=class extends I{constructor(i){super(i),this.template=null}};t([e()],m.prototype,"template",void 0),t([e({json:{write:!0}})],m.prototype,"templateGlobalId",void 0),t([e({json:{write:!0}})],m.prototype,"templateId",void 0),t([e({readOnly:!0,json:{read:!1,write:!1}})],m.prototype,"type",void 0),m=t([y("esri.editing.sharedTemplates.templateDefinitions.parts.TemplatePartBase")],m);let f=class extends m{constructor(o){super(o),this.relationshipCatalogId="",this.relationshipMetadata=null,this.template=null,this.type="relationship"}assertIsSupportedPart(){}};t([e({json:{name:"relationshipClassID",write:!0}})],f.prototype,"relationshipCatalogId",void 0),t([e()],f.prototype,"relationshipMetadata",void 0),t([e()],f.prototype,"template",void 0),t([e()],f.prototype,"type",void 0),f=t([y("esri.editing.sharedTemplates.templateDefinitions.parts.FeatureTemplateRelationshipPart")],f);const z=f;let g=class extends a{constructor(i){super(i),this.type="feature",this.defaultValues=null,this.relationships=[]}get allParts(){return this.relationships}initializeRelationshipMetadata(i){for(const n of this.relationships){const{relationshipCatalogId:s}=n,l=n.template?.layer,w=i.relationships?.find(h=>h.catalogId===s),_=l?.relationships?.find(h=>h.catalogId===s);if(!w||!l||!_)throw new G(s);n.relationshipMetadata={destinationField:_.keyField,destinationLayerId:l.layerId,sourceField:w.keyField,sourceLayerId:i.layerId}}}};t([e({readOnly:!0})],g.prototype,"type",void 0),t([e()],g.prototype,"allParts",null),t([e({json:{write:!0}})],g.prototype,"defaultValues",void 0),t([e({constructOnly:!0,type:[z],json:{write:!0}})],g.prototype,"relationships",void 0),g=t([y("esri.editing.sharedTemplates.templateDefinitions.FeatureTemplateDefinition")],g);const x=new j({esri_editing_transformation_bufferLineToPolygon:"buffer-line-to-polygon",esri_editing_transformation_bufferPointToPolygon:"buffer-point-to-polygon",esri_editing_transformation_bufferPolygonToPolygon:"buffer-polygon-to-polygon",esri_editing_transformation_connectionPoint:"connection-point",esri_editing_transformation_equallySpaced:"equally-spaced",esri_editing_transformation_offsetLine:"offset-line",esri_editing_transformation_offsetPrimaryLine:"offset-primary-line",esri_editing_transformation_pointAtAllVerticesOfLine:"point-at-all-vertices-of-line",esri_editing_transformation_pointAtBeginningOfLine:"point-at-beginning-of-line",esri_editing_transformation_pointAtBeginningOfRadial:"point-at-beginning-of-radial",esri_editing_transformation_pointAtEndOfLine:"point-at-end-of-line",esri_editing_transformation_pointAtInteriorVertices:"point-at-interior-vertices",esri_editing_transformation_pointAtIntersectionVerticesOfLine:"point-at-intersection-vertices-of-line",esri_editing_transformation_pointAtNotBeginningOfLine:"point-at-not-beginning-of-line",esri_editing_transformation_pointAtNotEndOfLine:"point-at-not-end-of-line",esri_editing_transformation_pointAtPolygonCentroid:"point-at-polygon-centroid",esri_editing_transformation_pointAtPolygonNotStart:"point-at-polygon-not-start",esri_editing_transformation_pointAtPolygonStart:"point-at-polygon-start",esri_editing_transformation_pointIdentity:"point-identity",esri_editing_transformation_pointPrimaryIdentity:"point-primary-identity",esri_editing_transformation_polygonBoundary:"polygon-boundary",esri_editing_transformation_polygonBoundaryTwoPoint:"polygon-boundary-two-point",esri_editing_transformation_polygonIdentity:"polygon-identity",esri_editing_transformation_polygonPrimaryIdentity:"polygon-primary-identity",esri_editing_transformation_polygonVertices:"polygon-vertices",esri_editing_transformation_radialLines:"radial-lines",esri_editing_transformation_twoPointLines:"two-point-lines"}),Y={"buffer-line-to-polygon":"polyline","buffer-point-to-polygon":"point","buffer-polygon-to-polygon":"polygon","connection-point":"polyline","equally-spaced":"polyline","offset-line":"polyline","offset-primary-line":"polyline","point-at-all-vertices-of-line":"polyline","point-at-beginning-of-line":"polyline","point-at-beginning-of-radial":"polyline","point-at-end-of-line":"polyline","point-at-interior-vertices":"polyline","point-at-intersection-vertices-of-line":"polyline","point-at-not-beginning-of-line":"polyline","point-at-not-end-of-line":"polyline","point-at-polygon-centroid":"polygon","point-at-polygon-not-start":"polygon","point-at-polygon-start":"polygon","point-identity":"point","point-primary-identity":"point","polygon-boundary":"polygon","polygon-boundary-two-point":"polygon","polygon-identity":"polygon","polygon-primary-identity":"polygon","polygon-vertices":"polygon","radial-lines":"polyline","two-point-lines":"polyline"};let c=class extends m{constructor(i){super(i),this.builderConfig={},this.type="group"}assertIsSupportedPart(){const{builderType:i}=this;if(!x.apiValues.includes(i))throw new q(i)}};t([k(x,{ignoreUnknown:!1,name:"type"})],c.prototype,"builderType",void 0),t([e({json:{name:"options"}})],c.prototype,"builderConfig",void 0),t([e()],c.prototype,"type",void 0),c=t([y("esri.editing.sharedTemplates.templateDefinitions.parts.GroupTemplatePart")],c);const S=c;let p=class extends a{constructor(o){super(o),this.type="group",this.createUtilityNetworkAssociations=!1,this.parts=[],this.utilityNetwork=null,this.utilityNetworkAssociationsTable=null}get allParts(){return[this.basePart,...this.parts]}get inputGeometryType(){return Y[this.basePart.builderType]}};t([e({readOnly:!0})],p.prototype,"type",void 0),t([e()],p.prototype,"allParts",null),t([e({constructOnly:!0,type:S,json:{write:!0}})],p.prototype,"basePart",void 0),t([e({constructOnly:!0})],p.prototype,"createUtilityNetworkAssociations",void 0),t([e()],p.prototype,"inputGeometryType",null),t([e({constructOnly:!0,type:[S],json:{write:!0}})],p.prototype,"parts",void 0),t([e()],p.prototype,"utilityNetwork",void 0),t([e()],p.prototype,"utilityNetworkAssociationsTable",void 0),p=t([y("esri.editing.sharedTemplates.templateDefinitions.GroupTemplateDefinition")],p);let v=class extends m{constructor(o){super(o),this.geometry=null,this.type="preset"}assertIsSupportedPart(){}};t([e({types:F,json:{read:L,write:!0}})],v.prototype,"geometry",void 0),t([e()],v.prototype,"type",void 0),v=t([y("esri.editing.sharedTemplates.templateDefinitions.parts.PresetTemplatePart")],v);const Z=v;let u=class extends a{constructor(o){super(o),this.type="preset",this.parts=[]}get allParts(){return this.parts}};t([e({readOnly:!0})],u.prototype,"type",void 0),t([e()],u.prototype,"allParts",null),t([e({constructOnly:!0,type:J,json:{write:!0}})],u.prototype,"origin",void 0),t([e({constructOnly:!0,type:[Z],json:{name:"features"}})],u.prototype,"parts",void 0),t([e({type:C})],u.prototype,"spatialReference",void 0),u=t([y("esri.editing.sharedTemplates.templateDefinitions.PresetTemplateDefinition")],u);const H=o=>d.fromJSON(o);let d=class extends b(O(B)){constructor(o){super(o),this.definition=null,this.layer=null,this.type="feature",this.view=null}readDefinition(o,i){switch(i.type){case"feature":return g.fromJSON(o);case"group":return p.fromJSON(o);case"preset":return u.fromJSON(o);default:throw V(i.type),new $("shared-template:no-definition","No value for 'definition' provided to 'SharedTemplate' constructor")}}load(o){return this.addResolvingPromise(this._load(o)),Promise.resolve(this)}async _load(o){const{definition:i,featureService:n,layer:s,view:l}=this;if(!(i&&n&&s&&l))throw new U;i.featureService=n,i.makeSharedTemplateFromJSON=H,i.view=l,await this.definition?.load(o),E(i)&&i.initializeRelationshipMetadata(s)}};t([e({json:{write:!0}})],d.prototype,"definition",void 0),t([N("definition")],d.prototype,"readDefinition",null),t([e()],d.prototype,"layer",void 0),t([e()],d.prototype,"type",void 0),t([e()],d.prototype,"view",void 0),d=t([y("esri.editing.sharedTemplates.SharedTemplate")],d);const ge=d;export{ge as default};
