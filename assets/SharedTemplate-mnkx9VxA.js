import{m_ as b,i$ as O,cn as I,bI as $,a5 as t,x as e,c8 as x,fQ as D,y as m,cQ as j,co as k,dx as L,iQ as F,ai as J,al as C,oh as B}from"./index-Brd6-W-v.js";import{c as P,i as R,t as V}from"./FeatureTemplates-Bu9eqWTt.js";import{o as E,T as M,d as G,i as q,c as Q}from"./customElement-D22u-hy8.js";import"./FeatureService-DSAuScGJ.js";import"./applyEditsUtils-EMDD5YBG.js";import"./MeshTransform-Dbi_AwF7.js";import"./editingSupport-DaCBY8tG.js";import"./utils-CuHNsYAo.js";import"./Heading-BCcHIRjP.js";import"./SketchOptions-DVOz4iqy.js";import"./SketchLabelOptions-C_8uwBga.js";import"./Attachments-i07qdQ8V.js";import"./AttachmentsViewModel-Dqiq1T_W.js";import"./AttachmentInfo-BffJmunk.js";import"./featureUtils-C9FquY4Q.js";import"./attachmentUtils-yLe1aIrJ.js";import"./legacyIcon-BpbXCnGp.js";import"./featureFormUtils-JL6ExD4t.js";import"./dateUtils-Dxl5F42Y.js";import"./arcade-bRr7-7bN.js";import"./arcadeEnvironment-CxplAMXe.js";import"./ImmutableArray-BPVd6ESQ.js";import"./FeatureForm-zCONaVtg.js";import"./FieldInput-C1VIBWC8.js";import"./FeatureRelationshipViewModel-CNhZZ4Kg.js";import"./Spinner-4IXYCy3n.js";import"./AnchorElementViewModel-BqnDrso2.js";import"./GraphicsLayer-CjG4lAYI.js";import"./SnappingManager-C6oen82f.js";import"./euclideanLengthMeasurementUtils-DM9lZgm8.js";import"./geometry2dUtils-BOHjqgu-.js";import"./geodeticLengthOperator-DnkggiH8.js";import"./geodeticCurveType-CirnHLSB.js";import"./helpMessageUtils-2XpUG8Xk.js";import"./HighlightHelper-BKXHZcwO.js";import"./layerUtils-61hESGqR.js";import"./GraphicState-fCylpEwE.js";import"./DrawingMode-Cvvf0VVz.js";import"./SketchViewModel-B60c25uC.js";import"./isSupportedObject-CBU7VL65.js";import"./automaticAreaMeasurementUtils-OmtWBaHK.js";import"./geodesicAreaMeasurementUtils-DJGxN27X.js";import"./earcut-D9gy186-.js";import"./automaticLengthMeasurementUtils-DtR3CDX6.js";import"./utils-Ft0ftxMI.js";import"./splitCurveAtPoint-CxbUr1qm.js";import"./coordinateHelper-DvQOiAfn.js";import"./SelectionToolbar-B3-D-H93.js";import"./directionModeIcons-Br5woIHu.js";import"./uploadAssetErrors-CIhQPvk0.js";let a=class extends b(O(I)){constructor(){super(...arguments),this.excludedTools=[],this.featureService=null,this.makeSharedTemplateFromJSON=null,this.view=null}readExcludedTools(o){const i=o.map(r=>P.fromJSON(r));return Array.from(new Set(i))}writeExcludedTools(o,i){o?.length&&(i.excludedTools=o.map(r=>P.toJSON(r.toLowerCase())))}load(o){return this.addResolvingPromise(this._load(o)),Promise.resolve(this)}async _load(o){const i=this.allParts,{featureService:r,makeSharedTemplateFromJSON:s,view:l}=this;if(r==null||s==null||l==null)throw new E;for(const n of i)n.assertIsSupportedPart();const w=M(l,{makeSharedTemplateFromJSON:s}),_=i.filter(n=>n.template==null),h=await w.getTemplates({templateIds:_.map(n=>n.templateId),featureService:r,signal:o?.signal}),A=new Map(h.map(n=>[n.templateId,n]));for(const n of _){const T=A.get(n.templateId);if(T==null)throw new $("internal:missing-template",`Failed to retrieve template for template ID ${n.templateId}`);n.template=T}await Promise.all(i.map(n=>n.template?.load(o)))}};t([e({readOnly:!0})],a.prototype,"type",void 0),t([e({constructOnly:!0})],a.prototype,"excludedTools",void 0),t([x("excludedTools")],a.prototype,"readExcludedTools",null),t([D("excludedTools")],a.prototype,"writeExcludedTools",null),t([e()],a.prototype,"featureService",void 0),t([e()],a.prototype,"makeSharedTemplateFromJSON",void 0),t([e()],a.prototype,"view",void 0),a=t([m("esri.editing.sharedTemplates.templateDefinitions.TemplateDefinitionBase")],a);let y=class extends I{constructor(i){super(i),this.template=null}};t([e()],y.prototype,"template",void 0),t([e({json:{write:!0}})],y.prototype,"templateGlobalId",void 0),t([e({json:{write:!0}})],y.prototype,"templateId",void 0),t([e({readOnly:!0,json:{read:!1,write:!1}})],y.prototype,"type",void 0),y=t([m("esri.editing.sharedTemplates.templateDefinitions.parts.TemplatePartBase")],y);let f=class extends y{constructor(o){super(o),this.relationshipCatalogId="",this.relationshipMetadata=null,this.template=null,this.type="relationship"}assertIsSupportedPart(){}};t([e({json:{name:"relationshipClassID",write:!0}})],f.prototype,"relationshipCatalogId",void 0),t([e()],f.prototype,"relationshipMetadata",void 0),t([e()],f.prototype,"template",void 0),t([e()],f.prototype,"type",void 0),f=t([m("esri.editing.sharedTemplates.templateDefinitions.parts.FeatureTemplateRelationshipPart")],f);const U=f;let c=class extends a{constructor(i){super(i),this.type="feature",this.defaultValues=null,this.relationships=[]}get allParts(){return this.relationships}initializeRelationshipMetadata(i){for(const r of this.relationships){const{relationshipCatalogId:s}=r,l=r.template?.layer,w=i.relationships?.find(h=>h.catalogId===s),_=l?.relationships?.find(h=>h.catalogId===s);if(!w||!l||!_)throw new G(s);r.relationshipMetadata={destinationField:_.keyField,destinationLayerId:l.layerId,sourceField:w.keyField,sourceLayerId:i.layerId}}}};t([e({readOnly:!0})],c.prototype,"type",void 0),t([e()],c.prototype,"allParts",null),t([e({json:{write:!0}})],c.prototype,"defaultValues",void 0),t([e({constructOnly:!0,type:[U],json:{write:!0}})],c.prototype,"relationships",void 0),c=t([m("esri.editing.sharedTemplates.templateDefinitions.FeatureTemplateDefinition")],c);const N=new j({esri_editing_transformation_bufferLineToPolygon:"buffer-line-to-polygon",esri_editing_transformation_bufferPointToPolygon:"buffer-point-to-polygon",esri_editing_transformation_bufferPolygonToPolygon:"buffer-polygon-to-polygon",esri_editing_transformation_connectionPoint:"connection-point",esri_editing_transformation_equallySpaced:"equally-spaced",esri_editing_transformation_offsetLine:"offset-line",esri_editing_transformation_offsetPrimaryLine:"offset-primary-line",esri_editing_transformation_pointAtAllVerticesOfLine:"point-at-all-vertices-of-line",esri_editing_transformation_pointAtBeginningOfLine:"point-at-beginning-of-line",esri_editing_transformation_pointAtBeginningOfRadial:"point-at-beginning-of-radial",esri_editing_transformation_pointAtEndOfLine:"point-at-end-of-line",esri_editing_transformation_pointAtInteriorVertices:"point-at-interior-vertices",esri_editing_transformation_pointAtIntersectionVerticesOfLine:"point-at-intersection-vertices-of-line",esri_editing_transformation_pointAtNotBeginningOfLine:"point-at-not-beginning-of-line",esri_editing_transformation_pointAtNotEndOfLine:"point-at-not-end-of-line",esri_editing_transformation_pointAtPolygonCentroid:"point-at-polygon-centroid",esri_editing_transformation_pointAtPolygonNotStart:"point-at-polygon-not-start",esri_editing_transformation_pointAtPolygonStart:"point-at-polygon-start",esri_editing_transformation_pointIdentity:"point-identity",esri_editing_transformation_pointPrimaryIdentity:"point-primary-identity",esri_editing_transformation_polygonBoundary:"polygon-boundary",esri_editing_transformation_polygonBoundaryTwoPoint:"polygon-boundary-two-point",esri_editing_transformation_polygonIdentity:"polygon-identity",esri_editing_transformation_polygonPrimaryIdentity:"polygon-primary-identity",esri_editing_transformation_polygonVertices:"polygon-vertices",esri_editing_transformation_radialLines:"radial-lines",esri_editing_transformation_twoPointLines:"two-point-lines"}),z={"buffer-line-to-polygon":"polyline","buffer-point-to-polygon":"point","buffer-polygon-to-polygon":"polygon","connection-point":"polyline","equally-spaced":"polyline","offset-line":"polyline","offset-primary-line":"polyline","point-at-all-vertices-of-line":"polyline","point-at-beginning-of-line":"polyline","point-at-beginning-of-radial":"polyline","point-at-end-of-line":"polyline","point-at-interior-vertices":"polyline","point-at-intersection-vertices-of-line":"polyline","point-at-not-beginning-of-line":"polyline","point-at-not-end-of-line":"polyline","point-at-polygon-centroid":"polygon","point-at-polygon-not-start":"polygon","point-at-polygon-start":"polygon","point-identity":"point","point-primary-identity":"point","polygon-boundary":"polygon","polygon-boundary-two-point":"polygon","polygon-identity":"polygon","polygon-primary-identity":"polygon","polygon-vertices":"polygon","radial-lines":"polyline","two-point-lines":"polyline"};let g=class extends y{constructor(i){super(i),this.builderConfig={},this.type="group"}assertIsSupportedPart(){const{builderType:i}=this;if(!N.apiValues.includes(i))throw new q(i)}};t([k(N,{ignoreUnknown:!1,name:"type"})],g.prototype,"builderType",void 0),t([e({json:{name:"options"}})],g.prototype,"builderConfig",void 0),t([e()],g.prototype,"type",void 0),g=t([m("esri.editing.sharedTemplates.templateDefinitions.parts.GroupTemplatePart")],g);const S=g;let p=class extends a{constructor(o){super(o),this.type="group",this.createUtilityNetworkAssociations=!1,this.parts=[],this.utilityNetwork=null,this.utilityNetworkAssociationsTable=null}get allParts(){return[this.basePart,...this.parts]}get inputGeometryType(){return z[this.basePart.builderType]}};t([e({readOnly:!0})],p.prototype,"type",void 0),t([e()],p.prototype,"allParts",null),t([e({constructOnly:!0,type:S,json:{write:!0}})],p.prototype,"basePart",void 0),t([e({constructOnly:!0})],p.prototype,"createUtilityNetworkAssociations",void 0),t([e()],p.prototype,"inputGeometryType",null),t([e({constructOnly:!0,type:[S],json:{write:!0}})],p.prototype,"parts",void 0),t([e()],p.prototype,"utilityNetwork",void 0),t([e()],p.prototype,"utilityNetworkAssociationsTable",void 0),p=t([m("esri.editing.sharedTemplates.templateDefinitions.GroupTemplateDefinition")],p);let v=class extends y{constructor(o){super(o),this.geometry=null,this.type="preset"}assertIsSupportedPart(){}};t([e({types:F,json:{read:L,write:!0}})],v.prototype,"geometry",void 0),t([e()],v.prototype,"type",void 0),v=t([m("esri.editing.sharedTemplates.templateDefinitions.parts.PresetTemplatePart")],v);const H=v;let u=class extends a{constructor(o){super(o),this.type="preset",this.parts=[]}get allParts(){return this.parts}};t([e({readOnly:!0})],u.prototype,"type",void 0),t([e()],u.prototype,"allParts",null),t([e({constructOnly:!0,type:J,json:{write:!0}})],u.prototype,"origin",void 0),t([e({constructOnly:!0,type:[H],json:{name:"features"}})],u.prototype,"parts",void 0),t([e({type:C})],u.prototype,"spatialReference",void 0),u=t([m("esri.editing.sharedTemplates.templateDefinitions.PresetTemplateDefinition")],u);const K=o=>d.fromJSON(o);let d=class extends b(O(R)){constructor(o){super(o),this.definition=null,this.layer=null,this.type="feature",this.view=null}readDefinition(o,i){switch(i.type){case"feature":return c.fromJSON(o);case"group":return p.fromJSON(o);case"preset":return u.fromJSON(o);default:throw B(i.type),new $("shared-template:no-definition","No value for 'definition' provided to 'SharedTemplate' constructor")}}load(o){return this.addResolvingPromise(this._load(o)),Promise.resolve(this)}async _load(o){const{definition:i,featureService:r,layer:s,view:l}=this;if(!(i&&r&&s&&l))throw new Q;i.featureService=r,i.makeSharedTemplateFromJSON=K,i.view=l,await this.definition?.load(o),V(i)&&i.initializeRelationshipMetadata(s)}};t([e({json:{write:!0}})],d.prototype,"definition",void 0),t([x("definition")],d.prototype,"readDefinition",null),t([e()],d.prototype,"layer",void 0),t([e()],d.prototype,"type",void 0),t([e()],d.prototype,"view",void 0),d=t([m("esri.editing.sharedTemplates.SharedTemplate")],d);const Kt=d;export{Kt as default};
