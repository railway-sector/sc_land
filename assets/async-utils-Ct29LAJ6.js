import{Y as f,a4 as b,e as s,g as h}from"./index-BrQW8HOS.js";import{e as d,o as p}from"./maybe-BQxFr9e1.js";var m=Object.defineProperty,w=Object.getOwnPropertyDescriptor,a=(t,e,o,r)=>{for(var n=r>1?void 0:r?w(e,o):e,l=t.length-1,u;l>=0;l--)(u=t[l])&&(n=(r?u(e,o,n):u(n))||n);return r&&n&&m(e,o,n),n};function _(t="Aborted"){return new b("AbortError",t)}function I(t,e="Aborted"){if(v(t))throw _(e)}function c(t){return t instanceof AbortSignal?t:t?.signal??void 0}function v(t){return c(t)?.aborted??!1}function y(t){return t?.name==="AbortError"}function g(t){return{ok:!0,value:t}}function C(t){return{ok:!1,error:t}}function k(t){return t?.ok?t.value:null}function A(t){return t!=null&&!t.ok?t.error:null}function E(t,e){const o=c(t);if(o==null)return;if(o.aborted){e();return}const r=()=>e();return o.addEventListener("abort",r,{once:!0}),{remove:()=>o.removeEventListener("abort",r)}}function T(t,e){return new i(t,e)}let i=class extends f{constructor(t,e){super({}),this._abortHandle=null,this.abort=()=>{this._abortController=d(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:o}=this._abortController;this.promise=t(o),this.promise.then(r=>{this._result=g(r),this._cleanup()},r=>{this._result=C(r),this._cleanup()}),this._abortHandle=E(e,this.abort)}get value(){return k(this._result)}get error(){return A(this._result)}get finished(){return this._result!=null}destroy(){this.abort()}_cleanup(){this._abortHandle=p(this._abortHandle),this._abortController=null}[Symbol.dispose](){this._cleanup()}};a([s()],i.prototype,"value",1);a([s()],i.prototype,"error",1);a([s()],i.prototype,"finished",1);a([s()],i.prototype,"promise",2);a([s()],i.prototype,"_result",2);i=a([h("esri.components.asyncUtils.ReactiveTask")],i);function $(t){return t.catch(e=>{if(!y(e))throw e})}function q(t,e={}){if("requestIdleCallback"in window)return window.requestIdleCallback(t,e);const o=e.timeout!=null?e.timeout:50,r=typeof performance<"u"&&performance.now?performance.now.bind(performance):Date.now,n=r();return window.setTimeout(()=>{t({didTimeout:!1,timeRemaining(){return Math.max(0,o-(r()-n))}})},1)}function D(t){"cancelIdleCallback"in window&&window.cancelIdleCallback(t),window.clearTimeout(t)}export{y as A,D,I as H,T as P,$ as q,v,q as x};
