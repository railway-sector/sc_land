import{L as B,e as w,c as f,f as t,C as k,gx as A,i as T,l as M}from"./index-Bp3GeDhQ.js";const N=T`:host{display:none;background:#bdf2c4}:host([selected]){display:flex}calcite-block{margin-block:0}calcite-pagination{justify-content:center}`,v=class v extends B{constructor(){super(...arguments),this._filterInputElement=w(),this._flowItemElement=w(),this.currentPage=1,this.selected=!1,this.showBackButton=!1,this.arcgisFlowItemBack=f(),this.arcgisFlowItemClose=f(),this.arcgisGetVersions=f(),this.arcgisManageVersion=f(),this.arcgisNewVersion=f()}load(){this._filteredVersionInfos=this.versionListElementProps.versionInfos}willUpdate(e){if(e.has("versionListElementProps")){const i=e.get("versionListElementProps"),s=this.versionListElementProps;i?.versionInfos!==s.versionInfos&&(this._filteredVersionInfos=s.versionInfos,this._filterInputElement.value&&this._handleFilterChange())}}updated(){this._filterInputElement.value?.setFocus()}async setFocus(){this._flowItemElement.value?.setFocus()}goBack(){}_handleFilterChange(){const{versionListElementProps:{versionInfos:e}}=this,i=this._filterInputElement.value.value.toUpperCase();this._filteredVersionInfos=i===""?e:e.filter(s=>s.versionIdentifier.name.toUpperCase().includes(i)||s.versionIdentifier.guid.toUpperCase().includes(i)),this._filteredVersionInfos.length&&(this.currentPage=1)}_handleNoticeClosed(){this.versionListElementProps={...this.versionListElementProps,executionError:void 0}}_handlePaginationChange(e){this.currentPage=e.target.startItem}_getExecutionError(e){const{versionListElementProps:{strings:{executionErrors:i}}}=this;switch(e){case"no-feature-service-found":return i.noFeatureServiceFound;case"no-valid-enterprise-version":return i.notValidEnterpriseVersion;case"no-valid-version-name":return i.invalidVersionName;default:return e}}_paginate(e,i,s){return e.slice((s-1)*i,s*i)}render(){const{currentPage:e,selected:i,showBackButton:s,versionListElementProps:{closable:m,currentUser:$,currentVersionIdentifier:c,executionError:l,heading:n,isVersionAdministrator:d,isVersioningApiAvailable:p,pageSize:r,serviceName:u,serviceUrl:h,state:g,strings:{headers:a},strings:o,versionInfos:I}}=this,V=t`<calcite-block .heading=${a.currentVersion} .description=${c.name} overlay-positioning=fixed></calcite-block>`,b=t`<calcite-action id=actionRefreshVersions icon=refresh text @click=${()=>this.arcgisGetVersions.emit({serviceUrl:h})} slot=header-actions-end><calcite-tooltip overlay-positioning=fixed reference-element=actionRefreshVersions><span>${o.actions.refreshVersions}</span></calcite-tooltip></calcite-action>`;this._paginatedVersionInfos=this._filteredVersionInfos.length>r?this._paginate(this._filteredVersionInfos,r,e):this._filteredVersionInfos;const _=this._filteredVersionInfos.length>r?t`<calcite-pagination @calcitePaginationChange=${this._handlePaginationChange} page-size=1 .startItem=${e} .totalItems=${Math.ceil(this._filteredVersionInfos.length/r)}></calcite-pagination>`:void 0,x=this._paginate(this._paginatedVersionInfos,r,1).map(U=>{const y={currentUser:$,currentVersionIdentifier:c,isCurrentVersionCard:!1,isVersionAdministrator:d,isVersioningApiAvailable:p,serviceUrl:h,strings:o,versionInfo:U};return this._renderListItem(y)}),C=I.length>r?t`<calcite-block heading .label=${a.filterVersions} open><calcite-input-text clearable icon=search @calciteInputTextInput=${this._handleFilterChange} .placeholder=${o.actions.searchVersions} ${k(this._filterInputElement)}></calcite-input-text></calcite-block>`:void 0,P=t`<calcite-list .label=${o.labels.versionList}>${x}</calcite-list>`,L=p?t`<calcite-fab appearance=outline-fill slot=fab text-enabled .text=${o.actions.newVersion} @click=${()=>this.arcgisNewVersion.emit({serviceUrl:h})}></calcite-fab>`:void 0,F=l?t`<calcite-notice @calciteNoticeClose=${this._handleNoticeClosed} class="notice" closable kind=warning open scale=s slot=footer width=full><div slot=message>${this._getExecutionError(l)}</div></calcite-notice>`:void 0;return t`<calcite-flow-item .closable=${m} .description=${u} .heading=${n} .selected=${i} .showBackButton=${s} @calciteFlowItemBack=${()=>this.arcgisFlowItemBack.emit()} @calciteFlowItemClose=${()=>this.arcgisFlowItemClose.emit()} ${k(this._flowItemElement)}><calcite-panel .loading=${g==="executing"}>${V}<calcite-panel .heading=${this._filteredVersionInfos.length?`${o.headers.manageVersions} (${this._filteredVersionInfos.length})`:o.headers.manageVersions}>${b}${C}${P}${L}</calcite-panel>${_}${F}</calcite-panel></calcite-flow-item>`}_renderListItem(e){const{currentUser:i,currentVersionIdentifier:s,isVersionAdministrator:m,isVersioningApiAvailable:$,serviceUrl:c,strings:{actions:l},versionInfo:n}=e,d=n.versionIdentifier.name,p=d.substring(d.lastIndexOf(".")+1),r=d.substring(0,d.lastIndexOf(".")),u=n.versionIdentifier.guid,h=`actionSwitchToVersion_${u}`,g=r.toUpperCase()===i.toUpperCase()&&$||m,a=s.guid===n.versionIdentifier.guid,o=t`<calcite-action .disabled=${a} icon=code-branch @click=${()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:c,versionInfo:n})}} scale=s .text=${l.switchToVersion} text-enabled></calcite-action>`,I=t`<calcite-action .disabled=${!g||g&&a} icon=trash @click=${()=>{this.arcgisManageVersion.emit({actionType:"deleteVersion",serviceUrl:c,versionInfo:n})}} scale=s .text=${l.deleteVersion} text-enabled></calcite-action>`,V=t`<calcite-action .disabled=${!g||a} icon=code-branch-edit @click=${()=>{this.arcgisManageVersion.emit({actionType:"editVersion",serviceUrl:c,versionInfo:n})}} scale=s .text=${l.editVersion} text-enabled></calcite-action>`,b=t`<calcite-action-menu overlay-positioning=fixed slot=actions-end label>${o}${V}${I}</calcite-action-menu>`,_=a?void 0:t`<calcite-tooltip overlay-positioning=fixed .referenceElement=${h}><span>${l.switchToVersion}</span></calcite-tooltip>`,x=t`<div slot=actions-start><calcite-action appearance=transparent .disabled=${a} id=${h??A} icon=code-branch text @click=${()=>{this.arcgisManageVersion.emit({actionType:"changeVersion",serviceUrl:c,versionInfo:n})}}></calcite-action>${_}</div>`;return t`<calcite-list-item .description=${r} .label=${p} .value=${u}>${x}${b}</calcite-list-item>`}};v.properties={_filteredVersionInfos:16,currentPage:11,selected:7,showBackButton:7,versionListElementProps:0},v.styles=N;let E=v;M("arcgis-version-management-version-list",E);export{E as ArcgisVersionManagementVersionList};
