import{L as i,gu as o,j as c,f as s,i as n,l as p}from"./index-Brd6-W-v.js";import{m as d}from"./utils-CZAJu10i.js";const r=n`calcite-tab{--calcite-tab-content-block-padding: 0}calcite-loader{margin-right:var(--calcite-spacing-xxs)}`,t=class t extends i{constructor(){super(...arguments),this._prevLayoutTemplateId=null,this._handles=o("disconnect"),this._selectedTab="layout",this._hasPendingExport=!1}loaded(){this.manager.onLifecycle(()=>[this.viewModel.exportedLinks.on("change",()=>{this._handles.removeHandles("pending-exports"),this._handles.addHandles(this.viewModel.exportedLinks.toArray().map(e=>c(()=>e.state,()=>this.requestUpdate(),{initial:!0})),"pending-exports")})])}async _layoutTabChangeHandler(){const e=(this._prevLayoutTemplateId?this.viewModel.getLayoutTemplateById(this._prevLayoutTemplateId):null)??this.viewModel.defaultTemplate;await this.viewModel.applyTemplate(e),this._prevLayoutTemplateId=e?.id,this._selectedTab="layout"}async _mapOnlyTabChangeHandler(){this._updatePrevLayoutTemplateId(),await this.viewModel.applyTemplate("map-only"),this._selectedTab="map-only"}async _exportsTabChangeHandler(){this._updatePrevLayoutTemplateId(),this._selectedTab="exports"}_selectExportsTab(){this._updatePrevLayoutTemplateId(),this._selectedTab="exports"}_updatePrevLayoutTemplateId(){!d(this.viewModel.templateOptions.layout)&&this.viewModel.templateOptions.id&&(this._prevLayoutTemplateId=this.viewModel.templateOptions.id)}render(){const e=this.viewModel.exportedLinks.some(({state:l})=>l==="pending");return s`<div><calcite-tabs layout=center bordered><calcite-tab-nav slot=title-group><calcite-tab-title @calciteTabsActivate=${this._layoutTabChangeHandler} .selected=${this._selectedTab==="layout"}>${this.messages.layoutTab}</calcite-tab-title><calcite-tab-title @calciteTabsActivate=${this._mapOnlyTabChangeHandler} .selected=${this._selectedTab==="map-only"}>${this.messages.mapOnlyTab}</calcite-tab-title><calcite-tab-title @calciteTabsActivate=${this._exportsTabChangeHandler} .selected=${this._selectedTab==="exports"}>${e?s`<calcite-loader inline label=loading scale=s></calcite-loader>`:null}${this.messages.exportsTab}</calcite-tab-title></calcite-tab-nav><calcite-tab selected><arcgis-print-layout-panel .messages=${this.messages} .viewModel=${this.viewModel} .showTemplateSelector=${this.showTemplateSelector} .selectExportsTab=${this._selectExportsTab.bind(this)}></arcgis-print-layout-panel></calcite-tab><calcite-tab><arcgis-print-map-only-panel .messages=${this.messages} .viewModel=${this.viewModel} .selectExportsTab=${this._selectExportsTab.bind(this)}></arcgis-print-map-only-panel></calcite-tab><calcite-tab><arcgis-print-exports-panel .messages=${this.messages} .viewModel=${this.viewModel} .allowedFormatsForSaving=${this.allowedFormatsForSaving} .saveAsButtonCallback=${this.saveAsButtonCallback}></arcgis-print-exports-panel></calcite-tab></calcite-tabs></div>`}};t.properties={_selectedTab:16,_hasPendingExport:16,saveAsButtonCallback:0,viewModel:0,messages:0,showTemplateSelector:0,allowedFormatsForSaving:1},t.styles=r;let a=t;p("arcgis-print-main-panel",a);export{a as PrintMainPanel};
