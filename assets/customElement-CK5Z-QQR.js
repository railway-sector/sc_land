import{L as w,gp as _,k as g,F as s,f as a,ec as $,E as f,i as T,l as b}from"./index-CVzGOCNQ.js";import{m,u as y,f as L,d as S,g as x}from"./utils-C-WCK84I.js";const C=T`.arcgis-print__template-select-flow-item-container{display:flex;flex-direction:column;justify-content:space-between;overflow-y:hidden;flex-grow:1}.arcgis-print__template-select-flow-item-container .arcgis-print__template-select-flow-item-content{display:flex;flex-direction:column;overflow-y:auto;flex:1 0}.arcgis-print__template-select-flow-item-container .arcgis-print__template-select-flow-item-content .arcgis-print__template-select-flow-item-list-heading{display:flex;gap:var(--calcite-spacing-xs);align-items:center;padding:var(--calcite-spacing-md) var(--calcite-spacing-lg);background-color:var(--calcite-color-foreground-2);border-bottom:1px solid var(--calcite-color-border-3);font-weight:var(--calcite-font-weight-semibold)}.arcgis-print__template-button-container{padding:var(--calcite-spacing-md)}.arcgis-print__template-done-button{width:100%}`,o="arcgis-print",i={templateSelectError:`${o}__template-select-error`,templateButtonContainer:`${o}__template-button-container`,templateDoneButton:`${o}__template-done-button`,templateSelectFlowItemContainer:`${o}__template-select-flow-item-container`,templateSelectFlowItemContent:`${o}__template-select-flow-item-content`,templateSelectFlowItemListHeading:`${o}__template-select-flow-item-list-heading`,browseTemplateButtonContainer:`${o}__browse-template-button-container`,browseTemplateButtonContainerFilter:`${o}__browse-template-button-container-filter`},d=class d extends w{constructor(){super(...arguments),this._handles=_("disconnect")}loaded(){this.manager.onLifecycle(()=>[g(()=>this.viewModel.templateOptions.id,e=>{this._handles.removeHandles("template-handle"),this._selectedTemplate=e?this.viewModel.getLayoutTemplateById(e)??void 0:void 0,this._handles.addHandles(g(()=>this._selectedTemplate?.state,()=>this.requestUpdate(),{initial:!0}),"template-handle")},{initial:!0})])}_getPortalTemplates(){const{portalTemplateIds:e}=this.viewModel;return this.viewModel.includeDefaultTemplates&&!this.excludeOrganizationTemplates?this.viewModel.defaultTemplates.toArray().filter(({layout:n,layoutItem:l})=>!m(n)&&!!l?.id&&e.includes(l.id)):[]}_getDefaultTemplates(){const{portalTemplateIds:e}=this.viewModel;return this.viewModel.includeDefaultTemplates?this.viewModel.defaultTemplates.toArray().filter(({layout:n,layoutItem:l})=>!m(n)&&(!l?.id||!e.includes(l.id))):[]}_getPrintServiceTemplates(){return!this.viewModel.includeDefaultTemplates||!this._getDefaultTemplates().length?this.viewModel.printServiceTemplates.toArray().filter(({layout:e})=>!m(e)):[]}render(){const{messages:e}=this,n=y.test(this.viewModel.portal?.url),l=this.viewModel.browseTemplates.toArray(),t=this._getPortalTemplates(),c=this._getDefaultTemplates(),p=this._getPrintServiceTemplates(),r=l.length+t.length+c.length+p.length>15,h=this.browseTemplateButtonOnClick?a`<calcite-button appearance=outline class=${s(r?i.browseTemplateButtonContainerFilter:i.browseTemplateButtonContainer)} icon-start=folder @click=${this.browseTemplateButtonOnClick} .slot=${r?"filter-actions-end":"default"}>${r?null:e.browseTemplates}</calcite-button>`:null;return a`<div class=${s(i.templateSelectFlowItemContainer)}><div class=${s(i.templateSelectFlowItemContent)}>${r?null:h}${$("template-list",a`<calcite-list .filterEnabled=${r} .filterProps=${["label"]} .label=${e.templateList} selection-mode=single-persist @calciteListChange=${({currentTarget:v})=>this.viewModel.applyTemplate(v.selectedItems[0]?.value)}>${r?h:null}${l.length?a`<div><div class=${s(i.templateSelectFlowItemListHeading)}>${e.myTemplates}${n?a`<calcite-chip appearance=outline kind=neutral .label=${e.beta} scale=s>${e.beta}</calcite-chip>`:null}</div>${this._renderLayoutTemplates(l,!0,!0)}</div>`:null}${t.length?a`<div><div class=${s(i.templateSelectFlowItemListHeading)}>${e.organizationTemplates}${n?a`<calcite-chip appearance=outline kind=neutral .label=${e.beta} scale=s>${e.beta}</calcite-chip>`:null}</div>${this._renderLayoutTemplates(t)}</div>`:null}${l.length||t.length?c.length?a`<div><div class=${s(i.templateSelectFlowItemListHeading)}>${e.defaultTemplates}</div>${this._renderLayoutTemplates(c,!0)}</div>`:null:this._renderLayoutTemplates(c,!0)}${l.length||t.length?p.length?a`<div><div class=${s(i.templateSelectFlowItemListHeading)}>${e.defaultTemplates}</div>${this._renderLayoutTemplates(p)}</div>`:null:this._renderLayoutTemplates(p)}</calcite-list>`)}</div><div class=${s(i.templateButtonContainer)}><calcite-button class=${s(i.templateDoneButton)} @click=${this.hideTemplateSelector}>Done</calcite-button></div></div>`}_renderLayoutTemplates(e,n=!1,l=!1){return n&&e.sort((t,c)=>(t.label??"")>(c.label??"")?1:-1),e.map(t=>a`<calcite-list-item .description=${L(t)} .label=${S(t,this.messages)} .selected=${t.id===this.viewModel.templateOptions.id} title=${t.description??""??f} .value=${t}><calcite-icon .icon=${(t.layout?x(t.layout):null)||"custom-print"} slot=content-start></calcite-icon>${t.state==="loading"?a`<calcite-loader inline label=loading scale=s slot=content-end></calcite-loader>`:null}${t?.state==="error"?$(`template-error-${t.id}`,a`<calcite-icon class=${s(i.templateSelectError)} icon=exclamation-mark-circle scale=s slot=content-end></calcite-icon>`):null}${l?a`<calcite-action icon=trash @click=${()=>this.viewModel.removePortalTemplate(t)} slot=actions-end text=delete></calcite-action>`:null}</calcite-list-item>`)}};d.properties={_selectedTemplate:16,excludeOrganizationTemplates:5,browseTemplateButtonOnClick:0,viewModel:0,messages:0,hideTemplateSelector:0},d.styles=C;let u=d;b("arcgis-print-template-selector",u);export{u as PrintTemplateSelector};
