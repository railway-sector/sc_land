import{a2 as O,Q as b,k as $,by as x,Z as c,$ as p,a0 as R,L as k,e as E,d as S,u as U,c as C,F as _,S as L,G as D,f as u,B as z,E as V,C as K,T as I,i as T,l as B}from"./index-Bp3GeDhQ.js";import{s as y}from"./ClipRect-C_zYb9Bh.js";import{r as A}from"./legacyIcon-CjlqUSRb.js";function N(t,i){const e=10**i;return Math.round(t*e)/e}const f={left:0,right:0,top:0,bottom:0};let l=class extends O{constructor(t){super(t),this._leadingClips=new Map,this._trailingClips=new Map,this.direction="horizontal",this.leadingLayers=new b,this.max=100,this.min=0,this.precision=4,this.step=.5,this.stepMultiplier=10,this.trailingLayers=new b,this.view=null}initialize(){this.addHandles([$(()=>[this.view,this.view?.ready,this.position,this.direction],()=>this._clipLayers(),x),$(()=>this.leadingLayers.toArray(),()=>this._clipLeadingLayers(),x),$(()=>this.trailingLayers.toArray(),()=>this._clipTrailingLayers(),x)])}destroy(){this._removeExistingClips()}get position(){return 25}set position(t){const{precision:i,min:e,max:r}=this;this._set("position",N(Math.max(Math.min(t,r),e),i))}get state(){return this.view?.ready?"ready":"disabled"}_clipLayers(){this._clipLeadingLayers(),this._clipTrailingLayers()}_clipLeadingLayers(){this._removeClips("leading");const{leadingLayers:t}=this;t.forEach(i=>this._clipLayer({layer:i,type:"leading"}))}_clipTrailingLayers(){this._removeClips("trailing");const{trailingLayers:t}=this;t.forEach(i=>this._clipLayer({layer:i,type:"trailing"}))}async _getLayerView(t){const{view:i}=this;if(!t||!i)return null;const e=await i.whenLayerView(t);return"clips"in e?e:null}_getVerticalClipRect(t){const{position:i}=this;return t==="leading"?new y({...f,bottom:100-i+"%"}):t==="trailing"?new y({...f,top:`${i}%`}):null}_getHorizontalClipRect(t){const{position:i}=this;return t==="leading"?new y({...f,right:100-i+"%"}):t==="trailing"?new y({...f,left:`${i}%`}):null}_getClipRect(t){const{direction:i}=this;return i==="vertical"?this._getVerticalClipRect(t):i==="horizontal"?this._getHorizontalClipRect(t):null}async _clipLayer(t){const{_leadingClips:i,_trailingClips:e}=this,{layer:r,type:s}=t,a=s==="trailing"?e:s==="leading"?i:null,n=await this._getLayerView(r);if(!(n&&"clips"in n&&a&&n.hasOwnProperty("clips")))return;const d=a.get(n);d&&n.clips.remove(d);const o=this._getClipRect(s);o&&(a.set(n,o),n.clips.add(o))}_removeClips(t){const{_leadingClips:i,_trailingClips:e}=this,r=t==="trailing"?e:t==="leading"?i:null;r&&(r.forEach((s,a)=>{a&&a.hasOwnProperty("clips")&&a.clips.remove(s)}),r.clear())}_removeExistingClips(){this._removeClips("leading"),this._removeClips("trailing")}};c([p()],l.prototype,"direction",void 0),c([p({type:b,nonNullable:!0})],l.prototype,"leadingLayers",void 0),c([p({readOnly:!0})],l.prototype,"max",void 0),c([p({readOnly:!0})],l.prototype,"min",void 0),c([p()],l.prototype,"position",null),c([p()],l.prototype,"precision",void 0),c([p({readOnly:!0})],l.prototype,"state",null),c([p()],l.prototype,"step",void 0),c([p()],l.prototype,"stepMultiplier",void 0),c([p({type:b,nonNullable:!0})],l.prototype,"trailingLayers",void 0),c([p()],l.prototype,"view",void 0),l=c([R("esri.widgets.Swipe.SwipeViewModel")],l);const X=l;const Y=T`:host{position:absolute;margin:0;background:transparent!important;padding:0;width:100%;height:100%;overflow:hidden;user-select:none;--arcgis-internal-swipe-handle-color-background: var(--calcite-color-background);--arcgis-internal-swipe-divider-color-background: var(--calcite-color-background)}.arcgis-swipe{width:100%;height:100%;overflow:hidden;user-select:none}.arcgis-swipe,.arcgis-ui .arcgis-swipe{pointer-events:none!important}.arcgis-swipe__container{position:absolute;z-index:1;margin:0;outline:0;border:0;padding:0;overflow:hidden;pointer-events:auto;touch-action:none;outline-color:transparent}.arcgis-swipe--horizontal .arcgis-swipe__container{margin-left:calc(var(--calcite-spacing-xxxl) / 2 * -1);cursor:col-resize;height:100%}.arcgis-swipe--vertical .arcgis-swipe__container{margin-top:calc(var(--calcite-spacing-xxxl) / 2 * -1);cursor:row-resize;width:100%}.arcgis-swipe--disabled .arcgis-swipe__container{cursor:default;pointer-events:none}.arcgis-swipe__divider{position:absolute;background-color:var(--arcgis-internal-swipe-divider-color-background)}.arcgis-swipe--horizontal .arcgis-swipe__divider{top:0;left:calc(var(--calcite-spacing-xxxl) / 2);margin-left:calc(var(--calcite-border-width-lg) * .5 * -1);border-right:var(--calcite-border-width-sm) solid var(--calcite-color-border-1);border-left:var(--calcite-border-width-sm) solid var(--calcite-color-border-1);width:var(--calcite-border-width-lg);height:100%}.arcgis-swipe--vertical .arcgis-swipe__divider{top:calc(var(--calcite-spacing-xxxl) / 2);left:0;margin-top:calc(var(--calcite-border-width-lg) * .5 * -1);border-top:var(--calcite-border-width-sm) solid var(--calcite-color-border-1);border-bottom:var(--calcite-border-width-sm) solid var(--calcite-color-border-1);width:100%;height:var(--calcite-border-width-lg)}.arcgis-swipe__handle{display:flex;position:relative;align-items:center;justify-content:center;border:var(--calcite-border-width-sm) solid var(--calcite-color-border-1);border-radius:var(--calcite-corner-radius-round);background-color:var(--arcgis-internal-swipe-handle-color-background);width:var(--calcite-spacing-xxxl);height:var(--calcite-spacing-xxxl);color:var(--calcite-color-text-3)}.arcgis-swipe__handle--hidden{visibility:hidden}.arcgis-swipe--vertical .arcgis-swipe__handle{rotate:90deg}.arcgis-swipe__handle-icon{position:relative;z-index:2}.arcgis-swipe__handle-icon:before{content:"|||";color:inherit}.arcgis-swipe--horizontal .arcgis-swipe__handle{top:calc(50% - calc(var(--calcite-spacing-xxxl) / 2))}.arcgis-swipe--vertical .arcgis-swipe__handle{left:calc(50% - calc(var(--calcite-spacing-xxxl) / 2))}.arcgis-swipe__container:focus .arcgis-swipe__handle,.arcgis-swipe__container:focus .arcgis-swipe__divider{outline:inset 2px var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)))}.arcgis-swipe__container:focus .arcgis-swipe__handle{outline-offset:calc(-2px*(1 - (2*clamp(0,var(--calcite-offset-invert-focus),1))))}`,w="arcgis-swipe",h={base:w,baseDisabled:`${w}--disabled`,vertical:`${w}--vertical`,horizontal:`${w}--horizontal`,container:`${w}__container`,divider:`${w}__divider`,handle:`${w}__handle`,handleHidden:`${w}__handle--hidden`,handleIcon:`${w}__handle-icon`},j=I(X),m=class m extends k{constructor(){super(...arguments),this._container=null,this._containerRef=E(),this._swiping=!1,this._swipePositionChanged=!1,this.messages=S({}),this._pointerOffset=0,this.viewModel=j(this),this._onContainerPointerDown=i=>{i.preventDefault();const{_container:e}=this;e&&document.activeElement!==this.el&&e.focus(),this._swiping=!0,this._calculatePointerOffset(i)},this.view=this.viewModel.view,this.autoDestroyDisabled=!1,this.direction=this.viewModel.direction,this.disabled=!1,this.hideDivider=!1,this.hideHandle=!1,this.icon="compare",this.label=this.messages.componentLabel,this.leadingLayers=this.viewModel.leadingLayers,this.swipePosition=this.viewModel.position,this.state=this.viewModel.state,this.trailingLayers=this.viewModel.trailingLayers,this.arcgisPropertyChange=U()("state"),this.arcgisReady=C(),this.arcgisSwipeChange=C(),this.arcgisSwipeInput=C()}async destroy(){await this.manager.destroy()}loaded(){this.listenOn(document,"pointermove",this._onContainerPointerMove),this.listenOn(document,"pointerup",this._onContainerPointerUp)}_calculatePointerOffset(i){const{direction:e}=this,r=this._containerRef.value,s=(e==="vertical"?r.clientHeight:r.clientWidth)/2,a=r.getBoundingClientRect(),n=i.clientX-a.left,d=i.clientY-a.top;this._pointerOffset=e==="vertical"?d-s:n-s}_onContainerPointerUp(i){this._swiping&&(i.preventDefault(),this._swipePositionChanged&&(this.arcgisSwipeChange.emit(),this._swipePositionChanged=!1),this._swiping=!1)}_onContainerPointerMove(i){if(!this._swiping)return;i.preventDefault();const{_pointerOffset:e,el:r,direction:s}=this,{clientX:a,clientY:n}=i,{top:d,left:o,width:g,height:v}=r.getBoundingClientRect(),H=s==="vertical"?v:g,M=(s==="vertical"?n-d-e:a-o-e)/H*100;this.swipePosition!==M&&(this.swipePosition=M,this._swipePositionChanged=!0,this.arcgisSwipeInput.emit())}_getKeyPosition(i){const{key:e}=i,{swipePosition:r}=this,{max:s,min:a,step:n,stepMultiplier:d,direction:o}=this.viewModel,g=n*d;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].includes(e)&&(i.preventDefault(),i.stopPropagation()),o==="vertical"?e==="ArrowDown"||e==="ArrowRight":e==="ArrowUp"||e==="ArrowRight"){const v=i.shiftKey?g:n;return r+v}if(o==="vertical"?e==="ArrowUp"||e==="ArrowLeft":e==="ArrowDown"||e==="ArrowLeft"){const v=i.shiftKey?g:n;return r-v}return e==="Home"?a:e==="End"?s:(o==="vertical"?e==="PageDown":e==="PageUp")?r+g:(o==="vertical"?e==="PageUp":e==="PageDown")?r-g:null}_onContainerKeyDown(i){const e=this._getKeyPosition(i);typeof e=="number"&&this.swipePosition!==e&&(this.swipePosition=e,this.arcgisSwipeInput.emit(),this.arcgisSwipeChange.emit())}render(){const{state:i,direction:e}=this.viewModel,r=i==="disabled"||this.disabled,s={[D.disabled]:r,[h.baseDisabled]:r,[h.vertical]:e==="vertical",[h.horizontal]:e==="horizontal"};return u`<div class=${_(L(h.base,D.widget,s))}>${i==="disabled"?null:this._renderContainer()}</div>`}_renderHandle(){const{direction:i}=this.viewModel,{hideHandle:e}=this,r={[A.dragHorizontal]:i==="vertical",[A.dragVertical]:i==="horizontal"},s=L(h.handle,!!e&&h.handleHidden);return u`<div class=${_(s)} role=presentation><span aria-hidden=true class=${_(L(h.handleIcon,r))}></span></div>`}_renderDivider(){return this.hideDivider?null:u`<div class=${_(h.divider)} role=presentation></div>`}_renderContent(){return[this._renderDivider(),this._renderHandle()]}_renderContainer(){const{disabled:i,viewModel:e}=this,{max:r,min:s,direction:a,position:n}=e,d=this.label??this.messages.dragLabel??"",o=`${n}%`,g={top:a==="vertical"?o:void 0,left:a==="vertical"?void 0:o},v=this._renderContent();return i?u`<div class=${_(h.container)} role=presentation style=${z(g)}>${v}</div>`:u`<div @pointerdown=${this._onContainerPointerDown} .ariaLabel=${d} .ariaOrientation=${a} .ariaValueMax=${`${r}`} .ariaValueMin=${`${s}`} .ariaValueNow=${`${n}`} .ariaValueText=${o} class=${_(h.container)} @keydown=${this._onContainerKeyDown} role=slider style=${z(g)} tabindex=0 title=${d??V} touch-action=none ${K(this._containerRef)}>${v}</div>`}};m.properties={view:0,autoDestroyDisabled:5,direction:3,disabled:7,hideDivider:7,hideHandle:7,icon:1,label:1,leadingLayers:0,messageOverrides:0,position:3,swipePosition:9,referenceElement:1,state:3,trailingLayers:0},m.styles=Y;let P=m;B("arcgis-swipe",P);export{P as ArcgisSwipe};
