const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Brd6-W-v.js","assets/index-ni9qn0ie.css","assets/index-DTUrNkco.js","assets/index-DESQclsg.js","assets/index-8K2Vw-Cm.js","assets/index-Di1Qwrcg.js","assets/index-PykgRxEl.js","assets/index-CQigHSWj.js","assets/utils4-B2uEJjiT.js","assets/index-BP1ODbF9.js","assets/index-CvWxv4t6.js","assets/index-DLfZDdTt.js","assets/customElement-BCHU9VC3.js","assets/index-DPYNoEzK.js"])))=>i.map(i=>d[i]);
import{a1 as Z,a2 as Q,a3 as p,a4 as i,bJ as U,W as pe,C5 as xe,C6 as P,a5 as o,x as a,ab as z,y as $,n0 as Me,a9 as J,j as b,bH as F,hQ as me,C7 as ke,b1 as Ce,zS as De,ez as N,aZ as X,tO as Te,tq as Ie,yl as y,n1 as Ee,bY as Pe,ew as Re,cR as $e,b2 as ge,a8 as Y,K as Le,bG as ve,C8 as G,eD as j,cG as A,cI as Ae,cK as Oe,O as Fe,C9 as _e,cL as ee,Ca as te,Cb as Ne,cC as ze,bI as k,Y as we,c3 as ie,a7 as Be,M as Ve,n3 as He,Cc as Ue,Cd as Ke,au as Ge,ap as re,Ce as je,ch as qe,aP as Je,cA as We,L as Ze,u as Qe,c as Xe,Cf as Ye,I as et,i as tt,l as it}from"./index-Brd6-W-v.js";import{P as fe,d as rt,a as se}from"./RouteLayer-BU2vW0mG.js";import{e as st}from"./defaultUnit-31fx93G1.js";import{S as R,b as be}from"./Stop-DgLSJS2k.js";import{r as ot}from"./InteractiveToolBase-BUcul5AV.js";import{I as oe}from"./dateUtils-Dxl5F42Y.js";import"./networkEnums-DxmX55hr.js";import"./GPMessage-CW1P0x_K.js";const T="esri-search",C={base:T,autocomplete:`${T}__autocomplete`,dropdown:`${T}__dropdown`,container:`${T}__container`,form:`${T}__form`,submitButton:`${T}__submit-button`},ae="esri-search-result-renderer",ne={base:ae,moreResults:`${ae}--more-results`};let E=class extends Z{constructor(e,t){super(e,t),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}loadDependencies(){return Q({block:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.OY),__vite__mapDeps([0,1])),list:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.O$),__vite__mapDeps([0,1])),"list-item":()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.P1),__vite__mapDeps([0,1])),"list-item-group":()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.P0),__vite__mapDeps([0,1]))})}destroy(){this.viewModel=null}render(){return i("div",{class:this.classes(ne.base,U.widget)},this.viewModel?.selectedResult?.name??"",this._renderMoreResults())}_renderMoreResults(){if(!this.viewModel)return null;const{resultCount:e,results:t}=this.viewModel;return!e||e<2||!t?null:i("calcite-block",{class:ne.moreResults,collapsible:!0,expanded:this.showMoreResultsOpen,heading:pe(this.messages.showMoreResults,{count:e-1}),onCalciteBlockClose:()=>this._toggleShowMoreResults(!1),onCalciteBlockOpen:()=>this._toggleShowMoreResults(!0)},t.map(r=>this._renderMoreResultsList(r,t?.length>1)))}_renderListItem(e){return i("calcite-list-item",{key:`result-${e.sourceIndex}-${e.key}`,label:e.name,onCalciteListItemSelect:()=>this._selectResult(e)})}_renderMoreResultsList(e,t){const{results:r}=e;if(!(r?.length??0)||!r)return null;const s=this.viewModel?.selectedResult,l=this._getSourceName(e.source,e.sourceIndex),u=r.filter(c=>c!==s).map(c=>this._renderListItem(c));return i("calcite-list",{label:l},t?i("calcite-list-item-group",{heading:l,key:`group-${e.sourceIndex}`},u):u)}_selectResult(e){this.showMoreResultsOpen=!1,this.viewModel?.select(e)}_toggleShowMoreResults(e){this.showMoreResultsOpen=e;const t=xe(this.viewModel?.view);t&&"reposition"in t&&typeof t.reposition=="function"&&t.reposition()}_getSourceName(e,t){return t===P.ALL_INDEX?this.messages.all:e.name}};o([a(),z("esri/widgets/Search/t9n/Search")],E.prototype,"messages",void 0),o([a()],E.prototype,"showMoreResultsOpen",void 0),o([a()],E.prototype,"viewModel",void 0),E=o([$("esri.widgets.Search.SearchResultRenderer")],E);const at=E;let h=class extends Z{constructor(e,t){super(e,t),this._currentLocationValue=`${this.id}-search-use-current-location`,this._autocompleteNode=null,this._focusAbortController=null,this._searchResultRenderer=new at,this._suggestController=null,this._searchController=null,this._lastSearchTerm="",this._locateFailed=!1,this._showNoResults=!1,this.disabled=!1,this.messages=null,this.messagesCommon=null,this.viewModel=new P,this._renderSearchResultsContent=()=>this._searchResultRenderer,Me(J.getLogger(this),"Search","arcgis-search",{version:"4.33"}),this.addHandles([b(()=>this.viewModel,r=>this._searchResultRenderer.viewModel=r,F),b(()=>this.viewModel.results,()=>this._searchResultRenderer.showMoreResultsOpen=!1),b(()=>this.messages,r=>this.viewModel.messages=r),b(()=>this.viewModel?.defaultPopupTemplate,r=>{r&&(r.content=this._renderSearchResultsContent)},F),b(()=>this.viewModel?.view?.popupElement&&this.viewModel?.defaultPopupTemplate,()=>{if(this.viewModel?.defaultPopupTemplate&&this.viewModel?.view?.popupElement){const r=document.createElement("arcgis-search-result-renderer");r.viewModel=this.viewModel,r.messages=this.messages,this.viewModel.defaultPopupTemplate.content=r}},F)])}loadDependencies(){return Q({autocomplete:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.P3),__vite__mapDeps([0,1])),"autocomplete-item-group":()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.P4),__vite__mapDeps([0,1])),"autocomplete-item":()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.P2),__vite__mapDeps([0,1])),button:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.OI),__vite__mapDeps([0,1])),dropdown:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.OV),__vite__mapDeps([0,1])),"dropdown-group":()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.OX),__vite__mapDeps([0,1])),"dropdown-item":()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.OW),__vite__mapDeps([0,1])),notice:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.P5),__vite__mapDeps([0,1]))})}destroy(){this._cancelQueries(),this._searchResultRenderer=me(this._searchResultRenderer),this._focusAbortController?.abort()}get _isDisabled(){const{state:e}=this.viewModel;return e==="disabled"||e==="loading"||this.disabled}get _showCurrentLocation(){return this.locationEnabled&&!this.searchTerm?.trim()}get _effectiveActiveMenu(){const{activeMenu:e}=this;return this._isDisabled?"none":e==="warning"?"suggestion":e}get activeMenu(){return"none"}set activeMenu(e){e==="warning"&&ke(J.getLogger(this),"activeMenu","warning",{replacement:"Use the value 'suggestion' instead",version:"4.32",warnOnce:!0}),this._overrideIfSome("activeMenu",e)}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(e){this.viewModel.activeSourceIndex=e}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(e){this.viewModel.allPlaceholder=e}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(e){this.viewModel.autoNavigate=e}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(e){this.viewModel.autoSelect=e}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"search"}set icon(e){this._overrideIfSome("icon",e)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(e){this.viewModel.includeDefaultSources=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(e){this.viewModel.locationEnabled=e}get maxResults(){return this.viewModel.maxResults}set maxResults(e){this.viewModel.maxResults=e}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(e){this.viewModel.maxSuggestions=e}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(e){this.viewModel.minSuggestCharacters=e}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(e){this.viewModel.popupEnabled=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get portal(){return this.viewModel?.portal}set portal(e){this.viewModel&&(this.viewModel.portal=e)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(e){this.viewModel.resultGraphic=e}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(e){this.viewModel.resultGraphicEnabled=e}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(e){this.viewModel.searchAllEnabled=e}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(e){this.viewModel.searchTerm=e}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(e){this.viewModel.suggestionsEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}clear(){this._locateFailed=!1,this.viewModel.clear()}focus(){this._handleFocus(),this._emitFocus()}blur(){this._autocompleteNode?.blur(),this._emitBlur()}async search(e){this._cancelQueries();const t=new AbortController,{signal:r}=t;this._searchController=t;try{const s=await this.viewModel.search(e,{signal:r});return this._searchController!==t?void 0:(s?.numResults||(this._showNoResults=!0,this.activeMenu="suggestion"),this._searchController=null,s)}catch{return this._searchController!==t?void 0:void(this._searchController=null)}}async suggest(e){this._cancelSuggest();const t=new AbortController,{signal:r}=t;this._suggestController=t;try{const s=await this.viewModel.suggest(e,null,{signal:r});return this._suggestController!==t?void 0:(this._suggestController=null,s?.numResults&&(this.activeMenu="suggestion",this._scrollToTopSuggestion()),s)}catch{return this._suggestController!==t||(this._suggestController=null),null}}render(){return i("div",{class:this.classes(C.base,U.widget)},i("div",{class:C.container},this._renderSourcesMenu(),this._renderForm()))}_handleInputKeydown(e){e.key==="Tab"&&this._cancelSuggest()}_emitFocus(){this.emit("search-focus")}_emitBlur(){this.emit("search-blur")}async _handleFocus(){this._focusAbortController?.abort(),this._focusAbortController=new AbortController;const e=this._focusAbortController.signal;await Ce(De(e)),this._autocompleteNode?.setFocus()}_renderSourcesMenu(){const{messages:e,_isDisabled:t,_effectiveActiveMenu:r}=this,{allSources:s,searchAllEnabled:l}=this.viewModel;return s.length>1?i("calcite-dropdown",{bind:this,class:C.dropdown,disabled:t,open:r==="source",overlayPositioning:"fixed",onCalciteDropdownClose:this._handleSourceClose,onCalciteDropdownOpen:this._handleSourceOpen,onCalciteDropdownSelect:this._handleSourceSelect},i("calcite-button",{appearance:"outline-fill",iconStart:"caret-down",kind:"neutral",label:e.searchIn,slot:"trigger"}),i("calcite-dropdown-group",{groupTitle:e.searchIn},l?this._renderSource(P.ALL_INDEX):null,s.map((u,c)=>this._renderSource(c)).toArray())):null}_renderUseCurrentLocation(){const{_currentLocationValue:e}=this;return i("calcite-autocomplete-item",{heading:this.messages.useCurrentLocation,iconStart:"gps-on",key:e,value:e})}_handleAutocompleteCreate(e){this._autocompleteNode=e}_handleCalciteAutocompleteTextInput(e){const t=e.target.inputValue;t!==this.viewModel.searchTerm&&(this.viewModel.searchTerm=t,t||this.clear(),this.suggest())}_handleAutocompleteOpen(){this.activeMenu="suggestion"}_handleAutocompleteClose(){this.activeMenu==="suggestion"&&(this.activeMenu="none")}_handleCalciteAutocompleteChange(e){const t=e.target.value;if(t===this._currentLocationValue)return void this._useCurrentLocation();const r=JSON.parse(t),s=this.viewModel.suggestions?.find(({sourceIndex:l})=>l===r.sourceIndex)?.results?.find(({key:l})=>`${l}`==`${r.key}`);s&&this.search(s)}_renderAutocomplete(){const{_effectiveActiveMenu:e,messages:t,_isDisabled:r}=this,{maxInputLength:s,placeholder:l,searchTerm:u,state:c}=this.viewModel,m=this.label??t.searchButtonTitle??"";return i("calcite-autocomplete",{afterCreate:this._handleAutocompleteCreate,autocomplete:"off",bind:this,class:C.autocomplete,disabled:r,icon:this.icon||!1,inputValue:u,label:m,loading:c==="searching",maxLength:s,name:this.id,onblur:this._emitBlur,onfocus:this._emitFocus,onkeydown:this._handleInputKeydown,open:e==="suggestion",overlayPositioning:"fixed",placeholder:l,title:u?"":l,onCalciteAutocompleteChange:this._handleCalciteAutocompleteChange,onCalciteAutocompleteClose:this._handleAutocompleteClose,onCalciteAutocompleteOpen:this._handleAutocompleteOpen,onCalciteAutocompleteTextChange:this._handleCalciteAutocompleteTextInput,onCalciteAutocompleteTextInput:this._handleCalciteAutocompleteTextInput},this._renderSuggestions(),this._renderNotices())}_renderForm(){return i("form",{bind:this,class:C.form,disabled:this._isDisabled,key:C.form,onsubmit:this._formSubmit,role:"search"},this._renderAutocomplete(),i("button",{class:C.submitButton,type:"submit"},this.label??this.messages.searchButtonTitle??""))}_renderSuggestGroup(e){return e.results?.map(t=>this._renderSuggestion(t))}_renderSuggestions(){const{suggestions:e}=this.viewModel;return this._showNoResults?null:this._showCurrentLocation?this._renderUseCurrentLocation():e?.map(t=>this._renderSuggestResults(t))}_renderSuggestResults(e){const{allSources:t,activeSourceIndex:r}=this.viewModel,{sourceIndex:s}=e,l=e.results?.length,u=t.length>1&&r===P.ALL_INDEX,c=this._getSourceName(s);return l&&u?i("calcite-autocomplete-item-group",{heading:c,key:`suggestion-group-${c}-${s}`},this._renderSuggestGroup(e)):this._renderSuggestGroup(e)}_renderSuggestion({key:e,sourceIndex:t,text:r}){const s={key:e,sourceIndex:t};return i("calcite-autocomplete-item",{heading:r??this.messages.untitledResult,key:`suggestion_${e}`,value:JSON.stringify(s)})}_renderSource(e){const t=this._getSourceName(e);return i("calcite-dropdown-item",{"data-source-index":`${e}`,key:`source-${t}-${e}`,selected:e===this.viewModel.activeSourceIndex},t)}_renderNoResultsWarning(e){const{messages:t}=this,r=e?pe(t.noResultsFoundForValue,{value:`"${e}"`}):t.noResultsFound;return i("calcite-notice",{icon:"exclamation-mark-triangle",key:"no-results-warning",kind:"warning",open:!0,slot:"content-bottom"},i("div",{slot:"title"},t.noResults),i("div",{slot:"message"},r))}_renderLocateError(){return i("calcite-notice",{icon:"exclamation-mark-circle",key:"locate-warning",kind:"danger",open:!0,slot:"content-bottom"},i("div",{slot:"message"},this.messages.locateError))}_renderNotices(){return this._locateFailed?this._renderLocateError():this._showNoResults?this._renderNoResultsWarning(this._lastSearchTerm??this.viewModel.searchTerm):null}async _useCurrentLocation(){this._cancelQueries();const e=new AbortController,{signal:t}=e;this._searchController=e;try{await this.viewModel.searchNearby({signal:t})}catch(r){N(r)||(this._locateFailed=!0,this.activeMenu="suggestion")}finally{this._searchController=null}}_handleSourceOpen(){this.activeMenu="source"}_handleSourceClose(){this.activeMenu==="source"&&(this.activeMenu="none")}_handleSourceSelect(e){const t=e.target.selectedItems[0].getAttribute("data-source-index");t&&(this.viewModel.activeSourceIndex=parseInt(t,10))}_cancelSuggest(){this.activeMenu="none",this._locateFailed=!1,this._showNoResults=!1,this._suggestController=X(this._suggestController)}_cancelQueries(){this._cancelSuggest(),this._searchController=X(this._searchController)}_scrollToTopSuggestion(){this._autocompleteNode?.scrollContentTo({top:0})}_formSubmit(e){e.preventDefault(),this.activeMenu="none",this._lastSearchTerm=this.searchTerm,this.searchTerm&&this.search()}_getSourceName(e){const{messages:t}=this,{allSources:r}=this.viewModel,s=r.at(e);return e===P.ALL_INDEX?t.all:s?.name||t.untitledSource}};o([a()],h.prototype,"_locateFailed",void 0),o([a()],h.prototype,"_showNoResults",void 0),o([a()],h.prototype,"_isDisabled",null),o([a()],h.prototype,"_showCurrentLocation",null),o([a()],h.prototype,"_effectiveActiveMenu",null),o([a()],h.prototype,"activeMenu",null),o([a({readOnly:!0})],h.prototype,"activeSource",null),o([a()],h.prototype,"activeSourceIndex",null),o([a()],h.prototype,"allPlaceholder",null),o([a({readOnly:!0})],h.prototype,"allSources",null),o([a()],h.prototype,"autoNavigate",null),o([a()],h.prototype,"autoSelect",null),o([a({readOnly:!0})],h.prototype,"defaultSources",null),o([a()],h.prototype,"disabled",void 0),o([a()],h.prototype,"goToOverride",null),o([a()],h.prototype,"icon",null),o([a()],h.prototype,"includeDefaultSources",null),o([a()],h.prototype,"label",null),o([a()],h.prototype,"locationEnabled",null),o([a()],h.prototype,"maxResults",null),o([a()],h.prototype,"maxSuggestions",null),o([a(),z("esri/widgets/Search/t9n/Search")],h.prototype,"messages",void 0),o([a(),z("esri/t9n/common")],h.prototype,"messagesCommon",void 0),o([a()],h.prototype,"minSuggestCharacters",null),o([a()],h.prototype,"popupEnabled",null),o([a()],h.prototype,"popupTemplate",null),o([a()],h.prototype,"portal",null),o([a()],h.prototype,"resultGraphic",null),o([a()],h.prototype,"resultGraphicEnabled",null),o([a({readOnly:!0})],h.prototype,"results",null),o([a()],h.prototype,"searchAllEnabled",null),o([a()],h.prototype,"searchTerm",null),o([a({readOnly:!0})],h.prototype,"selectedResult",null),o([a()],h.prototype,"sources",null),o([a({readOnly:!0})],h.prototype,"suggestions",null),o([a()],h.prototype,"suggestionsEnabled",null),o([a()],h.prototype,"view",null),o([Te(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),a({type:P})],h.prototype,"viewModel",void 0),h=o([$("esri.widgets.Search")],h);const nt=h,d="esri-directions",n={base:d,accordion:`${d}__accordion`,actionContainer:`${d}__action-container`,addStopButton:`${d}__add-stop-button`,departureTime:`${d}__departure-time`,departureTimeOptions:`${d}__departure-time-options`,directionsHeader:`${d}__directions-header`,directionsHeaderStopName:`${d}__directions-header-stop-name`,editFooter:`${d}__edit-footer`,editRouteButton:`${d}__edit-route-button`,editToolbar:`${d}__edit-toolbar`,editToolbarContainer:`${d}__edit-toolbar-container`,flexColumn:`${d}__flex-column`,flexRow:`${d}__flex-row`,folder:`${d}__folder`,folderHome:`${d}__folder-home`,headerStops:`${d}__header-stops`,labelEmphasize:`${d}__label-emphasize`,labelNoBottomMargin:`${d}__label-no-bottom-margin`,marginInlineMedium:`${d}__margin-inline-medium`,optimizeSection:`${d}__optimize-section`,optimizeSwitches:`${d}__optimize-switches`,paddingMedium:`${d}__padding-medium`,primaryFlowItem:`${d}__primary-flow-item`,primaryFooter:`${d}__primary-footer`,primaryFooterCentered:`${d}__primary-footer-centered`,primaryFooterLoader:`${d}__primary-footer-loader`,printPreviewAvoidPageBreak:`${d}__print-preview--avoid-page-break`,printPreviewContent:`${d}__print-preview-content`,printPreviewDialog:`${d}__print-preview-dialog`,printPreviewDialogClose:`${d}__print-preview-dialog-close`,printPreviewDialogPrint:`${d}__print-preview-dialog-print`,printPreviewHeader:`${d}__print-preview-header`,printPreviewHeaderButtons:`${d}__print-preview-header-buttons`,printPreviewHeaderLabel:`${d}__print-preview-header-label`,printPreviewHideOnPrint:`${d}__print-preview--hide-on-print`,printPreviewMedia:`${d}__print-preview-media`,printPreviewSection:`${d}__print-preview-section`,routeItem:`${d}__route-item`,routeItemButton:`${d}__route-item-button`,routeItemButtonContent:`${d}__route-item-button-content`,routeItemDescription:`${d}__route-item-description`,routeItemLabel:`${d}__route-item-label`,saveError:`${d}__save-error`,saveErrorIcon:`${d}__save-error-icon`,saveErrorLabel:`${d}__save-error-label`,saveProcessLoader:`${d}__save-process-loader`,selectedFeatureContainer:`${d}__selected-feature-container`,separator:`${d}__separator`,solveRoute:`${d}__solve-route`,stopContainer:`${d}__stop-container`,stopItem:`${d}__stop-item`,stopList:`${d}__stop-list`};let O=class extends ot{constructor(t){super(t)}get cursor(){return"crosshair"}onInputEvent(t){t.type==="click"&&this._handleClick(t)}_handleClick(t){this.emit("click",t)}};o([a({readOnly:!0})],O.prototype,"cursor",null),o([a({constructOnly:!0})],O.prototype,"stop",void 0),O=o([$("esri.widgets.Directions.DirectionsSearchTool")],O);const le=new Map([["arrive","route-to"],["bear-left","bear-left"],["bear-right","bear-right"],["boundary-crossing","blank"],["central-fork","fork-middle"],["clockwise-roundabout","round-about-right"],["counter-clockwise-roundabout","round-about"],["depart","route-from"],["door","walk-through-door"],["down-elevator","elevator-down"],["down-escalator","escalator-down"],["down-stairs","stairs-down"],["elevator","elevator"],["escalator","escalator"],["general-event","information"],["header","blank"],["landmark","map-pin"],["lane","blank"],["left-fork","fork-left"],["left-handed-u-turn","u-turn"],["left-ramp","ramp-left"],["left-turn","left"],["left-turn-and-immediate-left-turn","left-left"],["left-turn-and-immediate-right-turn","left-right"],["off-ferry","disembark"],["on-ferry","embark"],["pedestrian-ramp","take-pedestrian-ramp"],["restriction-violation","exclamation-mark-triangle"],["right-fork","fork-right"],["right-handed-u-turn","u-turn-right"],["right-ramp","ramp-right"],["right-turn","right"],["right-turn-and-immediate-left-turn","right-left"],["right-turn-and-immediate-right-turn","right-right"],["roundabout","round-about"],["scaled-cost-barrier-event","blank"],["sharp-left","sharp-left"],["sharp-right","sharp-right"],["stairs","stairs"],["straight","straight"],["time-zone-change","clock"],["traffic-event","exclamation-mark-triangle"],["u-turn","u-turn"],["up-elevator","elevator-up"],["up-escalator","escalator-up"],["up-stairs","stairs-up"]]),D={NOW:"now",DEPART_AT:"depart-at",UNSPECIFIED:"unspecified"};function I(e,t){return Pe(e,{style:"unit",unit:t,unitDisplay:"short"})}function B(e,t,r){if(t===0)return"";let s,l,u=0;const c=Ie(t,"meters");switch(r){case"metric":c.value<.01?{value:s,unit:l}=y(c,"millimeters"):c.value<1?{value:s,unit:l}=y(c,"centimeters"):c.value<1e3?{value:s,unit:l}=y(c,"meters"):c.value<1e5?({value:s,unit:l}=y(c,"kilometers"),u=1):{value:s,unit:l}=y(c,"kilometers");break;case"imperial":c.value<.254?{value:s,unit:l}=y(c,"inches"):c.value<160.9344?{value:s,unit:l}=y(c,"feet"):c.value<160934.4?({value:s,unit:l}=y(c,"miles"),u=1):{value:s,unit:l}=y(c,"miles");break;default:({value:s,unit:l}=y(c,r)),u=2}return Ee(e,s,l,u)}function V(e){if(e===0)return"";if(e<1)return I(Math.floor(60*e),"second");if(e<60)return I(Math.floor(e),"minute");const t=Math.floor(e/60);if(e<1440){const r=Math.floor(e%60);return r===0?`${I(t,"hour")}`:`${I(t,"hour")} ${I(r,"minute")}`}return I(t,"hour")}function ce(e){return e!=null&&le.has(e)?le.get(e):"blank"}function lt(e){return e.map(t=>({locale:t,parts:_e(t)})).filter(({parts:t})=>!!t)}function ct(e,t){return e.find(({parts:r})=>ue(r.language,t.language)&&r.region===t.region)?.locale??e.find(({parts:r})=>ue(r.language,t.language))?.locale}function dt(e){return e?.declaredClass==="esri.Graphic"}function de(e){return e==="no"||e==="nb"}function ue(e,t){return e===t||de(e)&&de(t)}function ut(e){return e?.declaredClass==="esri.rest.support.Stop"}let g=class extends Re($e){constructor(e){super(e),this._debouncedSolveHandler=ge(async t=>{switch(t.type){case"create":if(t.state!=="complete")return;break;case"delete":break;case"update":switch(t.state){case"start":return void(this._networkFeatureUpdated=!1);case"active":return void(this._networkFeatureUpdated=!0);case"complete":if(!this._networkFeatureUpdated)return}}if(!((this.layer?.stops.filter(({geometry:r})=>!!r).length??0)<2)&&this.autoSolve)try{await this.getDirections({zoomToSolvedRoute:!1})}catch(r){J.getLogger(this).error(r)}}),this._highlight=null,this._loadController=null,this._loadPromise=null,this._networkFeatureUpdated=!1,this._layerView=null,this._routeController=null,this._serviceDescriptionStatus=3,this.apiKey=void 0,this.autoSolve=!0,this.defaultTravelMode=null,this.departureIsoDate=void 0,this.departureIsoTime=void 0,this.departureOption=D.NOW,this.departureTime="now",this.lastError=null,this.lastRoute=null,this.layer=null,this.maxStops=50,this.routeParameters=new fe({directionsLengthUnits:"kilometers",findBestSequence:!1,preserveFirstStop:!0,preserveLastStop:!0,returnZ:!0,useTimeWindows:!1}),this.serviceDescription=null,this.view=null}initialize(){this.addHandles([b(()=>this.layer,r=>{if(r!=null){for(;r.stops.length<2;)r.stops.add(new R);this._set("defaultTravelMode",null),this.addHandles(Le(()=>this.serviceDescription?r.routeInfo?.analysisSettings?.travelMode:null,s=>{this.defaultTravelMode=this._resolveDefaultTravelMode(s)},{once:!0}))}},Y),b(()=>[this.layer,this.view],async()=>{this._layerView=await this._getRouteLayerView()},Y),ve(()=>this._layerView,["create","delete","update"],r=>{this._debouncedSolveHandler(r).catch(s=>{if(!N(s))throw s})})]);const e=G(this.view?.timeZone??j),t=A.fromMillis(Date.now());this.departureIsoDate=t.toFormat(Ae,oe(e)),this.departureIsoTime=t.toFormat(Oe,oe(e))}get _directionsLanguage(){const e=this.serviceDescription?.directionsSupportedLanguages;if(!e)return;const t=this.routeParameters.directionsLanguage??Fe(),r=_e(t),s=r?.language,l=r?.region;if(s)return ct(lt(e),{language:s,region:l})}get formattedEta(){const e=this.layer?.routeInfo?.endTime,t=this.layer?.routeInfo?.endTimeOffset;if(this.departureOption===D.UNSPECIFIED||!e||!t)return null;const r=A.fromJSDate(e,{zone:ee.instance(t)}),s=A.fromJSDate(e,{zone:te.create(G(this.view?.timeZone??j))}),l=A.fromJSDate(new Date,{zone:te.create(G(this.view?.timeZone??j))}),u=l.year===s.year&&l.month===s.month&&l.day===s.day,c=s.offset===t?void 0:Ne,m=u?void 0:ie("short-date"),f=ie("short-time");return ze(r.toISO(),{...m,...f,timeZoneName:c})}get impedanceAttribute(){const e=this.routeParameters.travelMode?.impedanceAttributeName??this.routeParameters.impedanceAttribute??this.serviceDescription?.impedance??null;return this.getCostAttribute(e)}get selectedNetworkFeatures(){return this._layerView?.selectedNetworkFeatures??null}get selectedTravelMode(){return this.serviceDescription?this.defaultTravelMode??this.serviceDescription.defaultTravelMode??this.serviceDescription.supportedTravelModes?.[0]??null:null}set selectedTravelMode(e){this._override("selectedTravelMode",e)}get state(){if(this._routeController)return"routing";if(this.lastError)return"error";switch(this._serviceDescriptionStatus){case 4:return"unauthenticated";case 3:return"disabled";case 0:return"initializing";case 2:return"error";default:return"ready"}}get timeAttribute(){const e=this.routeParameters.travelMode?.timeAttributeName??this.routeParameters.directionsTimeAttribute??this.serviceDescription?.directionsTimeAttribute??null;return this.getCostAttribute(e)}get travelModes(){const e=this.serviceDescription?.supportedTravelModes?.slice()??[];return this.defaultTravelMode==null||e.includes(this.defaultTravelMode)||e.unshift(this.defaultTravelMode),e}async load(){if(this._loadPromise)return this._loadPromise;this._loadPromise=this._load(),await this._loadPromise,this._loadPromise=null}async highlight(e){if(this.clearHighlights(),!this.view||!this.layer)return;const t=await this.view.whenLayerView(this.layer);this._highlight=t.highlight(e)}clearHighlights(){this._highlight!=null&&(this._highlight.remove(),this._highlight=null)}centerAt(e){if(!this.view)return;const t=ut(e)||dt(e)?e.geometry:e;t&&this.callGoTo({target:t})}clearResults(){this._set("lastRoute",null),this.layer?.removeResult()}async create(e){await this._layerView?.create(e)}async getDirections(e={zoomToSolvedRoute:!0}){const{apiKey:t,layer:r,state:s}=this;if(!r)throw new k("directions-view-model:missing-route-layer","A route layer must be associated with the view model.");if(s==="unauthenticated"||s==="initializing"||s==="disabled"||this._serviceDescriptionStatus===2)throw new k("directions-view-model:not-loaded","Cannot get directions until view model loads.");this._routeController!=null&&(this._routeController.abort(),this._routeController=null);const{startTime:l,startTimeIsUTC:u}=this._getStartTimeParameters(),c=this.view?.spatialReference??null,m=this.routeParameters.clone();if(m.set({apiKey:t,directionsLanguage:this._directionsLanguage,outSpatialReference:c,startTime:l,startTimeIsUTC:u}),this.selectedTravelMode&&(m.travelMode=this.selectedTravelMode),r.stops.filter(({geometry:_})=>_!=null).length<2){const _=new k("directions-view-model:not-enough-stops","Not enough stops for routing");throw this._set("lastError",_),_}r.stops.forEach(_=>_.sequence=null),this._routeController=new AbortController;const{signal:f}=this._routeController;let w=null;try{w=await r.solve(m,{signal:f})}catch(_){if(!N(_)){const S=new k("directions-view-model:unable-to-route","Unable to route to these addresses",{error:_});throw this._set("lastError",S),this.clearResults(),S}}finally{this._routeController=null}this._set("lastError",null);for(const _ of w.stops)_.geometry==null&&(_.name=null);return r.update(w),this._set("lastRoute",w),e.zoomToSolvedRoute&&this.zoomToRoute(),w}getCostAttribute(e){return(this.serviceDescription?.networkDataset?.networkAttributes??[]).find(({name:t,usageType:r})=>t===e&&r==="cost")??null}remove(e){this._layerView?.remove(e)}reset(){this.clearHighlights(),this.clearResults(),this.layer!=null&&(this.layer.removeAll(),this.layer.stops=new we([new R,new R]))}save(){if(!this.layer)throw new k("directions-view-model:missing-layer","save() requires a layer");return this.layer.save()}saveAs(e,t={}){if(!this.layer)throw new k("directions-view-model:missing-layer","saveAs() requires a layer");return this.layer.saveAs(e,t)}async startEditing(){this._layerView&&(this._layerView.interactive=!0)}async stopEditing(){this._layerView&&(this._layerView.interactive=!1)}updateDepartureTime(){if(this.departureIsoDate&&this.departureIsoTime)switch(this.departureOption){case D.NOW:this.departureTime="now";break;case D.DEPART_AT:{const e=A.fromISO(`${this.departureIsoDate}T${this.departureIsoTime}`,{zone:ee.instance(0)});this.departureTime=e.toJSDate();break}case D.UNSPECIFIED:this.departureTime=null}}zoomToRoute(){const{view:e,layer:t}=this,r=t?.routeInfo?.geometry?.extent;if(!e||!r)return;const s=r.width>r.height,l=r.clone().expand(s?2:1);this.callGoTo({target:l})}async _getRouteLayerView(){return this.view&&this.layer?this.view.whenLayerView(this.layer):null}_getStartTimeParameters(){return this.departureTime==="now"?{startTime:this.serviceDescription?.capabilities.supportsNow??!1?"now":new Date,startTimeIsUTC:!0}:this.departureTime==null?{startTime:void 0,startTimeIsUTC:void 0}:{startTime:this.departureTime,startTimeIsUTC:!1}}async _load(){if(this.layer==null)return;this._loadController!=null&&(this._loadController.abort(),this._loadController=null),this._loadController=new AbortController;const{signal:e}=this._loadController;try{this._serviceDescriptionStatus=0;const t=await rt(this.layer.url,this.apiKey,{signal:e});this._set("serviceDescription",t),this._serviceDescriptionStatus=1}catch(t){if(N(t))return void(this._serviceDescriptionStatus=3);if(t.name==="identity-manager:user-aborted")return void(this._serviceDescriptionStatus=4);const r=new k("directions-view-model:service-metadata-unavailable","Cannot load route service metadata",{error:t});throw this._serviceDescriptionStatus=2,this._set("lastError",r),r}finally{this._loadController=null}}_resolveDefaultTravelMode(e){if(this.serviceDescription==null)return null;const{defaultTravelMode:t,supportedTravelModes:r}=this.serviceDescription,s=/^<(?<name>.*)>$/i.exec(e.name)?.groups?.name;if(s){const u=r?.find(({name:m})=>m.toLocaleLowerCase()===s.trim().toLocaleLowerCase()),c=u??t;return be.fromJSON({...c?.toJSON(),...e.toJSON()})}return r?.find(({name:u})=>u.toLocaleLowerCase()===e.name.toLocaleLowerCase())??t}};o([a()],g.prototype,"_directionsLanguage",null),o([a()],g.prototype,"_layerView",void 0),o([a()],g.prototype,"_routeController",void 0),o([a()],g.prototype,"_serviceDescriptionStatus",void 0),o([a()],g.prototype,"apiKey",void 0),o([a()],g.prototype,"autoSolve",void 0),o([a()],g.prototype,"defaultTravelMode",void 0),o([a()],g.prototype,"departureTime",void 0),o([a()],g.prototype,"formattedEta",null),o([a({readOnly:!0})],g.prototype,"impedanceAttribute",null),o([a()],g.prototype,"lastError",void 0),o([a({readOnly:!0})],g.prototype,"lastRoute",void 0),o([a()],g.prototype,"layer",void 0),o([a({type:Number,range:{min:2,max:50},nonNullable:!0})],g.prototype,"maxStops",void 0),o([a({type:fe,nonNullable:!0})],g.prototype,"routeParameters",void 0),o([a({readOnly:!0})],g.prototype,"selectedNetworkFeatures",null),o([a({type:be})],g.prototype,"selectedTravelMode",null),o([a({readOnly:!0})],g.prototype,"serviceDescription",void 0),o([a({readOnly:!0})],g.prototype,"state",null),o([a({readOnly:!0})],g.prototype,"timeAttribute",null),o([a()],g.prototype,"travelModes",null),o([a()],g.prototype,"view",void 0),o([a()],g.prototype,"zoomToRoute",null),g=o([$("esri.widgets.Directions.DirectionsViewModel")],g);const ye=g;let M=class extends Be{constructor(){super(...arguments),this.editRouteButton=!0,this.layerDetails=!0,this.printButton=!0,this.saveAsButton=!0,this.saveButton=!0}};o([a({type:Boolean,nonNullable:!0})],M.prototype,"editRouteButton",void 0),o([a({type:Boolean,nonNullable:!0})],M.prototype,"layerDetails",void 0),o([a({type:Boolean,nonNullable:!0})],M.prototype,"printButton",void 0),o([a({type:Boolean,nonNullable:!0})],M.prototype,"saveAsButton",void 0),o([a({type:Boolean,nonNullable:!0})],M.prototype,"saveButton",void 0),M=o([$("esri.widgets.Directions.DirectionsVisibleElements")],M);const Se=M;function he(e){const{branchName:t,displayText:r,exitName:s,intersectingName:l,name:u,towardName:c}=e;if(r==null)return null;const m=[t,s,l,u,c].filter(Je).sort((x,L)=>L.length-x.length).map(x=>We(x));if(!m.length)return r;const f=new RegExp(m.join("|"),"g"),w=r.matchAll(f);let _=0;const S=[];for(const{0:x,index:L}of w)S.push(r.slice(_,L),i("span",{class:n.labelEmphasize,key:`maneuver-${L}`},x)),_=L+x.length;return S.push(r.slice(_)),i("span",null,S)}const q="print-preview-closed";let v=class extends Z{constructor(e,t){super(e,t),this._activeManeuver=null,this._placeholderStops=new we([new R,new R]),this._portalFolderCombobox=null,this._portalFolders=null,this._portalItemNameInput=null,this._portalUserName=null,this._printPreviewDialog=null,this._sections=null,this._stopsToSearches=new Map,this._printPreviewDialogOpen=!1,this._currentFlowItem="primary",this._parentFlowItem="primary",this._saveState="initialized",this._searchTool=null,this.headingLevel=2,this.messages=null,this.messagesUnits=null,this.searchProperties={popupEnabled:!1,resultGraphicEnabled:!1},this.viewModel=new ye,this.visibleElements=new Se,this._solveRouteDebounced=ge(()=>this._solveRoute())}initialize(){this.addHandles([b(()=>this.viewModel.layer,()=>{try{this.viewModel.load()}catch{}},F),b(()=>this.viewModel.layer?.routeInfo,()=>{this._sections=this._getStopSections()},F),b(()=>this.viewModel.layer?.stops.toArray(),e=>{e&&this.view?.activeTool&&this._searchTool&&this.view.activeTool===this._searchTool&&!e.includes(this._searchTool.stop)&&(this.view.tools.remove(this._searchTool),this._searchTool=null)})])}loadDependencies(){return Q({accordion:()=>p(()=>import("./index-DTUrNkco.js"),__vite__mapDeps([2,0,1])),"accordion-item":()=>p(()=>import("./index-DESQclsg.js"),__vite__mapDeps([3,0,1])),action:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.OR),__vite__mapDeps([0,1])),"action-menu":()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.OT),__vite__mapDeps([0,1])),"block-section":()=>p(()=>import("./index-8K2Vw-Cm.js"),__vite__mapDeps([4,0,1,5])),button:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.OI),__vite__mapDeps([0,1])),combobox:()=>p(()=>import("./index-PykgRxEl.js"),__vite__mapDeps([6,0,1,7,8])),"combobox-item":()=>p(()=>import("./index-CQigHSWj.js"),__vite__mapDeps([7,0,1,8])),flow:()=>p(()=>import("./index-BP1ODbF9.js"),__vite__mapDeps([9,0,1])),"flow-item":()=>p(()=>import("./index-CvWxv4t6.js"),__vite__mapDeps([10,0,1])),icon:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.Ou),__vite__mapDeps([0,1])),input:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.O_),__vite__mapDeps([0,1])),"input-date-picker":()=>p(()=>import("./index-DLfZDdTt.js"),__vite__mapDeps([11,0,1,12])),"input-time-picker":()=>p(()=>import("./index-DPYNoEzK.js"),__vite__mapDeps([13,0,1])),label:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.P9),__vite__mapDeps([0,1])),list:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.O$),__vite__mapDeps([0,1])),"list-item":()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.P1),__vite__mapDeps([0,1])),loader:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.OH),__vite__mapDeps([0,1])),notice:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.P5),__vite__mapDeps([0,1])),panel:()=>p(()=>import("./index-Brd6-W-v.js").then(e=>e.OU),__vite__mapDeps([0,1])),switch:()=>p(()=>import("./index-Di1Qwrcg.js"),__vite__mapDeps([5,0,1]))})}destroy(){this._stopsToSearches.forEach(me)}get apiKey(){return this.viewModel.apiKey}set apiKey(e){this.viewModel.apiKey=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"right"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get lastRoute(){return this.viewModel.lastRoute}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get maxStops(){return this.viewModel.maxStops}set maxStops(e){this.viewModel.maxStops=e}get unit(){return this.defaultUnit}set unit(e){this._overrideIfSome("unit",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}acquireSearch(e){const{view:t}=this.viewModel;if(this._stopsToSearches.has(e)){const s=this._stopsToSearches.get(e);return s.view=t,this._overrideDefaultSources(s),s}const r=new nt({icon:"",popupEnabled:!1,resultGraphicEnabled:!1,view:t,...this.searchProperties});return this._normalizeSearchSources(r),this.addHandles([ve(()=>r.allSources,"change",()=>this._normalizeSearchSources(r)),r.on("search-clear",()=>{e.geometry=null,e.name=null,this.viewModel.layer?.removeResult()}),r.on("select-result",()=>{const s=r.selectedResult;e.geometry=s?.feature.geometry,e.name=s?.name,this._solveRouteDebounced()}),b(()=>r.searchTerm,s=>{e.name=s}),Ve(()=>this._normalizeSearchSources(r))],r),this._stopsToSearches.set(e,r),r}getDirections(){return this.viewModel.getDirections()}render(){return i("div",{class:this.classes(n.base,U.widget,U.panel)},i("calcite-flow",null,this._renderPrimaryFlowItem(),this._renderDirectionsFlowItem(),this._renderEditFlowItem(),this._renderSaveFlowItem()),this._renderPrintDocument())}save(){return this.viewModel.save()}saveAs(e,t={}){return this.viewModel.saveAs(e,t)}zoomToRoute(){return this.viewModel.zoomToRoute()}_applyLocatorSourceOverrides({allSources:e}){for(const t of e)"url"in t&&t.url&&(t.language=He(),t.locationType??="street",Ue(t.url)&&this.apiKey&&t.apiKey==null&&(t.apiKey=this.apiKey,t.url=Ke))}_disposeSearch(e){if(!e||!this._stopsToSearches.has(e))return;const t=this._stopsToSearches.get(e);this.removeHandles(t),t.destroy(),this._stopsToSearches.delete(e)}_getEffectiveStops(){return this.viewModel.layer?.stops??this._placeholderStops}_getErrorDescription(){switch(this.viewModel.lastError?.name){case"directions-view-model:unable-to-route":return this.messages.errors.unableToRoute;case"directions-view-model:service-metadata-unavailable":return this.messages.errors.unableToLoadServiceMetadata;default:return this.messages.errors.unknownError}}_getNetworkFeatureName(e){switch(e.type){case"stop":switch(e.locationType){case"stop":default:return this.messages.networkFeatures.stops.stop;case"waypoint":return this.messages.networkFeatures.stops.waypoint;case"break":return this.messages.networkFeatures.stops.break}case"point-barrier":return this.messages.networkFeatures.pointBarrier;case"polyline-barrier":return this.messages.networkFeatures.polylineBarrier;case"polygon-barrier":return this.messages.networkFeatures.polygonBarrier}}_getRouteCostSummary(){const e=this.viewModel.layer?.routeInfo;if(!e)return null;const t=e.totalDistance??0,r=e.totalDuration??0,{messagesUnits:s,unit:l}=this;return{distance:B(s,t,l),duration:V(r)}}_getStopCostDescription(e){if(!e.directions.length)return;const{totalDistance:t,totalDuration:r}=e.directions.reduce((c,{lines:m})=>{for(const{distance:f,duration:w}of m)c.totalDistance+=f??0,c.totalDuration+=w??0;return c},{totalDistance:0,totalDuration:0}),{messagesUnits:s,unit:l}=this,u=B(s,t,l);return`${V(r)} (${u})`}_getStopSections(){if(!this.viewModel.layer)return null;const{directionPoints:e,directionLines:t,stops:r}=this.viewModel.layer;if(!e||!t)return null;const s=[];let l=null;for(const u of e){const{objectId:c,stopId:m}=u;if(m!=null){const w=r.find(({objectId:_})=>_===m);l&&l.stop===w||(l={stop:w,directions:[]},s.push(l));continue}if(l==null)continue;const f=t.toArray().filter(({directionPointId:w})=>w===c);f.length!==0&&l.directions.push({directionPoint:u,lines:f})}return s}_handleAddStopClick(){const e=new Ge;this.viewModel.layer?.stops.add(new R({symbol:e}))}_handleAutoSolveChange({target:e}){this.viewModel.autoSolve=e.checked}_handleCreatePolylineBarrierClick(){this.viewModel.create("polyline-barrier")}_handleClearRouteClick(){this._currentFlowItem="primary",this.viewModel.reset()}_handleCreateStopClick(){this.viewModel.create("stop")}_handleDeleteNetworkFeatureClick(e){this.viewModel.remove(e),this.viewModel.autoSolve&&this._solveRouteDebounced()}_handleDeleteStopClick(e){this._getEffectiveStops().remove(e),this._disposeSearch(e),this._solveRouteDebounced()}_handleDepartureDateChange({currentTarget:{value:e}}){Array.isArray(e)||(this.viewModel.departureIsoDate=e,this._solveRouteDebounced())}_handleDepartureTimeChange({currentTarget:{value:e}}){this.viewModel.departureIsoTime=e,this._solveRouteDebounced()}_handleDepartureTimeOptionChange({currentTarget:e}){const{selectedItems:t}=e;t.length&&(this.viewModel.departureOption=t[0].value,this._solveRouteDebounced())}_handleDirectionsFlowItemBackClick(e){e.stopPropagation(),this._currentFlowItem="primary"}_handleDirectionTurnItemSelect(e){this._activeManeuver===e?this.zoomToRoute():(this._activeManeuver=e,this.viewModel.centerAt(e.geometry))}_handleDirectionTurnPointerEnter(e){this.viewModel.highlight(e)}_handleDirectionTurnPointerLeave(){this.viewModel.clearHighlights()}_handleEditFlowItemBackClick(e){e.stopPropagation(),this.viewModel.stopEditing(),this._currentFlowItem="primary"}_handleEditingDoneClick(){this.viewModel.stopEditing(),this._currentFlowItem="primary"}_handleEditRouteClick(){this._currentFlowItem="edit",this.viewModel.startEditing()}_handleItemDetailsClick(){const e=this.viewModel.layer?.portalItem;e&&window.open(`${e.portal.url}/home/item.html?id=${e.id}`,"_blank")}_handleLocateStopClick(e){const{view:t}=this;if(!t)return;const r="directions-search-tool";this.removeHandles(r),this._searchTool=new O({stop:e,view:t}),this.addHandles([this._searchTool.on("click",async s=>{if(s.mapPoint&&this._stopsToSearches.has(e)){const l=this._stopsToSearches.get(e),u=await l.search(s.mapPoint),c=u?.results?.[0].results?.[0];if(c){const{feature:m,name:f}=c;l.searchTerm=f,e.geometry=m.geometry}}this.removeHandles(r)}),re(()=>{this._searchTool&&(this.view?.tools.remove(this._searchTool),this._searchTool=null)})],r),t.addAndActivateTool(this._searchTool)}_handleOptimizeStopOrderToggle({target:{expanded:e}}){this.viewModel.routeParameters.findBestSequence=e,this._solveRouteDebounced()}_handlePanToStopClick(e){this.viewModel.centerAt(e)}_handlePreserveFirstStopChange({target:{checked:e}}){this.viewModel.routeParameters.preserveFirstStop=e,this._solveRouteDebounced()}_handlePreserveLastStopChange({target:{checked:e}}){this.viewModel.routeParameters.preserveLastStop=e,this._solveRouteDebounced()}_handlePrintPreviewDialogAfterCreate(e){document.body.appendChild(e),e.showModal(),this._printPreviewDialog=e,this.removeHandles(q),this.addHandles([je(e,"close",this._handlePrintPreviewDialogClosed.bind(this)),re(()=>{this._printPreviewDialog&&(document.body.removeChild(this._printPreviewDialog),this._printPreviewDialog=null,this._printPreviewDialogOpen=!1)})],q)}_handlePrintPreviewDialogClick(){this._printPreviewDialogOpen=!0}_handlePrintPreviewDialogCloseClick(){this._printPreviewDialog?.close()}_handlePrintPreviewDialogClosed(){this.removeHandles(q)}_handlePrintPreviewDialogPrintClick(){document.body.classList.add(n.printPreviewMedia),window.print(),document.body.classList.remove(n.printPreviewMedia),this._printPreviewDialog?.close()}_handleResolveRouteClick(){this._solveRouteDebounced()}_handleReverseStopOrderClick(){this._getEffectiveStops().reverse(),this._solveRouteDebounced()}_handleSaveErrorCloseClick(){this._currentFlowItem=this._parentFlowItem}_handleSaveFlowItemBackClick(e){e.stopPropagation(),this._currentFlowItem=this._parentFlowItem}async _handleSaveLayerAs(){const e=qe.getDefault();try{await e.signIn()}catch(t){return N(t)||t.name==="identity-manager:user-aborted"?void 0:(this._parentFlowItem=this._currentFlowItem,this._currentFlowItem="save",void(this._saveState="connect-to-portal-error"))}this._saveState="fetch-portal-information",this._parentFlowItem=this._currentFlowItem,this._currentFlowItem="save",this._portalUserName=e.user?.username;try{this._portalFolders=await e.user?.fetchFolders()}catch{return void(this._saveState="fetch-portal-information-error")}this._saveState="save-layer"}_handleSaveLayerClick(){this.viewModel.layer?.save()}_handleSaveLayerButtonClick(){this._saveState="saving";const{layer:e}=this;if(!e||!this._portalFolders)return;const t=this._portalItemNameInput?.value,r=this._portalFolderCombobox?.value,s=this._portalFolders.find(({id:l})=>l===r);e.saveAs({title:t},{folder:s}).then(()=>{e.title=t,this._currentFlowItem=this._parentFlowItem}).catch(()=>{this._saveState="saving-error"})}_handleSaveLayerCancelClick(){this._currentFlowItem=this._parentFlowItem}_handleSaveLayerFolderCreate(e){this._portalFolderCombobox=e}_handleSaveLayerNameCreate(e){this._portalItemNameInput=e}_handleSignInClick(){this.viewModel.load().catch(()=>{})}_handleStopListReorder({detail:{dragEl:e,newIndex:t}}){this._getEffectiveStops().reorder(e.value,t),this._solveRouteDebounced()}_handleTravelModeChange({currentTarget:{selectedItems:e}}){e.length&&(this.viewModel.selectedTravelMode=e[0].value,this._solveRouteDebounced())}_handleViewDrivingDirectionsClick(){this._currentFlowItem="directions"}_normalizeSearchSources(e){this._overrideDefaultSources(e),this._applyLocatorSourceOverrides(e)}_overrideDefaultSources(e){for(const t of e.viewModel.defaultSources)t.autoNavigate=!1}_renderClearRouteAction(e){return i("calcite-action",{bind:this,icon:"trash",key:"clear-route",onclick:this._handleClearRouteClick,...e,text:this.messages.common.clear,textEnabled:!0})}_renderDeleteStopAction(e){return i("calcite-action",{icon:"trash",onclick:this._handleDeleteStopClick.bind(this,e),scale:"s",slot:"actions-end",text:this.messages.deleteStop,title:this.messages.deleteStop})}_renderDepartureTime(){const{DEPART_AT:e,NOW:t,UNSPECIFIED:r}=D;return i("calcite-label",{class:n.departureTime,key:"departure-time"},this.messages.departureTime,i("calcite-combobox",{bind:this,clearDisabled:!0,label:this.messages.departureTime,overlayPositioning:"fixed",selectionMode:"single-persist",onCalciteComboboxChange:this._handleDepartureTimeOptionChange},i("calcite-combobox-item",{heading:this.messages.leaveNow,key:t,label:this.messages.leaveNow,selected:this.viewModel.departureOption===t,value:t}),i("calcite-combobox-item",{heading:this.messages.departAt,key:e,label:this.messages.departAt,selected:this.viewModel.departureOption===e,value:e}),i("calcite-combobox-item",{heading:this.messages.timeUnspecified,key:r,label:this.messages.timeUnspecified,selected:this.viewModel.departureOption===r,value:r})))}_renderDepartureTimeOptions(){return this.viewModel.departureOption!==D.DEPART_AT?null:i("div",{class:n.departureTimeOptions},i("calcite-input-date-picker",{bind:this,scale:"s",value:this.viewModel.departureIsoDate,onCalciteInputDatePickerChange:this._handleDepartureDateChange}),i("calcite-input-time-picker",{bind:this,scale:"s",value:this.viewModel.departureIsoTime,onCalciteInputTimePickerClose:this._handleDepartureTimeChange}))}_renderDirectionsFlowItem(){if(this._currentFlowItem!=="directions")return null;const e=this._getRouteCostSummary();if(!this._sections||!e)return null;const{distance:t,duration:r}=e,{formattedEta:s}=this.viewModel,l=this._sections.at(0)?.stop.name??"",u=this._sections.at(-1)?.stop.name??"";return i("calcite-flow-item",{bind:this,key:"directions-flow-item",overlayPositioning:"fixed",selected:this._currentFlowItem==="directions",onCalciteFlowItemBack:this._handleDirectionsFlowItemBackClick},i("div",{class:n.directionsHeader,slot:"header-content"},i("div",{class:n.headerStops},i("span",null,this.messages.from)," ",i("span",{class:n.directionsHeaderStopName},l),i("span",null,this.messages.to)," ",i("span",{class:n.directionsHeaderStopName},u)),i("div",{class:n.flexColumn},i("span",null,`${r} (${t})`),s?i("span",null,s):null)),this._renderRouteLayerActions({slot:"header-menu-actions"}),i("calcite-accordion",{class:n.accordion,iconPosition:"start",selectionMode:"single"},this._sections.map((c,m)=>this._renderDirectionSection(c,m))))}_renderDirectionSection(e,t){const{stop:r,directions:s}=e,{name:l}=r,u=t===0,c=this._getStopCostDescription(e);return i("calcite-accordion-item",{description:c,expanded:u,heading:l??"",key:`stop-${t}`},i("calcite-action",{icon:"zoom-to-object",onclick:this._handlePanToStopClick.bind(this,r),slot:"actions-end",text:this.messages.panToStop,title:this.messages.panToStop}),this._renderDirectionTurns(s))}_renderDirectionTurns(e){return i("calcite-list",{label:this.messages.drivingDirections,selectionMode:"none"},e.map((t,r)=>{const{directionPoint:s,lines:l}=t,u=l[0],{distance:c,duration:m}=u,f=B(this.messagesUnits,c??0,this.unit),w=V(m??0),_=f&&w?`${f} | ${w}`:`${f||w}`,S=he(s),x=ce(s.directionPointType);return i("calcite-list-item",{class:n.labelNoBottomMargin,key:`driving-direction-${r}`,onpointerenter:this._handleDirectionTurnPointerEnter.bind(this,u),onpointerleave:this._handleDirectionTurnPointerLeave.bind(this),onCalciteListItemSelect:this._handleDirectionTurnItemSelect.bind(this,u)},i("calcite-icon",{icon:x,slot:"content-start"}),i("div",{slot:"content"},i("calcite-label",{layout:"inline",scale:"s"},S),i("calcite-label",{layout:"inline",scale:"s"},_)))}))}_renderEditFlowItem(){return this._currentFlowItem!=="edit"?null:i("calcite-flow-item",{bind:this,heading:this.messages.editRoute,headingLevel:this.headingLevel,key:"edit-flow-item",loading:this.viewModel.state==="routing",selected:this._currentFlowItem==="edit",onCalciteFlowItemBack:this._handleEditFlowItemBackClick},i("div",{class:n.flexColumn,key:"edit-container"},i("div",{class:n.editToolbarContainer},i("calcite-label",{layout:"inline",scale:"s"},this.messages.automaticallySolve,i("calcite-switch",{bind:this,checked:this.viewModel.autoSolve,scale:"s",onCalciteSwitchChange:this._handleAutoSolveChange})),i("div",{class:n.editToolbar},i("calcite-action",{bind:this,disabled:!this.viewModel.layer||this.viewModel.layer.stops.length>=this.maxStops,icon:"flag",onclick:this._handleCreateStopClick,scale:"s",text:this.messages.networkFeatures.stops.stop,textEnabled:!0}),i("calcite-action",{bind:this,icon:"line",onclick:this._handleCreatePolylineBarrierClick,scale:"s",text:this.messages.barrier,textEnabled:!0}),i("calcite-action",{bind:this,class:n.solveRoute,disabled:this.viewModel.autoSolve,icon:"refresh",onclick:this._handleResolveRouteClick,scale:"s",text:this.messages.solve,textEnabled:!0}))),i("div",{class:n.selectedFeatureContainer},i("calcite-list",{label:this.messages.selectedNetworkFeatures,scale:"s",selectionMode:"none"},this.viewModel.selectedNetworkFeatures?.toArray().map((e,t)=>i("calcite-list-item",{description:this._getNetworkFeatureName(e),key:`network-feature-${t}`,label:e.name??e.objectId?.toString()??this.messages.unnamed},i("calcite-action",{icon:"trash",onclick:this._handleDeleteNetworkFeatureClick.bind(this,e),scale:"s",slot:"actions-end",text:this.messages.common.delete}))))),i("div",{class:n.editFooter},this._renderEditFooterContent())))}_renderEditFooterContent(){return this.viewModel.lastError?this._renderErrorNotice():i("calcite-button",{appearance:"outline-fill",bind:this,onclick:this._handleEditingDoneClick,width:"full"},this.messages.common.done)}_renderErrorNotice(){return i("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0},i("calcite-label",{class:n.labelNoBottomMargin,slot:"message"},this._getErrorDescription()))}_renderFooter(){if(!this.viewModel.layer)return i("div",{class:n.primaryFooter,key:"footer-missing-layer"},i("calcite-notice",{icon:"information",open:!0},i("calcite-label",{class:n.labelNoBottomMargin,slot:"message"},this.messages.missingLayer)));if(this.viewModel.state==="unauthenticated")return i("div",{class:n.primaryFooterCentered,key:"footer-sign-in"},i("calcite-label",null,this.messages.signInRequired),i("calcite-button",{bind:this,onclick:this._handleSignInClick},this.messages.common.auth.signIn));if(this.viewModel.state==="routing")return i("div",{class:this.classes(n.primaryFooter,n.primaryFooterLoader),key:"footer-routing"},i("calcite-loader",{label:this.messages.solve,scale:"s"}));if(this.viewModel.state==="error")return i("div",{class:n.primaryFooter,key:"footer-service-error"},this._renderErrorNotice());if(!this.viewModel.layer?.routeInfo)return i("div",{class:n.primaryFooter,key:"footer-unsolved-route"},i("calcite-notice",{icon:"information",open:!0},i("calcite-label",{class:n.labelNoBottomMargin,slot:"message"},this.messages.directionsPlaceholder)));const e=this._getRouteCostSummary();if(!e||!this.viewModel.layer?.directionPoints)return i("div",{class:n.primaryFooter,key:"footer-invalid-route"},i("calcite-notice",{icon:"exclamation-mark-triangle",kind:"danger",open:!0},i("calcite-label",{class:n.labelNoBottomMargin,slot:"message"},this.messages.invalidRoute)));const{distance:t,duration:r}=e,{formattedEta:s}=this.viewModel;return i("div",{class:n.routeItem,key:"footer-directions-summary"},i("button",{"aria-busy":"false","aria-label":this.messages.viewDrivingDirections,"aria-live":"polite",bind:this,class:n.routeItemButton,onclick:this._handleViewDrivingDirectionsClick,title:this.messages.viewDrivingDirections,type:"button"},i("div",{class:n.routeItemButtonContent},i("span",{class:n.routeItemLabel},`${r} (${t})`),i("span",{class:n.routeItemDescription},s)),i("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s"})),i("calcite-action-menu",{label:"test"},i("calcite-action",{icon:"ellipsis",key:"route-actions",slot:"trigger",text:"Route actions"}),this._renderRouteLayerActions()))}_renderInteractiveRouteActions(){return i("div",{class:n.actionContainer,key:n.actionContainer},i("calcite-button",{appearance:"outline",bind:this,class:n.addStopButton,disabled:this._getEffectiveStops().length>=this.maxStops,iconStart:"plus",kind:"neutral",label:this.messages.addStop,onclick:this._handleAddStopClick,title:this.messages.addStop,width:"half"},this.messages.addStop),this.visibleElements.editRouteButton?i("calcite-button",{appearance:"outline",bind:this,class:n.editRouteButton,disabled:this.viewModel.view?.type!=="2d",iconStart:"pencil",kind:"neutral",label:this.messages.editRoute,onclick:this._handleEditRouteClick,title:this.messages.editRoute,width:"half"},this.messages.editRoute):null)}_renderLocateStopAction(e){if(e.name!=null||e.geometry!=null)return null;const t=this._getEffectiveStops().indexOf(e),r=!!this.view?.activeTool&&this.view.activeTool===this._searchTool&&this._searchTool.stop===e;return i("calcite-action",{active:r,icon:"crosshair",key:`stop-location-action-${t}`,onclick:this._handleLocateStopClick.bind(this,e),scale:"s",slot:"actions-end",text:this.messages.pickALocationOnTheMap,title:this.messages.pickALocationOnTheMap})}_renderOptimizeStopOrder(){const{routeParameters:e}=this.viewModel,{findBestSequence:t,preserveFirstStop:r,preserveLastStop:s}=e;return i("calcite-block-section",{bind:this,class:n.optimizeSection,text:this.messages.optimizeOrder,toggleDisplay:"switch",onCalciteBlockSectionToggle:this._handleOptimizeStopOrderToggle},t?[i("calcite-label",{class:n.optimizeSwitches,key:"preserve-first-stop",layout:"inline-space-between"},this.messages.preserveFirstStop,i("calcite-switch",{bind:this,checked:r,scale:"s",onCalciteSwitchChange:this._handlePreserveFirstStopChange})),i("calcite-label",{class:n.optimizeSwitches,key:"preserve-last-stop",layout:"inline-space-between"},this.messages.preserveLastStop,i("calcite-switch",{bind:this,checked:s,scale:"s",onCalciteSwitchChange:this._handlePreserveLastStopChange}))]:null)}_renderPrimaryFlowItem(){return i("calcite-flow-item",{key:"primary-flow-item",loading:this.viewModel.state==="initializing",selected:this._currentFlowItem==="primary"},i("calcite-panel",{class:n.primaryFlowItem,disabled:!this.viewModel.layer||this.viewModel.state==="unauthenticated"||this.viewModel.state==="error"&&!this.viewModel.serviceDescription},this._renderStops(),this._renderInteractiveRouteActions(),this._renderSeparator(),this._renderRouteSolveOptions()),this._renderFooter())}_renderPrintDocument(){if(!this._printPreviewDialogOpen)return null;const e=this._getRouteCostSummary();if(!this._sections||!e)return null;const{distance:t,duration:r}=e,{formattedEta:s}=this.viewModel,l=this._sections.at(0)?.stop.name??"",u=this._sections.at(-1)?.stop.name??"";return i("dialog",{afterCreate:this._handlePrintPreviewDialogAfterCreate,bind:this,class:n.printPreviewDialog},i("div",{class:n.printPreviewContent},i("div",{class:n.printPreviewHeader},i("div",{class:n.printPreviewHeaderLabel},i("div",{class:n.headerStops},i("span",null,this.messages.from)," ",i("span",{class:n.directionsHeaderStopName},l),i("span",null,this.messages.to)," ",i("span",{class:n.directionsHeaderStopName},u))),i("div",{class:this.classes(n.printPreviewHeaderButtons,n.printPreviewHideOnPrint)},i("calcite-button",{autofocus:!0,bind:this,class:n.printPreviewDialogPrint,iconStart:"print",onclick:this._handlePrintPreviewDialogPrintClick},this.messages.common.print),i("calcite-button",{appearance:"outline",bind:this,class:n.printPreviewDialogClose,iconStart:"x-circle",onclick:this._handlePrintPreviewDialogCloseClick},this.messages.common.close))),i("div",{class:n.directionsHeader},i("span",null,`${r} (${t})`),s?i("span",null,s):null),this._sections.map((c,m)=>this._renderPrintSection(c,m))))}_renderPrintManeuver(e,t){const{directionPoint:r,lines:s}=e,{distance:l,duration:u}=s.at(0)??{},c=B(this.messagesUnits,l??0,this.unit),m=V(u??0),f=c&&m?`${c} | ${m}`:`${c||m}`,w=he(r),_=ce(r.directionPointType);return i("div",{class:this.classes(n.flexRow,n.printPreviewAvoidPageBreak),key:`direction-${t}`},i("calcite-icon",{icon:_}),i("div",{class:n.flexColumn},i("span",null,w),i("span",null,f)))}_renderPrintRouteAction(e){if(!this.visibleElements.printButton)return null;const t=!this.viewModel.layer?.routeInfo;return i("calcite-action",{bind:this,disabled:t,icon:"print",key:"print-route",onclick:this._handlePrintPreviewDialogClick,...e,text:this.messages.common.print,textEnabled:!0})}_renderPrintSection({stop:e,directions:t},r){return i("div",{class:n.printPreviewSection,key:`section-${r}`},i("span",{class:n.directionsHeaderStopName},e.name??""),t.map((s,l)=>this._renderPrintManeuver(s,l)))}_renderRouteLayerActions(e){return[this._renderClearRouteAction(e),this._renderSaveLayerAction(e),this._renderSaveLayerAsAction(e),this._renderPrintRouteAction(e),this._renderViewItemDetailsAction(e)]}_renderRouteSolveOptions(){return i("div",{class:n.marginInlineMedium,key:"route-solve-options"},this._renderTravelModes(),this._renderDepartureTime(),this._renderDepartureTimeOptions(),this._renderOptimizeStopOrder())}_renderSaveContent(){switch(this._saveState){case"initialized":return this._renderSaveInitialized();case"connect-to-portal":return this._renderSaveProcessing(this.messages.identity.lblSigning);case"connect-to-portal-error":return this._renderSaveError(this.messages.errors.authenticating);case"fetch-portal-information":return this._renderSaveProcessing(this.messages.processing.fetching);case"fetch-portal-information-error":return this._renderSaveError(this.messages.errors.fetching);case"save-layer":return this._renderSaveLayerSettings();case"saving":return this._renderSaveProcessing(this.messages.processing.saving);case"saving-error":return this._renderSaveError(this.messages.errors.saving)}}_renderSaveError(e){return i("calcite-panel",{class:n.paddingMedium,key:"save-layer-error"},i("div",{class:n.saveError},i("calcite-icon",{class:n.saveErrorIcon,icon:"exclamation-mark-triangle",scale:"l",textLabel:this.messages.common.errorMessage}),i("calcite-label",{class:n.saveErrorLabel},e)),i("calcite-button",{appearance:"outline",bind:this,onclick:this._handleSaveErrorCloseClick,slot:"footer-actions",width:"full"},this.messages.common.close))}_renderSaveInitialized(){return i("calcite-panel",{class:n.paddingMedium,key:"save-layer-initialized"})}_renderSaveFlowItem(){return this._currentFlowItem!=="save"?null:i("calcite-flow-item",{bind:this,heading:this.messages.saveLayer,headingLevel:this.headingLevel,key:"save-layer-flow-item",selected:this._currentFlowItem==="save",onCalciteFlowItemBack:this._handleSaveFlowItemBackClick},this._renderSaveContent())}_renderSaveLayerAction(e){if(!this.visibleElements.saveButton)return null;const t=this.viewModel.layer,r=t?.routeInfo,s=t?.portalItem?.itemControl;return i("calcite-action",{bind:this,disabled:!(r&&(s==="admin"||s==="update")),icon:"save",key:"save-route",onclick:this._handleSaveLayerClick,...e,text:this.messages.common.save,textEnabled:!0})}_renderSaveLayerAsAction(e){if(!this.visibleElements.saveAsButton)return null;const t=!this.viewModel.layer?.routeInfo;return i("calcite-action",{disabled:t,icon:"save-as",key:"save-as-route",onclick:()=>{this._handleSaveLayerAs()},...e,text:this.messages.common.saveAs,textEnabled:!0})}_renderSaveLayerSettings(){if(this.layer==null||this._portalFolders==null||this._portalUserName==null)return this._renderSaveInitialized();const{stops:e}=this.layer,t=`${e.at(0).name} - ${e.at(-1).name}`,r=[i("calcite-combobox-item",{heading:`${this._portalUserName} (${this.messages.common.home})`,key:n.folderHome,selected:!0,value:n.folderHome}),...this._portalFolders.map(s=>i("calcite-combobox-item",{heading:s.title??"",key:`${n.folder}-${s.id}`,value:s.id}))];return i("calcite-panel",{key:"save-layer-panel"},i("div",{class:n.paddingMedium},i("calcite-label",null,this.messages.layerName,i("calcite-input",{afterCreate:this._handleSaveLayerNameCreate,bind:this,label:this.messages.layerName,value:t})),i("calcite-label",null,this.messages.saveInFolder,i("calcite-combobox",{afterCreate:this._handleSaveLayerFolderCreate,bind:this,clearDisabled:!0,label:this.messages.saveInFolder,overlayPositioning:"fixed",selectionMode:"single-persist"},r))),i("calcite-button",{bind:this,onclick:this._handleSaveLayerButtonClick,slot:"footer-actions",width:"full"},this.messages.common.save),i("calcite-button",{appearance:"outline",bind:this,onclick:this._handleSaveLayerCancelClick,slot:"footer-actions",width:"full"},this.messages.common.cancel))}_renderSaveProcessing(e){return i("calcite-panel",{class:n.marginInlineMedium,key:"save-layer-processing"},i("calcite-loader",{class:n.saveProcessLoader,label:e,text:e}))}_renderSeparator(){return i("div",{class:n.separator})}_renderStop(e){const t=this.acquireSearch(e);e.name!=null&&(t.searchTerm=e.name);const r=this._getEffectiveStops(),s=this._renderLocateStopAction(e),l=r.length>2&&this._renderDeleteStopAction(e);return i("calcite-list-item",{key:e,value:e},s,l,i("div",{class:n.stopItem,slot:"content"},t.render()))}_renderStops(){const e=this._getEffectiveStops();for(const t of this._stopsToSearches.keys())e.includes(t)||this._disposeSearch(t);return i("div",{class:n.stopContainer,key:n.stopContainer},i("calcite-list",{bind:this,class:n.stopList,dragEnabled:!0,label:this.messages.widgetLabel,scale:"s",onCalciteListOrderChange:this._handleStopListReorder},e.toArray().map(t=>this._renderStop(t))),e.length===2&&i("calcite-action",{bind:this,icon:"arrow-up-down",onclick:this._handleReverseStopOrderClick,scale:"s",text:this.messages.reverseStops,title:this.messages.reverseStops}))}_renderTravelMode(e){const{id:t,name:r}=e;return i("calcite-combobox-item",{heading:r,key:t,label:r,selected:this.viewModel.selectedTravelMode?.id===t,value:e})}_renderTravelModes(){return this.viewModel.travelModes.length?i("calcite-label",{key:"travel-modes"},this.messages.mode,i("calcite-combobox",{bind:this,clearDisabled:!0,label:this.messages.mode,overlayPositioning:"fixed",selectionMode:"single-persist",onCalciteComboboxChange:this._handleTravelModeChange},this.viewModel.travelModes.map(e=>this._renderTravelMode(e)))):null}_renderViewItemDetailsAction(e){return this.visibleElements.layerDetails?i("calcite-action",{bind:this,disabled:!this.viewModel.layer?.portalItem,icon:"launch",key:"open-route-details-link",onclick:this._handleItemDetailsClick,...e,text:this.messages.viewLayerDetails,textEnabled:!0}):null}async _solveRoute(){if(this.viewModel.updateDepartureTime(),!((this.viewModel.layer?.stops.filter(({geometry:e})=>!!e).length??0)<2))try{await this.viewModel.getDirections()}catch{}}};o([a()],v.prototype,"_printPreviewDialogOpen",void 0),o([a()],v.prototype,"_currentFlowItem",void 0),o([a()],v.prototype,"_saveState",void 0),o([a()],v.prototype,"_searchTool",void 0),o([a()],v.prototype,"apiKey",null),o([a(st)],v.prototype,"defaultUnit",void 0),o([a()],v.prototype,"goToOverride",null),o([a()],v.prototype,"headingLevel",void 0),o([a()],v.prototype,"icon",null),o([a()],v.prototype,"label",null),o([a({readOnly:!0})],v.prototype,"lastRoute",null),o([a()],v.prototype,"layer",null),o([a()],v.prototype,"maxStops",null),o([a(),z("esri/widgets/Directions/t9n/Directions")],v.prototype,"messages",void 0),o([a(),z("esri/core/t9n/Units")],v.prototype,"messagesUnits",void 0),o([a()],v.prototype,"searchProperties",void 0),o([a()],v.prototype,"unit",null),o([a()],v.prototype,"view",null),o([a({type:ye})],v.prototype,"viewModel",void 0),o([a({type:Se,nonNullable:!0})],v.prototype,"visibleElements",void 0),v=o([$("esri.widgets.Directions")],v);const ht=v;const pt=tt`.esri-widget__heading{color:var(--calcite-color-text-2);margin:0 0 .5rem;font-weight:var(--calcite-font-weight-semibold)}h1.esri-widget__heading{font-size:var(--calcite-font-size-xl)}h2.esri-widget__heading{font-size:var(--calcite-font-size-md)}h3.esri-widget__heading,h4.esri-widget__heading,h5.esri-widget__heading,h6.esri-widget__heading{font-size:var(--calcite-font-size)}.esri-widget{--esri-widget-padding-x: 15px;--esri-widget-padding-y: var(--calcite-spacing-md);--esri-widget-padding: var(--esri-widget-padding-y) var(--esri-widget-padding-x);box-sizing:border-box;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);font-size:var(--calcite-font-size);line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget *,.esri-widget :before,.esri-widget :after{box-sizing:inherit}.esri-widget.esri-widget--disabled>*{opacity:.4;pointer-events:none}.esri-widget.esri-widget--compact{--esri-widget-padding-y: 0;--esri-widget-padding-x: 0}.esri-widget__anchor{color:var(--calcite-color-text-2)}.esri-widget__anchor:hover{color:var(--calcite-color-text-3)}.esri-widget__anchor:hover,.esri-widget__anchor:focus{text-decoration:underline}.esri-widget__anchor--disabled{opacity:.4;pointer-events:none}.esri-widget__header{background-color:var(--calcite-color-foreground-1);flex:1 0 100%;justify-content:space-between;align-items:center;width:100%;min-height:48px;padding:12px 0 12px 15px;display:flex}.esri-widget__header .esri-widget__heading{width:calc(100% - 48px);text-align:initial;color:var(--calcite-color-text-1);align-items:center;margin:0;padding:0;display:flex}.esri-widget__header-button{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);border:none;flex:0 0 48px;justify-content:center;align-self:stretch;align-items:center;width:48px;padding:0;display:flex}.esri-widget__footer{background-color:var(--calcite-color-foreground-1);justify-content:center;align-items:center;width:100%;min-height:48px;display:flex}.esri-widget__footer-pagination{color:var(--calcite-color-text-2);justify-content:space-between;align-items:center;display:flex}.esri-widget__footer-pagination-previous-button,.esri-widget__footer-pagination-next-button{cursor:pointer;background-color:var(--calcite-color-foreground-1);border:0;margin:0 7px;padding:12px 15px;transition:background-color .125s ease-in-out}.esri-widget__footer-pagination-previous-button:hover,.esri-widget__footer-pagination-previous-button:focus,.esri-widget__footer-pagination-next-button:hover,.esri-widget__footer-pagination-next-button:focus{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1)}.esri-menu{visibility:hidden;z-index:1;background-clip:padding;background-color:var(--calcite-color-foreground-1);background-clip:padding-box;width:100%;max-height:0;margin:2px 0 0;padding:0;font-size:var(--calcite-font-size);line-height:var(--calcite-spacing-xl);position:absolute;top:100%;left:0;overflow:hidden;box-shadow:0 1px 2px #0000004d}.esri-menu .esri-menu__header{color:var(--calcite-color-text-inverse);background-color:var(--calcite-color-inverse);padding:6px 12px}.esri-menu__list{margin:0;padding:0;list-style:none}.esri-menu__list-item{cursor:pointer;border-top:1px solid #adadad4d;border-left:3px solid #0000;padding:.8em 1em}.esri-menu__list-item [class^=esri-icon-],.esri-menu__list-item [class*=" esri-icon-"]{padding-right:2.8px}.esri-menu__list-item:first-child{border-top:none}.esri-menu__list-item--focus,.esri-menu__list-item:hover,.esri-menu__list-item:focus{background-color:var(--calcite-color-foreground-1)}.esri-menu__list-item:active{background-color:var(--calcite-color-foreground-current)}.esri-menu__list-item--active,.esri-menu__list-item--active:hover,.esri-menu__list-item--active:focus{background-color:var(--calcite-color-foreground-1);border-left-color:var(--calcite-color-brand)}.esri-widget__table{border-collapse:collapse;color:var(--calcite-color-text-1);border:none;width:100%;line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget__table tr:nth-child(odd){background-color:var(--calcite-color-transparent)}.esri-widget__table tr:nth-child(2n){background-color:var(--calcite-color-transparent-press)}.esri-widget__table tr a{color:var(--calcite-color-text-2)}.esri-widget__table tr a:hover,.esri-widget__table tr a:focus{color:var(--calcite-color-text-1)}.esri-widget__table tr td,.esri-widget__table tr th{vertical-align:top;word-break:break-word;padding:.5em .7em;font-size:var(--calcite-font-size-sm);font-weight:var(--calcite-font-weight-regular)}.esri-widget__table tr th{text-align:left;border-right:3px solid #0000000d;width:50%}.esri-widget__table tr td{width:50%}.esri-input{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1);border:1px solid #959595;font-size:var(--calcite-font-size)}.esri-input::-ms-clear{display:none}.esri-input::placeholder{opacity:1;color:var(--calcite-color-text-2)}.esri-input:placeholder-shown{text-overflow:ellipsis}.esri-input[type=text],.esri-input[type=password],.esri-input[type=number]{height:32px;padding:0 .5em}calcite-combobox.esri-input{border:none}.esri-widget__content--empty{text-align:center;color:var(--calcite-color-border-input);flex-flow:column wrap;align-items:center;padding:18px 22px;display:flex}.esri-widget__content--empty h1.esri-widget__heading,.esri-widget__content--empty h2.esri-widget__heading,.esri-widget__content--empty h3.esri-widget__heading,.esri-widget__content--empty h4.esri-widget__heading,.esri-widget__content--empty h5.esri-widget__heading{font-weight:var(--calcite-font-weight-regular)}.esri-widget__content-illustration--empty{width:128px;padding:1rem 0}.esri-widget__content-icon--empty{width:32px;padding:.5rem 0}.esri-select{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background:var(--calcite-color-foreground-1) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='-8 -8 32 32' width='32' height='32'%3E%3Cpath d='M8 11.207l-4-4V5.793l4 4 4-4v1.414z' fill='%23adadad' fillrule='nonzero'/%3E%3C/svg%3E") 100% no-repeat;border:1px solid #959595;border-radius:0;width:100%;height:32px;margin:0;padding:0 .5em;font-family:inherit;font-size:.85em;display:block}.esri-select[disabled]{cursor:auto}.esri-select::-ms-expand{display:none}.esri-disabled a,.esri-disabled [role=menu],.esri-disabled [role=checkbox],.esri-disabled [class^=esri-icon-],.esri-disabled [class*=" esri-icon-"]{color:var(--calcite-color-text-3)}.keynav-mode .esri-widget:focus,.keynav-mode .esri-widget :focus{z-index:1;outline-offset:2px;outline:2px solid #adadad}.esri-widget__loader-animation{border:.15em solid #adadad4d;border-top-color:var(--calcite-color-border-input);border-radius:100%;width:1em;height:1em;font-size:var(--calcite-font-size-md);animation:1.25s linear infinite esri-rotate;display:block;transform:translateZ(0)}:dir(rtl) .esri-widget__table th{text-align:right;border-left:3px solid #0000000d;border-right:none}:dir(rtl) .esri-select{background-position:0}:dir(rtl) .esri-menu__list-item{border-left:none;border-right:3px solid #0000}:dir(rtl) .esri-menu__list-item [class^=esri-icon-],:dir(rtl) .esri-menu__list-item [class*=" esri-icon-"]{padding-left:2px;padding-right:0}:dir(rtl) .esri-menu__list-item--active{border-right-color:var(--calcite-color-brand)}.esri-icon-font-fallback-text{clip:rect(0 0 0 0);width:1px;height:1px;position:absolute;overflow:hidden}.esri-rotating{animation:1.25s linear infinite esri-rotate;transform:translateZ(0)}.esri-clearfix:before,.esri-clearfix:after{content:" ";display:table}.esri-clearfix:after{clear:both}.esri-interactive{cursor:pointer}.esri-hidden{display:none!important}.esri-invisible{visibility:hidden!important}.esri-offscreen{position:absolute;top:-999em;left:-999em}.esri-match-height{flex-direction:column;flex:auto;display:flex;overflow:hidden}.esri-widget--panel{min-width:300px;min-height:32px;padding:var(--esri-widget-padding);transition:max-height .25s ease-in-out;overflow-y:auto}.esri-search{flex-flow:row;justify-content:center;align-items:center;width:240px;display:flex}.esri-search__dropdown{--calcite-color-border-1: var(--calcite-color-border-input);--calcite-dropdown-width: 240px;width:31px}.esri-search__autocomplete{flex:1}.esri-search__container{flex-flow:row;flex:1 0 100%;align-items:stretch;display:flex;position:relative}.esri-search__form{flex-flow:row;flex:1 0;align-items:stretch;margin:0;padding:0;display:flex}.esri-search-result-renderer calcite-block,.esri-search-result-renderer calcite-block[expanded]{margin-block:0;border:0;margin-block-start:var(--calcite-spacing-md)}.esri-search__submit-button{position:absolute;margin:-1px;border-width:0;padding:0;width:1px;height:1px;overflow:hidden;white-space:nowrap;clip:rect(0,0,0,0)}:host{display:flex}.esri-directions calcite-flow-item{--calcite-color-background: var(--calcite-color-foreground-1)}.esri-directios calcite-flow{z-index:1;position:relative}.esri-directions__accordion{--calcite-accordion-border-color: transparent}.esri-directions__stop-container{--calcite-list-border-color: transparent;--calcite-list-background-color-hover: var(--calcite-color-foreground-1);margin-block-start:var(--calcite-spacing-sm);display:flex}.esri-directions__stop-list{flex:auto}.esri-directions__action-container{margin-top:var(--calcite-spacing-sm);margin-inline:var(--calcite-spacing-sm);display:flex}.esri-directions__add-stop-button{margin-inline-end:var(--calcite-spacing-xs)}.esri-directions__departure-time{--calcite-label-margin-bottom: 0}.esri-directions__departure-time-options{margin-bottom:var(--calcite-spacing-sm);display:flex}.esri-directions__departure-time-options calcite-input-date-picker,.esri-directions__departure-time-options calcite-input-time-picker{flex:1}.esri-directions__directions-header{line-height:var(--calcite-font-line-height-relative-snug);color:var(--calcite-color-text-3);font-size:var(--calcite-font-size--2);flex-direction:column;display:flex}.esri-directions__header-stops{gap:var(--calcite-spacing-base) var(--calcite-spacing-xxs);font-size:var(--calcite-font-size--1);grid-template-columns:auto 1fr;margin-block-end:var(--calcite-spacing-base);display:grid}.esri-directions__directions-header-stop-name{text-overflow:ellipsis;color:var(--calcite-color-text-1);font-weight:var(--calcite-font-weight-medium);overflow:hidden}.esri-directions__edit-footer{border-top:var(--calcite-border-width-sm) solid var(--calcite-color-border-3);padding:var(--calcite-spacing-md)}.esri-directions__edit-toolbar-container{margin:var(--calcite-spacing-md);flex-flow:column;align-items:flex-start;display:flex}.esri-directions__edit-toolbar{border-width:var(--calcite-border-width-sm);border-radius:var(--calcite-corner-radius-round);border-style:solid;border-color:var(--calcite-color-foreground-3);flex-flow:row;display:flex;overflow:hidden}.esri-directions__solve-route{border-inline-start:solid var(--calcite-border-width-sm) var(--calcite-color-border-3)}.esri-directions__flex-column{flex-direction:column;display:flex}.esri-directions__flex-row{flex-direction:row;display:flex}.esri-directions__label-emphasize{font-weight:var(--calcite-font-weight-medium)}.esri-directions__label-no-bottom-margin{--calcite-label-margin-bottom: 0}.esri-directions__margin-inline-medium{margin-inline:var(--calcite-spacing-md)}.esri-directions__padding-medium{padding:var(--calcite-spacing-md)}.esri-directions__route-item{margin:var(--calcite-spacing-md);border:var(--calcite-border-width-sm) solid var(--calcite-color-border-3);border-radius:var(--calcite-corner-radius-round);flex:1 0 auto;width:auto;margin-block-start:var(--calcite-spacing-sm);display:flex;overflow:hidden}.esri-directions__route-item-button{background-color:var(--calcite-color-foreground-1);padding:var(--calcite-spacing-sm) var(--calcite-spacing-md);text-align:unset;font-family:var(--calcite-font-family);border:none;flex:1 0 auto;align-items:center;margin:0;padding-inline-end:var(--calcite-spacing-xs);display:flex}.esri-directions__route-item-button:hover{background-color:var(--calcite-color-foreground-2);cursor:pointer}.esri-directions__route-item-button-content{flex-direction:column;flex:1 0 auto;display:flex}.esri-directions__route-item-label{line-height:var(--calcite-font-line-height-relative-snug);color:var(--calcite-color-text-1);font-size:var(--calcite-font-size-md);font-weight:var(--calcite-font-weight-medium)}.esri-directions__route-item-description{line-height:var(--calcite-font-line-height-relative-snug);color:var(--calcite-color-text-3);font-size:var(--calcite-font-size--2);font-weight:var(--calcite-font-weight-regular)}.esri-directions__optimize-section{--calcite-block-section-header-text-color: var(--calcite-color-text-1)}.esri-directions__optimize-switches{cursor:pointer;margin-inline-start:var(--calcite-spacing-md)}.esri-directions__panel-header-action{align-items:center;display:flex}.esri-directions__primary-flow-item{flex-flow:column;flex:auto;justify-content:flex-start;align-items:stretch;display:flex;overflow:visible}.esri-directions__primary-footer{border-top:var(--calcite-border-width-sm) solid var(--calcite-color-border-3);padding:var(--calcite-spacing-md)}.esri-directions__primary-footer-centered{border-top:var(--calcite-border-width-sm) solid var(--calcite-color-border-3);padding:var(--calcite-spacing-md);flex-flow:column wrap;align-items:center;display:flex}.esri-directions__primary-footer-loader{--calcite-loader-spacing: 0;margin-top:var(--calcite-spacing-md);margin-bottom:var(--calcite-spacing-md)}.esri-directions__save-error{flex-direction:column;align-items:center;display:flex}.esri-directions__save-error-icon{margin-top:calc(var(--calcite-spacing-lg) * 3);margin-bottom:var(--calcite-spacing-xxs);color:var(--calcite-color-status-danger)}.esri-directions__save-error-label{margin-inline:var(--calcite-spacing-sm)}.esri-directions__save-process-loader{padding-top:calc(var(--calcite-spacing-lg) * 3);padding-bottom:calc(var(--calcite-spacing-lg) * 2)}.esri-directions__selected-feature-container{margin-inline:var(--calcite-spacing-md);height:100px;overflow-y:auto}.esri-directions__separator{margin:var(--calcite-spacing-md) 0;background-color:var(--calcite-color-border-3);height:var(--calcite-border-width-sm)}.esri-directions__stop-item .esri-search{width:auto}.esri-directions__print-document{box-sizing:border-box;z-index:var(--calcite-z-index-overlay);background-color:var(--calcite-color-foreground-1);width:100%;height:100%;position:fixed;top:0;left:0;overflow-y:scroll}.esri-directions__print-body{padding-inline:var(--calcite-spacing-md);flex-direction:column;display:flex}.esri-directions__print-header{margin-bottom:var(--calcite-spacing-lg);border-block-end:var(--calcite-border-width-sm) solid var(--calcite-color-border-3);align-items:center;display:flex}.esri-directions__print-header-label{padding-block:var(--calcite-spacing-sm);line-height:var(--calcite-font-line-height-relative-snug);color:var(--calcite-color-text-3);font-size:var(--calcite-font-size--2);font-weight:var(--calcite-font-weight-bold);flex-direction:column;flex-grow:1;display:flex}.esri-directions__print-section{margin-top:var(--calcite-spacing-md);flex-direction:column;display:flex}.esri-directions__print-header-buttons{padding-inline-end:var(--calcite-spacing-md);display:flex}.esri-directions__print--avoid-page-break{break-inside:avoid}@media print{body.esri-directions__print-media{margin:0;padding:0}body.esri-directions__print-media>:not(div.esri-directions__print-document){display:none}}@media print{.esri-directions__print-document{height:auto;position:static;overflow:visible}.esri-directions__print--hide-on-print{display:none}}`,mt=et(ht),H="map-components:arcgis-directions",K=class K extends Ze{constructor(){super(...arguments),this.widget=mt(this),this.viewModel=this.widget.viewModel,this.view=this.widget.view,this.apiKey=this.widget.apiKey,this.autoDestroyDisabled=!1,this.goToOverride=this.widget.goToOverride,this.headingLevel=this.widget.headingLevel,this.hideLayerDetails=this.widget.visibleElements.layerDetails,this.hideSaveAsButton=this.widget.visibleElements.saveAsButton,this.hideSaveButton=this.widget.visibleElements.saveButton,this.icon=this.widget.icon,this.label=this.widget.label,this.lastRoute=this.widget.lastRoute,this.layer=this.widget.layer,this.maxStops=this.widget.maxStops,this.searchProperties=this.widget.searchProperties,this.state=this.viewModel.state,this.unit=this.widget.unit,this.useDefaultRouteLayer=!1,this.arcgisPropertyChange=Qe()("lastRoute","state"),this.arcgisReady=Xe()}async destroy(){await this.manager.destroy()}async getDirections(){if(this.widget?.viewModel?.state!=="ready")throw new Error(`${H} - component not ready to get directions`);return await this.widget?.getDirections()}async save(){if(this.widget?.viewModel?.state!=="ready")throw new Error(`${H} - component not ready to save directions`);return await this.widget?.save()}async saveAs(t,r){if(this.widget?.viewModel?.state!=="ready")throw new Error(`${H} - component not ready to save directions as a Portal Item`);return await this.widget?.saveAs(t,r)}async zoomToRoute(){if(this.widget?.viewModel?.state!=="ready")throw new Error(`${H} - component not ready to zoom to route`);this.widget?.zoomToRoute()}willUpdate(t){if(t.has("routeLayerItemId")){const r=this.routeLayerItemId;if(Ye(r)&&!this.useDefaultRouteLayer){const{layer:s}=this;s&&this.widget.view?.map?.remove(s),this._setDefaultLayer()}else r&&this.widget&&(this.layer=new se({portalItem:{id:r}}),this.widget.view?.map?.add(this.layer))}t.has("useDefaultRouteLayer")&&this._setDefaultLayer()}_setDefaultLayer(){this.useDefaultRouteLayer&&!this.routeLayerItemId&&(this.layer=new se,b(()=>this.widget.view,()=>this.widget.view?.map?.add(this.layer),{once:!0}))}};K.properties={view:0,apiKey:1,autoDestroyDisabled:5,goToOverride:0,headingLevel:9,hideLayerDetails:5,hideSaveAsButton:5,hideSaveButton:5,icon:1,label:1,lastRoute:0,layer:0,maxStops:9,position:1,referenceElement:1,routeLayerItemId:1,searchProperties:0,state:3,unit:1,useDefaultRouteLayer:5},K.styles=pt;let W=K;it("arcgis-directions",W);export{W as ArcgisDirections};
