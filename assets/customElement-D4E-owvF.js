import{_ as n,e as l,g as y,d6 as w,a5 as p,L as v,r as x,u as b,c as L,d as s,b as $,i as E,l as C}from"./index-CgzAF5Ey.js";import{C as k}from"./supportUtils-BZj590vD.js";import{v as _}from"./useViewModel-C2OUFn4j.js";import{s as f}from"./useT9n-CtkFUew7.js";import"./GraphicsLayer-CNIUk38A.js";import"./knowledgeGraphService-DdwbA4aa.js";import"./submitJob-C_BQYrXw.js";import"./networkEnums-Tj95fFYJ.js";import"./GPMessage-CUpfv7Q3.js";import"./GraphQueryStreaming-5_IvnDby.js";import"./useView-CMtXgKA0.js";let o=class extends w{constructor(t){super(t),this._goToExtentController=null,this._scaleExtent=(e,a)=>{const i=e,r=(e.xmax-e.xmin)/2*(a-1),d=(e.ymax-e.ymin)/2*(a-1);return i.xmin=e.xmin-r,i.ymin=e.ymin-d,i.xmax=e.xmax+r,i.ymax=e.ymax+d,i},this.switchLayout=this.switchLayout.bind(this)}destroy(){this._cancelGoToExtent(),this.view=null}set view(t){this._set("view",t),t&&t.when().then(()=>{if(this.view===t){if(!this.view.map.linkChartProperties)throw new p("linkChartLayoutSwitcher:error","Link chart layouts are only supported on WebLinkCharts.");this.layout=k(this.view.map.linkChartProperties.layoutType)}})}get state(){return this.view?this.view.map.linkChartProperties?"ready":"disabled":"loading"}get layout(){return this._get("layout")||"organic-standard"}set layout(t){this._set("layout",t)}get preventExtentUpdate(){return this._get("preventExtentUpdate")||!1}set preventExtentUpdate(t){this._set("preventExtentUpdate",t)}async switchLayout(t){if(!this.view||!this.view.map)throw new p("linkChartLayoutSwitcher:loading-state","Cannot change layout when link chart has not loaded.");if(this.layout=t,await this.view.map.applyLayout(t),!this.preventExtentUpdate&&this.view.map.diagramNodesExtent){const e=t!=="geographic-organic-standard"?this._scaleExtent(this.view.map.diagramNodesExtent,1.4):this.view.map.diagramNodesExtent,a=new AbortController;this._goToExtentController=a;try{await this.view.when(),await this.view.goTo(e,{signal:a.signal})}catch{}this._goToExtentController=null}this.emit("switchLayout",{layout:t})}_cancelGoToExtent(){const{_goToExtentController:t}=this;t&&t.abort(),this._goToExtentController=null}};n([l()],o.prototype,"_goToExtentController",void 0),n([l()],o.prototype,"view",null),n([l({readOnly:!0})],o.prototype,"state",null),n([l()],o.prototype,"layout",null),n([l()],o.prototype,"preventExtentUpdate",null),o=n([y("esri.widgets.LinkChartLayoutSwitcher.LinkChartLayoutSwitcherViewModel")],o);const M=o;const T=E``,u={basicLayoutCategory:["basic-grid"],organicLayoutCategory:["organic-standard","organic-community","geographic-organic-standard"],treeLayoutCategory:["tree-left-to-right","radial-root-centric"],hierarchicalLayoutCategory:["hierarchical-bottom-to-top"],chronologicalLayoutCategory:["chronological-mono-timeline","chronological-multi-timeline"]},m={"organic-standard":"force-directed-link-chart-layout","organic-community":"community-link-chart-layout","basic-grid":"simple-link-chart-layout","hierarchical-bottom-to-top":"hierarchical-link-chart-layout","radial-root-centric":"radial-tree-link-chart-layout","tree-left-to-right":"smart-tree-link-chart-layout","geographic-organic-standard":"geographic-link-chart-layout","chronological-mono-timeline":"single-timeline","chronological-multi-timeline":"multi-timeline"},g={"organic-standard":"forceDirected","organic-community":"community","basic-grid":"simple","hierarchical-bottom-to-top":"hierarchical","radial-root-centric":"radialTree","tree-left-to-right":"smartTree","geographic-organic-standard":"geographic","chronological-mono-timeline":"chronologicalSingle","chronological-multi-timeline":"chronologicalMultiple"},S={base:"link-chart-layout-switcher"},D=_(M),c=class c extends v{constructor(){super(...arguments),this.messages=f(),this.viewModel=D(this),this.view=this.viewModel.view,this.appearance="dropdown",this.autoDestroyDisabled=!1,this.closeOnSelectDisabled=!1,this.icon="nodes-link",this.layout=this.viewModel.layout,this.preventExtentUpdate=this.viewModel.preventExtentUpdate,this.state=this.viewModel.state,this.arcgisSwitchLayout=x(()=>this.viewModel,"switchLayout"),this.arcgisPropertyChange=b()("state"),this.arcgisReady=L()}async destroy(){await this.manager.destroy()}async switchLayout(t){this.viewModel.switchLayout(t)}_renderDropdown(){const{messages:t,icon:e}=this;return s`<calcite-dropdown scale=s width=m max-items=9 .closeOnSelectDisabled=${this.closeOnSelectDisabled}><calcite-action slot=trigger .disabled=${this.viewModel.state==="disabled"} .icon=${e??void 0} .label=${t.layoutOptions??"Layout"} appearance=solid scale=s .text=${t.layoutOptions??"Layout"}></calcite-action>${Object.entries(u).map(([a,i])=>s`<calcite-dropdown-group selection-mode=single .groupTitle=${this.messages[a]}>${i.map(r=>s`<calcite-dropdown-item .iconStart=${m[r]} .selected=${r===this.layout?!0:void 0} @click=${()=>{this.switchLayout(r)}}>${t[g[r]]}</calcite-dropdown-item>`)}</calcite-dropdown-group>`)}</calcite-dropdown>`}_renderMenuBar(){const{messages:t}=this;return s`<calcite-action-bar scale=s floating overflow-actions-disabled>${Object.entries(u).map(([e,a])=>s`<calcite-action-group .label=${this.messages[e]}>${a.map(i=>s`<calcite-action scale=s .icon=${m[i]} .active=${i===this.layout?!0:void 0} @click=${()=>{this.switchLayout(i)}} .text=${t[g[i]]}></calcite-action>`)}</calcite-action-group>`)}</calcite-action-bar>`}render(){const{appearance:t}=this,e=t==="menu-bar"?this._renderMenuBar():this._renderDropdown();return s`<div class=${$(S.base)}>${e}</div>`}};c.properties={view:0,appearance:1,autoDestroyDisabled:5,closeOnSelectDisabled:5,icon:1,label:1,layout:32,messageOverrides:0,position:3,preventExtentUpdate:5,referenceElement:1,state:3},c.styles=T;let h=c;C("arcgis-link-chart-layout-switcher",h);export{h as ArcgisLinkChartLayoutSwitcher};
