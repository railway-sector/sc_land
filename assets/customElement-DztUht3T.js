import{L as f,p2 as x,k as v,f as o,y as $,F as d,E as b,i as g,l as L}from"./index-CVzGOCNQ.js";const w=(r,e,t=!1)=>{if(!r||!e)return!1;const i=new URL(r),n=new URL(e);return!t&&i.protocol!==n.protocol||i.host==null||n.host==null?!1:i.host.toLowerCase()===n.host.toLowerCase()&&i.port===n.port};const _=g`@layer{.arcgis-print__exported-file{display:flex;align-items:center;justify-content:space-between}.arcgis-print__exported-file-link-title,.arcgis-print__exported-file-link-description{word-wrap:break-word;word-break:break-all;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical}}`,p="arcgis-print",m={exportedFile:`${p}__exported-file`,exportedFileLinkTitle:`${p}__exported-file-link-title`,exportedFileLinkDescription:`${p}__exported-file-link-description`};function I(r){const{state:e,extension:t}=r;switch(e){case"pending":return"spinner";case"error":return"exclamation-mark-circle";default:return t?.toLowerCase()?.includes("pdf")?"file-pdf":"file"}}function k(r,e){return!r||r==="all"||!!(e&&r.includes(e))}const s=class s extends f{constructor(){super(...arguments),this._handleLinkClick=e=>{if(!e||e.state!=="ready"||!e.url)return;const t=e.url,i=document.createElement("a");i.target="_blank",i.href=t,i.rel="noreferrer",i.download=e.formattedName??"";{i.click();return}}}loaded(){this.manager.onLifecycle(()=>[v(()=>this.exportedLink.state,()=>this.requestUpdate())])}render(){const{exportedLink:e}=this,t=e.formattedName??"";return o`<calcite-list-item .label=${t}>${this._renderExportedLinkItemContent(e)}${this._renderExportedLinkItemIcon(e)}${this._renderExportedLinkItemAction(e)}</calcite-list-item>${this._renderExportedLinkItemPopover(e)}`}_renderExportedLinkItemPopover(e){const t=this.messages,i=e.formattedName??"",{state:n}=e,c=this.saveAsButtonCallback&&n!=="error"&&k(this.allowedFormatsForSaving,e.extension);return n!=="pending"&&c?o`<calcite-popover auto-close label=Popover offset-distance=1 overlay-positioning=fixed pointer-disabled .referenceElement=${`${i}-popover-button`} scale=s><calcite-list label>${e.portalItem?o`<calcite-list-item .label=${t.openItem} @calciteListItemSelect=${()=>{const l=e.portalItem;if(!l?.itemPageUrl)return;const a=document.createElement("a");a.target="_blank",a.href=l.itemPageUrl,a.rel="noreferrer",a.click()}}><calcite-icon icon=launch2 scale=s slot=content-start></calcite-icon></calcite-list-item>`:o`<calcite-list-item .label=${t.saveAs} @calciteListItemSelect=${async()=>{this.saveAsButtonCallback&&($(()=>e.portalItem).then(l=>{l.itemPageUrl&&this.requestUpdate()}),await this.saveAsButtonCallback(e))}}><calcite-icon icon=save scale=s slot=content-start></calcite-icon></calcite-list-item>`}<calcite-list-item label=Delete @calciteListItemSelect=${()=>this.viewModel.exportedLinks.remove(e)}><calcite-icon icon=trash scale=s slot=content-start></calcite-icon></calcite-list-item></calcite-list></calcite-popover>`:null}_renderExportedLinkItemContent(e){const t=this.messages,{url:i,state:n,error:c}=e,l=e.formattedName??"",a=w(i||null,document.location.href),h=n==="error"?c?.name==="print-task:cim-symbol-unsupported"?t.exportWebMapCIMError:t.exportWebMapError:null;return o`<div class=${d(m.exportedFile)} slot=content @click=${()=>this._handleLinkClick(e)}><div><div class=${d(m.exportedFileLinkTitle)}>${l}</div><div class=${d(m.exportedFileLinkDescription)}>${n==="pending"?t.generatingExport:h||(a?t.ready:t.linkReady)}</div></div>${n==="ready"?o`<calcite-icon .ariaLabel=${`${l}. ${t.linkReady}`} .icon=${a?"download-to":"launch"} scale=s slot=content-end></calcite-icon>`:null}</div>`}_renderExportedLinkItemIcon(e){return e.state==="pending"?o`<calcite-loader inline .label=${this.messages.generatingExport} scale=m slot=content-start></calcite-loader>`:o`<calcite-icon .icon=${I(e)} scale=s slot=content-start></calcite-icon>`}_renderExportedLinkItemAction(e){const{state:t}=e,i=e.formattedName??"",n=this.saveAsButtonCallback&&t!=="error"&&k(this.allowedFormatsForSaving,e.extension);return t!=="pending"?o`<calcite-action .icon=${n?"ellipsis":"x"} id=${(n?`${i}-popover-button`:void 0)??b} @click=${n?void 0:()=>{this.viewModel.exportedLinks.remove(e)}} slot=actions-end .text=${n?"options":"remove"}></calcite-action>`:null}};s.properties={saveAsButtonCallback:0,allowedFormatsForSaving:1,exportedLink:0,viewModel:0,messages:0},s.styles=_,s.shadowRootOptions=x;let u=s;L("arcgis-print-exported-link",u);export{u as PrintExportedLink};
