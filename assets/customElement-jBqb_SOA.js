const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/languageUtils-BHSX9xR7.js","assets/index-Bp3GeDhQ.js","assets/index-ni9qn0ie.css","assets/ImmutableArray-BPVd6ESQ.js","assets/shared-Uanpa3Wf.js","assets/number-DFdmL_Vd.js","assets/index-Df8y7Bmz.js","assets/index-Dwxj2UE3.js","assets/utils4-9V5NgBE2.js","assets/index-DMhv2Rxw.js","assets/index-Dk659Oi9.js","assets/customElement-DHYSes4u.js","assets/index-DolGN-Zc.js","assets/index-DCTkqeOC.js","assets/index-Bw6DDd_M.js","assets/index-BuREWvaP.js","assets/index-BgTwaj8G.js","assets/throttle-W3wYPyFb.js","assets/index-IGA6vAz5.js","assets/index-DM5di0oO.js","assets/UtilityNetworkLookupHelper-X4MXTyHS.js","assets/symbolLayerUtils-DErvo6ln.js","assets/SharedTemplate-Cevb2Q7i.js","assets/FeatureTemplates-DDe33nkx.js","assets/FeatureService-CQv55fsp.js","assets/applyEditsUtils-W-o5CTP2.js","assets/MeshTransform-DL5XJk6-.js","assets/editingSupport-DzHnEVys.js","assets/utils-C26rocyt.js","assets/Heading-BGY36xKf.js","assets/SketchOptions-DkZT37r7.js","assets/SketchLabelOptions-CvfS2rfH.js","assets/Attachments-C8EnUWK-.js","assets/AttachmentsViewModel-DwcGCVGV.js","assets/AttachmentInfo-blkrOCwg.js","assets/featureUtils-C0djycCw.js","assets/attachmentUtils-DFE6k1cZ.js","assets/legacyIcon-BpbXCnGp.js","assets/featureFormUtils-BtOqPOku.js","assets/dateUtils-C2q8JwmU.js","assets/arcade-Ahk07dfV.js","assets/arcadeEnvironment-BCJuKHfj.js","assets/FeatureForm-Esq--nsm.js","assets/FieldInput-uSIyfyem.js","assets/FeatureRelationshipViewModel-BD3PC9S2.js","assets/Spinner-CL3dKNGL.js","assets/AnchorElementViewModel-Du3Oh9aO.js","assets/GraphicsLayer-n_skBp8O.js","assets/SnappingManager-BICxJWyY.js","assets/euclideanLengthMeasurementUtils-D9l_P3ES.js","assets/geometry2dUtils-2tpfJ_8-.js","assets/geodeticLengthOperator-i8Sfrrr_.js","assets/geodeticCurveType-CirnHLSB.js","assets/helpMessageUtils-2XpUG8Xk.js","assets/HighlightHelper-C2mJ0y4W.js","assets/layerUtils-D3xv-kL2.js","assets/GraphicState-nmBtyrVq.js","assets/DrawingMode-Cvvf0VVz.js","assets/SketchViewModel-BRoViF94.js","assets/isSupportedObject-BoTASd6h.js","assets/automaticAreaMeasurementUtils-DsNHnpIJ.js","assets/geodesicAreaMeasurementUtils-CpeJNyDK.js","assets/earcut-D9gy186-.js","assets/automaticLengthMeasurementUtils-B7UwQrK7.js","assets/utils-Bge9By5o.js","assets/splitCurveAtPoint-7DF0p4EV.js","assets/coordinateHelper-DdBv3hO4.js","assets/SelectionToolbar-BB-c1Flk.js","assets/directionModeIcons-Br5woIHu.js","assets/uploadAssetErrors-D7BOdSyz.js","assets/Upload-BiQfvhk2.js","assets/progressUtils-XePbnA6r.js","assets/helpMessageUtils3d-DeHUiAZq.js","assets/createTemplateExecutor-DLBC0PDj.js","assets/unionOperator-By4XjY8Y.js","assets/Point2D-8Py_srEd.js","assets/ProjectionTransformation-lQCY9pCU.js","assets/Envelope2D-DQ3Tn1o-.js","assets/Transformation2D-Ckyhe4wc.js","assets/SimpleGeometryCursor-B92kdZ15.js","assets/OperatorDefinitions-DP7_WWTp.js","assets/jsonConverter-DUGRtN2X.js","assets/operatorUnion-CM_7A96B.js","assets/apiConverter-jueJBHyz.js","assets/measures-DWa78IKg.js","assets/lengthOperator-D89j2ysp.js","assets/differenceOperator-Bz1kAB0n.js","assets/intersectionOperator-gU2sAccy.js","assets/operatorIntersection-DDYr4WNS.js","assets/cutOperator-DRkmjMLj.js","assets/AddAssociationWorkflow-Jw4yuD6v.js","assets/UtilityNetworkAssociationAddAssociationViewModel-DEHJzYJ7.js","assets/Association-CJfeke1h.js","assets/getFeatureTitle-Mrr3SXNI.js","assets/index-B7G391H4.js","assets/index-DyJBVOCy.js","assets/index-DqsaUgdy.js","assets/index-TKhwHmwK.js","assets/index-CnRlY83M.js","assets/UtilityNetworkAssociationItemList-DaA8Cj3y.js","assets/UtilityNetworkAssociationSettings-BFyyQfkm.js","assets/getAssociationTitle-CbehvZwK.js","assets/Sketch-Co3rAk_s.js"])))=>i.map(i=>d[i]);
import{ei as ce,gz as es,gA as ts,a2 as j,Z as s,$ as n,a0 as M,oc as is,O as X,eg as le,a4 as z,nH as Wt,_,bz as v,db as Zr,dc as qr,aK as Q,IU as Fr,IV as Zt,gf as rr,IW as or,Q as ye,lG as rs,lK as os,bU as as,bV as Ui,bK as ss,ye as Jr,yi as ns,t_ as wi,cD as Qr,yf as Kr,cA as Mt,IX as Yr,F6 as ls,AV as cs,IY as Xr,ze as eo,zf as to,cN as We,gQ as Ni,fO as ds,IZ as us,yh as ps,op as tt,od as hs,EF as fs,yg as ms,cI as Ir,hB as Dt,eu as gs,bx as Z,k as x,es as Pt,aU as De,y as O,ag as ys,k6 as Ti,cU as pt,W as si,X as Pe,Y as f,bA as st,zw as ws,cw as io,tJ as vs,a6 as xe,tM as zo,aZ as ht,aY as St,xE as _s,ak as L,gg as ar,gi as Uo,tN as bs,dq as Rt,c6 as ks,cX as xs,qE as Ar,hR as Fs,ev as Si,hK as Is,b4 as de,aj as ni,I_ as As,I$ as Ms,GN as Cs,eB as Es,gk as No,aQ as Ts,BB as Ss,eF as Ls,aq as Gi,ep as Vs,ap as $s,J0 as Go,ww as Os,iU as Ws,J1 as Ps,bS as Rs,Ev as jo,ch as Bo,nu as xt,ao as ji,Er as Zo,ot as Hs,Eq as et,aV as bt,q as Ve,by as re,dt as Mr,a3 as rt,qL as Ft,hL as ct,Aq as qo,jv as Jt,eX as Ds,eD as zs,dB as Us,eM as sr,ad as $t,aC as ro,nL as Ns,az as Gs,bf as js,fm as Bs,am as Zs,eO as qs,ae as oo,cO as Js,mW as Qs,eq as Ks,jE as Ys,cL as Xs,iA as en,cM as nr,nt as tn,ds as rn,bR as on,r2 as an,b5 as Bi,dx as sn,dz as nn,dy as ln,J2 as cn,J3 as dn,J4 as lr,J5 as qt,J6 as un,J7 as pn,uw as Jo,cY as hn,Bh as fn,bZ as Xt,nb as dt,bP as pi,bC as mn,J8 as gn,L as yn,u as wn,c as vn,r as ao,I as _n,i as bn,l as kn}from"./index-Bp3GeDhQ.js";import{l as zt,n as xn}from"./SketchOptions-DkZT37r7.js";import{k as Fn}from"./Attachments-C8EnUWK-.js";import{u as Qo,d as In,m as so,c as no,p as lo,s as An,l as Mn,a as cr,g as co,i as Cn,X as En}from"./featureFormUtils-BtOqPOku.js";import{F as Ko,T as Tn,V as Zi,C as qi,E as uo,b as Sn,N as Ln}from"./dateUtils-C2q8JwmU.js";import{createArcadeExecutor as Vn,createArcadeProfile as $n}from"./arcade-Ahk07dfV.js";import{D as On,Q as Pi,Y as Wn}from"./FeatureForm-Esq--nsm.js";import{e as Yo,a as Pn,b as Rn,c as Hn,r as Dn}from"./FieldInput-uSIyfyem.js";import{g as ei,A as li,I as Xo,h as Ri,w as ea,d as dr,y as ta,a as Cr,O as ia,S as zn,l as Un,s as Er,F as Nn,m as Gn}from"./FeatureTemplates-DDe33nkx.js";import{t as jn,c as Bn}from"./Spinner-CL3dKNGL.js";import{n as It}from"./GraphicsLayer-n_skBp8O.js";import{q as Zn}from"./SnappingManager-BICxJWyY.js";import{e as ra,u as oa}from"./euclideanLengthMeasurementUtils-D9l_P3ES.js";import{y as aa}from"./AttachmentsViewModel-DwcGCVGV.js";import{e as sa}from"./helpMessageUtils-2XpUG8Xk.js";import{l as ze}from"./HighlightHelper-C2mJ0y4W.js";import{e as na}from"./GraphicState-nmBtyrVq.js";import{e as qn}from"./DrawingMode-Cvvf0VVz.js";import{t as Jn,d as ci,n as Qn}from"./SketchViewModel-BRoViF94.js";import{p as Kn}from"./utils-Bge9By5o.js";import{h as Yn}from"./splitCurveAtPoint-7DF0p4EV.js";import{w as Xn}from"./coordinateHelper-DdBv3hO4.js";import{findUtilityNetwork as el,isGraphicForRelatableFeatureSupportedLayer as tl,isRelatableFeatureSupportedLayer as il}from"./featureUtils-C0djycCw.js";import{b as rl,d as ol,n as Tr,l as al,k as sl,f as nl,y as ll,p as cl,a as dl,s as ul,e as pl}from"./SelectionToolbar-BB-c1Flk.js";import{s as ti,l as Ot}from"./Heading-BGY36xKf.js";import{l as hl,m as fl,i as ml}from"./uploadAssetErrors-D7BOdSyz.js";const gl=new WeakMap;let yl=class{constructor(){this._observables=new Map}get(t,i,r){const o=ce(this._observables,i,()=>new es);return ts(o),Reflect.get(t,i)}set(t,i,r,o){return Reflect.set(t,i,r),this._observables.get(i)?.notify(),!0}};function wl(e){return!e||typeof e!="object"||"__accessor__"in e?e:ce(gl,e,()=>new Proxy(e,new yl))}let Ne=class extends j{constructor(t){super(t),this.userChangesHaveMadeInvalid=!1,this.original=t.source.clone();const i=t.source.attributes??{},r=wl({...i});this.attributes=r;const o=t.source.cloneShallow();o.attributes=r,this.plainGraphic=o}get geometry(){return this.plainGraphic.geometry}set geometry(t){this.plainGraphic.geometry=t}get layer(){return this.source.sourceLayer??this.source.layer}attributeHasChanged(t){return!Qo(this.attributes[t],this.original.attributes?.[t])}getAttribute(t){return this.attributes[t]??null}setAttribute(t,i){this.attributes[t]=i}};s([n()],Ne.prototype,"attributes",void 0),s([n()],Ne.prototype,"geometry",null),s([n()],Ne.prototype,"plainGraphic",void 0),s([n()],Ne.prototype,"layer",null),s([n({constructOnly:!0})],Ne.prototype,"original",void 0),s([n({constructOnly:!0})],Ne.prototype,"source",void 0),s([n()],Ne.prototype,"userChangesHaveMadeInvalid",void 0),Ne=s([M("esri.widgets.BatchAttributeForm.ReactiveGraphic")],Ne);const Ji=(e,t)=>e!=null&&e.input?.type===t;function vl(e){return new Ne({source:e})}function _l(e,t,i,r){const{dataType:o,minLength:a}=e,l=i?.validationErrors;if(!l||!t)return null;if(t==="batch-attribute-form-validation::features-have-different-errors")return l.invalidBatchFormType;if(t==="input-validation-error::cannot-be-empty")return l.cannotBeNull;if(t==="domain-validation-error::value-out-of-range"||t==="numeric-range-validation-error::out-of-range"){const{field:c,range:d}=e,u={type:"date",intlOptions:{timeZone:c.type==="date"&&r?r:void 0,...Ko(c)}},p=In(d,l);return X(p,d,{format:{max:o==="date"?u:d.max!=null&&so(d.max)?no:lo,min:o==="date"?u:d.min!=null&&so(d.min)?no:lo}})}return t==="domain-validation-error::invalid-coded-value"?l.invalidCodedValue:t==="type-validation-error::invalid-type"?l.invalidType:t==="length-validation-error::too-short"?X(l.tooShort,{min:a}):null}function bl(e,t,i){const r=i?.validationErrors;if(!r)return null;let o=null;for(const a of e.invalidHiddenInputs)switch(a.effectiveVisibilityCode){case"hidden:visibility-expression:all-features":case"hidden:group-visibility-expression:all-features":case"hidden:field-definition":return t==="single"?r.nonVisibleError_changeValues:r.nonVisibleError_checkIndividualFeatures;case"hidden:no-domain-in-common":case"hidden:visibility-expression:some-features":case"hidden:group-visibility-expression:some-features":case"hidden:not-in-all-layers":o=r.nonVisibleError_checkIndividualFeatures;break;case"visible":continue;default:is(a.effectiveVisibilityCode)}return o}function kl(e){return e!=null&&typeof e=="object"&&"type"in e&&(e.type==="feature"||e.type==="geojson"||e.type==="knowledge-graph-sublayer"||e.type==="oriented-imagery"||e.type==="scene"||e.type==="subtype-sublayer")}const xl=$n("form-calculation");let Fl=class{constructor(){this._executors=new Map,this._executorPromises=new Map}async getArcadeExecutor(t){return this._executors.has(t)?this._executors.get(t):this._executorPromises.has(t)?this._executorPromises.get(t):this._createExecutor(t)}async _createExecutor(t){try{const i=Vn(t,xl);this._executorPromises.set(t,i);const r=await i;return this._executors.set(t,r),r}finally{this._executorPromises.delete(t)}}};const J="esri_BatchAttributeForm_different_values";function Sr(e){return e==="visible"}function Li(e){return e.type==="field"}function Lr(e){return e.type==="group"}function vi(e,t){return`${e}:${t}`}const po=e=>e!=null&&(ho(e,"combo-box")||ho(e,"radio-buttons"));function ho(e,t){return e?.type===t}function ii(e){return e.type==="field"}function Hi(e){return e.type==="group"}let be=null,qe=class extends j{constructor(t){super(t),this.calculating=!1,this.arcadeContext=null,this._abortController=new AbortController,this.layerExpressionsModelMap=new Map,this.evaluatedExpressions=new le,this.expressionEvaluationFailed=!1}abort(){this._abortController.abort()}async runAllExpressions(t,i=!1){return this._evaluateSpecifiedComponentsForEachFeature(t,Ml,i)}async runGeometryDependentExpressions(t,i=!1){return this._evaluateSpecifiedComponentsForEachFeature(t,Cl,i)}async valueChanged(t,i,r=!0){try{this.calculating=!0;const o=i.map(a=>this.evaluateValueChangedForFeature(t,a,r));await Promise.all(o)}catch(o){z.getLogger(this).error(o),this.expressionEvaluationFailed=!0}finally{this.calculating=!1}}async evaluateValueChangedForFeature(t,i,r){if(this._abortController.signal.aborted)return;const o=this.layerExpressionsModelMap.get(i.layer);if(!o||o.components.length===0)return;const a=new Set,l=new Set([t]),c=new Set;for(;l.size>0;){const[d]=l;if(l.delete(d),a.has(d))continue;a.add(d);const u=o.fieldReferencesMap.get(d.toLowerCase());if(!u)continue;for(const h of u)c.has(h)&&u.delete(h);if(u.size===0)continue;const p=new Set;await this.evaluateAffectedComponents([...u],i,o,r,p);for(const h of u)c.add(h);for(const h of p)a.has(h)||l.add(h)}}async evaluateAffectedComponents(t,i,r,o,a){const l=new Map;for(const d of t)l.has(d)||l.set(d,this.createSccEvaluator(d,i,l,r));if(l.size===0)return;const c=[...l.values()].map(d=>d.evaluate(o,a));await Promise.all(c)}createSccEvaluator(t,i,r,o){const a=new Il(t,i,this.arcadeContext,o,this.evaluatedExpressions,this._abortController);for(const l of t.adjacencyList)a.dependentEvaluators.push(ce(r,l,()=>this.createSccEvaluator(l,i,r,o)));return a}async _evaluateSpecifiedComponentsForEachFeature(t,i,r=!1){this.calculating=!0;try{const o=[];for(const a of t){const l=this.layerExpressionsModelMap.get(a.layer);if(!l||l.components.length===0)continue;const c=new Set;o.push(this.evaluateAffectedComponents(i(l),a,l,r,c))}await Wt(Promise.all(o),this._abortController)}catch(o){z.getLogger(this).error(o),this.expressionEvaluationFailed=!0}finally{this.calculating=!1}}};s([n()],qe.prototype,"calculating",void 0),s([n({constructOnly:!0})],qe.prototype,"arcadeContext",void 0),s([n()],qe.prototype,"_abortController",void 0),s([n()],qe.prototype,"layerExpressionsModelMap",void 0),s([n()],qe.prototype,"evaluatedExpressions",void 0),s([n()],qe.prototype,"expressionEvaluationFailed",void 0),qe=s([M("esri.widgets.BatchAttributeForm.expressions.ExpressionsManager")],qe);let Il=class{constructor(t,i,r,o,a,l){this.scc=t,this.feature=i,this.arcadeContextInfo=r,this.expressionsModel=o,this.evaluatedExpressions=a,this._abortController=l,this.dependentEvaluators=[],this._evaluatorPromise=null}get baseContext(){const{editType:t,map:i,spatialReference:r,timeZone:o}=this.arcadeContextInfo,a=this.feature.layer,l=a?.type==="scene"&&a.associatedLayer!=null?a.associatedLayer:a;return{variables:{$originalfeature:this.feature.original,$editcontext:{editType:t},$layer:l,$featureset:l,$datastore:l?.url,$feature:this.feature.plainGraphic,$map:i},executeContext:{rawOutput:!0,spatialReference:r??void 0,timeZone:o,abortSignal:this._abortController.signal}}}evaluate(t,i){return this._evaluatorPromise==null&&(this._evaluatorPromise=this._evaluate(t,i)),this._evaluatorPromise}async _evaluate(t,i){be===null&&(be=await _(()=>import("./languageUtils-BHSX9xR7.js").then(o=>o.ae),__vite__mapDeps([0,1,2,3,4,5])));const r=this.dependentEvaluators.map(o=>o.evaluate(t,i));await Wt(Promise.all(r),this._abortController);for(const o of this.scc.executors){const a=this.baseContext;if(this._abortController.signal.aborted)break;const l=this.expressionsModel.arcadeExecutorUses.get(o)??[],c=ce(this.evaluatedExpressions,this.feature,()=>new le);let d=null,u=null;try{d=o.isAsync?await o.executeAsync(a.variables,a.executeContext):o.execute(a.variables,a.executeContext),u={result:d,status:"success"}}catch(p){u={error:p,status:"error"}}for(const p of l){const h=this.expressionsModel.elementTemplateMap.get(p.elementId);switch(p.executorPurpose){case"editable":case"required":c.set(vi(p.elementId,p.executorPurpose),u);break;case"value":{if(u?.status==="error")continue;const m=h.getExpressionExecutorsForLayer(this.feature.layer);let g=!0;if(m?.editableExpression&&(g=c.get(vi(h.elementId,"editable"))?.result===!1),g){const y=this.feature.getAttribute(h.fieldName)??null,b=Al(u.result,this.feature,h.fieldName,this.arcadeContextInfo.timeZone);b!==y&&(this.feature.setAttribute(h.fieldName,b),i.add(h.fieldName))}}break;case"visibility":if(c.set(vi(p.elementId,p.executorPurpose),u),!this.expressionsModel.preserveFieldValuesWhenHidden&&u.result===!1&&t)if(Hi(h))for(const m of h.elements)ii(m)&&(this.feature.getAttribute(m.fieldName)!==null&&i.add(m.fieldName),this.feature.setAttribute(m.fieldName,null));else ii(h)&&(this.feature.getAttribute(h.fieldName)!==null&&i.add(h.fieldName),this.feature.setAttribute(h.fieldName,null))}}if(u?.status==="error"){const p=new Set;for(const h of l){const m=this.expressionsModel.elementTemplateMap.get(h.elementId);if(m)switch(h.executorPurpose){case"editable":p.add(m.label+" - Editable expression");break;case"required":p.add(m.label+" - Required expression");break;case"value":p.add(m.label+" - Value expression");break;case"visibility":p.add(m.label+" - Visibility expression")}}throw p.size>0?new v("expression-evaluation-failed","Arcade evaluation failed ("+[...p].join(",")+")"):new v("expression-evaluation-failed","Arcade evaluation failed ")}}}};function Al(e,t,i,r){if(e===null)return null;const o=t.layer.fieldsIndex.get(i);if(!o)throw new v("field-not-found","Unable set field value as the field cannot be found. ("+i+")");switch(o.type){case"big-integer":case"integer":case"long":case"oid":case"small-integer":case"single":case"double":return be.toNumber(e);case"global-id":case"guid":case"string":return be.toString(e);case"date":{if(be.isDate(e))return e.getTime();const a=be.toDate(e,r);if(!a)throw new v("unsupported-value-type","Arcade return type is not a supported field type. ("+i+")");return a.getTime()}case"date-only":{if(be.isDateOnly(e))return e.toStorageFormat();if(be.isDate(e))return qr.fromDateTime(e.toDateTime()).toStorageFormat();const a=qr.fromString(be.toString(e));if(!a)throw new v("unsupported-value-type","Arcade return type is not a supported field type.");return a.toStorageFormat()}case"time-only":{if(be.isTime(e))return e.toStorageString();if(be.isDate(e))return Zr.fromDateTime(e.toDateTime()).toStorageString();const a=Zr.fromString(be.toString(e));if(!a)throw new v("unsupported-value-type","Arcade return type is not a supported field type.");return a.toStorageString()}case"timestamp-offset":{if(be.isDate(e))return e.toISOString(!1);const a=be.toDate(e,r);if(!a)throw new v("unsupported-value-type","Arcade return type is not a supported field type. ("+i+")");return a.toISOString(!1)}}throw new v("unsupported-value-type","Arcade return type is not a supported field type. ("+i+")")}function Ml(e){return e.components}function Cl(e){return Array.from(e.geometryReferences)}let fo=0,El=class{constructor(t){this.arcadeExecutorUses=new Map,this.components=[],this.preserveFieldValuesWhenHidden=!1,this.executorMap=t.executorMap,this.preserveFieldValuesWhenHidden=t.preserveFieldValuesWhenHidden===!0,this.elementTemplateMap=new Map;for(const i of this.executorMap.keys())this.elementTemplateMap.set(i.elementId,i);this._buildDependencyGraph()}_buildDependencyGraph(){const t=Vl(this.executorMap),i={components:[],arcadeExecutorUses:this.arcadeExecutorUses,elementTemplatesById:new Map([...this.executorMap.keys()].map(r=>[r.elementId,r])),executorMap:this.executorMap,fieldElementTemplateMap:Ll(this.executorMap),fieldReferencesMap:new Map,geometryReferences:new Set,nextIndex:0,nodeInfoMap:t,nodeStack:new rr(or),shouldConsiderVisibility:!this.preserveFieldValuesWhenHidden};for(const r of this.executorMap.keys()){const o=this.executorMap.get(r);o.editableExpression&&ce(this.arcadeExecutorUses,o.editableExpression,()=>[]).push({elementId:r.elementId,executorPurpose:"editable"}),o.valueExpression&&ce(this.arcadeExecutorUses,o.valueExpression,()=>[]).push({elementId:r.elementId,executorPurpose:"value"}),o?.visibilityExpression&&ce(this.arcadeExecutorUses,o.visibilityExpression,()=>[]).push({elementId:r.elementId,executorPurpose:"visibility"}),o?.requiredExpression&&ce(this.arcadeExecutorUses,o.requiredExpression,()=>[]).push({elementId:r.elementId,executorPurpose:"required"})}for(const r of this.arcadeExecutorUses.values())r.sort(o=>o.executorPurpose==="editable"?-1:1);for(const r of t.values())r.index===-1&&la(r,i);this.dependencyGraphComponents=$l(i.nodeInfoMap),this.fieldReferencesMap=Ol(i),this.geometryReferences=Wl(i),this.components=i.components}};function la(e,t){e.index=e.lowlink=t.nextIndex++,t.nodeStack.push(e);for(const i of Tl(e,t))i.index===-1?(la(i,t),e.lowlink=Math.min(e.lowlink,i.lowlink)):i.index<e.index&&t.nodeStack.contains(i)&&(e.lowlink=Math.min(e.lowlink,i.index)),t.nodeStack.contains(i)||e.crossLinkNeighbors.add(i);if(e.lowlink===e.index){const i=Pl();for(t.components.push(i);Rl(t.nodeStack)>=e.index;){const r=t.nodeStack.pop();if(r!=null){r.component=i,i.executors.add(r.executor);for(const o of r.crossLinkNeighbors)o.component!=null&&i.adjacencyList.add(o.component)}}}}function Tl({executor:e},t){const i=new Set;for(const o of e.fieldsUsed){const a=o.toLowerCase();ce(t.fieldReferencesMap,a,()=>new Set).add(e),Fr(i,Sl(a,t))}e.geometryUsed&&t.geometryReferences.add(e);const r=t.arcadeExecutorUses.get(e)?.filter(o=>o.executorPurpose==="value")??[];for(const o of r){const a=t.executorMap.get(t.elementTemplatesById.get(o.elementId));a?.editableExpression&&a.editableExpression!==e&&i.add(a.editableExpression)}return Array.from(i).map(o=>t.nodeInfoMap.get(o)).filter(Q)}function Sl(e,{executorMap:t,fieldElementTemplateMap:i,shouldConsiderVisibility:r}){const o=[],a=i.get(e);if(a==null)return o;const l=t.get(a);if(l==null)return o;if(Zt(o,l.editableExpression),Zt(o,l.valueExpression),r){Zt(o,l?.visibilityExpression);const{group:c}=a;if(c!=null){const d=t.get(c)?.visibilityExpression;Zt(o,d)}}return o}function Ll(e){const t=new Map;for(const i of e.keys())ii(i)&&t.set(i.fieldName.toLowerCase(),i);return t}function Vl(e){const t=Array.from(e.values()).filter(Q),i=new Set(t.flatMap(o=>Array.from(Object.values(o)))),r=Array.from(i).map(o=>({component:null,crossLinkNeighbors:new Set,executor:o,index:-1,lowlink:-1,onStack:!1}));return new Map(r.map(o=>[o.executor,o]))}function $l(e){return new Map([...e.values()].map(({component:t,executor:i})=>[i,t]))}function Ol({fieldReferencesMap:e,nodeInfoMap:t}){const i=new Map;for(const[r,o]of e.entries())i.set(r,ca(o,t));return i}function Wl({geometryReferences:e,nodeInfoMap:t}){return ca(e,t)}function ca(e,t){const i=new Set;for(const r of e){const o=t.get(r);o?.component&&i.add(o.component)}return i}function Pl(){fo++;const e=fo.toString();return{executors:new Set,adjacencyList:new Set,componentId:e}}function Rl(e){return e.peek()?.index??-1}let Ee=class extends j{constructor(t){super(t),this.inputs=[],this.template=null}get allFieldInputs(){const t=[];for(const i of this.inputs)Li(i)?t.push(i):Lr(i)&&t.push(...i.inputs.filter(Li));return t}get description(){return this.template?.description??null}get hasInvalidHiddenInputs(){return this.invalidHiddenInputs.length>0}get invalidFeatures(){return Array.from(new Set(this.allFieldInputs.flatMap(t=>t.invalidFeatures)))}get invalidHiddenInputs(){return this.allFieldInputs.filter(t=>!t.valid&&!t.effectiveVisible)}get title(){return this.template?.title??null}get valid(){return this.allFieldInputs.every(t=>t.valid)}};s([n()],Ee.prototype,"allFieldInputs",null),s([n()],Ee.prototype,"description",null),s([n()],Ee.prototype,"inputs",void 0),s([n()],Ee.prototype,"hasInvalidHiddenInputs",null),s([n()],Ee.prototype,"invalidFeatures",null),s([n()],Ee.prototype,"invalidHiddenInputs",null),s([n()],Ee.prototype,"template",void 0),s([n()],Ee.prototype,"title",null),s([n()],Ee.prototype,"valid",null),Ee=s([M("esri.widgets.BatchAttributeForm.inputs.BatchFormInputs")],Ee);const da=Ee;let pe=class extends j{constructor(t){super(t),this.existsInAllLayers=!0,this.features=new ye}get description(){return this.template.description}get featuresHaveSameCalculatedVisibility(){const t=new Set;for(const i of this.features){if(this.template.getExpressionExecutorsForLayer(i.layer)?.visibilityExpression==null){t.add(!0);continue}const r=this._lookupEvaluatedExpression(i,"visibility");if(r?.status==="success"){if(t.add(r.result===!0),t.size>1)return!1}else t.add(!1)}return t.size<=1}get label(){return this.template.label}get layers(){return Array.from(new Set(this.features.map(t=>t.layer).filter(kl)))}get visibilityCode(){return this._baseVisibilityCode}get visible(){return Sr(this.visibilityCode)}get _baseVisibilityCode(){return this.existsInAllLayers?this.featuresHaveSameCalculatedVisibility?this._evaluatedVisibilityExpression===!1?"hidden:visibility-expression:all-features":"visible":"hidden:visibility-expression:some-features":"hidden:not-in-all-layers"}get _evaluatedVisibilityExpression(){let t=!0,i=!0;for(const r of this.features){if(this.template.getExpressionExecutorsForLayer(r.layer)?.visibilityExpression==null){t=t&&!0;continue}i=!1;const o=this._lookupEvaluatedExpression(r,"visibility");o?.status==="success"?t=t&&o.result===!0:t=!1}return i?null:t}_lookupEvaluatedExpression(t,i){return this.expressionsManager.evaluatedExpressions.get(t)?.get(vi(this.template.elementId,i))}};s([n({constructOnly:!0})],pe.prototype,"expressionsManager",void 0),s([n()],pe.prototype,"description",null),s([n()],pe.prototype,"existsInAllLayers",void 0),s([n()],pe.prototype,"features",void 0),s([n()],pe.prototype,"featuresHaveSameCalculatedVisibility",null),s([n()],pe.prototype,"label",null),s([n()],pe.prototype,"layers",null),s([n({constructOnly:!0})],pe.prototype,"template",void 0),s([n()],pe.prototype,"visibilityCode",null),s([n()],pe.prototype,"visible",null),s([n()],pe.prototype,"_baseVisibilityCode",null),s([n()],pe.prototype,"_evaluatedVisibilityExpression",null),pe=s([M("esri.widgets.BatchAttributeForm.inputs.InputBase")],pe);const ua=pe;let Ct=class extends ua{constructor(){super(...arguments),this.editType="NA"}get editable(){return this._evaluatedEditableExpression??!0}get _evaluatedEditableExpression(){let t=!0,i=!0;for(const r of this.features){if(this.template.getExpressionExecutorsForLayer(r.layer)?.editableExpression==null){t=t&&!0;continue}i=!1;const o=this._lookupEvaluatedExpression(r,"editable");o?.status==="success"?t=t&&o.result===!0:t=!1}return i?null:t}};s([n()],Ct.prototype,"editable",null),s([n()],Ct.prototype,"editType",void 0),s([n()],Ct.prototype,"_evaluatedEditableExpression",null),Ct=s([M("esri.widgets.BatchAttributeForm.inputs.EditableInput")],Ct);const Hl=Ct;let T=class extends Hl{constructor(t){super(t),this.group=null,this.type="field",this.userHasChangedValue=!1,this._hasIntersectionWithElementFieldDomain=!1}get compositeError(){if(this.valid)return null;const{errors:t}=this;if(t.length<this.features.length)return"batch-attribute-form-validation::features-have-different-errors";const i=t[0];for(const r of t)if(r.error!==i.error)return"batch-attribute-form-validation::features-have-different-errors";return i.error}get dataType(){const{field:t}=this;return rs(t)?"number":os(t)?"text":as(t)||Ui(t)?"date":"unsupported"}get domain(){const t=this._allDomains.toArray();return this.calculateDomain(t)}get distinctValues(){if(this.featuresHaveSameValue)return[this.value];const t=new Set;for(const i of this.features)t.add(i.getAttribute(this.fieldName));return Array.from(t)}get editable(){return!!this.field.editable&&(this._evaluatedEditableExpression??!0)}get label(){const t=this.template;if(t.label!=null&&t.label!=="")return t.label;const{field:i,layers:r}=this;if(r.length===1){const o=r[0];if(ss(o)){const a=o.getFieldAlias(i.name);if(a!=null&&a!=="")return a}}return i.alias||i.name}get effectiveVisible(){return Sr(this.effectiveVisibilityCode)}get effectiveVisibilityCode(){const{visibilityCode:t}=this;if(t!=="visible")return t;const{group:i}=this;if(i==null)return t;const r=i.visibilityCode;return r==="hidden:visibility-expression:all-features"?"hidden:group-visibility-expression:all-features":r==="hidden:visibility-expression:some-features"?"hidden:group-visibility-expression:some-features":t}get errors(){return this._validate()}get featuresHaveSameValue(){const{fieldName:t}=this,i=this.features.at(0)?.getAttribute(t);return this.features.every(r=>r.getAttribute(t)===i)}get field(){return this.template.field}get fieldName(){return this.field.name}get invalidFeatures(){return this.errors.map(t=>t.feature)}get isSubtypeField(){return this.layers.some(t=>{if(t&&"subtypeField"in t){const{subtypeField:i,fieldsIndex:r}=t;return(r.get(i)?.name??i)===this.fieldName}return!1})}get showNoValueOptionEnabled(){const{input:t}=this.template;return!this.required&&(!po(t)||t?.showNoValueOption===!0)}get showNoValueLabel(){const{input:t}=this.template;return po(t)?t?.noValueOptionLabel:null}get includeTime(){const{template:t,field:i}=this;return this.dataType==="date"&&(i.type==="time-only"||i.type!=="date-only"&&(t.input?.type!=="datetime-picker"||t.input.includeTime))}get includeTimeOffset(){if(this.field.type!=="timestamp-offset")return!1;const t=this.template.input;return!t||t.type==="datetimeoffset-picker"&&t.includeTimeOffset}get maxLength(){return An({dataType:this.dataType,field:this.field,input:this.template.input})}get minLength(){return Mn({dataType:this.dataType,field:this.field,input:this.template.input})}get range(){if(this.dataType==="date")return this._dateRange;const{domain:t,field:i}=this;if(t){const o=Jr(i,t);return{max:o?.max,min:o?.min}}const r=this._allDomains.toArray().every(o=>!o)?ns(i):null;return{max:r?.max===Number.MAX_VALUE?null:r?.max??null,min:r?.min===-Number.MAX_VALUE?null:r?.min??null}}get required(){if(!this.editable)return!1;if(!this.field.nullable||this.isSubtypeField)return!0;const t=this.visible&&this.group?.visible!==!1,i=this._evaluatedRequiredExpression;return!(!t||i==null)&&i}get submittable(){return(!this.required||!this.distinctValues.some(t=>cr(t)))&&!!this.valid}get valid(){return this.errors.length===0}get value(){return this.featuresHaveSameValue?this.features.at(0)?.getAttribute(this.fieldName)??null:J}get visibilityCode(){return this.field.visible?this._fieldShouldHaveDomain&&this.domain==null?"hidden:no-domain-in-common":this._baseVisibilityCode:"hidden:field-definition"}get effectiveTimeZone(){const t=this.template;let i=t.formTimeZone??"system";return t.layerTimeZone?t.layerTimeZone===wi?i=Qr:t.formTimeZone===wi&&(i=t.layerTimeZone):t.formTimeZone===wi&&(i=Qr),i}get codedValueDomainOptions(){return this.domain?.type==="coded-value"?this.domain.codedValues.map(({name:t,code:i})=>({name:t,value:i})):[]}get codedValueOptions(){const t=this.codedValueDomainOptions,{value:i}=this,r=i==null||i===J||t.some(o=>o.value===i)?[]:[{name:`${i}`,value:i}];return[t,r]}get _evaluatedRequiredExpression(){let t=!1,i=!0;const r=this.template;for(const o of this.features){if(r.getExpressionExecutorsForLayer(o.layer)?.requiredExpression==null)continue;i=!1;const a=this._lookupEvaluatedExpression(o,"required");a?.status==="success"?t=t||a.result===!0:t=!0}return i?null:t}get _allDomains(){const t=this.template.domain;return this.features.map(i=>{const r=i.layer.getFieldDomain(this.fieldName,{feature:i.plainGraphic});return r?.type==="range"||t?.type==="range"?r??this.template.domain:r})}get _fieldShouldHaveDomain(){return!!this._hasIntersectionWithElementFieldDomain||this._allDomains.some(Q)}get _dateFormRange(){if(this.dataType!=="date")return{};const t=this.template.input;if(!t)return{};const{type:i}=t;let r={};if(i!=="date-picker"&&i!=="time-picker"&&i!=="datetimeoffset-picker"||(r=Kr(this.field,t.max,t.min)),i==="datetime-picker"){const{max:o,min:a}=t;r={max:o!=null&&co(o)?o.getTime():null,min:a!=null&&co(a)?a.getTime():null}}return{min:r.min,max:r.max,rawMax:r?.rawMax??null,rawMin:r?.rawMin??null}}get _dateRange(){const{_dateFormRange:t,template:i,field:r,domain:o}=this;if(this.dataType!=="date")return{};if(!o)return this._fieldShouldHaveDomain?{}:t;const a=Jr(r,o);if(!a)return t;const{max:l,min:c,rawMax:d,rawMin:u}=t,{type:p}=i.field;if(p==="date"){const{max:h,min:m}=a;return{max:Mt(l)&&(h===null||h!=null&&l<=h)?l:h??null,min:Mt(c)&&(m===null||m!=null&&c>=m)?c:m??null}}if(p==="date-only"||p==="time-only"||p==="timestamp-offset"){const{max:h,min:m,rawMax:g,rawMin:y}=a,b=Mt(l)&&d&&(h==null||l<h),w=Mt(c)&&u&&(m==null||c>m);return{max:b?l:h,min:w?c:m,rawMax:b?d:g,rawMin:w?u:y}}return{}}async setValueFromUser(t){this.userHasChangedValue=!0;const i=[],r=this.fieldName;for(const o of this.features)o.getAttribute(r)!==t&&i.push(o);this._setValue(t),await this.expressionsManager.valueChanged(r,i)}_setValue(t){const{fieldName:i}=this;for(const r of this.features)r.setAttribute(i,t)}_validate(){const{dataType:t,fieldName:i,maxLength:r,minLength:o,range:a}=this,l=[];for(const c of this.features){const{layer:d}=c,u=d.getField(i)??this.field,p=d.getFieldDomain(i,{feature:c.plainGraphic}),h=this.calculateDomain([p]),m=this._requiredForFeature(c),g=c.getAttribute(i),y=Cn(g,{dataType:t,domain:h,field:u,maxLength:r,minLength:o,range:a,required:m});y&&l.push({error:y,feature:c.source})}return l}_editableForFeature(t){if(!this.field.editable)return!1;if(this.template.getExpressionExecutorsForLayer(t.layer)?.editableExpression==null)return!0;const i=this._lookupEvaluatedExpression(t,"editable");return i?.status==="success"&&i.result===!0}_effectiveVisibleFeature(t){if(this.group&&!this.group.visibleForFeature(t))return!1;if(this.template.getExpressionExecutorsForLayer(t.layer)?.visibilityExpression==null)return!0;const i=this._lookupEvaluatedExpression(t,"visibility");return i?.status==="success"&&i.result===!0}_requiredForFeature(t){if(!this._editableForFeature(t))return!1;if(!this.field.nullable||this.isSubtypeField)return!0;const i=this._effectiveVisibleFeature(t);if(this.template.getExpressionExecutorsForLayer(t.layer)?.requiredExpression==null)return!1;const r=this._lookupEvaluatedExpression(t,"required");return r?.status!=="success"?i:i&&r.result===!0}calculateDomain(t){const i=t.find(a=>a!=null),r=this.template.domain;if(!i)return r&&Yr(this.field,r)?r:null;switch(i.type){case"coded-value":if(t.some(a=>!a)){if(!r)return null;t=t.filter(a=>a!==null)}break;case"range":t=t.filter(a=>a!==null)}if(!t.every(a=>a?.type===i?.type))return null;let o=null;switch(i?.type){case"range":o=this._intersectRangeDomains(t);break;case"coded-value":o=this._intersectCodedValueDomains(t)}return o}_intersectCodedValueDomains(t){if(!t.length)return null;const i=new Map(t[0].codedValues.map(({code:l,name:c})=>[l,c])),r=this.template.domain?new Map(this.template.domain.codedValues.map(({code:l,name:c})=>[l,c])):null;for(const l of t)for(const[c,d]of i)l.codedValues.some(u=>u.code===c&&u.name===d)||i.delete(c);let o=i;if(r){o=new Map;for(const[l,c]of r)i.has(l)&&o.set(l,c)}const a=Array.from(o.entries()).map(([l,c])=>new ls({code:l,name:c}));return a.length?new cs({codedValues:a}):null}_intersectRangeDomains(t){if(!t.length)return null;let i=t[0];for(let o=1;o<t.length;o++){if(!i)return null;i=this._findMinMaxValuesBetweenTwoDomains(i,t[o])}if(i&&!Yr(this.field,i))return null;const{domain:r}=this.template;if(i&&r&&r instanceof Xr){const o=this._findMinMaxValuesBetweenTwoDomains(i,r);return this._hasIntersectionWithElementFieldDomain=!!o,o}return i}_getMinMaxFromRangeDomain(t){const i=t.minValue,r=t.maxValue,{field:o}=this;return eo(o)||Ui(o)||to(o)?Kr(o,r,i):{min:i!=null&&typeof i=="number"?i:null,max:r!=null&&typeof r=="number"?r:null}}_findMinMaxValuesBetweenTwoDomains(t,i){const r=new Xr,o=this._getMinMaxFromRangeDomain(t),a=this._getMinMaxFromRangeDomain(i),{field:l}=this,c=this._getValidRangeValue(o.min,-1/0),d=this._getValidRangeValue(o.max,1/0),u=this._getValidRangeValue(a.min,-1/0),p=this._getValidRangeValue(a.max,1/0);return r.minValue=Math.max(c,u),r.maxValue=Math.min(d,p),r.minValue===-1/0||r.maxValue===1/0||r.minValue>r.maxValue?null:((eo(l)||Ui(l)||to(l))&&(r.minValue=Number(o.min)>Number(a.min)?o.rawMin:a.rawMin,r.maxValue=Number(o.max)<Number(a.max)?o.rawMax:a.rawMax),r.name="intersection",r)}_getValidRangeValue(t,i){return Mt(t)?t:i}};s([n()],T.prototype,"dataType",null),s([n()],T.prototype,"domain",null),s([n()],T.prototype,"distinctValues",null),s([n()],T.prototype,"editable",null),s([n()],T.prototype,"label",null),s([n()],T.prototype,"effectiveVisible",null),s([n()],T.prototype,"effectiveVisibilityCode",null),s([n()],T.prototype,"errors",null),s([n()],T.prototype,"featuresHaveSameValue",null),s([n()],T.prototype,"field",null),s([n()],T.prototype,"fieldName",null),s([n()],T.prototype,"group",void 0),s([n()],T.prototype,"invalidFeatures",null),s([n()],T.prototype,"isSubtypeField",null),s([n()],T.prototype,"showNoValueOptionEnabled",null),s([n()],T.prototype,"showNoValueLabel",null),s([n()],T.prototype,"includeTime",null),s([n()],T.prototype,"includeTimeOffset",null),s([n()],T.prototype,"maxLength",null),s([n()],T.prototype,"minLength",null),s([n()],T.prototype,"range",null),s([n()],T.prototype,"required",null),s([n()],T.prototype,"submittable",null),s([n({readOnly:!0})],T.prototype,"type",void 0),s([n()],T.prototype,"userHasChangedValue",void 0),s([n()],T.prototype,"valid",null),s([n()],T.prototype,"value",null),s([n()],T.prototype,"visibilityCode",null),s([n()],T.prototype,"effectiveTimeZone",null),s([n()],T.prototype,"_evaluatedRequiredExpression",null),s([n()],T.prototype,"_hasIntersectionWithElementFieldDomain",void 0),s([n()],T.prototype,"_allDomains",null),s([n()],T.prototype,"_fieldShouldHaveDomain",null),s([n()],T.prototype,"_dateFormRange",null),s([n()],T.prototype,"_dateRange",null),T=s([M("esri.widgets.BatchAttributeForm.inputs.FieldInput")],T);const Dl=T;let yt=class extends ua{constructor(t){super(t),this.inputs=[],this.type="group"}initialize(){for(const t of this.inputs)t.group=this}get open(){return this.template.initialState==="expanded"}set open(t){this._override("open",t)}get visible(){return Sr(this.visibilityCode)&&this.inputs.some(t=>t.visible)}visibleForFeature(t){if(this.template.getExpressionExecutorsForLayer(t.layer)?.visibilityExpression==null)return!0;const i=this._lookupEvaluatedExpression(t,"visibility");return i?.status==="success"&&i.result===!0}};s([n()],yt.prototype,"inputs",void 0),s([n({readOnly:!0})],yt.prototype,"type",void 0),s([n()],yt.prototype,"open",null),s([n()],yt.prototype,"visible",null),yt=s([M("esri.widgets.BatchAttributeForm.inputs.GroupInput")],yt);const zl=yt;function mo(e,t,i){const r=e.elements.map(o=>pa(o,t,i));return new da({inputs:r,template:e})}function pa(e,t,i){const r=new Set(e.layers),o=t.filter(l=>r.has(l.layer)),a=o.length===t.length;if(ii(e))return new Dl({existsInAllLayers:a,features:o,template:e,expressionsManager:i});if(Hi(e)){const l=e.elements.map(c=>pa(c,t,i));return new zl({existsInAllLayers:a,features:o,inputs:l,template:e,expressionsManager:i})}throw new v("batch-attribute-form:unsupported-element-template","The type of form element template provided is not supported")}let Ge=class extends j{constructor(t){super(t),this.description=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}get elementsFlat(){const t=[];for(const i of this.elements)if(t.push(i),Hi(i))for(const r of i.elements)t.push(r);return t}get elementsInCommon(){const t=this.layers.length;return this.elements.filter(i=>i.layers.length===t)}get layers(){const t=new Set(this.elements.flatMap(i=>i.layers));return Array.from(t)}getExpressionExecutorsForLayer(t){const i=new Map;for(const r of this.elementsFlat)r.layers.includes(t)&&i.set(r,r.getExpressionExecutorsForLayer(t));return i}};s([n()],Ge.prototype,"description",void 0),s([n()],Ge.prototype,"elements",void 0),s([n()],Ge.prototype,"elementsFlat",null),s([n()],Ge.prototype,"elementsInCommon",null),s([n()],Ge.prototype,"layers",null),s([n()],Ge.prototype,"preserveFieldValuesWhenHidden",void 0),s([n()],Ge.prototype,"title",void 0),Ge=s([M("esri.widgets.BatchAttributeForm.templates.BatchFormTemplate")],Ge);const ri=Ge,go=new Map;async function Ul(e){return(e=We(e)?e.parent:e?.type==="feature"?e:null)?await ce(go,e,()=>{const i=On.createLoadedLayerContingentValuesCache(e);return e.addHandles({remove(){go.delete(e)}}),i})??null:null}async function ha({element:e,expressionInfos:t,provider:i}){const r={};if(e.visibilityExpression){const o=t.get(e.visibilityExpression);r.visibilityExpression=o?await i.getArcadeExecutor(o.expression):void 0}if("editableExpression"in e&&e.editableExpression){const o=t.get(e.editableExpression);r.editableExpression=o?await i.getArcadeExecutor(o.expression):void 0}if("requiredExpression"in e&&e.requiredExpression){const o=t.get(e.requiredExpression);r.requiredExpression=o?await i.getArcadeExecutor(o.expression):void 0}if("valueExpression"in e&&e.valueExpression){const o=t.get(e.valueExpression);r.valueExpression=o?await i.getArcadeExecutor(o.expression):void 0}return r}function Nl(e){return new Map(e?.map(t=>[t.name,t]))}function Gl(e){return e.type==="barcode-scanner"}function jl(e){return e.type==="combo-box"}function Bl(e){return e.type==="date-picker"}function Zl(e){return e.type==="datetime-picker"}function ql(e){return e.type==="datetimeoffset-picker"}function Jl(e){return e.type==="radio-buttons"}function Ql(e){return e.type==="switch"}function Kl(e){return e.type==="text-area"}function Yl(e){return e.type==="text-box"}function Xl(e){return e.type==="time-picker"}const oe="",ec="num:";function fa(e){return ii(e)?Ni(tc(e)).toString():Hi(e)?Ni(ic(e)).toString():Ni(JSON.stringify(e)).toString()}function tc(e){return`${ma(e)}.${oc(e.field)}.${ac(e.domain)}.${e.hint??oe}.${rc(e.input)}.${e.layerTimeZone??""}`}function ic(e){const t=ma(e)+`.${e.initialState}`;let i=oe;for(const r of e.elements)i+="."+fa(r).toString();return`${t}${i}`}function ma(e){return`${e.label??oe}.${e.description??oe}`}function rc(e){if(!e)return oe;const{type:t}=e;if(Gl(e))return t??oe;if(jl(e)||Jl(e)){const{showNoValueOption:i}=e;return`${t}.${i}.${e.noValueOptionLabel??oe}`}if(Bl(e))return`${t}.${Qi(e)}`;if(Zl(e)){const i=e.min?.getTime(),r=e.max?.getTime(),{includeTime:o}=e;return`${t}.${i}.${r}.${o}`}if(ql(e)){const i=Qi(e),{includeTimeOffset:r,timeResolution:o}=e;return`${t}.${i}.${r}.${o}`}if(Ql(e)){const{offValue:i,onValue:r}=e;return`${t}.${ur(i)}.${ur(r)}`}if(Kl(e)||Yl(e))return`${t}.${e.minLength?.toString()??oe}.${e.maxLength?.toString()??oe}`;if(Xl(e)){const i=Qi(e),{timeResolution:r}=e;return`${t}.${i}.${r}`}return JSON.stringify(e)}function Qi(e){return`${e.min??oe}.${e.max??oe}`}function oc(e){const t=e.name,i=e.alias??oe;return`${t}.${i===t?oe:i}.${e.nullable}.${e.type}.${e.length??oe}.${e.defaultValue??oe}.${e.description??oe}.${e.editable}.${e.visible}`}function ac(e){return e?e.type==="coded-value"?sc(e):e.type==="range"?nc(e):JSON.stringify(e):oe}function sc(e){const{type:t}=e;return`${t}.${e.codedValues.map(({code:i,name:r})=>`${ur(i)}.${r}`).sort().join(".")}`}function ur(e){return typeof e=="number"?`${ec}${e}`:e}function nc(e){const{maxValue:t,minValue:i,type:r}=e;return`${r}.${i}.${t}`}let Je=class extends ds{constructor(t){super(t),this.description=null,this.label=null,this._expressionExecutorsByLayer=new le}get elementId(){return fa(this)}get layers(){return Array.from(this._expressionExecutorsByLayer.keys())}addLayer(t,i=null){this._expressionExecutorsByLayer.set(t,i)}foldIn(t){for(const i of t.layers)this.addLayer(i,t.getExpressionExecutorsForLayer(i))}getExpressionExecutorsForLayer(t){return this._expressionExecutorsByLayer.get(t)??null}};s([n()],Je.prototype,"description",void 0),s([n({readOnly:!0})],Je.prototype,"elementId",null),s([n()],Je.prototype,"label",void 0),s([n({readOnly:!0})],Je.prototype,"layers",null),s([n({readOnly:!0})],Je.prototype,"type",void 0),s([n({clonable:e=>new le(Array.from(e))})],Je.prototype,"_expressionExecutorsByLayer",void 0),Je=s([M("esri.widgets.BatchAttributeForm.templates.ElementTemplateBase")],Je);let ke=class extends Je{constructor(t){super(t),this.domain=null,this.group=null,this.hint=null,this.input=null,this.type="field",this.layerTimeZone=null,this.formTimeZone=null}get fieldName(){return this.field.name}get hasValueCalculations(){for(const t of this.layers)if(this.getExpressionExecutorsForLayer(t)?.valueExpression)return!0;return!1}};s([n({clonable:"reference"})],ke.prototype,"domain",void 0),s([n({clonable:"reference",constructOnly:!0})],ke.prototype,"field",void 0),s([n()],ke.prototype,"fieldName",null),s([n({clonable:!1})],ke.prototype,"group",void 0),s([n()],ke.prototype,"hint",void 0),s([n()],ke.prototype,"input",void 0),s([n()],ke.prototype,"type",void 0),s([n()],ke.prototype,"layerTimeZone",void 0),s([n()],ke.prototype,"formTimeZone",void 0),s([n()],ke.prototype,"hasValueCalculations",null),ke=s([M("esri.widgets.BatchAttributeForm.templates.FieldElementTemplate")],ke);let Et=class extends Je{constructor(t){super(t),this.initialState="expanded",this.type="group"}initialize(){for(const t of this.elements)t.group=this}foldIn(t){const{elements:i}=this,r=t.elements;if(i.length!==r.length)throw new v("unable-to-fold-in","Unable to fold in the given GroupElementTemplate because it has a different number of child elements");for(const o of t.layers){this.addLayer(o,t.getExpressionExecutorsForLayer(o));for(let a=0;a<i.length;a++)i.at(a).foldIn(r.at(a))}}};s([n()],Et.prototype,"initialState",void 0),s([n({constructOnly:!0})],Et.prototype,"elements",void 0),s([n()],Et.prototype,"type",void 0),Et=s([M("esri.widgets.BatchAttributeForm.templates.GroupElementTemplate")],Et);const pr="expression/dea57012-47ca4b55a000-8df62742ed0c",ga=()=>z.getLogger("esri.widgets.BatchAttributeForm.templates.templateUtils");async function lc(e,t,i=e.formTemplate){return i?.elements&&i.elements.length>0?dc(i,e,t):cc(e,t)}async function cc(e,{arcadeExecutorProvider:t,formTimeZone:i}){const r=new Set(ps(e)),o={arcadeExecutorProvider:t,formTimeZone:i,layer:e},a=[];for(const c of e.fields)fc(c,e,r)&&a.push(hc(c,o));const l=await Promise.all(a);return new ri({elements:l,preserveFieldValuesWhenHidden:!0})}function ya(e,t){for(const i of e??[])if(i.type!=="group"){if(i.type==="field"&&(i.editable===!1&&!i.editableExpression||t.subtypeField&&(We(t)||tt(t))&&i.fieldName?.toLowerCase()===t.subtypeField.toLowerCase()))return!0}else if(ya(i.elements??[],t))return!0;return!1}async function dc(e,t,i){let r=null;ya(e.elements??[],t)&&(r=new us({title:"",name:pr,expression:"false"}));const o=Nl(r?[...e.expressionInfos??[],r]:e.expressionInfos),a={description:e.description,elements:new Array,title:e.title,preserveFieldValuesWhenHidden:e.preserveFieldValuesWhenHidden},{elements:l}=e;if(!l)return new ri(a);const{arcadeExecutorProvider:c,formTimeZone:d}=i;for(const u of l){const p=await wa(u,{arcadeExecutorProvider:c,expressionInfos:o,layer:t,formTimeZone:d});p&&a.elements.push(p)}return new ri(a)}async function wa(e,t){return hs(e)?uc(e,t):fs(e)?pc(e,t):(ga().warn(new v("batch-attribute-form:unsupported-element-type",`Form elements of type ${e.type} are not supported`)),null)}async function uc(e,{arcadeExecutorProvider:t,expressionInfos:i,layer:r,formTimeZone:o}){const{fieldsIndex:a}=r,{description:l,domain:c,fieldName:d,hint:u,input:p,label:h}=e;if(d==null||!a.has(d))return ga().warn(new v("batch-attribute-form:invalid-form-element-field",`Field element with label '${h}' does not refer to a valid field`)),null;const m={description:l,domain:c,field:a.get(d),hint:u,input:p,formTimeZone:o,layerTimeZone:va(r),label:h};e.editable!==!1||e.editableExpression||((e=e.clone()).editableExpression=pr),r.subtypeField&&(We(r)||tt(r))&&e.fieldName?.toLowerCase()===r.subtypeField.toLowerCase()&&((e=e.clone()).editableExpression=pr);const g=new ke(m),y=await ha({element:e,expressionInfos:i,provider:t});return g.addLayer(r,y),g}async function pc(e,t){const{arcadeExecutorProvider:i,expressionInfos:r,layer:o}=t,{description:a,label:l,initialState:c}=e,d={description:a,elements:[],label:l,initialState:c??"expanded"};for(const h of e.elements){const m=await wa(h,t);m&&d.elements.push(m)}const u=new Et(d),p=await ha({element:e,expressionInfos:r,provider:i});return u.addLayer(o,p),u}async function hc(e,{arcadeExecutorProvider:t,layer:i,formTimeZone:r}){const o=Yo(e,i)||e.name,a=new ke({field:e,label:o,formTimeZone:r,layerTimeZone:va(i)}),l={},c=(tt(i)||We(i))&&i.subtypeField&&i.subtypeField.toLowerCase()===e.name.toLowerCase();return!c&&e.editable&&i.userHasUpdateItemPrivileges&&(l.editableExpression=await t.getArcadeExecutor("true")),c&&(l.editableExpression=await t.getArcadeExecutor("false")),a.addLayer(i,l),a}function fc(e,t,i){return!i.has(e.name.toLowerCase())&&ms(e,t)}function va(e){return We(e)&&e.parent&&(e=e.parent),e&&"datesInUnknownTimezone"in e&&e.datesInUnknownTimezone?wi:e&&"preferredTimeZone"in e&&e.preferredTimeZone?e.preferredTimeZone:null}function mc(e,t){return e?.find(i=>i.layer===t)}let E=class extends Ir{constructor(t){super(t),this.activeFeatureIndex=-1,this.disabled=!1,this.editType="NA",this.features=new ye,this._hasAsyncArcadeExpressions=!1,this.maximumFeatureCount=2e3,this.maximumFeatureCountWithComplexForms=50,this.map=null,this.readOnly=!1,this.spatialReference=null,this.submitHasBeenAttempted=!1,this.timeZone=null,this.userHasChangedValues=!1,this.layerInfos=null,this._arcadeExecutorProvider=new Fl,this._activeFormInputsByElementId=new Map,this._emptyForm=new da({inputs:[]}),this._emptyFormTemplate=new ri({elements:[]}),this._featureFormMap=new Map,this._prepareTask=null,this._reactiveGraphicLookup=new le,this._updatingHandles=new Dt,this._layerTemplateMap=new le,this._layerContingentValuesMap=new le,this._workingFeatures=new ye,this._expressionsManager=new qe({arcadeContext:{editType:"NA",spatialReference:null,map:null,timeZone:gs}}),this.sharedForm=this._emptyForm,this.sharedFormTemplate=this._emptyFormTemplate}initialize(){this.addHandles([Z(()=>this.features,"after-changes",()=>this._prepare(),{sync:!0}),x(()=>[this.features,this.map,this.timeZone,this.editType],()=>this._prepare(),Pt),x(()=>this.activeForm,()=>this._activeFormInputsByElementId.clear(),Pt)]),this._prepare()}destroy(){this._prepareTask=De(this._prepareTask),this._workingFeatures.destroyAll(),this._expressionsManager&&this._expressionsManager.abort(),this._reactiveGraphicLookup=new le,this._emptyForm.destroy(),this._emptyFormTemplate.destroy()}get _effectiveTimeZone(){return this.timeZone??"system"}get activeFeature(){const t=this.activeFeatureIndex;return t<0?null:this.features.at(t)}get activeForm(){if(this.mode==="batch")return this.sharedForm;const t=this._workingFeatures.at(this.activeFeatureIndex);if(!t)return this._emptyForm;const i=this._featureFormMap.get(t);if(i)return i;const r=this._makeBatchFormInputsForFeature(t);return r!==this._emptyForm&&this._featureFormMap.set(t,r),r}get calculating(){return this._expressionsManager.calculating}get expressionEvaluationFailed(){return this._expressionsManager.expressionEvaluationFailed}get hasNonActiveInvalidFeatures(){if(this.mode==="batch")return!1;const{activeFeature:t}=this;return this.invalidFeatures.some(i=>i!==t)}get hasAsyncArcadeExpressions(){return this._hasAsyncArcadeExpressions}get hasTooManyFeatures(){return this._workingFeatures.length>this.maximumFeatureCount}get hasTooManyComplexFeatures(){return this._workingFeatures.length>this.maximumFeatureCountWithComplexForms&&this.hasAsyncArcadeExpressions}get invalidFeatures(){return this.sharedForm.invalidFeatures}get hasVisibleInputs(){return this.visibleInputs.length>0}get hasLayersWithContingentValues(){for(const t of this.layers){const i=this._layerContingentValuesMap.get(t);if(i&&i.size>0)return!0}return!1}get visibleInputs(){return this.activeForm.inputs.filter(t=>t.visible)}get noVisibleElementsReason(){if(this.hasVisibleInputs)return null;if(this.activeForm.inputs.length===0)return"noElements";const t=new Set;for(const i of this.activeForm.inputs)switch(i.visibilityCode){case"hidden:not-in-all-layers":case"hidden:no-domain-in-common":t.add("noElementsInCommon");break;case"hidden:field-definition":case"hidden:group-visibility-expression:all-features":case"hidden:visibility-expression:all-features":t.add("allElementsHidden");break;case"hidden:group-visibility-expression:some-features":case"hidden:visibility-expression:some-features":return"elementsHiddenInSome"}return t.has("allElementsHidden")?"allElementsHidden":"noElementsInCommon"}get status(){const t=this._prepareTask;return t==null?"not-loaded":t.finished?t.error!=null?"failed":"loaded":"loading"}get submittable(){return this.valid,!0}get updating(){return this._updatingHandles.updating||this.calculating}get valid(){return this.sharedForm.valid}get layers(){const t=new Set;return this.features.forEach(i=>{const r=i.sourceLayer??i.layer;t.add(r)}),Array.from(t)}get mode(){return this.activeFeatureIndex>-1?"single":"batch"}submit(){this.submitHasBeenAttempted=!0,this.emit("submit",{name:"submit",results:this._makeSubmitResults(),valid:this.valid})}findFieldInput(t){if(t==null)return;const i=this._activeFormInputsByElementId;if(i.has(t))return i.get(t);const r=this.activeForm.allFieldInputs.find(o=>o.template.elementId===t);return r!==void 0?(i.set(t,r),r):void 0}getFirstVisibleInvalidFieldInput(){if(this.hasVisibleInputs&&!this.activeForm.valid)for(const t of this.visibleInputs){if(Lr(t)){const i=t.inputs.find(r=>!r.valid);if(i)return{input:i,groupInput:t}}if(Li(t)&&!t.valid)return{input:t}}}getFieldInputValue(t){return this.findFieldInput(t)?.value}getValues(t){const i=this._reactiveGraphicLookup.get(t);if(!i)throw new v("feature-not-found","The given feature is not present in the BatchAttributeForm");return{...i.attributes}}notifyGeometriesChanged(t){const i=[];for(const r of t){const o=this._reactiveGraphicLookup.get(r);o&&(i.push(o),o.geometry=r.geometry)}this._expressionsManager.runGeometryDependentExpressions(i)}async setFieldInputValue(t,i){const r=new Set(this.invalidFeatures);await t.setValueFromUser(i),this.userHasChangedValues=!0,this._trackValidityChange(r),this.emit("value-change",{features:t.features.toArray().map(o=>o.source),fieldName:t.fieldName,name:"value-change",value:i})}async setValue(t,i){const r=this.findFieldInput(t);if(r==null)throw new v("no-FieldInput-found",`Cannot set the value of FieldInput with ID: ${t} because none was found in the active form`);await this.setFieldInputValue(r,i)}userChangesHaveMadeFeatureInvalid(t){return!!this._reactiveGraphicLookup.get(t)?.userChangesHaveMadeInvalid}async _trackValidityChange(t){await O(()=>this.calculating===!1);const i=this.invalidFeatures;for(const r of i)t.has(r)===!1&&this._reactiveGraphicLookup.has(r)&&(this._reactiveGraphicLookup.get(r).userChangesHaveMadeInvalid=!0)}validate(){return!1}_makeBatchFormInputsForFeature(t){const i=this._layerTemplateMap.get(t.layer);return i?mo(i,new ye([t]),this._expressionsManager):this._emptyForm}_makeSubmitResults(){const t=new Map;for(const[i,r]of this._reactiveGraphicLookup)t.set(i,{feature:i,values:{...r.attributes},invalidFields:[]});for(const i of this.sharedForm.allFieldInputs)for(const r of i.invalidFeatures)t.get(r)?.invalidFields.push(i.fieldName);return Array.from(t.values())}_prepare(){this._hasAsyncArcadeExpressions=!1,this._prepareTask=De(this._prepareTask),this._updateWorkingFeatures(),De(this._expressionsManager),this.userHasChangedValues=!1,this._expressionsManager=new qe({arcadeContext:{editType:this.editType,spatialReference:this.spatialReference??ys.WebMercator,map:this.map,timeZone:this._effectiveTimeZone}});const{layers:t}=this;if(t.length===0)return;const i=Ti(async r=>{try{pt(r);const o=new Map;for(const l of t){const c=await Ul(l);if(c){const h=c.fieldGroups.flatMap(m=>m.fields);this._layerContingentValuesMap.set(l,new Set(h))}else this._layerContingentValuesMap.set(l,new Set);const d=mc(this.layerInfos,l),u=await lc(l,{arcadeExecutorProvider:this._arcadeExecutorProvider,formTimeZone:this._effectiveTimeZone},d?.formTemplate);this._layerTemplateMap.set(l,u);const p=u.getExpressionExecutorsForLayer(l);if(this._expressionsManager.layerExpressionsModelMap.set(l,new El({preserveFieldValuesWhenHidden:u.preserveFieldValuesWhenHidden,executorMap:p})),!this._hasAsyncArcadeExpressions)for(const h of p.keys()){const m=p.get(h);if(this._hasAsyncArcadeExpressions=(m.editableExpression?.isAsync||m.requiredExpression?.isAsync||m.valueExpression?.isAsync||m.visibilityExpression?.isAsync)===!0,this._hasAsyncArcadeExpressions)break}for(const h of u.elements){const{elementId:m}=h;o.has(m)?o.get(m).foldIn(h):o.set(m,h.clone())}}if(this.hasTooManyComplexFeatures)throw new v("too-many-features-with-complex-forms","There are too many features to load into the form with the configured complexity");if(this.hasTooManyFeatures)throw new v("too-many-features","There are too many features to load into the form.");const a=new ri({elements:Array.from(o.values())});this.sharedFormTemplate=a,this.sharedForm=mo(a,this._workingFeatures,this._expressionsManager),await this._expressionsManager.runAllExpressions(this._workingFeatures.toArray())}catch(o){throw z.getLogger(this).error("Failed preparing form",o),o}});this._updatingHandles.addPromise(i.promise),this._prepareTask=i}_updateWorkingFeatures(){this._workingFeatures.destroyAll();const{features:t}=this;if(this._reactiveGraphicLookup=new le,t.length!==0){this._workingFeatures.addMany(t.map(vl));for(const i of this._workingFeatures)this._reactiveGraphicLookup.set(i.source,i)}}};s([n()],E.prototype,"_effectiveTimeZone",null),s([n({readOnly:!0})],E.prototype,"activeFeature",null),s([n()],E.prototype,"activeFeatureIndex",void 0),s([n({readOnly:!0})],E.prototype,"activeForm",null),s([n()],E.prototype,"disabled",void 0),s([n()],E.prototype,"calculating",null),s([n()],E.prototype,"editType",void 0),s([n()],E.prototype,"features",void 0),s([n()],E.prototype,"expressionEvaluationFailed",null),s([n()],E.prototype,"hasNonActiveInvalidFeatures",null),s([n()],E.prototype,"hasAsyncArcadeExpressions",null),s([n()],E.prototype,"_hasAsyncArcadeExpressions",void 0),s([n()],E.prototype,"invalidFeatures",null),s([n()],E.prototype,"hasVisibleInputs",null),s([n()],E.prototype,"hasLayersWithContingentValues",null),s([n()],E.prototype,"maximumFeatureCount",void 0),s([n()],E.prototype,"maximumFeatureCountWithComplexForms",void 0),s([n()],E.prototype,"visibleInputs",null),s([n()],E.prototype,"map",void 0),s([n()],E.prototype,"noVisibleElementsReason",null),s([n()],E.prototype,"readOnly",void 0),s([n()],E.prototype,"spatialReference",void 0),s([n()],E.prototype,"submitHasBeenAttempted",void 0),s([n()],E.prototype,"timeZone",void 0),s([n()],E.prototype,"updating",null),s([n()],E.prototype,"valid",null),s([n()],E.prototype,"layers",null),s([n()],E.prototype,"mode",null),s([n()],E.prototype,"sharedForm",void 0),s([n()],E.prototype,"sharedFormTemplate",void 0),s([n()],E.prototype,"userHasChangedValues",void 0),s([n()],E.prototype,"layerInfos",void 0),s([n()],E.prototype,"_arcadeExecutorProvider",void 0),s([n()],E.prototype,"_prepareTask",void 0),s([n()],E.prototype,"_reactiveGraphicLookup",void 0),s([n()],E.prototype,"_layerTemplateMap",void 0),s([n()],E.prototype,"_layerContingentValuesMap",void 0),s([n()],E.prototype,"_workingFeatures",void 0),s([n()],E.prototype,"_expressionsManager",void 0),E=s([M("esri.widgets.BatchAttributeForm.BatchAttributeFormViewModel")],E);const _a=E,at="esri-batch-attribute-form",Ki=`${at}__group`,mt=`${at}__input`,W={base:at,noticeError:`${at}__notice-error`,label:`${at}__label`,labelTextContent:`${at}__label-text-content`,fieldInput:`${mt}`,inputRadio:`${mt}--radio`,placeholderRadio:`${mt}--radio-placeholder`,inputRadioGroup:`${mt}--radio-group`,inputRadioLabel:`${mt}--radio-label`,inputDisabled:`${mt}--disabled`,inputSwitch:`${mt}--switch`,description:`${at}__description-text`,dateInputContainer:`${`${at}__date`}-input-container`,group:Ki,groupSequential:`${Ki}--sequential`,individualElement:`${Ki}__individual-element`};let Xe=class extends j{constructor(t){super(t),this.errorsForNonVisibleFields=!0,this.featureInfo=!0,this.featureSwitcher=!0,this.loadingIndicator=!0}};s([n({type:Boolean,nonNullable:!0})],Xe.prototype,"errorsForNonVisibleFields",void 0),s([n({type:Boolean,nonNullable:!0})],Xe.prototype,"featureInfo",void 0),s([n({type:Boolean,nonNullable:!0})],Xe.prototype,"featureSwitcher",void 0),s([n({type:Boolean,nonNullable:!0})],Xe.prototype,"loadingIndicator",void 0),Xe=s([M("esri.widgets.BatchAttributeForm.VisibleElements")],Xe);const Ue="data-element-id";let H=class extends si{constructor(t,i){super(t,i),this.headingLevel=2,this.messagesCommon=null,this.messages=null,this.featureFormMessages=null,this.viewModel=new _a,this.visibleElements=new Xe,this.groupDisplay="all",this._attemptFocusOnNextRender=!1,this._dateComponentMap=new Map,this._touchedInputs=new Set,this._focusedFieldInput=null,this._batchSwitchInputInitialValues=new Map,this._saveInput=this._saveInput.bind(this),this._onFormSubmit=this._onFormSubmit.bind(this),this._onComponentFocus=this._onComponentFocus.bind(this),this._onComponentBlur=this._onComponentBlur.bind(this),this._afterComponentCreateOrUpdate=this._afterComponentCreateOrUpdate.bind(this),this._afterDateComponentCreate=this._afterDateComponentCreate.bind(this),this._afterRadioGroupCreateOrUpdate=this._afterRadioGroupCreateOrUpdate.bind(this)}initialize(){this.addHandles([x(()=>this.features,()=>{this._dateComponentMap.clear()}),x(()=>this.viewModel.activeForm,()=>{this._batchSwitchInputInitialValues.clear()}),Z(()=>this.viewModel,"submit",()=>{this.valid||this.goToClosestError()})])}loadDependencies(){return Pe({input:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OY),__vite__mapDeps([1,2])),block:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OW),__vite__mapDeps([1,2])),button:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OG),__vite__mapDeps([1,2])),combobox:()=>_(()=>import("./index-Df8y7Bmz.js"),__vite__mapDeps([6,1,2,7,8])),"combobox-item":()=>_(()=>import("./index-Dwxj2UE3.js"),__vite__mapDeps([7,1,2,8])),"combobox-item-group":()=>_(()=>import("./index-DMhv2Rxw.js"),__vite__mapDeps([9,1,2,8])),dropdown:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OT),__vite__mapDeps([1,2])),"dropdown-group":()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OV),__vite__mapDeps([1,2])),"dropdown-item":()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OU),__vite__mapDeps([1,2])),"input-date-picker":()=>_(()=>import("./index-Dk659Oi9.js"),__vite__mapDeps([10,1,2,11])),"input-number":()=>_(()=>import("./index-DolGN-Zc.js"),__vite__mapDeps([12,1,2])),"input-time-picker":()=>_(()=>import("./index-DCTkqeOC.js"),__vite__mapDeps([13,1,2])),"input-time-zone":()=>_(()=>import("./index-Bw6DDd_M.js"),__vite__mapDeps([14,1,2,7,8,6,9])),label:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.P7),__vite__mapDeps([1,2])),"input-message":()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OX),__vite__mapDeps([1,2])),loader:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OF),__vite__mapDeps([1,2])),notice:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.P3),__vite__mapDeps([1,2])),switch:()=>_(()=>import("./index-BuREWvaP.js"),__vite__mapDeps([15,1,2])),"text-area":()=>_(()=>import("./index-BgTwaj8G.js"),__vite__mapDeps([16,1,2,17])),"radio-button":()=>_(()=>import("./index-IGA6vAz5.js"),__vite__mapDeps([18,1,2])),"radio-button-group":()=>_(()=>import("./index-DM5di0oO.js"),__vite__mapDeps([19,1,2]))})}get activeFeatureIndex(){return this.viewModel.activeFeatureIndex}set activeFeatureIndex(t){this.viewModel.activeFeatureIndex=t}get disabled(){return this.viewModel.disabled}set disabled(t){this.viewModel.disabled=t}get _effectiveDisabled(){return this.disabled||this.viewModel.updating}get features(){return this.viewModel.features}set features(t){this.viewModel.features=t}get map(){return this.viewModel.map}set map(t){this.viewModel.map=t}get maximumFeatureCount(){return this.viewModel.maximumFeatureCount}set maximumFeatureCount(t){this.viewModel.maximumFeatureCount=t}get maximumFeatureCountWithComplexForms(){return this.viewModel.maximumFeatureCountWithComplexForms}set maximumFeatureCountWithComplexForms(t){this.viewModel.maximumFeatureCountWithComplexForms=t}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(t){this.viewModel.spatialReference=t}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(t){this.viewModel.layerInfos=t}get timeZone(){return this.viewModel.timeZone}set timeZone(t){this.viewModel.timeZone=t}get icon(){return"edit-attributes"}set icon(t){this._overrideIfSome("icon",t)}get readOnly(){return this.viewModel.readOnly}set readOnly(t){this.viewModel.readOnly=t}get valid(){return this.viewModel.valid}goToClosestError(){const t=this.viewModel.getFirstVisibleInvalidFieldInput();if(!t)return;const{groupInput:i}=t;i&&(i.open||(i.open=!0)),this._focusedFieldInput=t.input,this._attemptFocusOnNextRender=!0,this.scheduleRender()}render(){const{status:t}=this.viewModel;return t==="failed"?this.viewModel.hasTooManyComplexFeatures?this._renderErrorNotice(X(this.messages.formFailedToLoadTooManyComplexFeatures,{num:this.viewModel.maximumFeatureCountWithComplexForms})):this.viewModel.hasTooManyFeatures?this._renderErrorNotice(X(this.messages.formFailedToLoadTooManyFeatures,{num:this.viewModel.maximumFeatureCount})):this._renderErrorNotice(this.messages.formFailedToLoad):this.viewModel.expressionEvaluationFailed?this._renderErrorNotice(this.messages.expressionEvaluationFailed):this.viewModel.hasLayersWithContingentValues?this._renderErrorNotice(this.messages.unsupportedContingentValues):f("div",{class:this.classes(W.base,st.widget,st.panel)},t==="loaded"?this._renderForm():t==="loading"&&this.visibleElements.loadingIndicator?f("calcite-loader",{key:"loader",label:this.messagesCommon?.loading}):null)}submit(){this.viewModel.submit()}_setDateTimeTimeZoneMap(t){const{datePart:i,elementId:r}=t.dataset,o=ce(this._dateComponentMap,`${r}`,()=>({}));switch(i){case"date":o.date=t;break;case"time":o.time=t;break;case"timeZone":o.timeZone=t}}_renderErrorNotice(t){return f("div",{class:this.classes(W.base,st.widget,st.panel)},f("calcite-notice",{class:W.noticeError,icon:!0,kind:"warning",open:!0},f("div",{slot:"message"},t)))}_renderForm(){return f("form",{onsubmit:this._onFormSubmit},this._renderInvisibleFieldsError(),this._renderContent())}_renderInvisibleFieldsError(){const{viewModel:t}=this,{hasNonActiveInvalidFeatures:i,activeForm:r}=t;let o;if(!t.submitHasBeenAttempted)return null;if(r.invalidHiddenInputs.length>0)if(o=bl(r,t.mode,this.messages),this.viewModel.mode==="batch"){const a=r.invalidHiddenInputs.filter(l=>l.effectiveVisibilityCode==="hidden:group-visibility-expression:all-features"||l.visibilityCode==="hidden:visibility-expression:all-features");a.length>0?o+=` (${a.map(l=>l.label).join(", ")})`:o=null}else o+=` (${r.invalidHiddenInputs.map(a=>a.label).join(", ")})`;else if(i)return null;return o?f("calcite-notice",{class:W.noticeError,icon:!0,kind:"danger",open:!0},f("div",{slot:"message"},o)):null}_renderContent(){if(!this.viewModel.hasVisibleInputs)return[f("calcite-notice",{class:W.noticeError,icon:!0,kind:"warning",open:!0},f("div",{slot:"message"},this.messages.noVisibleFields[this.viewModel.noVisibleElementsReason]))];const{inputs:t}=this.viewModel.activeForm;return t.filter(i=>i.visible).map(i=>this._renderInput(i))}_renderInput(t){return Lr(t)?this._renderGroupInput(t):Li(t)?this._renderLabeledField(t):void 0}_renderGroupInput(t){const{inputs:i,template:r,open:o}=t,a=i.filter(c=>c.visible),l=r.label??"";return f("calcite-block",{class:this.classes(W.group,this.groupDisplay==="sequential"?W.groupSequential:null,this.disabled?W.inputDisabled:null),collapsible:!0,description:r.description??void 0,disabled:this._effectiveDisabled,expanded:o,heading:l,headingLevel:this.headingLevel,key:`{${r.elementId}-key}`,label:l,onCalciteBlockClose:()=>{t.open=!1},onCalciteBlockOpen:()=>{t.open=!0}},a.map(c=>this._renderInput(c)))}_renderLabeledField(t){const{elementId:i}=t.template,{label:r,required:o,dataType:a}=t,l=o?X(this.messages.requiredFieldLabel,{name:r}):r;return f("calcite-label",{"aria-label":l,class:W.label,key:`field--${i}`},f("div",{class:W.labelTextContent,key:"labelTextContainer"},r,o?f("span",{"aria-hidden":"true",title:this.messagesCommon.required},"*"):void 0),a!=="unsupported"?this._renderFieldInput(t):this._renderReadOnlyComponent(t),this._renderAuxiliaryText(t))}_renderFieldInput(t){const i=this.getCommonInputProps(t),{dataType:r}=t;return r==="date"?this._renderDateComponents(t,i):t.domain?.type==="coded-value"?this._renderCodedInputs({input:t,props:i}):r==="number"?this._renderNumberComponent(t,i):this._renderStringComponent(t,i)}_renderAuxiliaryText(t){const{compositeError:i,description:r,submittable:o}=t,a=!o&&i&&(this.viewModel.submitHasBeenAttempted||this._touchedInputs.has(t.template.elementId))?_l(t,i,this.messages):null;return a?f("calcite-input-message",{icon:!0,status:"invalid"},a):r?f("calcite-input-message",{class:W.description,icon:!1,status:"idle"},r):null}_renderCodedInputs({input:t,props:i}){const r=t.template.input?.type??null,o=t.codedValueOptions;switch(r){case"switch":return this._renderSwitchField({input:t,props:i});case"radio-buttons":return this._renderRadioButtonGroupComponent({input:t,options:o.flat(),props:i});default:return this._renderComboBoxComponent({options:o,props:i,input:t})}}_renderSwitchField({input:t,props:i}){if((this._batchSwitchInputInitialValues.get(t)===J||t.value===J)&&this.viewModel.mode==="batch"){const r={dropdown:{afterCreate:this._afterComponentCreateOrUpdate,afterUpdate:this._afterComponentCreateOrUpdate,disabled:i.readOnly,open:!1,[Ue]:i[Ue]},trigger:{appearance:"transparent",iconEnd:"chevron-down",kind:"neutral",slot:"trigger",label:i.label},group:{mode:"single"}};return this._renderDropdownComponent({buttonValue:t.value,dropdownProps:r,options:[{name:this.messages.differentValuesPlaceholder,value:J,disabled:!0},...t.codedValueDomainOptions]})}return this._renderSwitchComponent({input:t,props:i})}_renderSwitchComponent({input:t,props:i}){return f("calcite-switch",{...i,checked:!!Ji(t.template,"switch")&&t.value===t.template.input.onValue,class:W.inputSwitch,disabled:i.readOnly,onblur:()=>{this._focusedFieldInput=null},onCalciteSwitchChange:({currentTarget:r})=>this._saveInput(r)})}_renderDropdownComponent({buttonValue:t,options:i,dropdownProps:r}){const{trigger:o,dropdown:a,group:l}=r;return f("calcite-dropdown",{...a,onblur:()=>{this._focusedFieldInput=null},onfocus:this._onComponentFocus,onCalciteDropdownSelect:({currentTarget:c})=>this._saveInput(c)},f("calcite-button",{...o},t===J?this.messages.differentValuesPlaceholder:t),f("calcite-dropdown-group",{selectionMode:l.mode},i.map(c=>f("calcite-dropdown-item",{disabled:c.disabled,label:String(c.name),selected:t===c.value},c.name))))}_renderComboBoxComponent({input:t,options:i,props:r}){const o=this.viewModel.editType==="INSERT",a=this._touchedInputs.has(t?.template?.elementId),l=o&&t.showNoValueOptionEnabled&&!a?()=>{}:r.onblur,c={...r,onblur:l};return f("calcite-combobox",{...c,selectionMode:"single",value:r.placeholder===this.messages.differentValuesPlaceholder?J:String(r.value),onCalciteComboboxChange:({currentTarget:d})=>{d.value!==J&&this._saveInput(d)}},this.renderComboboxOptionsList({input:t,options:i,props:r}))}renderComboboxOptionsList({input:t,options:i,props:r}){const[o,a]=i.map(u=>u.map(({name:p,value:h})=>f("calcite-combobox-item",{key:`#${h}`,selected:r.value===h,textLabel:p,value:`${h}`}))),l=[...o];a.length>0&&l.push(f("calcite-combobox-item-group",{key:"unsupported",label:this.featureFormMessages.subtypes.unsupportedDomainGroupTitle},a));const c=r.placeholder===this.messages.differentValuesPlaceholder,d=!c&&cr(r.value);return t.showNoValueOptionEnabled&&l.unshift(f("calcite-combobox-item",{key:"empty-option",selected:d,textLabel:t.showNoValueLabel||this.messages.empty,value:""})),c&&l.unshift(f("calcite-combobox-item",{key:J,selected:!0,textLabel:this.messages.differentValuesPlaceholder,value:J})),l}_renderRadioButtonGroupComponent({input:t,options:i,props:r}){const o=i.map(({name:a,value:l})=>this._renderRadioButtons({label:a,value:l,selected:l===t.value,props:r}));if(t.showNoValueOptionEnabled){const l=t.showNoValueLabel||this.messages.empty,c=cr(t.value);o.unshift(this._renderRadioButtons({label:l,value:"",selected:c,props:r}))}return f("calcite-radio-button-group",{afterCreate:this._afterRadioGroupCreateOrUpdate,afterUpdate:this._afterRadioGroupCreateOrUpdate,class:W.inputRadioGroup,disabled:r.readOnly,key:`${r.key}-radio-group`,layout:"vertical",name:r.name,required:r.required},o,r.placeholder===this.messages.differentValuesPlaceholder?f("calcite-label",{class:W.placeholderRadio,key:r.label,layout:"inline"},f("calcite-radio-button",{checked:!0,class:W.inputRadio,disabled:!0,name:r.placeholder,value:r.placeholder}),r.placeholder):null)}_renderRadioButtons({value:t,selected:i,label:r,props:o}){return f("calcite-label",{class:W.inputRadioLabel,key:o.label,layout:"inline"},f("calcite-radio-button",{...o,afterCreate:void 0,afterUpdate:void 0,checked:i,class:W.inputRadio,disabled:o.readOnly,name:o.label,onblur:()=>{this._focusedFieldInput=null},value:t,onCalciteRadioButtonChange:({currentTarget:a})=>{a.checked&&this._saveInput(a)}}),r)}_renderStringComponent(t,i){const{template:r}=t;return!r.field.editable||this.readOnly?this._renderReadOnlyComponent(t):r.input&&r.input.type==="text-area"?f("calcite-text-area",{...i,class:this.classes(W.individualElement),resize:"vertical",value:i.value?String(i.value):"",onCalciteTextAreaInput:({currentTarget:o})=>this._saveInput(o)}):f("calcite-input",{...i,class:this.classes(W.individualElement),type:"text",value:i.value?String(i.value):"",onCalciteInputInput:({currentTarget:o})=>this._saveInput(o)})}_renderNumberComponent(t,i){const r=ws(t.field);return f("calcite-input-number",{...i,integer:r,type:"number",value:r&&i.value!==""?Math.round(parseFloat(String(i.value))).toString():String(i.value),onCalciteInputNumberInput:({currentTarget:o})=>this._saveInput(o)})}_renderReadOnlyComponent(t,i){const r=this.getCommonInputProps(t);return f("calcite-input",{...r,class:this.classes(W.fieldInput,W.inputDisabled,W.individualElement),readOnly:!0,type:"text",value:String(i??r.value??"")})}_renderDateComponents(t,i){const{field:r}=t;let o;switch(r.type){case"date":o=this._renderDateFieldComponents(t,i);break;case"date-only":o=this._renderDateOnlyFieldComponent(t,i);break;case"time-only":o=this._renderTimeOnlyFieldComponent(t,i);break;case"timestamp-offset":o=this._renderTimestampOffsetFieldComponents(t,i);break;default:o=this._renderReadOnlyComponent(t,Tn(r,i.value,{timeZone:t.effectiveTimeZone,...Ko(t.template.field)}))}return t.value===J?[o,f("calcite-input-message",{icon:"information",key:"diff-values-message",status:"idle"},this.messages.differentValues)]:o}_renderDateOnlyFieldComponent(t,i){const{class:r,key:o,readOnly:a}=i,{rawMax:l,rawMin:c}=t.range;return f("calcite-input-date-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterComponentCreateOrUpdate,class:r,"data-date-part":"date","data-element-id":i[Ue],key:`${o}-date-input`,max:io(l)?l:void 0,min:io(c)?c:void 0,onblur:()=>{this._focusedFieldInput=null},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:a,value:t.value===J?"":t.value?String(t.value):"",onCalciteInputDatePickerChange:d=>this._saveValueFromDateComponent(t,d.currentTarget)})}_renderTimeOnlyFieldComponent(t,i){const{class:r,key:o,readOnly:a}=i;return f("calcite-input-time-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterComponentCreateOrUpdate,class:r,"data-date-part":"time","data-element-id":i[Ue],key:`${o}-time-input`,onblur:()=>{this._focusedFieldInput=null},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:a,value:t.value===J?"":t.value?String(t.value):"",onCalciteInputTimePickerChange:l=>this._saveValueFromDateComponent(t,l.currentTarget)})}_renderTimestampOffsetFieldComponents(t,i){const{class:r,key:o,readOnly:a}=i,{rawMax:l,rawMin:c}=t.range,d=Zi(l),u=Zi(c),p=Zi(t.value===J?"":t.value),h=t.includeTimeOffset,m={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterComponentCreateOrUpdate,overlayPositioning:"fixed",readOnly:a,[Ue]:i[Ue],onfocus:this._onComponentFocus};return f("div",{class:W.dateInputContainer,key:`${o}-date-time-container`},f("calcite-input-date-picker",{...m,class:r,"data-date-part":"date",key:`${o}-date-input`,max:d?.date??void 0,min:u?.date??void 0,onblur:()=>{this._focusedFieldInput=null},value:p.date??"",onCalciteInputDatePickerChange:g=>this._saveValueFromDateComponent(t,g.target)}),f("calcite-input-time-picker",{...m,class:r,"data-date-part":"time",key:`${o}-time-input`,onblur:()=>{this._focusedFieldInput=null},value:p.time??"",onCalciteInputTimePickerChange:g=>this._saveValueFromDateComponent(t,g.target)}),h?f("calcite-input-time-zone",{...m,class:r,clearable:t.value===J||t.value==null,"data-date-part":"timeZone",key:`${o}-timezone-input`,onblur:()=>{this._focusedFieldInput=null},value:p.timeZoneOffset||"",onCalciteInputTimeZoneChange:g=>this._saveValueFromDateComponent(t,g.target)}):null)}_renderDateFieldComponents(t,i){const{class:r,key:o,readOnly:a,min:l,max:c}=i,d=t.effectiveTimeZone,u=qi(t.value===J?"":t.value,d),p=qi(c,d),h=qi(l,d),m=t.includeTime,g={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterComponentCreateOrUpdate,overlayPositioning:"fixed",readOnly:a,[Ue]:i[Ue],onfocus:this._onComponentFocus};return f("div",{class:W.dateInputContainer,key:`${o}-date-time-container`},f("calcite-input-date-picker",{...g,class:r,"data-date-part":"date",key:`${o}-date-input`,max:p?.date??void 0,min:h?.date??void 0,onblur:()=>{this._focusedFieldInput=null},value:u.date??"",onCalciteInputDatePickerChange:y=>this._saveValueFromDateComponent(t,y.target)}),m?f("calcite-input-time-picker",{...g,"data-date-part":"time",key:`${o}-time-input`,onblur:()=>{this._focusedFieldInput=null},step:1,value:u.time??"",onCalciteInputTimePickerChange:y=>{this._saveValueFromDateComponent(t,y.target)}}):null)}getCommonInputProps(t){const{template:i,valid:r,value:o,minLength:a,maxLength:l,required:c,fieldName:d,editable:u,userHasChangedValue:p,range:{max:h,min:m}}=t,g=!u||this.readOnly,y=!g&&this._effectiveDisabled;let b=i.hint??void 0,w=!1;return o===J&&(b=this.messages.differentValuesPlaceholder,w=!0),{afterCreate:this._afterComponentCreateOrUpdate,afterUpdate:this._afterComponentCreateOrUpdate,"aria-invalid":r?"false":"true",class:this.classes(W.fieldInput,g?W.inputDisabled:null),status:!p&&!this.viewModel.submitHasBeenAttempted||r?"idle":"invalid",maxLength:l&&l>-1?l:void 0,minLength:a&&a>-1?a:void 0,key:i.elementId,label:d,name:d,max:h??void 0,min:m??void 0,disabled:y,readOnly:g,onblur:this._onComponentBlur,required:c,placeholder:b,value:w?"":o??"",[Ue]:i.elementId,onfocus:this._onComponentFocus}}_onFormSubmit(t){t.preventDefault()}_getFieldInputFromHTMLElement(t){return this.viewModel.findFieldInput(t.getAttribute(Ue))}_afterRadioGroupCreateOrUpdate(t){const i=t.selectedItem,r=t.querySelector("calcite-radio-button"),o=i||r;o&&this._afterComponentCreateOrUpdate(o)}_onComponentFocus(t){const i=t.target,r=this._getFieldInputFromHTMLElement(i);this._touchedInputs.add(r.template.elementId),this._focusedFieldInput=r}_afterComponentCreateOrUpdate(t){const i=this._getFieldInputFromHTMLElement(t),r=this._focusedFieldInput;this._attemptFocusOnNextRender&&r===i&&(this._attemptFocusOnNextRender=!1,vs(t))}_onComponentBlur(){this._focusedFieldInput=null}_parseValue(t,i){if(Ji(i.template,"switch")){if(t.localName==="calcite-dropdown"&&i.domain){for(const o of i.domain.codedValues)if(o.name===t.selectedItems[0].textContent)return o.code}return t.checked?i.template.input.onValue:i.template.input.offValue}const r=t.value;return r==null||r===""?null:i.dataType==="number"?r==="-0"||r==="-0."||r==="-0,"?r:parseFloat(r):i.field.type==="date"?parseFloat(r):r}_saveInput(t){const i=this._getFieldInputFromHTMLElement(t),{elementId:r}=i.template;if(!i)return;const o=i?.value;if(Ji(i.template,"switch")&&this.viewModel.mode!=="single"){const l=ce(this._batchSwitchInputInitialValues,i,()=>i.value);this._batchSwitchInputInitialValues.set(i,l===null?o:l)}const a=this._parseValue(t,i);a!==o&&this.viewModel.setValue(r,a)}_afterDateComponentCreate(t){this._setDateTimeTimeZoneMap(t),this._afterComponentCreateOrUpdate(t)}_saveValueFromDateComponent(t,i){const{elementId:r}=t.template,o=t.field.type,a=this._dateComponentMap.get(`${r}`);if(!a)return;const l=t.effectiveTimeZone;let c=t.value===J?void 0:t.value,d=null;o==="date-only"?d=Array.isArray(i.value)?i.value[0]:i.value:o==="time-only"?(c=uo(c),d=uo(i.value)):d=o==="timestamp-offset"?i.value!=null?Sn({dateComponent:a.date,timeComponent:a.time,oldValue:c,timeZoneComponent:a.timeZone,defaultTimeZone:l}):null:i.value!=null?Ln({oldValue:c,dateComponent:a.date,timeZone:l,timeComponent:a.time?.value===J?void 0:a.time}):null,c!==d&&(d!==null&&i.value?this.viewModel.setValue(`${r}`,d):this.viewModel.setValue(`${r}`,null))}};s([n()],H.prototype,"activeFeatureIndex",null),s([n()],H.prototype,"disabled",null),s([n()],H.prototype,"_effectiveDisabled",null),s([n()],H.prototype,"features",null),s([n()],H.prototype,"map",null),s([n()],H.prototype,"maximumFeatureCount",null),s([n()],H.prototype,"maximumFeatureCountWithComplexForms",null),s([n()],H.prototype,"spatialReference",null),s([n()],H.prototype,"layerInfos",null),s([n()],H.prototype,"timeZone",null),s([n()],H.prototype,"headingLevel",void 0),s([n()],H.prototype,"icon",null),s([n(),xe("esri/t9n/common")],H.prototype,"messagesCommon",void 0),s([n(),xe("esri/widgets/BatchAttributeForm/t9n/BatchAttributeForm")],H.prototype,"messages",void 0),s([n(),xe("esri/widgets/FeatureForm/t9n/FeatureForm")],H.prototype,"featureFormMessages",void 0),s([n()],H.prototype,"readOnly",null),s([n()],H.prototype,"valid",null),s([n(),zo(["value-change","submit"])],H.prototype,"viewModel",void 0),s([n({type:Xe,nonNullable:!0})],H.prototype,"visibleElements",void 0),s([n()],H.prototype,"groupDisplay",void 0),H=s([M("esri.widgets.BatchAttributeForm")],H);const gc=H,Fe="esri-editor",ge={base:Fe,helpMessage:`${Fe}__help-message`,updateActions:`${Fe}__update-actions`,updateActionsList:`${Fe}__update-actions-list`,featureTemplatesContainer:`${Fe}__feature-templates-container`,templateItemContentEnd:`${Fe}__template-item-content-end`,sketchContainer:`${Fe}__sketch-container`,pendingFeatureListIcon:`${Fe}__pending-feature-list-icon`,mergeFeaturesListSection:`${Fe}__merge-features-list-section`,mergeFeaturesList:`${Fe}__merge-features-list`,mergeFeaturesListItemPreserved:`${Fe}__merge-features-list__item--preserved`,selectionToolbarContainer:`${Fe}__selection-toolbar-container`,updateActionBar:`${Fe}__update-action-bar`};function yc(e){return e&&"layer"in e?e.layer:void 0}function Vr(e){let t=yc(e.origin);return tt(t)&&(t=t.findSublayerForFeature(e)),t??e.sourceLayer??e.layer}function wc(e,t){const i=e??{},r=t??{},o=new Set(Object.keys(i));Fr(o,Object.keys(r));for(const a of o){const l=i[a],c=r[a];if(!Qo(l,c))return!1}return!0}function vc(e){return e==null?null:JSON.stringify(e)}let Me=class extends j{constructor(t){super(t),this._stagedForDelete=!1,this.feature=null,this.initialFeature=null,this.submittable=!1,this.displayTitle=null,this.isAssociation=!1,this._debouncedRefreshDisplayTitle=ht(this._refreshDisplayTitle.bind(this),100)}get attributesModified(){return!wc(this.initialFeature?.attributes,this.feature?.attributes)}get geometryModified(){return this._stringifyGeometry(this.feature)!==this._stringifyGeometry(this.initialFeature)}get stagedForDelete(){return this._stagedForDelete}get modified(){return this.attributesModified||this.geometryModified||this._stagedForDelete}set timeZone(t){this._set("timeZone",t),St(this._debouncedRefreshDisplayTitle())}setAttribute(t,i){const{feature:r}=this;r&&(r.setAttribute(t,i),this.notifyChange("attributesModified")),St(this._debouncedRefreshDisplayTitle())}stageDelete(){this._stagedForDelete=!0}unstageDelete(){this._stagedForDelete=!1}trackChanges(t=this.feature){this.initialFeature=t?.clone(),St(this._debouncedRefreshDisplayTitle())}updateAttributes(t){const{feature:i}=this;i&&(i.attributes=t,this.notifyChange("attributesModified")),St(this._debouncedRefreshDisplayTitle())}updateGeometry(t){const{feature:i}=this;i&&(i.geometry=t,this.notifyChange("geometryModified"))}_stringifyGeometry(t){const i=t?.geometry;return vc(i?.type==="mesh"?{transform:i.transform??null,vertexSpace:i.vertexSpace}:i)}async _refreshDisplayTitle(t){const i=this.feature,r=i?.sourceLayer;if(!r||!("getFeatureTitle"in r))return;const o=await r.getFeatureTitle(i,{fetchMissingFields:!1,removeHTML:!0,timeZone:this.timeZone});t.aborted||(this.displayTitle=o===""?null:o)}};s([n()],Me.prototype,"_stagedForDelete",void 0),s([n()],Me.prototype,"attributesModified",null),s([n()],Me.prototype,"feature",void 0),s([n()],Me.prototype,"geometryModified",null),s([n()],Me.prototype,"initialFeature",void 0),s([n()],Me.prototype,"modified",null),s([n()],Me.prototype,"submittable",void 0),s([n()],Me.prototype,"displayTitle",void 0),s([n()],Me.prototype,"isAssociation",void 0),s([n()],Me.prototype,"timeZone",null),Me=s([M("esri.widgets.Editor.Edits")],Me);const Ht=Me,_c=()=>z.getLogger("esri.widgets.Editor.CreateFeaturesWorkflowData");let ee=class extends j{constructor(t){super(t),this.creationInfo=null,this.editorItem=null,this.fullTemplate=null,this.parent=null,this.temporaryHighlightFeature=null,this.sketchOptions=null,this.snappingManager=null,this.templateExecutorInfo=null,this.viewModel=null,this.upload=null,this._pendingEdits=new le}get isSharedTemplateWorkflow(){return!!this.fullTemplate&&ei(this.fullTemplate)}get pendingFeatures(){return new ye([...this._pendingEdits.keys()])}set selectedPendingFeature(t){this._set("selectedPendingFeature",t),this.temporaryHighlightFeature=null}set timeZone(t){this._set("timeZone",t),this._pendingEdits.forEach(i=>{i.timeZone=t})}isSubmittable(t){const i=this._pendingEdits.get(t);return!!i?.submittable||!!i?.isAssociation}isDisplayable(t){return!this._pendingEdits.get(t)?.isAssociation}addPendingFeature(t,i=t,r={isAssociation:!1}){this.temporaryHighlightFeature=null;const{_pendingEdits:o}=this;if(o.has(t))return o.get(t);t.sourceLayer||_c().warn("source-layer-not-set","A feature added to `pendingFeatures` did not have `sourceLayer` set. This may cause problems throughout `CreateFeaturesWorkflow`.");const a=new Ht({feature:t,isAssociation:r.isAssociation});return a.trackChanges(i),o.set(t,a),a}getEditsForPendingFeature(t){return this._pendingEdits.get(t)}removePendingFeature(t){this.temporaryHighlightFeature=null;const{_pendingEdits:i}=this,r=i.get(t);r&&(r.destroy(),i.delete(t)),this.selectedPendingFeature===t&&(this.selectedPendingFeature=null)}getFeatureTitle(t){return this._pendingEdits.get(t)?.displayTitle}};s([n()],ee.prototype,"creationInfo",void 0),s([n()],ee.prototype,"editorItem",void 0),s([n()],ee.prototype,"fullTemplate",void 0),s([n()],ee.prototype,"isSharedTemplateWorkflow",null),s([n()],ee.prototype,"parent",void 0),s([n()],ee.prototype,"pendingFeatures",null),s([n()],ee.prototype,"selectedPendingFeature",null),s([n()],ee.prototype,"temporaryHighlightFeature",void 0),s([n({constructOnly:!0})],ee.prototype,"sketchOptions",void 0),s([n()],ee.prototype,"snappingManager",void 0),s([n()],ee.prototype,"templateExecutorInfo",void 0),s([n()],ee.prototype,"viewModel",void 0),s([n()],ee.prototype,"upload",void 0),s([n()],ee.prototype,"timeZone",null),ee=s([M("esri.widgets.Editor.CreateFeaturesWorkflowData")],ee);const bc=ee;let kc=class extends v{constructor(t,i){super("shared-template-query-failed",`Request to fetch templates failed. templateIds: ${t.join(",")}`,{error:i}),this.templateIds=t}},xc=class extends v{constructor(t,i){const r=new Set(i.map(a=>a.templateId)),o=_s(new Set(t),r);super("shared-template-some-templates-missing",`The service failed to return templates for the following 'templateId's: ${Array.from(o).join(",")}`)}},ch=class extends v{constructor(){super("shared-template-required-properties-not-set","Values must be specified for the `definition`, `featureService`, `layer`, and `view` properties of a `SharedTemplate` in order to load it")}},uh=class extends v{constructor(){super("shared-template-definition-required-properties-not-set","The `featureService`, `makeSharedTemplateFromJSON`, and `view` properties must all be set in order to load a template definition")}},hh=class extends v{constructor(t){super("shared-template-unsupported-builder",`This template uses an unsupported builder type, '${t}'`),this.builderType=t}},Fc=class extends v{constructor(t,i){super("shared-template-layer-resolver-error",`The 'layerResolver' function failed to provide any layers for template with 'templateId: ${t}'`,{error:i}),this.templateId=t}},Ic=class extends v{constructor(t,i){super("shared-template-utility-network-resolver-error",`The 'utilityNetworkResolver' function threw an error while attempting to find a utility network for template with 'templateId: ${t}'`,{error:i}),this.templateId=t}},yo=class extends v{constructor(t){super("shared-template-layer-unavailable",`None of the layers with which the template is associated are present in the view. Layer IDs: [${t.join(",")}]`),this.layerIds=t}},wh=class extends v{constructor(t){super("shared-template-relationship-not-found",`Relationship class '${t}' could not be found.`),this.relationshipCatalogId=t}};const wo=new Map;function Ac(e,t){return ce(wo,e,()=>{const i=new je({layerResolver:t?.layerResolver??Tc(e),makeSharedTemplateFromJSON:t.makeSharedTemplateFromJSON,utilityNetworkResolver:t?.utilityNetworkResolver??Sc(e),view:e});return e.addHandles(L(()=>{wo.delete(e),i.destroy()})),i})}let je=class extends j{constructor(t){super(t),this._abortController=null,this._cache=new Map,this._pending=new Map,this._utilityNetworkLookupHelperCache=new Map,this.layerResolver=null,this.makeSharedTemplateFromJSON=null,this.utilityNetworkResolver=null,this.view=null}initialize(){this.addHandles(x(()=>this.view.spatialReference,()=>this._reset()))}destroy(){this._abortController=De(this._abortController)}async getTemplates({templateIds:t,featureService:i,signal:r}){const o=this._cache,a=this._pending,l=[],c=new Set,d=new Set,u=Symbol();for(const m of new Set(t)){const g=hi(i,m);if(o.has(g))l.push(o.get(g));else if(a.has(g)){const y=a.get(g);y.subscribers.add(u),d.add(y)}else c.add(m),a.set(g,Cc())}if(l.length===t.length)return l;const p=()=>{for(const{subscribers:m}of d)m.delete(u)},h=ar(r,p);try{const m=await this._loadTemplates({templateIds:Array.from(c),featureService:i,signal:r}),g=await Promise.all(Array.from(d).map(({resolver:y})=>y.promise));l.push(...m),l.push(...g)}catch(m){p();for(const g of c){const y=hi(i,g);a.get(y)?.resolver.reject(m),a.delete(y)}throw m}finally{h?.remove()}return pt(r),l}async _loadTemplates({templateIds:t,featureService:i,signal:r}){if(t.length===0)return[];const o=this._cache,a=this._pending,l=this._abortController=new AbortController,c=ar(r,()=>{for(const p of t)if(vo(a.get(hi(i,p))))return;l.abort()}),d=await Mc({featureService:i,templateIds:t,signal:l.signal,spatialReference:this.view.spatialReference});if(d.length<t.length)throw new xc(t,d);const u=await Promise.all(d.map(p=>this._makeTemplate({json:p,featureService:i})));for(const p of u){const h=hi(i,p.templateId),m=a.get(h);!r?.aborted||vo(m)?(o.set(h,p),m?.resolver.resolve(p)):m?.resolver.reject(Uo()),a.delete(h)}return c?.remove(),u}async _makeTemplate({json:t,featureService:i}){const{view:r}=this,o=this.makeSharedTemplateFromJSON(t);o.featureService=i,o.view=r;const{layerIds:a,subtypeCode:l}=o;try{o.layer=await this.layerResolver({featureService:i,layerIds:a,subtypeCode:l})}catch(c){throw new Fc(o.templateId,c)}if(li(o)&&o.definition?.createUtilityNetworkAssociations){let c=null;try{c=await this.utilityNetworkResolver(i)}catch(d){throw new Ic(o.templateId,d)}if(c){o.definition.utilityNetwork=await this._getOrCreateUtilityNetworkLookupHelper(c);const d=c.associationsTable;o.definition.utilityNetworkAssociationsTable=d,Xo(r).additionalLayers.add(d)}}if(Ri(o)&&o.definition){o.definition.spatialReference=r.spatialReference;for(const c of o.definition.allParts)c.geometry&&(c.geometry.spatialReference=r.spatialReference);o.definition.origin.spatialReference=r.spatialReference}if(ea(o)&&o.definition?.defaultValues){const c=o.definition.defaultValues,d={},{fieldsIndex:u}=o.layer;for(const p in o.definition.defaultValues)d[u.get(p)?.name??p]=c[p];o.definition.defaultValues=d}return o}async _getOrCreateUtilityNetworkLookupHelper(t){const i=this._utilityNetworkLookupHelperCache.get(t);if(i)return i;const{UtilityNetworkLookupHelper:r}=await _(()=>import("./UtilityNetworkLookupHelper-X4MXTyHS.js"),__vite__mapDeps([20,1,2])),o=await new r({utilityNetwork:t}).load();this._utilityNetworkLookupHelperCache.set(t,o);const a=L(()=>{o.destroy(),this._utilityNetworkLookupHelperCache.delete(t)});return t.addHandles(a),this.addHandles(a),o}_reset(){this._abortController?.abort(),this._cache.clear(),this._pending.clear()}};async function Mc({templateIds:e,featureService:t,spatialReference:i,signal:r}){const o=`${t.url}/sharedTemplates/templates`;return(await ks(o,{query:{f:"json",outSR:i,ids:e.join(",")},signal:r}).catch(l=>{throw xs(l),new kc(e,l)})).data?.templates??[]}function vo(e){return e!=null&&e.subscribers.size>0}function Cc(){return{resolver:Rt(),subscribers:new Set}}function hi(e,t){return`${e.url}/${t}`}function Ec(e){return Ar(e)||tt(e)}function Tc(e){return async({featureService:t,layerIds:i})=>{if(!e.map)throw new yo(i);const r=new Set(i),{allLayers:o,allTables:a}=e.map,l=o.concat(a).find(c=>c.url===t.url&&Ec(c)&&r.has(c.layerId));if(l==null)throw new yo(i);return l}}function Sc(e){return async t=>{const{map:i}=e;if(!bs(i)||!i.utilityNetworks)return null;for(const r of i.utilityNetworks)if(r.featureServiceUrl===t.url)return r.load();return null}}s([n()],je.prototype,"_abortController",void 0),s([n()],je.prototype,"_cache",void 0),s([n()],je.prototype,"_pending",void 0),s([n({constructOnly:!0})],je.prototype,"layerResolver",void 0),s([n({constructOnly:!0})],je.prototype,"makeSharedTemplateFromJSON",void 0),s([n({constructOnly:!0})],je.prototype,"utilityNetworkResolver",void 0),s([n({constructOnly:!0})],je.prototype,"view",void 0),je=s([M("esri.editing.sharedTemplates.SharedTemplateProvider")],je);function Lc(e,t){const i={};t=t||{continueOnCircularDependency:!1};const r=[],o={};e.forEach(l=>{const c=l[0];let d;(d=i[c])||(d=i[c]=new _o(c)),l.forEach(u=>{u!==c&&(i[u]||(i[u]=new _o(u)),d.afters.push(u))})});const a=Object.keys(i);return a.sort(bo),a.forEach(function l(c,d){const u=i[c],p=u.id;if(o[c])return;const h=Array.isArray(d)?d:[];h.push(p),o[c]=!0,u.afters.sort(bo),u.afters.forEach(m=>{if(h.includes(m)){if(t?.continueOnCircularDependency)return;throw new Error("Circular chain found: "+p+" must be before "+m+" due to a direct order specification, but "+m+" must be before "+p+" based on other specifications.")}l(m,h.slice())}),r.push(p)}),r.reverse()}let _o=class{constructor(t){this.id=t,this.afters=[]}};function bo(e,t){return e<t?1:e>t?-1:0}const ba="updateFeatureWorkflow-internal",Vc=()=>z.getLogger("esri.widgets.Editor.workflowUtils");function $c(e){return Kt(e)||nt(e)}function ka(e){return!!e&&"features"in e}function Qt(e){return e!=null&&e.type==="create-features"}function Ke(e){return!!e&&"feature"in e}function nt(e){return e!=null&&e.type==="update-features"}function xa(e){return e!=null&&e.type==="update-feature"}function Kt(e){return e!=null&&e.type.includes("update-")&&"fullFeature"in e}function oi(e){return e!=null&&e.type==="update"}function $r(e){return e!=null&&e.type==="merge-features"}function Ut(e){return e!=null&&e.type==="split-feature"}function Gt(e){const t=e?.type;return t==="update-feature"||t==="update-table-record"||t==="update-features"||t==="split-feature"}function Oc(e){return e?.type==="merge"}function Wc(e){return e?.type==="split"}function Pc(e){return $r(e)||Ut(e)}function Rc(e){return e?.type==="update-multiple"}function Fa(e){const t=e&&"renderer"in e?e.renderer:null;if(!Ma(t))return{rotation:null,size:null};const i=t.getVisualVariablesForType("rotation").filter(o=>(!o.axis||o.axis==="heading")&&o.field&&!o.valueExpression),r=t.getVisualVariablesForType("size").filter(o=>o.field&&!o.useSymbolValue&&!o.valueExpression&&Ms(o)==="real-world-size");return{rotation:i.length===1?i[0]:null,size:r.length===1?r[0]:null}}function Or(e){const t=e.sourceLayer;if(!(t&&"renderer"in t&&Ma(t.renderer)))return{rotation:null,size:null};const{rotation:i,size:r}=Fa(t);let o=null,a=null;if(i){const l=t.fields?.filter(d=>d.name===i.field),c=l?.length===1?l[0]:null;o=Ia(i,c)}if(r){const l=t.fields?.filter(d=>d.name===r.field),c=l?.length===1?l[0]:null;a=Aa(r,c)}return{rotation:o,size:a}}function Ia(e,t){const i=(e.axis||"heading")==="heading"&&e.rotationType==="arithmetic"?-1:1,r=t?.type??"double",o={initial:0,current:0};return{field:e.field,fieldType:r,getDefaultValue:()=>Promise.resolve(0),getValue:a=>(o.current=o.initial-i*a,hr((o.current+360)%360,r)),setInitialValue:a=>{o.initial=a,o.current=0},isUpdatingInteractively:!1,rotationType:e.rotationType??"geographic"}}function Hc(e,t){switch(t){case"width":return e[0];case"depth":return e[1];case"height":return e[2];default:return e[2]||e[1]||e[0]}}async function Dc(e,t,i){if(t==null)return 0;const{symbol:r}=Ss(t);if(r==null||r.type==="web-style"||r.type==="cim")return 0;const o=r.symbolLayers.at(0);if(!o)return 0;switch(o.type){case"icon":{const{computeIconLayerResourceSize:a}=await _(()=>import("./symbolLayerUtils-DErvo6ln.js"),__vite__mapDeps([21,1,2]));return Math.min(gt.icon,(await a(o,gt.icon))[0])||gt.icon}case"text":return gt.text;case"line":return gt.line;case"object":{const{computeObjectLayerResourceSize:a}=await _(()=>import("./symbolLayerUtils-DErvo6ln.js"),__vite__mapDeps([21,1,2]));return Hc(await a(o,e.scale/gt.viewScaleSizeFactor),i)}case"path":case"extrude":return e.scale/gt.viewScaleSizeFactor;default:return 0}}function Aa(e,t){const i=e.axis,r=t?.type??"double",o={initial:0,current:0},a=Cs[e.valueUnit]??1;let l;return l=e.valueRepresentation==="area"?c=>(c*a/2)**2*Math.PI:e.valueRepresentation==="radius"||e.valueRepresentation==="distance"?c=>c*a/2:c=>c*a,{field:e.field,fieldType:r,getDefaultValue:async(c,d)=>hr(l(await Dc(d,c,i)),r),getValue:(c,d)=>(o.initial||(o.initial=d.pixelSizeAt(d.center)),o.current=o.initial*c,hr(o.current,r)),setInitialValue:c=>{o.initial=c,o.current=0},isUpdatingInteractively:!1,displayUnit:cd(e.valueUnit),axis:e.axis}}function hr(e,t){switch(t){case"small-integer":case"integer":case"long":return Math.round(e);case"double":case"single":return e;default:return 0}}function Ma(e){if(!As(e))return!1;switch(e?.type){case"class-breaks":case"simple":case"unique-value":case"dot-density":case"dictionary":case"pie-chart":return!0;default:return!1}}async function ae(e,t,i){const r=await Si(e,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:t,scale:i});Is(e.symbol,r)!=null&&(e.symbol=r)}function Ca(e,t){if(!e||!t)throw new Error("no geometry type");if(e==="multipatch")return{tool:"mesh",createOptions:{mode:"hybrid"}};const i=new Map;i.set("circle",{mode:"freehand"}),i.set("rectangle",{mode:"freehand"});const r={mode:qn,optionsPerTool:i};if(ei(t)){const o=t.defaultTool,a=li(t)?t.definition?.inputGeometryType??e:e;switch(o){case"freehand":case"stream-line":return{tool:a==="polyline"?"freehandPolyline":"freehandPolygon",createOptions:r};case"autocomplete-freehand-polygons":case"stream-polygon":return{tool:"freehandPolygon",createOptions:r};case"autocomplete-polygons":case"difference-polygon":case"create-structures":case"polygon":case"trace":return{tool:a==="polygon"?"polygon":"polyline",createOptions:r};case"circle":return i.get("circle").preserveAspectRatio=!0,{tool:"circle",createOptions:r};case"ellipse":return i.get("circle").preserveAspectRatio=!1,{tool:"circle",createOptions:r};case"create-points-along-line":case"multipoint":return{tool:"multipoint",createOptions:r};case"line":case"radial-line":case"right-angle-line":case"split":case"two-point-line":return{tool:"polyline",createOptions:r};case"rectangle":case"regular-polygon":case"right-angle-polygon":return{tool:"rectangle",createOptions:r};case"elevation-point-from-contour":case"elevation-point-from-dem":case"parcel-seed":case"point":case"point-and-rotation":case"point-at-end-of-line":return{tool:"point",createOptions:r}}}else{const o=t.drawingTool;if(o==="circle"||o==="ellipse")return i.get("circle").preserveAspectRatio=o==="circle",{tool:"circle",createOptions:r};if(o==="rectangle")return{tool:"rectangle",createOptions:r};if(o==="freehand")return{tool:e==="polygon"?"freehandPolygon":"freehandPolyline",createOptions:r}}return{tool:e,createOptions:r}}async function zc(e,t,i,r){const{creationInfo:o,fullTemplate:a}=i;if(!o)throw new v("featureworkflow","No creation info provided.");const l=o.layer,c=_i(a,o.attributeOverrides),{view:d}=e,u=d?.type==="2d";li(a)||Ri(a)||await Ta(e,l,c,r,u?d.scale:null);const{capabilities:p}=l;t.elevationInfo=l.elevationInfo;const h=Ca(l.geometryType,a);e.defaultCreateOptions={graphicProperties:{attributes:c,sourceLayer:l},mode:h.createOptions.mode,optionsPerTool:h.createOptions.optionsPerTool,preserveAspectRatio:h.createOptions.preserveAspectRatio,hasZ:p.data.supportsZ,defaultZ:(u?p.editing.zDefault:null)??e.defaultCreateOptions.defaultZ},o.geometryToPlace==null?await e.create(h.tool):await e.place(o.geometryToPlace,{graphicProperties:{attributes:c,sourceLayer:l}})}async function Uc(e){return de([Nc(e),Gc(e)])}function Nc({creationAttributes:e,data:t,sketchViewModel:i,view:r,webStyleCache:o}){const{creationInfo:a}=t,{fullTemplate:l}=t;if(!a||r?.type!=="2d"||li(l)||Ri(l))return null;const c=ht(d=>Ta(i,a.layer,e,o,d));return x(()=>r.scale,d=>c(d))}function Gc({data:e,sketchViewModel:t,view:i}){const{templateExecutorInfo:r}=e;if(!r)return null;const o=t.activeComponent;if(!i||!Jn(o))return Vc().error(new v("featureworkflow","Failed to set up template feedback.")),null;const a=new It({effect:"saturate(0.6) opacity(0.8)",listMode:"hide",title:"Shared Template Feedback Graphics"});i.map?.add(a);const{executor:l,serviceLayersById:c}=r,d=i.theme?.accentColor??new Es([255,165,0,1]);return de([Z(()=>o,["cursor-update","vertex-add"],()=>{a.removeAll();const u=o.graphic?.geometry;if(!u||!jc(u))return;const p=l(u,"digitizing");if(!No(p))for(const h of p.edits){const m=c.get(h.id);if(m&&h.addFeatures&&h.addFeatures.length!==0){for(const g of m)if(!g.isTable)for(const y of h.addFeatures){const b=Bc(y,d);b&&a.add(b)}}}}),L(()=>{i.map.remove(a),a.destroy()})])}function jc(e){switch(e.type){case"point":case"multipoint":return!0;case"polyline":return e.paths[0].length>1;case"polygon":{const t=e.rings[0];return Ls(t.at(0),t.at(-1))?t.length>2:t.length>1}default:return!1}}function Bc(e,t){let i=null;switch(e.geometry?.type){case"point":case"multipoint":i=new $s({angle:0,color:t,outline:new Gi({cap:"round",color:t,join:"round",miterLimit:1,style:"solid",width:1}),path:"undefined",size:8,style:"circle",xoffset:0,yoffset:0});break;case"polygon":i=new Vs({color:t,outline:new Gi({cap:"round",color:t,join:"round",miterLimit:1,style:"solid",width:3}),style:"none"});break;case"polyline":i=new Gi({cap:"round",color:t,join:"round",miterLimit:1,style:"solid",width:2});break;default:return null}return new ni({geometry:e.geometry,symbol:i,attributes:{...e.attributes}})}function Ea(e,t){const i=Xo(t),r=We(e)?e.parent:e;return i.tablesAndLayersLookup.get(r)}function Zc(e,t){const i=Ea(e,t);if(!i)return new Map;const r=new Map;for(const o of i.layersAndTables)ce(r,o.layerId,()=>[]).push(o);return r}function Yi(e){const t=e.objectIdField,i=e.globalIdField??"";return{id:e.layerId,identifierFields:{objectIdField:t,globalIdField:i},addFeatures:[],deleteAttachments:[],addAttachments:[],deleteFeatures:[],updateFeatures:[]}}function qc(e){const{edits:t,serviceInfo:i,view:r,findOriginalFeature:o}=e,a=Jc(i.layersAndTables),l=i.layersAndTables.toArray(),{allEditData:c,editDataByLayerIdMap:d,editDataByIdMap:u}=Kc(t,a,o),p=Yc(c,Qc(l,d),d);if(r&&ed(c,p,r),p.length===0)return t;const h=Lc(p,{continueOnCircularDependency:!0}).map(w=>u.get(w)).filter(Q),m=new Map;for(const w of h)m.set(w.uniqueId,w);const g=[];for(const w of c)m.has(w.uniqueId)||g.push(w);const y=[];let b=null;for(const w of h){const{layer:k}=w;switch(b==null?b=Yi(k):b.id!==k.layerId&&(y.push(b),b=Yi(k)),w.operationType){case"add":case"modify":b.addFeatures.push(w.after);break;case"delete":b.deleteFeatures.push(w.before)}}b!==null&&y.push(b);for(const w of g){const k=w.layer.layerId,F=y.find(A=>A.id===k)??Yi(w.layer);switch(y.includes(F)||y.push(F),w.operationType){case"add":F.addFeatures.push(w.after);break;case"modify":F.updateFeatures.push(w.after);break;case"delete":F.deleteFeatures.push(w.before);break;case"deleteAttachment":F.deleteAttachments.push(w.attachmentId);break;case"addAttachment":F.addAttachments.push(w.attachment)}}for(const w of y)w.deleteAttachments!==void 0&&w.deleteAttachments.length===0&&delete w.deleteAttachments,w.addAttachments!==void 0&&w.addAttachments.length===0&&delete w.addAttachments;return y}function Jc(e){const t=new Map;for(const i of e)t.set(i.layerId,i);return t}function Qc(e,t){const i=new Map;for(const r of e)for(const o of r.relationships??[])if(i.set(fr(r,o),""),t.has(o.relatedTableId)){const a=t.get(o.relatedTableId);if(a.length>0){for(const l of a[0].layer.relationships??[])if(l.id===o.id){i.set(fr(r,o),l.keyField);break}}}return i}function Kc(e,t,i){const r=new Map,o=[],a=new Map;let l=1;for(const c of e){const d=[],u=t.get(c.id);if(!u)throw new v("featureworkflow",`Failed to prepare applyEdits payload. Layer with id ${c.id} not found.`);for(const p of c.addFeatures??[])d.push({uniqueId:"T"+l++,operationType:"add",layer:u,after:p});for(const p of c.deleteFeatures??[])d.push({uniqueId:"T"+l++,operationType:"delete",before:p,layer:u});for(const p of c.deleteAttachments??[])d.push({uniqueId:"T"+l++,operationType:"deleteAttachment",attachmentId:p,layer:u});for(const p of c.addAttachments??[])d.push({uniqueId:"T"+l++,operationType:"addAttachment",attachment:p,layer:u});for(const p of c.updateFeatures??[])d.push({uniqueId:"T"+l++,operationType:"modify",before:i(p),after:p,layer:u});r.set(u.layerId,d);for(const p of d)o.push(p),a.set(p.uniqueId,p)}return{allEditData:o,editDataByIdMap:a,editDataByLayerIdMap:r}}function Yc(e,t,i){const r=[];for(const o of e){const a=o.layer.relationships??[],{uniqueId:l}=o;for(const c of a){const d=c.keyField;if(c.role==="origin"){const u=i.get(c.relatedTableId);if(!u||u.length===0)continue;const p=fr(o.layer,c),h=t.get(p);if(h===void 0||h==="")continue;switch(o.operationType){case"add":for(const m of u)m!==o&&(m.operationType!=="add"&&m.operationType!=="modify"||m.after.attributes[h]===o.after.attributes[d]&&r.push([l,m.uniqueId]));break;case"modify":if(o.before.attributes[d]!==o.after.attributes[d])for(const m of u){const g=m.uniqueId;m!==o&&(m.operationType==="delete"?m.before.attributes[h]===o.before.attributes[d]?r.push([g,l]):m.before.attributes[h]===o.after.attributes[d]&&r.push([l,g]):m.operationType==="add"?m.after.attributes[h]===o.after.attributes[d]?r.push([l,g]):m.after.attributes[h]===o.before.attributes[d]&&r.push([g,l]):m.operationType==="modify"&&(m.before.attributes[h]!==m.after.attributes[h]?m.after.attributes[h]===o.after.attributes[d]?r.push([l,g]):r.push([g,l]):r.push([l,g])))}break;case"delete":for(const m of u)m!==o&&(m.operationType!=="delete"&&m.operationType!=="modify"||m.before.attributes[h]===o.before.attributes[d]&&r.push([m.uniqueId,l]))}}}}return r}function fr(e,t){return`${e.layerId}:${t.id}`}function Xc(e,t){return!!(t?.map&&"utilityNetworks"in t.map&&t.map.utilityNetworks?.length&&t.map.utilityNetworks.some(i=>!(!i.loaded||!e.url?.startsWith(i.featureServiceUrl)||e.layerId!==i.networkSystemLayers.associationsTableId)))}function ed(e,t,i){const r=[];for(const a of e)Xc(a.layer,i)&&r.push(a);if(r.length===0)return;let o=[];for(const a of r){const l=a.layer;switch(a.operationType){case"delete":o=[...fi(a.before.attributes[l.fieldsIndex.get("fromglobalid").name],e),...fi(a.before.attributes[l.fieldsIndex.get("toglobalid").name],e)];for(const c of o)t.push([a.uniqueId,c.uniqueId]);break;case"add":o=[...fi(a.after.attributes[l.fieldsIndex.get("fromglobalid").name],e),...fi(a.after.attributes[l.fieldsIndex.get("toglobalid").name],e)];for(const c of o)t.push([c.uniqueId,a.uniqueId])}}}function fi(e,t){const i=[],r=t.filter(({layer:o})=>o.globalIdField!==""&&o.globalIdField!=null);for(const o of r){const a=o.layer.globalIdField;("before"in o&&o.before?.attributes[a]===e||"after"in o&&o.after?.attributes[a]===e)&&i.push(o)}return i}function _i(e,t={}){return li(e)||Ri(e)?{}:ta(e)?{...e.prototype.attributes,...t}:ea(e)?{...e.definition?.defaultValues,...t}:{...t}}async function Ta(e,t,i,r,o){const a=new ni({sourceLayer:t,attributes:i}),{rotation:l,size:c}=Or(a);let d=await Si(a,{useSourceLayer:!0,webStyleCache:r,scale:o}),u=!1;for(const p of[c,l])p!=null&&i[p.field]==null&&(i[p.field]=await p.getDefaultValue(d,e.view),u=!0);switch(u&&(d=await Si(a,{useSourceLayer:!0,webStyleCache:r,scale:o})),d?.type){case"simple-fill":case"polygon-3d":e.polygonSymbol=d;break;case"simple-line":case"line-3d":e.polylineSymbol=d;break;case"simple-marker":case"picture-marker":case"point-3d":case"cim":e.pointSymbol=d;break;case"mesh-3d":e.meshSymbol=d}Sa(e.tooltipOptions,c,l)}function Sa(e,t,i){e.visualVariables=t!=null||i!=null?{size:t!=null?{unit:t.displayUnit,axis:t.axis,valueType:t.fieldType}:null,rotation:i!=null?{valueType:i.fieldType,rotationType:i.rotationType??"geographic"}:null}:null}function it(e,t){return e.find(i=>i.layer===t)}function Lt(e,t){const i=it(e,t);if(i==null)throw new v("no-editorItem-found","The EditorViewModel provided did not have an EditorItem associated with the specified layer");return i}function Xi(e,t){return e?.find(i=>i.layer===t)}async function td(e,t,i,r){switch(t.type){case"3d":return id(e,t,i,r);case"2d":return rd(e,t,i,r)}}async function id(e,t,i,r){if(e.length===0)return[];const{updatable:o,graphicsByLayer:a}=await i.defer(async()=>{const{results:l}=await Wt(Ps(t,i),r),c=new Map,d=p=>{const h=p.layer,m=c.get(h);if(!m){const g=new Array;return c.set(h,g),g}return m};Go(l).forEach(({graphic:p})=>d(p).push(p));const u=e.filter(({capabilities:p,layer:h})=>p.update.enabled&&c.has(h));return u.length!==0&&i.stopPropagation(),{updatable:u,graphicsByLayer:c}});return Wt(Promise.allSettled(o.map(async({layer:l})=>{const c=a.get(l),d=La(l);if(c.every(h=>Rs(h,d)))return c;const u=[];for(const h of c){u.push(h.getObjectId());const m=Object.keys(h.attributes);jo(d,m)}const p=l.createQuery();return p.returnGeometry=!1,p.objectIds=u,p.outFields=Bo(l.fieldsIndex,d),l.queryFeatures(p,{signal:r}).then(({features:h})=>h)})),r)}async function rd(e,t,i,r){if(e.length===0)return[];const{mapPoint:o}=i;if(o==null)return[];let a=null;const l=await i.defer(async()=>{const{results:c}=await Wt(t.hitTest(i),r);if(c.length===0)return[];const d=new Set;a=Go(c),a.forEach(({graphic:p})=>p&&d.add(p.layer));const u=e.filter(p=>d.has(p.layer)&&p.supportsUpdateWorkflow);return u.length>0&&i.stopPropagation(),u});return Wt(Promise.allSettled(l.map(async({layer:c})=>{const d=c.createQuery();d.returnGeometry=!0,d.outFields=La(c);const u="renderer"in c?Os({renderer:c.renderer,pointerType:i.pointerType}):0;d.geometry=Ws(o,u,t),d.outSpatialReference=t.spatialReference;const{features:p}=await c.queryFeatures(d,{signal:r});return a?.forEach(({graphic:h})=>{h.layer!==c||p.some(m=>m.getObjectId()===h.getObjectId())||p.push(h)}),p})),r)}function La(e){return Bo(e.fieldsIndex,[e.objectIdField,Zo({displayField:"displayField"in e?e.displayField:null,fields:e.fields})])}async function Va(e,t,i,r){return Wr(e.map(o=>o.getObjectId()??o.attributes[t.objectIdField]).filter(Q),t,i,r)}async function Wr(e,t,i,r){const o=t.createQuery();o.objectIds=e,o.outFields=["*"],o.returnM=t.capabilities.data.supportsM,o.returnZ=t.capabilities.data.supportsZ,t.type==="scene"&&t.infoFor3D!=null||(o.returnGeometry=!0,o.outSpatialReference=i);const a=await t.queryFeatures(o,{signal:r});return pt(r),a.features}async function bi(e){const{graphic:t,sketchViewModel:i,sourceLayer:r,visualVariables:o}=e;await Pr(e);const a={multipleSelectionEnabled:!1};return r.geometryType==="point"&&(a.enableRotation=o.rotation!=null,a.enableScaling=o.size!=null),i.update(t,a)}async function Pr(e){const{graphic:t,sketchLayer:i,sketchViewModel:r,sourceLayer:o,visualVariables:a,webStyleCache:l}=e;let c=!1;const{rotation:d,size:u}=a;for(const p of[d,u]){if(p==null)continue;const h=t.getAttribute(p.field);if(h!=null)p.setInitialValue(h);else{const m=await p.getDefaultValue(t.symbol,r.view);p.setInitialValue(m),t.setAttribute(p.field,m),c=!0}}if(c){const p=r.view?.type==="2d"?r.view.scale:null;await ae(t,l,p)}Sa(r.tooltipOptions,u,d),i.elevationInfo=o.elevationInfo}function od(e){return e==null||e.type!=="rotate-start"&&e.type!=="rotate"&&e.type!=="rotate-stop"?null:e}function ad(e){return e==null||e.type!=="scale-start"&&e.type!=="scale"&&e.type!=="scale-stop"?null:e}function Rr(e,t,i,r){if(t.geometry==null||t.geometry?.type!=="point")return!1;const o=t.attributes;let a=!1;const l=r.rotation,c=od(i.toolEventInfo);if(l!=null&&c!=null){const{field:p,getValue:h}=l;if(c.type==="rotate-stop")l.isUpdatingInteractively=!1,l.setInitialValue(t.getAttribute(p));else{l.isUpdatingInteractively=!0;const m=h(c.angle,e);m!==o[p]&&t.setAttribute(p,m),a=!0}}const d=r.size,u=ad(i.toolEventInfo);if(d!=null&&u!=null){const{field:p,getValue:h}=d;if(u.type==="scale-stop")d.isUpdatingInteractively=!1,d.setInitialValue(t.getAttribute(p));else{d.isUpdatingInteractively=!0;const m=h(u.xScale,e);m!==o[p]&&t.setAttribute(p,m),a=!0}}return a}async function sd({feature:e,featureClone:t,visualVariableAttributes:i,sketchLayer:r,sketchViewModel:o,view:a,onUpdate:l,webStyleCache:c,addUpdatingPromise:d,addHandle:u}){await ae(t,c,a.type==="2d"?a.scale:null);let p=null;if(o?.view?.type==="2d"){const A=ht(V=>ae(t,c,V));p=x(()=>o?.view?.scale,V=>A(V))}const h=t.sourceLayer,m=ut(a,h);await bi({graphic:t,sketchLayer:r,sketchViewModel:o,sourceLayer:h,visualVariables:i,webStyleCache:c});let g=null;m.then(A=>g=A).catch(()=>{});const y=i.size,b=i.rotation,w=x(()=>e.attributes,async A=>{let V=!1;for(const P in A){const R=A[P];R!==t.getAttribute(P)&&(t.setAttribute(P,R),y==null||y.isUpdatingInteractively||y.field!==P||y.setInitialValue(R),b==null||b.isUpdatingInteractively||b.field!==P||b.setInitialValue(R),(g==null||g.requiredFields.includes(P))&&(V=!0))}V&&await ae(t,c,a.type==="2d"?a.scale:null)}),k=o.on("update",async A=>{const V=A.graphics[0],P={graphic:V,sketchLayer:r,sketchViewModel:o,sourceLayer:h,visualVariables:i,webStyleCache:c};if(A.state==="complete"){if(a.activeTool===null)return bi(P);const R=new AbortController,ue=xt(R);return u(ue),d(O(()=>a.activeTool===null,R.signal).then(async()=>{if(!R.signal.aborted)return R.abort(),bi(P)}))}Rr(a,V,A,i)&&await ae(V,c,a.type==="2d"?a.scale:null),l(mr(V),A)}),F=o.on(["undo","redo"],A=>{l(mr(A.graphics[0]),A)});return de([F,k,L(()=>o.cancel()),w,p])}async function Hr(e,t,i,r){e.add(r);const o=i.sourceLayer,a=i.getAttribute(o.objectIdField);let l=null;function c(d){l?.abort(),l=Ti(async u=>{const p=await ut(t,o);pt(u),p.setVisibility?.(a,d)})}return await $a(t,r),c(!1),de([nd(t,r,d=>c(!d)),L(async()=>{c(!0);try{if(!t.destroyed){const d=await ut(t,o).catch(()=>{});d&&!d.destroyed&&await O(()=>!d.updating)}}finally{e.remove(r)}})])}function nd(e,t,i){if(e.type==="3d"){const r=new na({graphic:t});return de([e.trackGraphicState(r),x(()=>r.displaying,i)])}return x(()=>t.visible,i)}async function $a(e,t){if(e.type==="3d"){const i=new na({graphic:t}),r=e.trackGraphicState(i);await O(()=>i.displaying||i.error),r.remove()}else await O(()=>t.visible)}const gt={icon:ji(24),text:ji(12),line:ji(1),viewScaleSizeFactor:100};function Dr(e,t,i){let r=!1;return e.filter(o=>!!r||(r=o===t,r)).map(o=>i[o]())}function ld(e,t){e.viewModel.syncFeatureTemplates();const i=e.creationInfo;if(t[0].id==="awaiting-feature-creation-info"&&i){const r=i.layer,o=e.viewModel.getTemplatesForLayer(r);o.length===1&&r.type!=="scene"&&(i.template=o[0],t.shift())}return t}function cd(e){return e==="unknown"?null:e}function dd(e){e.filesEnabled=!0,e.mode="view",e.capabilities={editing:!0,operations:{add:!0,update:!0,delete:!0}}}const Oa=e=>e.includes("-stop")||e.includes("vertex-"),ut=(e,t)=>{const i=t.type==="subtype-sublayer"?t.parent:t;return e.whenLayerView(i)};function ud(e){return"createInteractiveEditSession"in e}function mr(e){const t=e.geometry;if(t?.type==="mesh"){const i=e.cloneShallow();return i.attributes=Ts(e.attributes),i.geometry=t.cloneShallow(),i.geometry.transform=t.transform?.clone()??null,i}return e.clone()}function Wa(e){return e.acquireCursor("progress")}async function pd(e,t){const{template:i}=e;if(i==null)return null;if(dr(i))return i.load();if(ei(i)){const r=(await _(async()=>{const{default:l}=await import("./SharedTemplate-Cevb2Q7i.js");return{default:l}},__vite__mapDeps([22,1,2,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,3,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69]))).default,o=Ac(t,{makeSharedTemplateFromJSON:l=>r.fromJSON(l)}),a=await o.getTemplates({templateIds:[i.templateId],featureService:i.featureService});if(a.length===0)throw new v("editor:failed-to-load-template","Unable to load the provided template");return a[0].load()}return i}function Pa(e){for(const t of e){const{destinationGraphic:i,destinationField:r,sourceGraphic:o,sourceField:a}=t;i.setAttribute(r,o.getAttribute(a))}}function hd(e){const t=e.templateExecutorInfo?.completionResults;return t?.length?(t.forEach(i=>Pa(i.relationships)),t.flatMap(i=>i.edits)):null}function fd(e){const t=oi(e)?e.activeWorkflow:e;if(t==null)return[];if(nt(t))return t.data.layers;const i=t.layer;return i?[i]:[]}function gr({attributes:e},t){const i=new Set;i.add(t.objectIdField),"uniqueIdFields"in t&&t.uniqueIdFields&&t.uniqueIdFields.length>0&&Fr(i,t.uniqueIdFields);const r={};for(const o of i)e[o]!=null&&(r[o]=e[o]);if(t.type==="scene"&&t.infoFor3D!=null){const o=t.associatedLayer?.globalIdField;o!=null&&(e[o]=e[o])}return r}function ki(e){if(!md(e))return e;const t=new Map;for(const i of e){const r=i.getObjectId();if(r!=null){const o=i.sourceLayer??i.layer;ce(t,o,()=>[]).push(r)}}return Array.from(t.entries()).map(([i,r])=>({layer:i,objectIds:r}))}function md(e){return e.length===0||Fs(e[0])}async function gd({view:e,data:t,signal:i,next:r,cancel:o}){const{creationInfo:a}=t;if(!a)return L();if(!Qe(a))return L();const{layer:l}=a,c=a.geometryToPlace!=null;if(a.geometryToPlace=null,c)return o(),L();const{Upload:d}=await _(()=>import("./Upload-BiQfvhk2.js"),__vite__mapDeps([70,1,2,71]));pt(i);const u=new d;t.upload=u;let p=null;const h=()=>p?.remove(),m=de([x(()=>u.state,g=>{switch(g){case"default":case"error":h();break;case"pending":h(),p=Wa(e);break;case"success":{a.maxFeatures=1;const{result:y}=u;y?.type==="georeferenced"||y?.type==="georeferenced-reprojected"?(a.geometryToPlace=y.mesh,a.initialFeature=new ni({geometry:y.mesh,sourceLayer:l}),e.type==="3d"&&e.goTo({target:y.mesh},{animate:!0}).catch(()=>{})):a.geometryToPlace=y?.mesh,h(),r();break}}}),L(()=>{u.cancel(),h()})]);return u.uploadTo(l),m}function Qe(e){return e?.layer?.type==="scene"}let N=class extends Ir{constructor(t){super(t),this._indexHistory=[],this._lastStepIndex=-1,this._stepIndex=-1,this._updatingHandles=new Dt,this._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"},this.data=void 0,this.started=!1,this.steps=[],this.type=null,this._pendingOperation=null}destroy(){this._updatingHandles.destroy()}get formViewModel(){return null}get hasNextStep(){const{steps:t}=this;return!!(t&&this._stepIndex<t.filter(i=>!i.parent).length-1)}get hasPreviousStep(){return this._stepIndex>0}get reliesOnOwnerAdminPrivileges(){return!1}get hasInvalidFormTemplate(){return!1}get shouldShowAttachments(){return!1}get shouldAllowAttachmentEditing(){return!1}get stepId(){const{steps:t}=this,i=t&&t[this._stepIndex];return i&&i.id}get allowSave(){return!this.updating}get helpMessage(){}get noticeMessage(){}get hasPendingEdits(){return!1}get keyboardCancellationEnabled(){return!0}get saveActionLabel(){return"submit"}get updating(){return this._updatingHandles.updating||!!this.formViewModel?.updating}async back(t=()=>Promise.resolve(!0)){this.hasPendingEdits&&!await t()||(this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0}))}async cancel(t={force:!0}){return t.force!==!1?this._cancel(t):new Promise((i,r)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel({...t,force:!0}).then(i)},deny:()=>r(new v("workflow:cancel-denied","Request to cancel workflow was denied."))}})})}async commit(){this.removeHandles(this._handleKeys.beforeCommit),this.onCommit&&await this.onCommit(this.data),this.removeHandles(this._handleKeys.afterCommit),this.emit("commit")}async go(t){const{steps:i}=this,r=i.findIndex(o=>o.id===t);this._indexHistory.push(this._stepIndex),await this._go(r)}async next(){this._indexHistory.push(this._stepIndex),await this._go(this._stepIndex+1)}async previous(t={cancelCurrentStep:!1}){await this._go(this._indexHistory.pop(),t.cancelCurrentStep)}async reset(){await this._cancel({emitCancelEvent:!1}),await this.start()}async save(){await this.commit(),await this.reset()}async start(){this._set("started",!0);const t=this._stepIndex===-1?0:this._stepIndex;await this._go(t)}async _cancel({emitCancelEvent:t=!0,error:i}={}){this.started&&(this._set("started",!1),await this._transaction(()=>this.steps[this._stepIndex]?.tearDown({canceled:!0}))),this.removeHandles([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]),this._resetIndexing(t),t&&this.emit("cancel",{error:i})}_go(t=-1,i=!1){return this._transaction(async()=>{const{steps:r}=this;if(!(t<=-1||t>=r.length)){if(!this.started)return this._stepIndex=t,void this._notifyStepProps();this._lastStepIndex>-1&&await r[this._lastStepIndex].tearDown({canceled:i});try{await r[t].setUp()}catch(o){Hs(o)}this._lastStepIndex=t,this._stepIndex=t,this._notifyStepProps()}})}async _transaction(t){const i=this._pendingOperation,r=Rt(),o=(i??Promise.resolve()).then(()=>r.promise);this._pendingOperation=o,this._updatingHandles.addPromise(o);try{i&&await i,await t()}finally{r.resolve(),o===this._pendingOperation&&(this._pendingOperation=null)}}_resetIndexing(t=!0){this._stepIndex=-1,this._lastStepIndex=-1,this._indexHistory.length=0,t&&this._notifyStepProps()}_notifyStepProps(){this.notifyChange("stepId"),this.notifyChange("hasPreviousStep"),this.notifyChange("hasNextStep")}};s([n()],N.prototype,"data",void 0),s([n()],N.prototype,"formViewModel",null),s([n()],N.prototype,"hasNextStep",null),s([n()],N.prototype,"hasPreviousStep",null),s([n()],N.prototype,"onCommit",void 0),s([n()],N.prototype,"reliesOnOwnerAdminPrivileges",null),s([n()],N.prototype,"hasInvalidFormTemplate",null),s([n()],N.prototype,"shouldShowAttachments",null),s([n()],N.prototype,"shouldAllowAttachmentEditing",null),s([n()],N.prototype,"started",void 0),s([n({readOnly:!0})],N.prototype,"stepId",null),s([n()],N.prototype,"steps",void 0),s([n({readOnly:!0})],N.prototype,"type",void 0),s([n()],N.prototype,"allowSave",null),s([n()],N.prototype,"helpMessage",null),s([n()],N.prototype,"noticeMessage",null),s([n()],N.prototype,"hasPendingEdits",null),s([n()],N.prototype,"keyboardCancellationEnabled",null),s([n()],N.prototype,"updating",null),N=s([M("esri.widgets.Editor.Workflow")],N);const Nt=N;var xi;const yd=Symbol(),jt=Symbol(),mi=Symbol(),ko=Symbol(),wd={point:["point"],multipoint:["multipoint"],polygon:["polygon","freehandPolygon","rectangle","circle"],polyline:["polyline","freehandPolyline"],mesh:[],multipatch:[]};let D=xi=class extends Nt{constructor(e){super(e),this.type="create-features",this.createFeatureState="create-new",this.data=void 0,this.isNested=!1,this._getDrawMeshHelpMessage=void 0,this._webStyleCache=new Map,this._featureFormHandle=null,this._visualVariableAttributes={rotation:null,size:null},this._formViewModel=new Pi,this._sketchLayer=null,this._sketchViewModel=null,this._attachmentFileInfos=new Map,this._isActive=!0}initialize(){this.isNested&&(this._isActive=!1),this._initializeSketchViewModel()}destroy(){this._sketchViewModel.destroy()}get allowSave(){return!this.updating}get formViewModel(){return this._formViewModel}get hasInvalidFormTemplate(){return!!this.data.editorItem?.hasInvalidFormTemplate}get hasPendingEdits(){if(this.pendingFeatures.some(a=>!!this.data.getEditsForPendingFeature(a)?.modified))return!0;const{creationInfo:e,upload:t}=this.data,{activeComponent:i,createGraphic:r}=this._sketchViewModel,o=r?.geometry?.type;return!(o!=="polyline"&&o!=="polygon"&&o!=="multipoint"||i?.type!=="draw-2d"&&i?.type!=="draw-3d")&&i.drawOperation.committedVertices.length>0||!(!t||t.state!=="pending"&&t.state!=="success")||!!e?.geometryToPlace}get hasPreviousStep(){return this._stepIndex>0||this.createFeatureState==="update-pending"&&!!this.data.selectedPendingFeature&&!this.parent&&!Qe(this.data.creationInfo)}get helpMessage(){const{creationInfo:e,viewModel:t}=this.data;if(this.stepId!=="creating-features"||!e)return;const{_sketchViewModel:i}=this,r=e.layer.geometryType,o=i.createGraphic;if(r==="mesh"){this._getDrawMeshHelpMessage||_(()=>import("./helpMessageUtils3d-DeHUiAZq.js"),__vite__mapDeps([72,1,2])).then(d=>{this._getDrawMeshHelpMessage=d.getDrawMeshHelpMessage});const{view:c}=t;return c?.type==="3d"?this._getDrawMeshHelpMessage?.(o,c):void 0}const{activeCreateToolDrawMode:a,activeTool:l}=i;return sa(l==="rectangle"||l==="circle"?l:r,o?.geometry,a)}get layer(){return this.data.creationInfo?.layer}get numPendingFeatures(){return this.pendingFeatures.length}get numPendingFeaturesExcludingHidden(){return this.pendingFeatures.filter(e=>this.data.isDisplayable(e)).length}get parent(){return this.data.parent}get pendingFeatures(){return this.data.pendingFeatures}get keyboardCancellationEnabled(){return this.numPendingFeatures===0}get reliesOnOwnerAdminPrivileges(){return this.data.editorItem?.capabilities.create.reliesOnOwnerAdminPrivileges??!1}get saveActionLabel(){return"create"}get shouldShowAttachments(){return(this.data.selectedPendingFeature&&this.data.editorItem?.capabilities.create.attachments.enabled)??!1}get shouldAllowAttachmentEditing(){return this.shouldShowAttachments}get sketchViewModel(){return this._sketchViewModel}get test(){}get availableCreateTools(){const e=this.data.creationInfo?.layer.geometryType,t=this.data.viewModel.view;if(!e)return[];if(this.data.creationInfo?.maxFeatures&&this.data.creationInfo.maxFeatures<=this.numPendingFeatures)return[];if(ei(this.data.fullTemplate)){const{tool:i}=Ca(e,this.data.fullTemplate);return[i]}return t?.type!=="2d"&&e==="multipoint"?[]:[...wd[e]]}get _attachmentsActive(){const e=this.data.viewModel.attachmentsViewModel.mode,t=this.stepId;return this.shouldShowAttachments&&(e==="add"||e==="edit"||t==="adding-attachment"||t==="editing-attachment")}async enter(){this._isActive=!0,this.stepId!=="awaiting-feature-creation-info"&&await this._updatingHandles.addPromise(this._setUpCreatingFeaturesStep())}exit(){this._isActive=!1,this.removeHandles([mi])}async updatePendingFeature(e){if(e!==this.data.selectedPendingFeature)return this._sketchViewModel.cancel(),this._startUpdating({feature:e})}async start(){return await super.start(),et(this.data.creationInfo?.layer)?null:{enter:async()=>{},exit:async()=>{},viewModel:this._sketchViewModel}}async save(){const{formViewModel:e}=this;if(e.pendingSubtypeChoice)return;e.submit(),this._stashValidationState();const t=this.data.selectedPendingFeature,i=this._hasValidationErrors(t)?t:this.data.pendingFeatures.find(r=>this._hasValidationErrors(r));return i?(await this._startUpdating({feature:i}),void e?.submit()):super.save()}back(e){return this.createFeatureState!=="update-pending"||!this.data.selectedPendingFeature||Qe(this.data.creationInfo)||this._attachmentsActive||this.parent?super.back(e):this._clearSelectedFeature()}previous(e){return this.createFeatureState!=="update-pending"||!this.data.selectedPendingFeature||Qe(this.data.creationInfo)||this._attachmentsActive?super.previous(e):this._clearSelectedFeature()}cancelFeature(e){this.data.isSharedTemplateWorkflow?z.getLogger(this).warn("Cannot cancel individual features created by shared templates."):(this.data.removePendingFeature(e),this.sketchViewModel.removeGraphic(e))}static create(e){const{addAttachmentsCallback:t,applyEdits:i,applyEditsFeatureService:r,isNested:o,creationInfo:a,parent:l,snappingManager:c,startAt:d,viewModel:u}=e,p=e.sketchOptions??new zt,h=a?.layer,m=h?it(u.editorItems,h):void 0,g=new xi({data:new bc({creationInfo:a,editorItem:m,parent:l,sketchOptions:p,snappingManager:c,viewModel:u}),isNested:o,onCommit:async y=>{const{creationInfo:b}=y;if(!b)return;g._sketchViewModel.cancel();const w=y.pendingFeatures.toArray(),{layer:k}=b,F=k.capabilities?.editing.supportsGlobalId&&"globalIdField"in k,A=g._attachmentFileInfos,{fullTemplate:V}=y,P=hd(g.data),R=dr(V)&&P;if(F){if(kd(w),R){let U=Fd(P,A);const ft=await Ea(k,u.view)?.load();ft&&(U=qc({edits:U,serviceInfo:ft,view:u.view,findOriginalFeature:ui=>y.getEditsForPendingFeature(ui)?.initialFeature??ui})),await r(V.featureService,U,{globalIdUsed:!0,gdbVersion:V.layer.gdbVersion??void 0})}else{const U=xd(w,A);await i(k,U,{globalIdUsed:!0})}return}const ue=R?await r(V.featureService,P,{gdbVersion:V.layer.gdbVersion??void 0}):[await i(k,{addFeatures:w})];ue&&A.size>0&&await Promise.all(ue.map(U=>{if(U?.addFeatureResults)return t(k,bd(w,U.addFeatureResults,k,A))}))}});return g._set("steps",this._createWorkflowSteps(g,d)),g}_fadeExistingFeatures(e){if("effect"in e){const i=e.effect;return e.effect="saturate(0.6) opacity(0.8)",L(()=>e.effect=i)}const t=e.opacity;return e.opacity=.7,L(()=>e.opacity=t)}async _initializeFullTemplateAndExecutorInfo(e){const{creationInfo:t}=e,{view:i}=e.viewModel;if(!t||!i)return null;const r=await pd(t,i);if(e.fullTemplate=r,r&&dr(r)){const{createTemplateExecutor:o}=await _(()=>import("./createTemplateExecutor-DLBC0PDj.js").then(l=>l.c),__vite__mapDeps([73,1,2,23,24,25,26,27,28,29])),a={completionResults:[],executor:await o(r),serviceLayersById:Zc(t.layer,i)};e.templateExecutorInfo=a}return r}async _startCreating(){this.removeHandles(jt);const{data:e}=this;if(!e.creationInfo)return;const t=this.data.creationInfo?.maxFeatures;if(t&&this.numPendingFeatures>=t)return this.sketchViewModel.cancel(),void(this.numPendingFeatures&&await this._startUpdating({feature:this.pendingFeatures.at(-1)}));this.createFeatureState="create-new",await zc(this._sketchViewModel,this._sketchLayer,e,this._webStyleCache)}async _clearSelectedFeature(){const e=this._formViewModel.pendingSubtypeChoice;e&&(e.resolve("undo"),await e.promise),this._stashValidationState(),this.sketchViewModel.cancel(),this.data.selectedPendingFeature=null,this._featureFormHandle=bt(this._featureFormHandle),this._formViewModel.feature=null;const t=this.data.viewModel.attachmentsViewModel;t.mode!=="add"&&t.mode!=="edit"||await this.data.viewModel.activeWorkflow?.previous()}_stashValidationState(){const e=this._formViewModel.feature,t=e&&this.data.getEditsForPendingFeature(e);t&&(t.submittable=this._formViewModel.submittable)}async _selectFeatureForUpdate({feature:e,initialFeature:t=e}){this._stashValidationState();const{data:i,pendingFeatures:r,_webStyleCache:o}=this;r.includes(e)||i.addPendingFeature(e,t),i.selectedPendingFeature=e;const{_formViewModel:a,_sketchViewModel:l}=this,{creationInfo:c,viewModel:d}=i,{attachmentsViewModel:u,layerInfos:p,view:h}=d;if(!h||!c)return;bt(this._featureFormHandle);const m=e.sourceLayer,g=Xi(p,m),y=g?.formTemplate,b=h.spatialReference;a.set({editType:"INSERT",feature:e,formTemplate:y,spatialReference:b,map:h.map}),u.mode!=="add"&&u.mode!=="edit"||await d.activeWorkflow?.previous(),u.graphic=e,u.fileInfos.removeAll(),u.mode="view",(this._attachmentFileInfos.get(e)||[]).forEach(({file:k,form:F})=>u.addFile(k,F)),await ae(e,o,h.type==="2d"?h.scale:null);const w=i.getEditsForPendingFeature(e);this._featureFormHandle=de([a.on("value-change",async({fieldName:k,value:F})=>{if(w?.updateAttributes(a.getValues()),Mt(F)){const A=this._visualVariableAttributes;A.size&&!A.size.isUpdatingInteractively&&k===A.size.field&&A.size.setInitialValue(F),A.rotation&&!A.rotation.isUpdatingInteractively&&k===A.rotation.field&&A.rotation.setInitialValue(F)}await ae(e,o,h.type==="2d"?h.scale:null)}),l.on(["update","undo","redo"],k=>{(k.type==="undo"||k.type==="redo"||k.type==="update"&&k.toolEventInfo!=null&&Oa(k.toolEventInfo.type))&&a.notifyFeatureGeometryChanged()}),x(()=>a.feature?.sourceLayer,k=>e.sourceLayer=k),x(()=>[a.feature,a.submittable],()=>this._stashValidationState())]),this.createFeatureState="update-pending"}async _startUpdating({feature:e,initialFeature:t=e}){await this._selectFeatureForUpdate({feature:e,initialFeature:t});const{_sketchLayer:i,_sketchViewModel:r,data:o}=this,{creationInfo:a,viewModel:l}=o,{view:c}=l;if(!c||!a)return;const d=e.sourceLayer??a.layer;return et(d)?void 0:(this._visualVariableAttributes=Or(e),bi({graphic:e,sketchLayer:i,sketchViewModel:r,sourceLayer:d,visualVariables:this._visualVariableAttributes,webStyleCache:this._webStyleCache}))}static _createWorkflowSteps(e,t="awaiting-feature-creation-info"){const{data:i}=e,r=Dr(["awaiting-feature-creation-info","creating-features","adding-attachment","editing-attachment"],t,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){const{creationInfo:o,viewModel:a}=i,{view:l}=a;l&&(Qe(o)?e.addHandles(await gd({view:l,data:i,next:()=>e.next(),cancel:()=>a.cancelWorkflow({warnIfNoWorkflow:!1})}),this.id):(i.parent&&o&&e.addHandles(a.restrictFeatureTemplatesViewModelToLayer(o.layer),this.id),e.addHandles(a.featureTemplatesViewModel.on("select",({item:c})=>{c&&(i.creationInfo={...i.creationInfo,layer:c.layer,template:c.template},e.next())}),this.id)))},async tearDown(){e.removeHandles(this.id)}}),"creating-features":()=>({id:"creating-features",async setUp(){e._isActive&&await e._setUpCreatingFeaturesStep()},async tearDown(o){const{viewModel:a}=i;o.canceled&&(e.removeHandles([mi,yd,jt,ko]),a.attachmentsViewModel.fileInfos.removeAll(),e._attachmentFileInfos.clear())}}),"adding-attachment":()=>({id:"adding-attachment",parent:"creating-features",async setUp(){},async tearDown(){const{attachmentsViewModel:o}=i.viewModel,{graphic:a,fileInfos:l}=o;e._attachmentFileInfos.set(a,l.toArray()),o.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",async setUp(){},async tearDown(){const{attachmentsViewModel:o}=i.viewModel,{graphic:a,fileInfos:l}=o;e._attachmentFileInfos.set(a,l.toArray()),o.mode="view"}})});return ld(i,r)}static _configureSketchViewModel(e){const{data:t,_sketchLayer:i,_sketchViewModel:r,_webStyleCache:o}=e,{creationInfo:a,viewModel:l}=t,{view:c}=l,d=[];if(!c)return L();if(c.type==="2d"){a&&d.push(e._fadeExistingFeatures(a.layer));const w=ht((k,F)=>Promise.all(k.map(A=>ae(A,o,F))));d.push(x(()=>c.scale,k=>w(i.graphics,k)))}const u=_i(t.fullTemplate,a?.attributeOverrides),p=x(()=>r.createGraphic,w=>{w&&!e.hasHandles(jt)&&e._updatingHandles.addPromise(Uc({creationAttributes:u,data:t,sketchViewModel:r,view:c,webStyleCache:o}).then(k=>e.addHandles(k,jt)))}),h=async w=>{if(w.state!=="cancel"&&w.state!=="complete"||e.removeHandles(jt),w.state==="cancel"&&c.activeTool!==null&&c.activeTool!==e.sketchViewModel.activeComponent&&(await e._waitForActiveToolCleared(),await e._startCreating()),w.state==="complete"&&w.graphic){const k=await e._processEdits(w.graphic,{scale:c.type==="2d"?c.scale:null,useSourceLayer:!0,webStyleCache:e._webStyleCache});k&&(await e._waitForActiveToolCleared(),await e._startUpdating({feature:k}))}},m=async w=>{const{attachmentsViewModel:k}=l,{_formViewModel:F}=e;if(w.graphics.length>1)return void await e._clearSelectedFeature();const A=w.graphics[0];if(w.state==="complete"){const{submittable:V}=F;if(e.numPendingFeatures!==a?.maxFeatures&&V||F.submit(),await e._clearSelectedFeature(),k.mode!=="add"&&k.mode!=="edit"||await l.activeWorkflow?.previous(),!w.aborted&&c.activeTool===e.sketchViewModel.activeComponent&&(await e.sketchViewModel.wait(),e.sketchViewModel.state==="ready"&&e.data.creationInfo?.layer.geometryType!=="mesh"))return e._startCreating()}else{if(w.state==="start")return A.sourceLayer??=t.creationInfo?.layer,await Pr({graphic:A,sketchLayer:i,sketchViewModel:r,visualVariables:e._visualVariableAttributes,webStyleCache:e._webStyleCache,sourceLayer:A.sourceLayer}),e._selectFeatureForUpdate({feature:A});if(w.state==="active"){await e.updatePendingFeature(A);const V=e._visualVariableAttributes;Rr(c,A,w,V)&&await ae(A,e._webStyleCache,c.type==="2d"?c.scale:null);const P=A.attributes,{rotation:R,size:ue}=V;if(R!=null){const{field:U}=R;F.setValue(U,P[U])}if(ue!=null){const{field:U}=ue;F.setValue(U,P[U])}}}},g=async w=>{if(w.graphics.forEach(k=>{t.removePendingFeature(k)}),!Qe(t.creationInfo))return e._startCreating()},y=async()=>{if(Qe(t.creationInfo))try{await e.data.viewModel.back()}catch{}return e._startCreating()};d.push(p,r.on("create",w=>e._updatingHandles.addPromise(h(w))),r.on("update",w=>e._updatingHandles.addPromise(m(w))),r.on("delete",w=>e._updatingHandles.addPromise(g(w))),Ve(()=>!e.numPendingFeatures,()=>e._updatingHandles.addPromise(y())),L(()=>{r.cancel()}),vd(r,i,t),..._d(t));const b=de(d);return r.addHandles(b),b}_initializeSketchViewModel(){const{data:e}=this,{view:t}=e.viewModel,i=new It({elevationInfo:e.creationInfo?.layer.elevationInfo,internal:!0,listMode:"hide",title:"createFeaturesWorkflow-internal"}),r=new ci({layer:i,creationMode:"single",sketchOptions:e.sketchOptions,snappingManager:e.snappingManager,updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},view:t});this._sketchLayer=i,this._sketchViewModel=r,t?.map.add(i),this.addHandles([L(()=>{t?.destroyed||t?.map.remove(i),i.destroy()}),x(()=>this.numPendingFeatures>0,o=>this._sketchViewModel.updateOnGraphicClick=o,re)])}_hasValidationErrors(e){return!!e&&(!this.data.isSubmittable(e)||!!this._formViewModel.validateContingencyConstraints(e.attributes,{includeIncompleteViolations:!0})?.length)}async _processEdits(e,t){const{data:i,_formViewModel:r,_sketchLayer:o}=this,{layerInfos:a,view:l}=i.viewModel;r.editType="INSERT",r.map=l?.map,r.spatialReference=l?.spatialReference;const{templateExecutorInfo:c}=i;if(!c){const h=e.clone();return h.geometry=null,await this._addAndInitializeEdits(e,h),e}o.remove(e);const{executor:d}=c,u=d(e.geometry,"completion"),p=No(u)?await u:u;c.completionResults.push(p),Pa(p.relationships),r.editType="INSERT",r.map=l?.map,r.spatialReference=l?.spatialReference,p.primary&&i.creationInfo?.attributeOverrides&&(p.primary.graphic.attributes={...p.primary.graphic.attributes,...i.creationInfo.attributeOverrides});for(const h of p.edits){let m=null;if(h.addFeatures)for(const g of h.addFeatures){const y=g.clone();y.geometry=null,g.geometry!=null&&(g.symbol=await Si(g,t),o.add(g)),g.sourceLayer!==m?.layer&&(m=Xi(a,g.sourceLayer));const b=!!p.associationGraphics?.has(g);await this._addAndInitializeEdits(g,y,m,b)}}return r.feature=null,await O(()=>!r.updating),p.edits.reduce((h,m)=>h+(m.addFeatures?.length??0),0)>1?null:p.primary?.graphic}async _addAndInitializeEdits(e,t,i,r=!1){const{data:o,_formViewModel:a}=this,{layerInfos:l}=o.viewModel,c=o.addPendingFeature(e,t,{isAssociation:r});i??=Xi(l,e.sourceLayer),a.feature=e,a.formTemplate=i?.formTemplate,await O(()=>!a.updating),c.updateAttributes(a.getValues()),c.submittable=a.submittable}async _setUpCreatingFeaturesStep(){if(this.hasHandles(mi))return;const{data:e,sketchViewModel:t}=this,{creationInfo:i,viewModel:r}=e,{attachmentsViewModel:o,view:a}=r;if(!a||!i?.layer)throw new v("missing-parameters","CreateFeaturesWorkflow requires a view and creationInfo.");const{initialFeature:l,layer:c}=i,d=[],u=[];this._featureFormHandle=bt(this._featureFormHandle),this._visualVariableAttributes={rotation:null,size:null},e.editorItem=it(r.editorItems,i.layer),i.template&&(e.fullTemplate==null&&await this._initializeFullTemplateAndExecutorInfo(e),u.push(L(()=>{e.templateExecutorInfo&&(e.templateExecutorInfo.completionResults=[])}))),t.allowDeleteKey=!e.isSharedTemplateWorkflow,dd(o),d.push(x(()=>o.mode,F=>{switch(F){case"add":this.go("adding-attachment");break;case"edit":this.go("editing-attachment")}}));const p=Wa(a);d.push(p);const h=et(i.layer),{template:m}=i,g=!m||ta(m)||ei(m)&&m.type==="feature",y=h&&g;try{if(y){const F=l??new ni({attributes:_i(e.fullTemplate,i.attributeOverrides),sourceLayer:c}),A=await this._processEdits(F);A&&await this._startUpdating({feature:A})}else d.push(xi._configureSketchViewModel(this)),l?(Qe(i)&&i.geometryToPlace&&(l.attributes=_i(e.fullTemplate,i.attributeOverrides)),t.addGraphic(l),await this._startUpdating({feature:l})):await this._startCreating()}finally{p.remove()}const b=L(()=>{for(const F of e.pendingFeatures)t.removeGraphic(F),e.removePendingFeature(F)}),w=x(()=>a?.timeZone,F=>{this._formViewModel.timeZone=F,this.data.timeZone=F},re),k=L(()=>{Qe(i)&&r.cancelWorkflow({warnIfNoWorkflow:!1})});this._featureFormHandle&&d.push(this._featureFormHandle),this.addHandles(d,this._handleKeys.beforeCommit),this.addHandles(u,this._handleKeys.afterCommit),this.addHandles([L(()=>o.fileInfos.removeAll()),de(d),de(u),k,b,w],mi)}async _waitForActiveToolCleared(){const e=this.data.viewModel.view;if(e?.activeTool==null)return;const t=new AbortController;this.addHandles(xt(t),ko),await O(()=>e?.activeTool==null,t.signal),t.abort()}};function vd(e,t,i){let r=null;const o=()=>e.snappingOptions.featureSources,a=()=>(r=new ra({layer:t}),o().add(r),r),l=()=>{r!=null&&(o().remove(r),r=ct(r))};return de([x(()=>{const c=i.creationInfo?.layer,d=o().find(u=>u.layer===c);return{hasFeatureLayerSource:!!d,enabled:d?.enabled??!1}},({hasFeatureLayerSource:c,enabled:d})=>{if(!c)return l();r??=a(),r.enabled=d},rt),L(l)])}function _d(e){const t=e.viewModel.view;if(!t)return[];const i=[];if(t.type==="3d"){const o=new ze({view:t});i.push(x(()=>e.selectedPendingFeature,(a,l)=>{o.remove(a),o.add(l)}),L(()=>o.destroy()))}const r=new ze({view:t,highlightName:Ft});return i.push(x(()=>e.temporaryHighlightFeature,o=>{r.removeAll(),r.add(o)}),L(()=>r.destroy())),i}function bd(e,t,i,r){const o=[];return t.forEach((a,l)=>{if(!a.error){const c=e[l],d=r.get(c)||[];c.attributes[i.objectIdField]=a.objectId,d.forEach(({form:u})=>o.push({feature:c,attachment:u}))}}),o}function kd(e){for(const t of e){const{sourceLayer:i}=t;i&&"globalIdField"in i&&i.globalIdField!=null&&(t.attributes[i.globalIdField]??=Mr())}}function xd(e,t){const i=[];if(!t||t.size===0)return{addFeatures:e};for(const[r,o]of t)for(const{file:a}of o)i.push({feature:r,attachment:{globalId:Mr(),data:a}});return i.length?{addFeatures:e,addAttachments:i}:{addFeatures:e}}function Fd(e,t){return e.map(i=>{const{addFeatures:r}=i;if(!r||r.length===0)return i;const o=[];for(const a of r){const l=t.get(a);if(l)for(const{file:c}of l)o.push({feature:a,attachment:{globalId:Mr(),data:c}})}return o.length?{...i,addAttachments:o}:i})}s([n()],D.prototype,"allowSave",null),s([n()],D.prototype,"createFeatureState",void 0),s([n()],D.prototype,"data",void 0),s([n({constructOnly:!0})],D.prototype,"isNested",void 0),s([n()],D.prototype,"formViewModel",null),s([n()],D.prototype,"hasInvalidFormTemplate",null),s([n()],D.prototype,"hasPendingEdits",null),s([n()],D.prototype,"hasPreviousStep",null),s([n()],D.prototype,"_getDrawMeshHelpMessage",void 0),s([n()],D.prototype,"helpMessage",null),s([n()],D.prototype,"layer",null),s([n()],D.prototype,"parent",null),s([n()],D.prototype,"keyboardCancellationEnabled",null),s([n()],D.prototype,"reliesOnOwnerAdminPrivileges",null),s([n()],D.prototype,"saveActionLabel",null),s([n()],D.prototype,"shouldShowAttachments",null),s([n()],D.prototype,"shouldAllowAttachmentEditing",null),s([n()],D.prototype,"sketchViewModel",null),s([n()],D.prototype,"availableCreateTools",null),s([n()],D.prototype,"_attachmentsActive",null),D=xi=s([M("esri.widgets.Editor.CreateFeaturesWorkflow")],D);const Ra=D;let he=class extends j{constructor(t){super(t),this._featureTitleMap=null,this.editorItem=null,this.features=[],this.initialFeatures=[],this.keyFeature=null,this.edits=null,this.mergedGeometry=null,this.parent=null,this.temporaryHighlightFeature=null,this.viewModel=null}async initialize(){const{features:t,timeZone:i}=this,{layer:r}=this.editorItem;if(this.keyFeature??=t[0],this.initialFeatures.length===0&&(this.initialFeatures=t.slice()),!("getFeatureTitle"in r))return;const o=await Promise.all(t.map(async a=>[a,await r.getFeatureTitle(a,{fetchMissingFields:!1,timeZone:i})]));this._featureTitleMap=new le(o)}get _initialFeatureMap(){const t=new Map(this.initialFeatures.map(o=>[o.getObjectId(),o])),i=new Map(this.features.map(o=>[o.getObjectId(),o])),r=new Map;for(const[o,a]of i){const l=t.get(o);o&&l&&r.set(a,l)}return r}get timeZone(){return this.viewModel.view?.timeZone}set timeZone(t){t==null?this._clearOverride("timeZone"):this._override("timeZone",t)}getFeatureTitle(t){return this._featureTitleMap?.get(t)}getInitialFeature(t){return this._initialFeatureMap.get(t)}};s([n()],he.prototype,"_featureTitleMap",void 0),s([n()],he.prototype,"_initialFeatureMap",null),s([n({constructOnly:!0})],he.prototype,"editorItem",void 0),s([n({constructOnly:!0})],he.prototype,"features",void 0),s([n()],he.prototype,"initialFeatures",void 0),s([n()],he.prototype,"keyFeature",void 0),s([n()],he.prototype,"edits",void 0),s([n()],he.prototype,"mergedGeometry",void 0),s([n()],he.prototype,"parent",void 0),s([n()],he.prototype,"temporaryHighlightFeature",void 0),s([n()],he.prototype,"timeZone",null),s([n()],he.prototype,"viewModel",void 0),he=s([M("esri.widgets.Editor.MergeFeaturesWorkflowData")],he);const Id=he;let xo=class extends v{constructor(t=!1){super("editing:fetch-feature",`Failed to fetch the full ${t?"features":"feature"} from the service.`)}},yr=class extends v{constructor(t){super("editing:not-enough-features",`At least ${t} ${t===1?"feature is":"features are"} required to perform this operation.`)}},Fo=class extends v{constructor(){super("editing:invalid-argument","Key feature must be one of the features being merged")}},Ad=class extends v{constructor(){super("editing:unsupported-workflow","Merge features workflow requires a layer with geometry type 'polygon', 'polyline', or 'multipoint' that allows deleting features and updating their geometries.")}},Yt=class extends v{constructor(){super("editing:multiple-layers-not-supported","Features must belong to the same layer.")}},Io=class extends v{constructor(){super("editing:layer-required","The feature must be associated with a layer to start a split feature workflow.")}},Md=class extends v{constructor(t){super("editing:unsupported-in-3d",`Workflow type ${t} is not supported in 3D.`)}},Cd=class extends v{constructor(){super("editing:unsupported-workflow","Split feature workflow requires a layer with geometry type 'polygon', 'polyline', or 'multipoint' that allows creating features and updating their geometries.")}};function Ha(e){if(qo(e.map(t=>Vr(t))).length>1)throw new Yt}function Da(e){if(!e.supportsMergeFeaturesWorkflow)throw new Ad}function Ed(e,t){if(e.length<t)throw new yr(t)}function za(e){if(!e.supportsSplitFeatureWorkflow)throw new Cd}function Vi(e,t){if(e.view?.type==="3d")throw new Md(t)}function Td(e){return e==="multipoint"||e==="polygon"||e==="polyline"}async function Sd(){return{unionOperator:await _(()=>import("./unionOperator-By4XjY8Y.js").then(e=>e.u),__vite__mapDeps([74,1,2,75,76,77,78,79,80,81,82,83]))}}async function Ld(e){const{unionOperator:t}=await Sd(),i=e.map(o=>{if(!o.geometry)throw new v("editing:invalid-argument","All features must have a geometry.");return o.geometry}),r=t.executeMany(i);if(!r)throw new v("editing:merge-failed","Failed to merge feature geometries.");return r}var wr;const Ao=Symbol();let Te=wr=class extends Nt{constructor(e){super(e),this.type="merge-features",this._formViewModel=null,this._graphicsLayer=null,this._highlightHelper=null,this._webStyleCache=new Map}initialize(){const e=this.data.viewModel.view;this._highlightHelper=e?new ze({view:e}):null,this._initializeFeatureFormViewModel(),this._initializeGraphicsLayer(),this._createAndInitializeEdits(this.data.keyFeature)}destroy(){const e=this._graphicsLayer,{view:t}=this.data.viewModel;t?.destroyed||t?.map.remove(e),this._graphicsLayer=ct(this._graphicsLayer),this._formViewModel?.destroy(),this._highlightHelper?.destroy()}get formViewModel(){return this._formViewModel}get hasPendingEdits(){return!1}get layer(){return this.data.editorItem.layer}get parent(){return this.data.parent}get shouldShowAttachments(){return this.data.editorItem.capabilities.attachments.enabled}static async create(e){const{applyEdits:t,applyEditsFeatureService:i,...r}=e,{editorItem:o,features:a}=r;if(Vi(r.viewModel,"merge-features"),Da(o),Ed(a,2),Ha(a),r.keyFeature&&!a.includes(r.keyFeature))throw new Fo;const l=await Ld(a),c=new wr({data:new Id({...r,mergedGeometry:l}),onCommit:Od(t)});return c._set("steps",$d()),c}async enter(){this._configureAttachmentsViewModel()}exit(){}isKeyFeature(e){return this.data.keyFeature===e}isTemporaryHighlightFeature(e){return this.data.temporaryHighlightFeature===e}async setKeyFeature(e){const{data:t}=this;if(e!==t.keyFeature){if(!t.features.includes(e))throw new Fo;t.keyFeature=e,await this._createAndInitializeEdits(e)}}async start(){return await super.start(),this._makeSketchController()}getFeatureTitle(e){return this.data.getFeatureTitle(e)}async _createAndInitializeEdits(e){const{data:t}=this,i=e.clone();i.geometry=t.mergedGeometry;const r=new Ht({feature:i});t.edits=r;const o=t.getInitialFeature(e)||e;r.trackChanges(o),await this._setFeatureOnFormViewModel(i,o),this._setFeatureOnAttachmentsViewModel(e)}_initializeFeatureFormViewModel(){const{data:e,_webStyleCache:t}=this,i=e.viewModel.view,r=new Pi({disabled:!0,editType:"UPDATE",formTemplate:e.editorItem.formTemplate,highlightHelper:this._highlightHelper,map:i?.map,spatialReference:i?.spatialReference,timeZone:e.timeZone});this._formViewModel=r,this.addHandles(Z(()=>r,"value-change",({feature:o,fieldName:a,value:l})=>{const c=e.edits;o&&c&&(c.setAttribute(a,l),ae(o,t,i?.scale))}))}_initializeGraphicsLayer(){const{data:e}=this,{view:t}=e.viewModel,i=new It({elevationInfo:e.editorItem.layer.elevationInfo,internal:!0,listMode:"hide",title:"mergeFeaturesWorkflow-internal"});this._graphicsLayer=i,t?.map.add(i)}_makeSketchController(){return{enter:async()=>{this.addHandles(Wd(this.data),Ao)},exit:()=>{this.removeHandles(Ao)}}}async _setFeatureOnFormViewModel(e,t){const i=this._formViewModel;i.feature=e,i.overrideInitialFeature(t),await O(()=>!i.updating)}_configureAttachmentsViewModel(){const{data:e}=this,{keyFeature:t,viewModel:i}=e,{attachmentsViewModel:r}=i;r.set({capabilities:{editing:!1},graphic:t,filesEnabled:!1,mode:"view"})}_setFeatureOnAttachmentsViewModel(e){this.data.viewModel.attachmentsViewModel.graphic=e}};s([n()],Te.prototype,"formViewModel",null),s([n()],Te.prototype,"hasPendingEdits",null),s([n()],Te.prototype,"layer",null),s([n()],Te.prototype,"parent",null),s([n()],Te.prototype,"shouldShowAttachments",null),s([n()],Te.prototype,"type",void 0),s([n()],Te.prototype,"_formViewModel",void 0),s([n()],Te.prototype,"_graphicsLayer",void 0),s([n()],Te.prototype,"_highlightHelper",void 0),Te=wr=s([M("esri.widgets.Editor.MergeFeaturesWorkflow")],Te);const Vd=Te;function $d(){return[{id:"choosing-key-feature",async setUp(){},async tearDown(){}}]}function Od(e){return async t=>{const{edits:i,keyFeature:r}=t,o=i?.feature?.cloneShallow(),a=t.editorItem.layer;if(!i||!o)throw new v("editing:missing-feature","Workflow data has no edits to submit.");i.attributesModified||(o.attributes=gr(o,t.editorItem.layer));const l=[];for(const c of t.features){if(c===r)continue;const d=c.cloneShallow();d.attributes=gr(d,a),d.geometry=null,l.push(d)}await e(a,{updateFeatures:[o],deleteFeatures:l})}}function Wd(e){const t=e.viewModel.view;if(!t)return L();const i=new ze({view:t});for(const c of e.features)i.add(c);const r=new ze({view:t,highlightName:Ft}),o=x(()=>e.keyFeature,c=>{r.removeAll(),r.add(c)},re),a=new ze({view:t,highlightName:Ft}),l=x(()=>e.temporaryHighlightFeature,c=>{a.removeAll(),c&&a.add(c)});return de([Jt(i),o,Jt(r),l,Jt(a)])}let se=class extends j{constructor(t){super(t),this.editorItem=null,this.newFeatureEdits=null,this.existingFeatureEdits=null,this.feature=null,this.initialFeature=null,this.sketchOptions=new zt,this.snappingManager=null,this.splitResult=null,this.splitterGeometry=null,this.temporaryHighlightFeature=null,this.viewModel=null}initialize(){this.initialFeature||(this.initialFeature=this.feature)}get timeZone(){return this.viewModel.view?.timeZone}set timeZone(t){t==null?this._clearOverride("timeZone"):this._override("timeZone",t)}getEditsForFeature(t){const{existingFeatureEdits:i,newFeatureEdits:r}=this;return i?.feature===t?i:r?.feature===t?r:null}getRoleForFeature(t){const{existingFeatureEdits:i,newFeatureEdits:r}=this;return i?.feature===t?"existing":r?.feature===t?"new":null}};s([n({constructOnly:!0})],se.prototype,"editorItem",void 0),s([n()],se.prototype,"newFeatureEdits",void 0),s([n()],se.prototype,"existingFeatureEdits",void 0),s([n()],se.prototype,"feature",void 0),s([n()],se.prototype,"initialFeature",void 0),s([n()],se.prototype,"parent",void 0),s([n({constructOnly:!0})],se.prototype,"sketchOptions",void 0),s([n()],se.prototype,"snappingManager",void 0),s([n()],se.prototype,"splitResult",void 0),s([n()],se.prototype,"splitterGeometry",void 0),s([n()],se.prototype,"temporaryHighlightFeature",void 0),s([n()],se.prototype,"timeZone",null),s([n()],se.prototype,"viewModel",void 0),se=s([M("esri.widgets.Editor.SplitFeatureWorkflowData")],se);const Pd=se;function Vh(e){return e.vcsWkid||e.latestVcsWkid?Ds(e)/zs(e):1}function Ua(e,t,i,r){return e==null||t==null?null:e+(t-e)/i*r}function Rd(e,t,i){let r=t[0]-e[0],o=t[1]-e[1];const a=Math.hypot(r,o);return r/=a,o/=a,r*=i,o*=i,[e[0]+r,e[1]+o]}function Hd(e,t,i,r){const o=Gs(t[0]-e[0],t[1]-e[1],t[2]*r-e[2]*r);return js(o,o),Bs(Zs(),e,o,i)}function $h(e,t){let i=0,r=null;const o=e.hasM,a=e.hasZ?3:2;for(const l of e.paths){if(t===0){r=new $t({x:l[0][0],y:l[0][1],...o?{m:l[0][a]}:{},spatialReference:e.spatialReference,hasM:o});break}for(let c=0;c<l.length-1;c++){const d=Ns(l[c],l[c+1]),u=i+d;if(u===t){r=new $t({x:l[c+1][0],y:l[c+1][1],...o?{m:l[c+1][a]}:{},spatialReference:e.spatialReference,hasM:o});break}if(u>t){const p=Rd(l[c],l[c+1],t-i);r=new $t({x:p[0],y:p[1],...o?{m:Ua(l[c][a],l[c+1][a],d,t-i)??void 0}:{},spatialReference:e.spatialReference,hasM:o});break}i+=d}if(r!==null)break}return r}function Oh(e,t,i){let r=0;const o=e.hasM;for(const a of e.paths){if(t===0)return new $t({x:a[0][0],y:a[0][1],z:a[0][2],...o?{m:a[0][3]}:{},hasZ:!0,hasM:o,spatialReference:e.spatialReference});for(let l=0;l<a.length-1;l++){const c=Dd(a[l],a[l+1],i),d=r+c;if(d===t)return new $t({x:a[l+1][0],y:a[l+1][1],z:a[l+1][2],...o?{m:a[l+1][3]}:{},hasZ:!0,hasM:o,spatialReference:e.spatialReference});if(d>t){const u=Hd(ro(a[l]),ro(a[l+1]),t-r,i);return new $t({x:u[0],y:u[1],z:u[2],...o?{m:Ua(a[l][3],a[l+1][3],c,t-r)??void 0}:{},hasZ:!0,hasM:o,spatialReference:e.spatialReference})}r+=c}}return null}function Dd(e,t,i){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]!==void 0&&t[2]!==void 0?e[2]*i-t[2]*i:0)}function zd(e,t,i,r,o=.001){if(Us(t))return[[e,i],[i,t]];const[a,l]=Yn(e,t,i,o);if(r&&i[2]!=null){const c=i[2];sr(a)[2]=c}return[[e,a],[sr(a),l]]}async function Ud(e,t){if(e.type==="point"||e.type==="extent"||e.type==="mesh")throw new v("editing:unsupported-split-geometry",`Cannot split geometry of type ${e.type}`);if(t.type==="point"&&Di(e))return await Nd(e,t);if(t.type==="polyline"&&Ur(e))return jd(e,t);if(t.type==="polygon"&&zr(e))return Gd(e,t);throw new v("editing:unsupported-split-geometry",`Geometry of type ${t.type} cannot be used to split geometry of type ${e.type}`)}async function Nd(e,t){const{apiConverter:i,arcadeMeasures:{pointToCoordinate:r},lengthOperator:o}=await Bd(),a=i.fromSpatialReference(e.spatialReference)?.getTolerance()??.001,l=r(e,t);if(l==null||l.distance==null||l.distance>a)return null;const c=r(e,l.coordinate);if(c==null||c.distanceAlong==null||c.partId==null||c.segmentId==null)throw new v("editing:split-by-point-failed","Failed to determine the split point on the polyline.");const d=c.coordinate.hasZ&&e.hasZ,u=Xn(d,e.hasM,e.spatialReference),p=qs(e),h=p?e.curvePaths:e.paths,m=[],g=[];for(let V=0;V<h.length;V++){const P=h[V];if(V<c.partId)m.push(P);else if(V>c.partId)g.push(P);else{const R=[],ue=[];for(let U=0;U<P.length;U++){const ft=P[U];if(U<c.segmentId)R.push(ft);else if(U>c.segmentId)ue.push(ft);else{const ui=sr(ft),Br=P.at(U+1),zi=u.pointToArray(c.coordinate);if(U++,!Br){R.push(ft,zi),ue.push(zi);continue}const[Ya,Xa]=zd(ui,Br,zi,d,a);R.push(...Ya),ue.push(...Xa)}}R.length>0&&m.push(R),ue.length>0&&g.push(ue)}}const y=new oo({[p?"curvePaths":"paths"]:m,spatialReference:e.spatialReference,hasZ:e.hasZ,hasM:e.hasM}),b=new oo({[p?"curvePaths":"paths"]:g,spatialReference:e.spatialReference,hasZ:e.hasZ,hasM:e.hasM}),w=o.execute(y),k=o.execute(b),F=Math.max(w,k);if(F===0)return null;const A=F===w?y:b;return{remainingPart:A,newPart:Math.min(w,k)===0?null:A===y?b:y}}async function Gd(e,t){const{differenceOperator:i,intersectionOperator:r}=await Zd(),o=r.execute(e,t);if(!o)return null;const a=i.execute(e,t);return a?{newPart:o,remainingPart:a}:{newPart:null,remainingPart:o}}async function jd(e,t){const{cutOperator:i}=await qd(),r=i.execute(e,t);if(r.length!==2)return null;const o=r[0];return{newPart:r[1]??null,remainingPart:o}}function Di(e){return e.type==="polyline"}function zr(e){return e.type==="polygon"||e.type==="polyline"||e.type==="multipoint"}function Ur(e){return e.type==="polygon"||e.type==="polyline"}async function Bd(){const[e,t,i]=await Promise.all([_(()=>import("./apiConverter-jueJBHyz.js"),__vite__mapDeps([83,75,77,76,78,79,1,2,80,81])),_(()=>import("./measures-DWa78IKg.js").then(r=>r.m),__vite__mapDeps([84,1,2,65])),_(()=>import("./lengthOperator-D89j2ysp.js").then(r=>r.l),__vite__mapDeps([85,1,2,75,77,76,78,79,80,81,83]))]);return{apiConverter:e,lengthOperator:i,arcadeMeasures:t}}async function Zd(){const[e,t]=await Promise.all([_(()=>import("./differenceOperator-Bz1kAB0n.js").then(i=>i.d),__vite__mapDeps([86,75,76,77,78,79,1,2,80,81,83])),_(()=>import("./intersectionOperator-gU2sAccy.js").then(i=>i.a),__vite__mapDeps([87,1,2,75,76,77,78,79,80,81,88,83]))]);return{differenceOperator:e,intersectionOperator:t}}async function qd(){return{cutOperator:await _(()=>import("./cutOperator-DRkmjMLj.js").then(e=>e.c),__vite__mapDeps([89,1,2,75,76,77,78,79,80,81,83]))}}function Jd(e){return e==="multipoint"||e==="polygon"||e==="polyline"}function Mo(e){if(!e)throw new v("editing:cannot-split-geometry","No geometry provided.");if(zr(e)||Ur(e)||Di(e))return e;throw new v("editing:cannot-split-geometry",`Cannot split geometry of type ${e.type}`)}function Co(e,t){return t==="point"&&Di(e)||t==="polyline"&&Ur(e)||t==="polygon"&&zr(e)?t:Qd(e)}function Qd(e){return e.type==="polyline"?"point":"polyline"}function Kd(e){const t=e?.type;return t==="point"||t==="polyline"||t==="polygon"}function Yd(e,t){const{fieldsIndex:i}=t,r={...e};if("globalIdField"in t&&t.globalIdField&&delete r[i.get(t.globalIdField)?.name??t.globalIdField],t.objectIdField&&delete r[i.get(t.objectIdField)?.name??t.objectIdField],"relationships"in t&&t.relationships){for(const o of t.relationships)if(o.cardinality==="one-to-one"||o.role==="origin"&&o.cardinality==="one-to-many"){const a=i.get(o.keyField)?.name??o.keyField;r[a]!=null&&delete r[a]}}return r}var Fi;const er=Symbol(),Xd=Symbol();let G=Fi=class extends Nt{constructor(e){super(e),this.defaultSplitterGeometryType=null,this.type="split-feature",this._activeFeature=null,this._formViewModel=null,this._graphicsLayer=null,this._highlightHelper=null,this._lastSplitterGeometryWasInvalid=!1,this._sketchViewModel=null,this._webStyleCache=new Map}initialize(){const e=this.data.viewModel.view;this._highlightHelper=e?new ze({view:e,highlightName:Ft}):null,this._initializeFormViewModel();const t=this._initializeGraphicsLayer();this._initializeSketchViewModel(t)}destroy(){const e=this._graphicsLayer,{view:t}=this.data.viewModel;t?.destroyed||t?.map.remove(e),this._graphicsLayer=ct(this._graphicsLayer),this._formViewModel.destroy(),this._sketchViewModel.destroy(),this._highlightHelper?.destroy()}get activeFeature(){return this._activeFeature}get allowSave(){const{data:e}=this;return e.existingFeatureEdits!=null&&e.newFeatureEdits!=null&&!this.updating}get availableCreateTools(){const e=["polyline","polygon","rectangle","circle","freehandPolyline","freehandPolygon"];switch(this.data.editorItem.layer.geometryType){case"polygon":case"multipoint":return e;case"polyline":return["point",...e];default:return[]}}get formViewModel(){return this._formViewModel}get hasInvalidFormTemplate(){return!!this.data.editorItem?.hasInvalidFormTemplate}get hasPreviousStep(){return this._activeFeature!==null||this._stepIndex>0}get helpMessage(){const{activeCreateToolDrawMode:e,activeTool:t,createGraphic:i}=this._sketchViewModel,r=Qn(t);if(r!=="mesh")return sa(r,i?.geometry,e)}get layer(){return this.data.editorItem.layer}get parent(){return this.data.parent}get updating(){return this._updatingHandles.updating||this._formViewModel.updating||this._sketchViewModel.updating}get noticeMessage(){return this._lastSplitterGeometryWasInvalid?"invalidSplitterGeometry":void 0}async back(e){return this.activeFeature?await this.setActiveFeature(null):await super.back(e)}static create(e){const{applyEdits:t,applyEditsFeatureService:i,defaultSplitterGeometryType:r,startAt:o,...a}=e;if(Vi(e.viewModel,"split-feature"),za(a.editorItem),o==="reviewing-features"){if(!a.splitterGeometry)throw new v("editing:split-geometry-required","Must provide the split geometry to start at the 'reviewing-features' step.");const c=Co(Mo(a.feature.geometry),a.splitterGeometry.type);if(a.splitterGeometry.type!==c)throw new v("editing:incompatible-split-geometries",`Geometry of type '${a.splitterGeometry.type}' cannot be used to split geometry of type '${a.feature.geometry?.type}'.`)}const l=new Fi({data:new Pd(a),defaultSplitterGeometryType:r,onCommit:tu(e.applyEdits)});return l._set("steps",Fi._createWorkflowSteps(l,o)),l}async enter(){}exit(){if(this.stepId!=="reviewing-features")throw new v("editing:invalid-exit-state","The SplitFeatureWorkflow can only be exited when in the 'reviewing-features' step.")}async setActiveFeature(e){const t=this._activeFeature;if(e===t)return;const i=this.data,r=t?i.getEditsForFeature(t):null;if(r&&(r.submittable=this._formViewModel.submittable),this._activeFeature=e,e==null)return;const o=this.data.getRoleForFeature(e);if(!o)throw new v("editing:unknown-feature","The provided feature is not part of this workflow.");await this._setFeatureOnFormViewModel(e,o)}async start(){return await super.start(),this._makeSketchController()}async _createAndInitializeEdits({newPart:e,remainingPart:t}){const{data:i}=this,r=i.feature,o=this._formViewModel,a=r.clone();a.geometry=t;const l=new Ht({feature:a});i.existingFeatureEdits=l,l.trackChanges(i.initialFeature),await this._setFeatureOnFormViewModel(a,"existing"),l.submittable=o.submittable;const c=r.clone();c.geometry=e,c.attributes=Yd(r.attributes,i.editorItem.layer);const d=new Ht({feature:c});return i.newFeatureEdits=d,d.trackChanges(),await this._setFeatureOnFormViewModel(c,"new"),d.submittable=o.submittable,{featureToCreate:c,featureToUpdate:a}}static _createWorkflowSteps(e,t="drawing-splitter-geometry"){const{data:i}=e;return Dr(["drawing-splitter-geometry","reviewing-features"],t,{"drawing-splitter-geometry":()=>({id:"drawing-splitter-geometry",async setUp(){const r=Mo(i.feature.geometry),o=Co(r,e.defaultSplitterGeometryType),{snappingManager:a}=i;Di(r)&&a&&e.addHandles(iu(a,e.layer));const l=e._sketchViewModel;e.addHandles([Z(()=>l,"create",async c=>{if(c.state==="start"&&e._lastSplitterGeometryWasInvalid&&(e._lastSplitterGeometryWasInvalid=!1),c.state==="complete"){e._graphicsLayer.removeAll();const d=c.graphic?.geometry;try{if(!Kd(d))throw new v("editing:invalid-split-geometry","The geometry produced by the Sketch operation cannot be used for splitting.");i.splitterGeometry=d,i.splitResult=await e._updatingHandles.addPromise(e._executeSplit(d)),await e.next()}catch{e._lastSplitterGeometryWasInvalid=!0,await l.create(c.tool)}}}),x(()=>l.activeTool,(c,d)=>{c==="point"&&!e.hasHandles(er)&&a?e.addHandles(ru(a,e.layer),er):d==="point"&&e.removeHandles(er)})],this.id),await l.create(o)},async tearDown(){e.removeHandles(this.id)}}),"reviewing-features":()=>({id:"reviewing-features",async setUp(){const r=i.splitterGeometry;if(!r)throw new v("editing:missing-splitter-geometry","The `splitterGeometry` property of the workflow's data must be set in order to start the 'reviewing-features' step.");const o=i.splitResult??await e._executeSplit(r),{featureToCreate:a,featureToUpdate:l}=await e._createAndInitializeEdits(o),c=await e._displayFeatureGraphics(l,a);e.addHandles(c,this.id)},async tearDown(){e.removeHandles(this.id)}})})}async _displayFeatureGraphics(e,t){const{data:i,_graphicsLayer:r}=this,o=i.viewModel.view,a=[];if(!e||!t||!o)return L();const l=ht(p=>Promise.all([ae(e,this._webStyleCache,p),ae(t,this._webStyleCache,p)]));await l(o.type==="2d"?o.scale:null),o.type==="2d"&&a.push(x(()=>o.scale,p=>l(p))),r.add(t),a.push(L(()=>r.remove(t)));const{feature:c}=i,d=c.layer,u=Js(d)&&d.title===ba&&d.internal?await au({editingGraphicsLayer:r,view:o,originalGraphicsLayer:d,editedGraphic:e}):await Hr(r,o,c,e);return a.push(u),de(a)}async _executeSplit(e){const{data:t}=this,{feature:i}=t,r=i.geometry;if(!r)throw new v("editing:feature-has-no-geometry","Cannot split the provided feature as it has no geometry.");const o=await Ud(r,e);if(!o||!o.newPart)throw new v("editing:split-failed","The split operation did not produce a valid result.");return o}_initializeFormViewModel(){const{data:e,_webStyleCache:t}=this,i=e.viewModel.view,r=new Pi({formTemplate:e.editorItem.formTemplate,highlightHelper:this._highlightHelper,map:i?.map,spatialReference:i?.spatialReference,timeZone:e.timeZone});this._formViewModel=r,this.addHandles(Z(()=>r,"value-change",({feature:o,fieldName:a,value:l})=>{o&&(e.getEditsForFeature(o)?.setAttribute(a,l),ae(o,t,i?.scale))}))}_initializeGraphicsLayer(){const{data:e}=this,{view:t}=e.viewModel,i=new It({elevationInfo:e.editorItem.layer.elevationInfo,internal:!0,listMode:"hide",title:"splitFeatureWorkflow-internal"});return this._graphicsLayer=i,t?.map.add(i),i}_initializeSketchViewModel(e){const{data:t}=this,{view:i}=t.viewModel;this._sketchViewModel=new ci({layer:e,creationMode:"single",sketchOptions:t.sketchOptions,snappingManager:t.snappingManager,updateOnGraphicClick:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},view:i})}_makeSketchController(){return{enter:async()=>this.addHandles(ou(this)),exit:()=>this.removeHandles(Xd),viewModel:this._sketchViewModel}}async _setFeatureOnFormViewModel(e,t){const{data:i}=this,r=this._formViewModel;r.feature=e,t==="existing"?(r.editType="UPDATE",r.overrideInitialFeature(i.initialFeature)):r.editType="INSERT",await O(()=>!r.updating)}get test(){}};s([n()],G.prototype,"activeFeature",null),s([n()],G.prototype,"allowSave",null),s([n()],G.prototype,"availableCreateTools",null),s([n()],G.prototype,"defaultSplitterGeometryType",void 0),s([n()],G.prototype,"formViewModel",null),s([n()],G.prototype,"hasInvalidFormTemplate",null),s([n()],G.prototype,"hasPreviousStep",null),s([n()],G.prototype,"helpMessage",null),s([n()],G.prototype,"layer",null),s([n()],G.prototype,"parent",null),s([n()],G.prototype,"type",void 0),s([n()],G.prototype,"updating",null),s([n()],G.prototype,"noticeMessage",null),s([n()],G.prototype,"_activeFeature",void 0),s([n()],G.prototype,"_formViewModel",void 0),s([n()],G.prototype,"_graphicsLayer",void 0),s([n()],G.prototype,"_highlightHelper",void 0),s([n()],G.prototype,"_lastSplitterGeometryWasInvalid",void 0),s([n()],G.prototype,"_sketchViewModel",void 0),G=Fi=s([M("esri.widgets.Editor.SplitFeatureWorkflow")],G);const eu=G;function tu(e){return async t=>{const{existingFeatureEdits:i,newFeatureEdits:r}=t,o=i?.feature?.cloneShallow(),a=r?.feature?.cloneShallow(),l=t.editorItem.layer;if(o==null||a==null)throw new v("editing:missing-features","Expected both a feature to update and a feature to add for the split operation.");i?.attributesModified||(o.attributes=gr(o,t.editorItem.layer)),await e(l,{addFeatures:[a],updateFeatures:[o]})}}function iu(e,t){if(e.options.featureSources.some(r=>r.layer===t))return L();const i=new ra({enabled:!1,layer:t});return e.options.featureSources.add(i),L(()=>{e.options.featureSources.remove(i),i.destroy()})}function ru(e,t){const{options:i}=e,r=i.enabled;i.enabled=!0;const o=i.featureEnabled;i.featureEnabled=!0;const a=i.distance;i.distance=15;const l=new Map;for(const c of i.featureSources)l.set(c,c.enabled),c.layer===t?c.enabled=!0:c.enabled=!1;return L(()=>{i.enabled=r,i.featureEnabled=o,i.distance=a;for(const[c,d]of l)c.enabled=d})}function ou(e){const t=e.data,{feature:i,viewModel:r}=t,{view:o}=r;if(!o)return L();const a=new ze({view:o}),l=x(()=>e.stepId,p=>{switch(a.removeAll(),p){case"drawing-splitter-geometry":a.add(i);break;case"reviewing-features":a.add(t.existingFeatureEdits?.feature),a.add(t.newFeatureEdits?.feature)}},re),c=new ze({view:o,highlightName:Ft}),d=x(()=>t.temporaryHighlightFeature,(p,h)=>{h&&h!==e.activeFeature&&c.remove(h),p&&c.add(p)}),u=x(()=>e.activeFeature,(p,h)=>{h&&h!==t.temporaryHighlightFeature&&c.remove(h),p&&c.add(p)});return de([l,d,u,Jt(a),Jt(c)])}async function au({editingGraphicsLayer:e,view:t,originalGraphicsLayer:i,editedGraphic:r}){function o(a){i.visible=a}return e.add(r),await $a(t,r),o(!1),de([L(async()=>{o(!0);try{if(!t.destroyed){const a=await ut(t,i).catch(()=>{});a&&!a.destroyed&&await O(()=>!a.updating)}}finally{e.remove(r)}})])}let ne=class extends Qs{constructor(t){super(t),this.editorItems=[],this.featureInfos=null,this.parent=null,this.selectedFeature=null,this.sketchOptions=null,this.snappingManager=null,this.viewModel=null,this._editorItemsByLayer=new le,this._fullFeatures=new le,this._pendingEdits=new le}initialize(){const t=new AbortController;this.addResolvingPromise(this._initializeFullFeatures(t.signal).then(i=>{pt(t.signal),this._initializeEdits(i)}).catch(i=>{throw Ks(i)?new v("update-features-workflow:full-features-aborted","Fetching of full features was aborted."):i})),this.addHandles(xt(t)),this._initializeEditorItemsByLayer()}get features(){return this.fullFeatures}get fullFeatures(){return Array.from(this._fullFeatures.values())}get initialFeatures(){return Array.from(this._pendingEdits.values()).map(t=>t.initialFeature).filter(Q)}get layers(){const{featureInfos:t,features:i}=this;return t?.length?t.map(r=>r.layer):i.length?qo(i.map(r=>r.sourceLayer).filter(Q)):[]}set timeZone(t){this._set("timeZone",t),this._pendingEdits.forEach(i=>{i.timeZone=t})}getEditorItemForLayer(t){return this._editorItemsByLayer.get(t)}getFeatureTitle(t){return this._pendingEdits.get(t)?.displayTitle}getPendingEditsForFeature(t){const i=t.getObjectId();if(i!=null)return this._pendingEdits.get(this._fullFeatures.get(i)??t)}isSubmittable(t){const i=this._pendingEdits.get(t);return!!i&&(i.submittable||i.isAssociation)}stageDelete(){for(const t of this._pendingEdits.values())t.stageDelete()}_initializeEditorItemsByLayer(){for(const t of this.editorItems)this._editorItemsByLayer.set(t.layer,t)}_initializeEdits(t){const{timeZone:i}=this;for(const r of t){const o=new Ht({feature:r,timeZone:i});o.trackChanges(),this._pendingEdits.set(r,o)}}async _initializeFullFeatures(t){const{_fullFeatures:i,featureInfos:r,features:o,viewModel:a}=this,{spatialReference:l}=a.view,c=new Map;if(r?.length)for(const{layer:u,objectIds:p}of r)c.set(We(u)?u.parent:u,p);else if(o.length)for(const u of o){const p=u.getObjectId();if(p!=null){const h=u.sourceLayer??u.layer,m=We(h)?h.parent:h;ce(c,m,()=>[]).push(p)}}const d=Array.from(c.entries()).map(async([u,p])=>{const h=await Wr(p,u,l,t);if(h.length!==p.length)throw new v("editor:update-features-workflow:fetch-full-features-incomplete","Failed to fetch full features for one or more of the provided features.");const m=u.objectIdField,g=(w,k)=>w.attributes[m]>k.attributes[m]?1:-1,y=p.sort((w,k)=>w-k),b=h.sort(g);for(let w=0;w<y.length;w++)i.set(y[w],b[w]);return h});return(await Promise.all(d)).flat()}};s([n({constructOnly:!0})],ne.prototype,"editorItems",void 0),s([n({constructOnly:!0})],ne.prototype,"featureInfos",void 0),s([n()],ne.prototype,"features",null),s([n()],ne.prototype,"fullFeatures",null),s([n()],ne.prototype,"initialFeatures",null),s([n()],ne.prototype,"layers",null),s([n()],ne.prototype,"parent",void 0),s([n()],ne.prototype,"selectedFeature",void 0),s([n({constructOnly:!0})],ne.prototype,"sketchOptions",void 0),s([n()],ne.prototype,"snappingManager",void 0),s([n()],ne.prototype,"timeZone",null),s([n()],ne.prototype,"viewModel",void 0),s([n()],ne.prototype,"_fullFeatures",void 0),ne=s([M("esri.widgets.Editor.UpdateFeaturesWorkflowData")],ne);const su=ne,tr=Symbol();let te=class extends j{constructor(t){super(t),this.features=[],this.onGeometriesUpdated=()=>{},this.onVisualVariableAttributesUpdated=()=>{},this.sketchOptions=new zt,this.snappingManager=null,this.sourceLayer=null,this.view=null,this.viewModel=null,this._nextUpdateSubset=[],this._sketchGraphicsMap=new le,this._sketchLayer=null,this._updatingHandles=new Dt,this._visualVariableAttributes=new Map,this._visualVariablesForLayer=null,this._webStyleCache=new Map}async initialize(){this._visualVariablesForLayer=Fa(this.sourceLayer),this._nextUpdateSubset=this.features,this._initializeSketchGraphics(),this._initializeSketchLayer(),await this._updatingHandles.addPromise(this._initializeSketchViewModel())}destroy(){const{_sketchLayer:t,view:i}=this;i?.destroyed||i?.map.remove(t),t.destroy(),this.viewModel.destroy()}get sketchGraphics(){return Array.from(this._sketchGraphicsMap.values())}get updating(){return this._updatingHandles.updating}async enter(){await this.startUpdatingFeatures(this._nextUpdateSubset)}async exit(){this._completeCurrentOperation()}notifyAttributesChanged({features:t,fieldName:i}){const r=this._webStyleCache,o=this.view.scale,a=this._updatingHandles;for(const l of t){const c=this._sketchGraphicsMap.get(l),d=l.getAttribute(i);if(!c||c.getAttribute(i)===d)continue;c.setAttribute(i,d);const u=this._visualVariableAttributes.get(l);u?.size==null||u.size.isUpdatingInteractively||u.size.field!==i||u.size.setInitialValue(d),u?.rotation==null||u.rotation.isUpdatingInteractively||u.rotation.field!==i||u.rotation.setInitialValue(d),a.addPromise(ae(c,r,o))}}async startUpdatingFeatures(t){const{onGeometriesUpdated:i,onVisualVariableAttributesUpdated:r,_sketchGraphicsMap:o,_sketchLayer:a,sourceLayer:l,view:c,viewModel:d,_webStyleCache:u}=this,p=t.map(b=>o.get(b)).filter(Q),h={};this._completeCurrentOperation();let m=null;if(t.length===1){const b=t[0],w=this._visualVariableAttributes.get(b);!(!w?.rotation&&!w?.size)&&(await Pr({graphic:p[0],sketchLayer:a,sketchViewModel:d,sourceLayer:l,visualVariables:w,webStyleCache:u}),l.geometryType==="point"&&(h.enableRotation=w.rotation!=null,h.enableScaling=w.size!=null,m=async k=>{const F=k.graphics[0];Rr(c,F,k,w)&&(r?.([{feature:b,attributes:F.attributes}],k),this._updatingHandles.addPromise(ae(F,u,c.type==="2d"?c.scale:null)))}))}else h.tool="move";const g=()=>d.update(p,h),y=d.on("update",b=>{if(b.state==="complete"){if(c.activeTool===null)return void g();const k=new AbortController,F=xt(k);return this.addHandles(F,tr),void this._updatingHandles.addPromise(O(()=>c.activeTool===null,k.signal).then(async()=>{k.signal.aborted||(k.abort(),await g())}))}const w=t.map(k=>{const F=o.get(k);return F?{feature:k,geometry:F.geometry}:null}).filter(Q);i(w,b),m?.(b)});await g(),this._nextUpdateSubset=this.features,this.addHandles(y,tr),d.addHandles(y)}_completeCurrentOperation(){this.removeHandles(tr),this.viewModel.complete()}_initializeSketchGraphics(){const{features:t,_sketchGraphicsMap:i,sourceLayer:r,_visualVariableAttributes:o}=this,a=this._visualVariablesForLayer,l=a.rotation?.field,c=a.size?.field,d={rotation:l?r.getField(l):null,size:c?r.getField(c):null},u=!(!d.rotation&&!d.size);for(const p of t)i.set(p,p.clone()),u&&o.set(p,nu(a,d))}_initializeSketchLayer(){const{view:t}=this,i=new It({elevationInfo:this.sourceLayer.elevationInfo,internal:!0,listMode:"hide",title:"SketchController layer"});this._sketchLayer=i,t.map.add(i),this._updatingHandles.addPromise(t.whenLayerView(i))}async _initializeSketchViewModel(){const{_sketchGraphicsMap:t,_sketchLayer:i,view:r,_webStyleCache:o}=this,a=Array.from(t.entries()),l=new ci({allowDeleteKey:!1,defaultUpdateOptions:{multipleSelectionEnabled:!1},layer:i,sketchOptions:this.sketchOptions,snappingManager:this.snappingManager,updateOnGraphicClick:!1,view:r});this.viewModel=l;const c=ht(d=>Promise.all(a.map(([,u])=>ae(u,o,d))));await c(r.type==="2d"?r.scale:null),r.type==="2d"&&this.addHandles(x(()=>r.scale,d=>c(d))),this.addHandles(await Promise.all(a.map(([d,u])=>Hr(i,r,d,u))))}};function nu({rotation:e,size:t},i){return{rotation:e?Ia(e,i.rotation):null,size:t?Aa(t,i.size):null}}s([n()],te.prototype,"features",void 0),s([n()],te.prototype,"onGeometriesUpdated",void 0),s([n()],te.prototype,"onVisualVariableAttributesUpdated",void 0),s([n()],te.prototype,"sketchGraphics",null),s([n()],te.prototype,"sketchOptions",void 0),s([n()],te.prototype,"snappingManager",void 0),s([n()],te.prototype,"sourceLayer",void 0),s([n()],te.prototype,"updating",null),s([n()],te.prototype,"view",void 0),s([n()],te.prototype,"viewModel",void 0),s([n()],te.prototype,"_nextUpdateSubset",void 0),s([n()],te.prototype,"_sketchGraphicsMap",void 0),s([n()],te.prototype,"_sketchLayer",void 0),s([n()],te.prototype,"_visualVariablesForLayer",void 0),te=s([M("esri.widgets.Editor.support.SketchController")],te);var vr;const $i=()=>z.getLogger("esri.widgets.Editor.UpdateFeaturesWorkflow"),Eo=Symbol();let K=vr=class extends Nt{constructor(e){super(e),this.type="update-features",this._formViewModel=null,this._sketchController=null}async initialize(){this._initializeFormViewModel();try{await this._updatingHandles.addPromise((async()=>{const{fullFeatures:e}=await this.data.when();this._formViewModel.features=new ye(e),this._initializeVisuals(e)})())}catch(e){this.cancel({force:!0,error:new v("update-features-workflow:initialize","Failed to initialize the workflow data.",e)})}}destroy(){this._sketchController=ct(this._sketchController),this._formViewModel.destroy()}get features(){return this.data.features}get featureInfos(){return this.data.featureInfos}get formViewModel(){return this._formViewModel}get hasInvalidFormTemplate(){return this.data.editorItems.some(e=>e.hasInvalidFormTemplate)}get hasPendingEdits(){const{data:e}=this;return e.fullFeatures.some(t=>!!e.getPendingEditsForFeature(t)?.modified)}get parent(){return this.data.parent}get saveActionLabel(){return"update"}get selectedFeature(){return this.data.selectedFeature}get sketchViewModel(){return this._sketchController?.viewModel}get supportsMergeFeaturesWorkflow(){const e=this.data,{layers:t}=e;return!(t.length!==1||e.fullFeatures.length<2)&&!!e.getEditorItemForLayer(t[0])?.supportsMergeFeaturesWorkflow}get updating(){return this._updatingHandles.updating||this._formViewModel.updating||!!this._sketchController?.updating}get viewGraphics(){return this._sketchController?.sketchGraphics??this.data.fullFeatures}async commit(){const{data:e,_formViewModel:t}=this;for(const i of e.fullFeatures)uu(e.getPendingEditsForFeature(i),t.getValues(i));await super.commit()}static create(e){const{applyEdits:t,applyEditsFeatureService:i,...r}=e,{features:o,featureInfos:a,viewModel:l}=r,c=new Set;function d(h){const m=it(l.editorItems,h);m&&c.add(m)}a?.length?a.forEach(({layer:h})=>d(h)):o?.length&&($i().warn("editor:update-features-workflow-data-features","UpdateFeaturesWorkflow: 'features' is deprecrated, use 'featureInfos'"),o.forEach(h=>d(h.sourceLayer??h.layer)));const u=Array.from(c),p=new vr({data:new su({...r,editorItems:u}),onCommit:du(e.applyEdits)});return p._set("steps",cu()),p}async deleteAndCommit(){return this.data.stageDelete(),this.commit()}async enter(){}exit(e){}async reset(){}async save(){const{formViewModel:e}=this;e.submit(),e.valid&&await super.save()}async start(){await super.start(),await O(()=>!this.updating);const e=this._sketchController;if(e)return e;const{data:t}=this,{view:i}=t.viewModel,r=Ii(t);return!i||et(r)?{enter:async()=>{},exit:()=>{}}:{enter:()=>this._initializeHighlights(t.fullFeatures,r,i),exit:()=>this.removeHandles(Eo)}}_initializeFormViewModel(){const{data:e}=this,t=e.viewModel.view,i=e.getEditorItemForLayer(Ii(e)),r=i?.layerInfo?[i.layerInfo]:null,o=new _a({editType:"UPDATE",map:t?.map,readOnly:i?.capabilities.update.attributes===!1,spatialReference:t?.spatialReference,timeZone:e.timeZone,layerInfos:r});this._formViewModel=o,this.addHandles(o.on("value-change",a=>{for(const l of a.features)e.getPendingEditsForFeature(l)?.setAttribute(a.fieldName,a.value);this._sketchController?.notifyAttributesChanged(a)}))}async _initializeHighlights(e,t,i){const r=await ut(i,t);this.addHandles(r.highlight(e),Eo)}_initializeSketchController(e,t,i){const{data:r}=this,o=new te({sourceLayer:t,view:i,features:e,onGeometriesUpdated:a=>{const l=[];for(const{feature:c,geometry:d}of a)r.getPendingEditsForFeature(c)?.updateGeometry(d),l.push(c);this._formViewModel.notifyGeometriesChanged(l)},onVisualVariableAttributesUpdated:()=>{$i().warnOnce("editor:batch-update-visual-variables","UpdateFeaturesWorkflow does not currently support modifying visual variables through the scale and rotate tools.")}});this._sketchController=o}_initializeVisuals(e){const{data:t}=this,{view:i}=t.viewModel;if(!i)return;const r=Ii(t);if(et(r))return;t.getEditorItemForLayer(r)?.capabilities.update.geometry&&this._initializeSketchController(e,r,i)}};s([n()],K.prototype,"features",null),s([n()],K.prototype,"featureInfos",null),s([n()],K.prototype,"formViewModel",null),s([n()],K.prototype,"hasInvalidFormTemplate",null),s([n()],K.prototype,"hasPendingEdits",null),s([n()],K.prototype,"parent",null),s([n()],K.prototype,"saveActionLabel",null),s([n()],K.prototype,"selectedFeature",null),s([n()],K.prototype,"sketchViewModel",null),s([n()],K.prototype,"supportsMergeFeaturesWorkflow",null),s([n()],K.prototype,"type",void 0),s([n()],K.prototype,"updating",null),s([n()],K.prototype,"viewGraphics",null),s([n()],K.prototype,"_formViewModel",void 0),s([n()],K.prototype,"_sketchController",void 0),K=vr=s([M("esri.widgets.Editor.UpdateFeaturesWorkflow")],K);const lu=K;function cu(){return[{id:"editing-features",async setUp(){},async tearDown(){}}]}function du(e){return async t=>{const i=Ii(t),r=[],o=[];for(const l of t.fullFeatures){const c=t.getPendingEditsForFeature(l),d=c?.stagedForDelete;if(!c?.modified&&!d)continue;const u=l.clone();if(!c?.attributesModified||d){const p=l.sourceLayer;if(!p){$i().warn("Feature has no sourceLayer. It will not be included in any applyEdits payload.");continue}const h=p.objectIdField;if(u.attributes={[h]:l.getAttribute(h)},p.type==="scene"&&p.infoFor3D!=null){const m=p.associatedLayer?.globalIdField;m!=null&&u.setAttribute(m,l.getAttribute(m))}}c?.geometryModified&&!d||(u.geometry=null),d?o.push(u):r.push(u)}if(r.length+o.length===0)return void $i().warn("No edits to apply. Workflow will finish without sending an applyEdits request.");const a={updateFeatures:r.length>0?r:void 0,deleteFeatures:o.length>0?o:void 0};await e(i,a)}}function Ii(e){if(e.layers.length>1)throw new Yt;return e.layers[0]}function uu(e,t){if(!e||!e.feature)return;const{attributes:i}=e.feature;Object.keys(t).some(r=>t[r]!==i[r])&&e.updateAttributes(t)}var Ai;let Se=Ai=class extends j{constructor(e){super(e),this.association=null,this.editorItem=null,this.edits=null,this.parent=null,this.featureFormCallbacks=null,this.viewModel=null,this.readOnly=!1}get attachmentsCapabilities(){const e=this.editorItem.capabilities.update.attachments.enabled;return{editing:!0,operations:{add:e,update:e,delete:e}}}get formTemplate(){return this.editorItem.formTemplate}static async create(e){const t=Ai._makeConstructorProps(e);return new Ai(t)}stageDelete(){this.edits.stageDelete()}static _makeConstructorProps(e){const{association:t,feature:i,parent:r,featureFormCallbacks:o,viewModel:a,readOnly:l}=e,c=it(a.editorItems,i.sourceLayer);if(!c)throw new v("no-editorItem-found","The EditorViewModel provided did not have an EditorItem associated with the specified Graphic's layer");return{association:t,editorItem:c,edits:new Ht({feature:i}),parent:r,featureFormCallbacks:o,viewModel:a,readOnly:l??!1}}};s([n()],Se.prototype,"association",void 0),s([n()],Se.prototype,"attachmentsCapabilities",null),s([n({constructOnly:!0})],Se.prototype,"editorItem",void 0),s([n()],Se.prototype,"edits",void 0),s([n()],Se.prototype,"formTemplate",null),s([n()],Se.prototype,"parent",void 0),s([n()],Se.prototype,"featureFormCallbacks",void 0),s([n()],Se.prototype,"viewModel",void 0),s([n()],Se.prototype,"readOnly",void 0),Se=Ai=s([M("esri.widgets.Editor.UpdateRecordWorkflowData")],Se);const Na=Se;var Mi;let Tt=Mi=class extends Na{constructor(e){super(e),this.sketchOptions=null,this.snappingManager=null}static async create(e){const{feature:t,snappingManager:i,viewModel:r}=e,o=e.sketchOptions??new zt,{view:a}=r;if(!a)throw new v("editor:cannot-create-workflow-data","The provided EditorViewModel does not have an associated view");const l=await ut(a,t.layer??t.sourceLayer);return new Mi({...Mi._makeConstructorProps(e),layerView:l,sketchOptions:o,snappingManager:i})}};s([n()],Tt.prototype,"layerView",void 0),s([n({constructOnly:!0})],Tt.prototype,"sketchOptions",void 0),s([n()],Tt.prototype,"snappingManager",void 0),Tt=Mi=s([M("esri.widgets.Editor.UpdateFeatureWorkflowData")],Tt);const pu=Tt;var _r;const To={exit:Symbol()};var kt;let ie=(kt=class extends Nt{constructor(t){super(t),this._highlightHelper=null,this.fullFeature=null,this.type="update-table-record"}initialize(){const{data:t}=this,{edits:i}=t,{view:r}=t.viewModel,o=i.feature;r&&(this._highlightHelper=new ze({view:r,highlightName:Ft}),this.addHandles(L(()=>this._highlightHelper?.removeAll())));const a=new AbortController;this.addHandles(xt(a)),this._updatingHandles.addPromise(Va([o],o.sourceLayer,t.viewModel.view.spatialReference,a.signal).then(([l])=>{Ys(a)||(this._onFullFeatureLoaded(l),this._initializeFormViewModel())},l=>(z.getLogger(this).error("initialize()","Failed to fetch full feature for update workflow.",l),this.cancel({force:!0,error:new v("editor:failed-to-fetch-full-feature","Failed to retrieve all information for this feature. The update cannot proceed.",{detail:{error:l}})}))))}get allowSave(){return!this.data.readOnly&&this.hasPendingEdits&&!this.updating}get editorItem(){return this.data.editorItem}get formViewModel(){return this._formViewModel}get hasInvalidFormTemplate(){return this.data.editorItem.hasInvalidFormTemplate}get hasPendingEdits(){return this.data.edits.modified&&!this.data.readOnly}get layer(){return this.data.editorItem.layer}get parent(){return this.data.parent}get saveActionLabel(){return"update"}get shouldShowAttachments(){return this.editorItem.capabilities.attachments.enabled}get shouldAllowAttachmentEditing(){return this.editorItem.capabilities.update.attachments.enabled}get reliesOnOwnerAdminPrivileges(){const t=this.editorItem.capabilities;return t.update.reliesOnOwnerAdminPrivileges||t.delete.reliesOnOwnerAdminPrivileges}async enter(){this._configureAttachmentsViewModel()}exit(t){this.removeHandles(To.exit)}async start(){return await super.start(),null}_configureAttachmentsViewModel(){const{data:t,fullFeature:i}=this,{attachmentsCapabilities:r,viewModel:o}=t,{attachmentsViewModel:a}=o,l=t.readOnly?{editing:!1}:r;a.set({capabilities:l,graphic:i,filesEnabled:!1,mode:"view"}),this.addHandles([L(()=>a.fileInfos.removeAll()),x(()=>a.mode,c=>{switch(c){case"add":this.go("adding-attachment");break;case"edit":this.go("editing-attachment")}})],To.exit)}_initializeFormViewModel(){const{association:t,edits:i,formTemplate:r,viewModel:{view:o},readOnly:a}=this.data,l=this._formViewModel=new Pi({activeAssociation:t,editType:"UPDATE",feature:this.fullFeature,formTemplate:r,highlightHelper:this._highlightHelper,map:o?.map,spatialReference:o.spatialReference,timeZone:o?.timeZone,disabled:a});l.callbacks={...this.data.featureFormCallbacks,showAllRelatedRecords:d=>l.relationshipId=d.relationshipId,viewAssociatedLayers:d=>l.associationId=d.associationId,viewAssociatedFeatures:d=>l.associatedLayer=d.associatedLayer};const{initialFeature:c}=i;c&&l.overrideInitialFeature(c),this.addHandles([l.on("value-change",()=>{i.updateAttributes(l.getValues()),this.fullFeature.attributes=i.feature.attributes}),x(()=>o?.timeZone,d=>l.timeZone=d)])}_onFullFeatureLoaded(t){this.fullFeature=t;const{edits:i}=this.data;i.updateAttributes(t.attributes),i.trackChanges()}static async create(t){const i=new _r({data:await Na.create(t),onCommit:this._onCommitFactory(t.applyEdits)});return i._set("steps",this._createWorkflowSteps(i)),i}static _createWorkflowSteps(t){const{attachmentsViewModel:i}=t.data.viewModel;return[{id:"editing-attributes",async setUp(){},async tearDown(){}},{id:"adding-attachment",async setUp(){},async tearDown(){i.mode="view"}},{id:"editing-attachment",async setUp(){},async tearDown(){i.mode="view"}}]}},_r=kt,kt._onCommitFactory=t=>async i=>{const{edits:r}=i,{feature:o}=r;if(!o)return;const a=o.sourceLayer,l=o.clone();if(!r.attributesModified||r.stagedForDelete){const d=a.objectIdField;if(l.attributes={[d]:o.getAttribute(d)},a.type==="scene"&&a.infoFor3D!=null){const u=a.associatedLayer?.globalIdField;u!=null&&l.setAttribute(u,o.getAttribute(u))}}r.geometryModified&&!r.stagedForDelete||(l.geometry=null);const c=r.stagedForDelete?"deleteFeatures":"updateFeatures";await t(a,{[c]:[l]})},kt);s([n()],ie.prototype,"_formViewModel",void 0),s([n()],ie.prototype,"allowSave",null),s([n()],ie.prototype,"editorItem",null),s([n()],ie.prototype,"formViewModel",null),s([n()],ie.prototype,"fullFeature",void 0),s([n()],ie.prototype,"hasInvalidFormTemplate",null),s([n()],ie.prototype,"hasPendingEdits",null),s([n()],ie.prototype,"layer",null),s([n()],ie.prototype,"parent",null),s([n()],ie.prototype,"saveActionLabel",null),s([n()],ie.prototype,"shouldShowAttachments",null),s([n()],ie.prototype,"shouldAllowAttachmentEditing",null),s([n()],ie.prototype,"reliesOnOwnerAdminPrivileges",null),ie=_r=s([M("esri.widgets.Editor.UpdateRecordWorkflow")],ie);var br;const Ie={highlights:Symbol(),sketchGraphics:Symbol(),sketchViewModel:Symbol(),waitingForTool:Symbol()};let wt=br=class extends ie{constructor(e){super(e),this.type="update-feature",this._layerViewEditSession=null,this._sketchGraphicClone=null,this._sketchLayer=null,this._sketchViewModel=null,this._webStyleCache=new Map}destroy(){this._layerViewEditSession?.rollback()}get viewGraphic(){return this._sketchViewModel?this._sketchGraphicClone:this.data.edits.feature??this.fullFeature}async commit(){this.removeHandles(Ie.sketchGraphics);try{const e=this.data.edits.stagedForDelete;await super.commit();const t=this._layerViewEditSession;e?t?.rollback():t?.commit()}catch(e){throw await this._configureSketchViewModel(),new v("editor-workflow:failed-to-commit","An error occurred when sending the updates to the service",{error:e})}}async start(){return await super.start(),await this._initializeSketchViewModel()}_initializeFormViewModel(){super._initializeFormViewModel(),this.addHandles([this._formViewModel.on("value-change",e=>{this._layerViewEditSession?.setAttribute(e.fieldName,e.value)}),x(()=>this._formViewModel.feature?.sourceLayer,e=>this._sketchGraphicClone.sourceLayer=e)])}_configureHighlight(){const{edits:e,layerView:t}=this.data;Xs(t)&&this.addHandles(t.highlight(e.feature),Ie.highlights)}async _configureSketchViewModel(){const{_sketchLayer:e,_sketchViewModel:t}=this;if(!t||!e)return;const{data:i,_formViewModel:r,_sketchGraphicClone:o}=this,{edits:a,viewModel:l}=i,c=a.feature,{view:d}=l,u=Or(c),p=await sd({feature:c,featureClone:o,visualVariableAttributes:u,sketchLayer:e,sketchViewModel:t,view:d,onUpdate:({geometry:h,attributes:m},g)=>{if(a.updateAttributes(m),a.updateGeometry(h),r.feature&&(r.feature.geometry=h),u.rotation!=null){const{field:y}=u.rotation;r.setValue(y,m[y])}if(u.size!=null){const{field:y}=u.size;r.setValue(y,m[y])}(g.type==="undo"||g.type==="redo"||g.type==="update"&&g.toolEventInfo!=null&&Oa(g.toolEventInfo.type))&&r.notifyFeatureGeometryChanged()},addUpdatingPromise:h=>{this._updatingHandles.addPromise(h)},addHandle:h=>{this.addHandles(h,Ie.waitingForTool)},webStyleCache:this._webStyleCache});this.addHandles(p,Ie.sketchGraphics),t.addHandles(p)}async _initializeSketchViewModel(){const{data:e,_sketchGraphicClone:t}=this,{readOnly:i}=e,r=e.edits.feature,{capabilities:o,layer:a}=e.editorItem,l=e.viewModel.view;if(this.removeHandles([Ie.highlights,Ie.sketchGraphics,Ie.sketchViewModel,Ie.waitingForTool]),!o.update.geometry||i)return{enter:async()=>{this.hasHandles(Ie.highlights)||this._configureHighlight()},exit:()=>this.removeHandles([Ie.highlights])};const c=new It({elevationInfo:a.elevationInfo,internal:!0,listMode:"hide",title:ba}),d=new ci({allowDeleteKey:!1,layer:c,sketchOptions:e.sketchOptions,snappingManager:e.snappingManager,updateOnGraphicClick:!1,view:l});return this._sketchLayer=c,this._sketchViewModel=d,l?.map.add(c),await l?.whenLayerView(c),this.addHandles(L(()=>{l?.destroyed||l?.map.remove(c),c.destroyed||c.destroy(),this._sketchViewModel=ct(d)}),Ie.sketchViewModel),await ae(t,this._webStyleCache,l?.type==="2d"?l.scale:null),this.addHandles([await Hr(c,l,r,t)]),{enter:async()=>{this.hasHandles(Ie.sketchGraphics)||await this._configureSketchViewModel()},exit:()=>this.removeHandles([Ie.sketchGraphics]),viewModel:d}}_onFullFeatureLoaded(e){super._onFullFeatureLoaded(e);const t=this._sketchGraphicClone=mr(e),{edits:i,layerView:r}=this.data;i.updateGeometry(e.geometry),i.trackChanges(),ud(r)&&(this._layerViewEditSession=r.createInteractiveEditSession(t))}static async create(e){const t=new br({data:await pu.create(e),onCommit:this._onCommitFactory(e.applyEdits)});return t._set("steps",this._createWorkflowSteps(t)),t}get test(){}};s([n()],wt.prototype,"_layerViewEditSession",void 0),s([n()],wt.prototype,"_sketchGraphicClone",void 0),s([n()],wt.prototype,"_sketchLayer",void 0),s([n()],wt.prototype,"_sketchViewModel",void 0),wt=br=s([M("esri.widgets.Editor.UpdateFeatureWorkflow")],wt);let Ce=class extends j{constructor(t){super(t),this.addAttachmentsCallback=null,this.applyEditsCallback=null,this.applyEditsFeatureServiceCallback=null,this.candidates=[],this.rootFeatures=new ye,this.rootFeatureInfos=[],this.rootWorkflowOptions={type:"update-single"},this.sketchOptions=new zt,this.snappingManager=null,this.viewModel=null}};s([n()],Ce.prototype,"addAttachmentsCallback",void 0),s([n()],Ce.prototype,"applyEditsCallback",void 0),s([n()],Ce.prototype,"applyEditsFeatureServiceCallback",void 0),s([n()],Ce.prototype,"candidates",void 0),s([n()],Ce.prototype,"rootFeatures",void 0),s([n()],Ce.prototype,"rootFeatureInfos",void 0),s([n()],Ce.prototype,"rootWorkflowOptions",void 0),s([n({constructOnly:!0})],Ce.prototype,"sketchOptions",void 0),s([n()],Ce.prototype,"snappingManager",void 0),s([n()],Ce.prototype,"viewModel",void 0),Ce=s([M("esri.widgets.Editor.UpdateWorkflowData")],Ce);const hu=Ce;var kr;let B=kr=class extends Nt{constructor(e){super(e),this._workflowStack=new rr(or),this._sketchStack=new rr(or),this.data=void 0,this.type="update"}destroy(){this._drainWorkflowStack(e=>e.cancel({force:!0}))}get formViewModel(){return this.activeWorkflow?.formViewModel}get activeUtilityNetworkAssociationAddAssociationViewModel(){return this.activeWorkflow?.type==="add-association"?this.activeWorkflow.utilityNetworkAssociationAddAssociationViewModel:null}get activeSketchViewModel(){return this._sketchStack.peek()?.viewModel}get canDeleteAssociation(){const{formViewModel:e}=this;if(!this.activeWorkflow||!this.data.viewModel.view?.map||!Ke(e))return!1;const{activeAssociation:t,feature:i}=e;return!(!t||!i?.sourceLayer||!Ar(i?.sourceLayer)&&!We(i?.sourceLayer))}get activeWorkflow(){return this._workflowStack.last()}get updating(){return this._updatingHandles.updating||!!this.activeWorkflow?.updating}get hasPreviousStep(){const e=this.activeWorkflow?.formViewModel;return this._stepIndex>0||this.nestedWorkflowCount>1||this.activeWorkflow?.hasPreviousStep||this.data.viewModel.attachmentsViewModel.mode!=="view"||Ke(e)&&(e.relationshipId!=null||e.associationId!=null||e.associatedLayer!=null)}get hasUpdatableCandidates(){const{candidates:e,viewModel:t}=this.data;return e.some(({layer:i})=>it(t.editorItems,i)?.supportsUpdateWorkflow)}get nestedWorkflowCount(){return this._workflowStack.length}get shouldShowAttachments(){return this.activeWorkflow?.shouldShowAttachments??!1}get shouldAllowAttachmentEditing(){return this.activeWorkflow?.shouldAllowAttachmentEditing??!1}get hasPendingEdits(){return Array.from(this._workflowStack).some(e=>e.hasPendingEdits)}get helpMessage(){return this.activeWorkflow?.helpMessage?this.activeWorkflow.helpMessage:this.stepId==="awaiting-feature-to-update"?"select":void 0}get noticeMessage(){return this.activeWorkflow?.noticeMessage}get reliesOnOwnerAdminPrivileges(){return this.activeWorkflow?.reliesOnOwnerAdminPrivileges??!1}get hasInvalidFormTemplate(){return this.activeWorkflow?.hasInvalidFormTemplate??!1}async back(e=()=>Promise.resolve(!0)){const{activeWorkflow:t}=this,i=t?.formViewModel;if(Ke(i)){if(i?.activeRelationshipInput){const r=i.activeRelationshipInput;if(r.activeCategory)return void(r.activeCategory=null);if(i.relationshipId!=null)return void(i.relationshipId=null);if(r.showAllEnabled)return void(r.showAllEnabled=!1)}if(t?.type==="add-association"){const{activeUtilityNetworkAssociationAddAssociationViewModel:r}=this;if(r?.filterOptionsVisible)return void(r.filterOptionsVisible=!1);r?.featureSpatialItems.length&&r.reset()}if(i?.associatedLayer!=null)return void(i.associatedLayer=null);if(i?.associationId!=null)return void(i.associationId=null)}if(t?.type==="create-features"&&t.hasPreviousStep)await t.previous({cancelCurrentStep:!0});else{if(Ut(t)&&t.hasPreviousStep)return await t.back();if(t){if(t.hasPendingEdits&&!await e())return;t.hasPreviousStep?await t.previous({cancelCurrentStep:!0}):await this.cancelActiveWorkflow({force:!0})}else this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0})}}async cancelActiveWorkflow(e){await this.activeWorkflow?.cancel(e),await this._popWorkflowAndReconcile()}async commit(){await this._drainWorkflowStack(e=>e.commit()),await super.commit()}static create(e){const{startAt:t,applyEdits:i,applyEditsFeatureService:r,...o}=e,a=new kr({data:new hu({applyEditsCallback:i,applyEditsFeatureServiceCallback:r,...o}),onCommit:async()=>{}});return a._set("steps",this._createWorkflowSteps(a,t)),a}async save(){const{formViewModel:e}=this;if(e&&(e.submit(),!e.submittable||Ke(e)&&fu(e)))return;if(this.nestedWorkflowCount<2)return await this.commit();const{activeWorkflow:t}=this;if(await t?.commit(),!Pc(t))return void await this._popWorkflowAndReconcile();this._popWorkflow();const i=this._workflowStack.peek();if(i&&i===t?.parent&&(await i.cancel(),this._popWorkflow(),this.nestedWorkflowCount===0))return await this.commit();await this._reconcileWorkflowStack()}async startCreatingRelatedRecord(e){const t=this._makeUpdatingResolver();try{const i=this._createNestedCreateFeaturesWorkflow(e);await this._pushWorkflowAndReconcile(i)}catch(i){throw new v("editor:unable-to-start-creating","Could not begin updating the provided feature or table record.",{error:i})}finally{t.resolve()}}async startMergingFeatures(e,t){const i=this._makeUpdatingResolver();try{const r=await this._createNestedMergeFeaturesWorkflow(e,t);await this._pushWorkflowAndReconcile(r)}catch(r){throw new v("editor:unable-to-start-merging","Could not begin merging the provided features.",{error:r})}finally{i.resolve()}}async startSplittingFeature(e,t){const i=this._makeUpdatingResolver();try{const r=await this._createNestedSplitFeatureWorkflow(e,t);await this._pushWorkflowAndReconcile(r)}catch(r){throw new v("editor:unable-to-start-splitting","Could not begin splitting the provided feature.",{error:r})}finally{i.resolve()}}async startUpdatingSingle(e,t){const i=this._makeUpdatingResolver();try{const r=await this._createNestedUpdateWorkflow(e,t);await this._pushWorkflowAndReconcile(r)}catch(r){throw new v("editor:unable-to-start-updating","Could not begin updating the provided feature or table record.",{error:r})}finally{i.resolve()}}async startUpdatingMultiple(e,t){const i=this._makeUpdatingResolver();try{const r=await this._createNestedUpdateFeaturesWorkflow(e,t);await this._pushWorkflowAndReconcile(r)}catch(r){throw new v("editor:unable-to-start-updating","Could not begin updating the provided features or table records.",{error:r})}finally{i.resolve()}}async startAddAssociation(e,t,i){const r=this._makeUpdatingResolver();try{const o=await this._createNestedAddAssociationWorkflow(e,t,i);await this._pushWorkflowAndReconcile(o)}catch(o){throw new v("editor:unable-to-start-updating","Could not begin updating the provided feature or table record.",{error:o})}finally{r.resolve()}}async deleteActiveFeatures(){const{activeWorkflow:e}=this;if(!e)throw new v("editor:nothing-to-delete","There is no feature to delete");const t=$c(e);if(t){e.data.stageDelete();const i=Kt(e)?e.data.edits.feature?[e.data.edits.feature]:[]:e.data.features;this._removeFeaturesFromCandidates(i)}else await e.cancel();this.nestedWorkflowCount<2?t?await this.commit():await this.cancel({force:!0}):(t&&await e.commit(),await this._popWorkflowAndReconcile(),await this._returnToPageWithContent())}async deleteActiveAssociation(){if(!this.canDeleteAssociation)throw new v("editor:nothing-to-delete","There is no association to delete");await this._deleteActiveAssociation(),await this._popWorkflowAndReconcile(),await this._returnToPageWithContent()}async cancelAll(){await this._drainWorkflowStack(e=>e.cancel({force:!0}))}async _deleteActiveAssociation(){const{formViewModel:e}=this;if(!Ke(e))throw new v("editing:failed-to-delete-association","The active workflow does not support editing associations");const{activeAssociation:t,feature:i}=e,{applyEditsFeatureServiceCallback:r,viewModel:o}=this.data,{sourceLayer:a}=i,l=We(a)&&a.parent?a.parent:a,c=Kn([l]),d=c.values().next().value?.featureService;if(!d)throw new v("editor:failed-to-delete-association","Could not retrieve feature service needed to delete association");await d?.load();const u=o.view.map,p=el(u,l);await p?.networkSystemLayers.loadAssociationsTable();const h=p?.generateDeleteAssociations([t]);if(!h)throw new v("editor:failed-to-delete-association","Could not create payload needed to delete association");const m=p?.gdbVersion??void 0;await r(d,[h],{gdbVersion:m,globalIdUsed:!0})}_removeFeaturesFromCandidates(e){const{candidates:t}=this.data;if(t.length!==0&&e.length!==0)for(const i of e)en(t,i)}async _returnToPageWithContent(){const{formViewModel:e}=this;if(!Ke(e)||!e?.activeAssociationInput)return;const{activeAssociationInput:t,associationId:i}=e;await t.refresh(),t.associatedLayer&&!t.associatedFeatures?.length&&(e.associatedLayer=null),i==null||t.associatedFeatureInfos.size||(e.associationId=null)}_createNestedCreateFeaturesWorkflow(e){const{relatedLayer:t}=e,{addAttachmentsCallback:i,applyEditsCallback:r,applyEditsFeatureServiceCallback:o,sketchOptions:a,snappingManager:l,viewModel:c}=this.data;if(!nr(t))throw new v("editor:unsupported-layer","Editing is not supported on the provided layer");const d=this._getCreationInfoForNestedCreateFeaturesWorkflow(e),u=d.template||d.initialFeature?"creating-features":"awaiting-feature-creation-info",p=Gt(this.activeWorkflow)?this.activeWorkflow:void 0;return Ra.create({addAttachmentsCallback:i,applyEdits:r,applyEditsFeatureService:o,creationInfo:d,isNested:!0,parent:p,sketchOptions:a,snappingManager:l,startAt:u,viewModel:c})}_getCreationInfoForNestedCreateFeaturesWorkflow(e){const{relatedLayer:t}=e;if(!nr(t)||tt(t))throw new v("editor:unsupported-layer","Editing is not supported on the provided layer");const{viewModel:i}=this.data,r={layer:t,maxFeatures:1},o=this._makeRelatedRecordAttributes(e),a=i.getTemplatesForLayer(t);return a?.length>0?(r.attributeOverrides=o,a.length===1&&(r.template=a[0])):r.initialFeature=new ni({sourceLayer:t,attributes:o}),r}async _createNestedUpdateWorkflow(e,t={}){const i=et(e.sourceLayer)?ie:wt,{applyEditsCallback:r,applyEditsFeatureServiceCallback:o,sketchOptions:a,snappingManager:l,viewModel:c}=this.data,d=Gt(this.activeWorkflow)?this.activeWorkflow:void 0,u=await i.create({feature:e,parent:d,sketchOptions:a,snappingManager:l,viewModel:c,applyEdits:r,applyEditsFeatureService:o,featureFormCallbacks:{addRelatedRecord:p=>{this.startCreatingRelatedRecord(p)},editRelatedRecord:({relatedFeature:p,readOnly:h})=>{this.startUpdatingSingle(p,{readOnly:h})},selectAssociatedFeature:async({feature:p,association:h})=>await this.startUpdatingSingle(p,{association:h}),addAssociation:p=>{this.startAddAssociation(p.feature,p.utilityNetwork,p.associationType)}},...t});return await O(()=>!u.updating),u}async _createNestedUpdateFeaturesWorkflow(e,t={}){const{applyEditsCallback:i,applyEditsFeatureServiceCallback:r,viewModel:o}=this.data,a=lu.create({applyEdits:i,applyEditsFeatureService:r,featureInfos:e,viewModel:o,...t});return await O(()=>!a.updating),a}async _createNestedAddAssociationWorkflow(e,t,i){const{AddAssociationWorkflow:r}=await _(()=>import("./AddAssociationWorkflow-Jw4yuD6v.js"),__vite__mapDeps([90,1,2,64,24,25,26,27,54,55,91,35,92,93,30,31,32,33,34,36,37,38,39,40,41,3,42,43,29,44,23,28,45,46,47,48,49,50,51,52,53,56,57,58,59,60,61,62,63,65,66,67,68,69])),{applyEditsCallback:o,applyEditsFeatureServiceCallback:a,viewModel:l}=this.data,c=Gt(this.activeWorkflow)?this.activeWorkflow:void 0,{formViewModel:d}=this,u=Ke(d)?d.activeAssociationInput:null;if(!u)throw new v("editing:unable-to-add-association","There is no active association input in the current workflow's form.");const p=await r.create({utilityNetwork:t,associationType:i,feature:e,parent:c,viewModel:l,associationInput:u,applyEdits:o,applyEditsFeatureService:a});return await O(()=>!p.updating),p}async _createNestedMergeFeaturesWorkflow(e,t){const{applyEditsCallback:i,applyEditsFeatureServiceCallback:r,viewModel:o}=this.data;Ha(e);const a=Lt(this.data.viewModel.editorItems,Vr(e[0])),l=Gt(this.activeWorkflow)?this.activeWorkflow:void 0,c=await Vd.create({applyEdits:i,applyEditsFeatureService:r,editorItem:a,features:e,parent:l,viewModel:o,...t});return await O(()=>!c.updating),c}async _createNestedSplitFeatureWorkflow(e,t){const{applyEditsCallback:i,applyEditsFeatureServiceCallback:r,sketchOptions:o,snappingManager:a,viewModel:l}=this.data,c=Gt(this.activeWorkflow)?this.activeWorkflow:void 0,d=Lt(l.editorItems,e.sourceLayer),u=eu.create({applyEdits:i,applyEditsFeatureService:r,editorItem:d,feature:e,parent:c,sketchOptions:o,snappingManager:a,viewModel:l,...t});return await O(()=>!u.updating),u}async _drainWorkflowStack(e){const t=this._workflowStack,i=[];for(const r of t){const o=e(r).finally(()=>r.destroy());this._updatingHandles.addPromise(o),i.push(o)}await Promise.all(i),this._workflowStack.clear(),this._sketchStack.clear()}_makeUpdatingResolver(){const e=Rt();return this._updatingHandles.addPromise(e.promise),e}_makeRelatedRecordAttributes(e){const{parentFeature:t,relatedLayer:i,relationshipId:r}=e;if(!tl(t))return;const o=i.relationships?.find(p=>p.id===r);if(!o)return void this._logContinuingWithoutRelationshipWarning("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the destination layer.");if(o.role==="origin")return void this._logContinuingWithoutRelationshipWarning("unsupported-role","Creating new related records in the 'origin' table of a relationship is not yet supported");const a=t.sourceLayer;o.relatedTableId!==a.layerId&&this._logContinuingWithoutRelationshipWarning("invalid-argument-combination","The given parent feature does not belong to the relationship designated by the given relationship ID.");const l=a.relationships?.find(p=>p.id===r);if(!l)return void this._logContinuingWithoutRelationshipWarning("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the origin layer.");const c=So(a,l),d=t.getAttribute(c);return d||this._logContinuingWithoutRelationshipWarning("no-key-on-origin-feature","The given parent feature does not have a value for the relationship's origin primary key field."),{[So(i,o)]:d}}_popWorkflow(){this._workflowStack.pop()?.destroy(),this._sketchStack.pop()}async _popWorkflowAndReconcile(){this._popWorkflow();const e=await this._reconcileWorkflowStack();if(e.failureCount>0)throw new v("editor:next-workflow-failed","Popped the top workflow, but the next workflow in the stack failed to activate",e)}async _pushWorkflowAndReconcile(e){const t=this._workflowRequiresSketchViewModel(e);this.activeWorkflow?.exit({removeSketchHandles:t});const i=this._sketchStack,r=await e?.start(),o=i.peek();r?(o?.exit(),i.push(r)):i.push(this._cloneSketchController(o)),this._workflowStack.push(e);const a=await this._reconcileWorkflowStack();if(a.failureCount>0)throw new v("editor:failed-to-start-updating-feature","Failed to enter the provided workflow.",a)}async _reconcileWorkflowStack(){const e=this._workflowStack,t=this._sketchStack;try{const i=e.peek();return await i?.enter(),await t.peek()?.enter(),{activeWorkflow:i,failureCount:0}}catch{e.pop().destroy(),t.pop();const{activeWorkflow:r,failureCount:o}=await this._reconcileWorkflowStack();return{activeWorkflow:r,failureCount:o+1}}}_cloneSketchController(e){return{enter:e?.enter??(async()=>{}),exit:e?.exit??(async()=>{}),viewModel:e?.viewModel}}_workflowRequiresSketchViewModel(e){const{type:t}=e;return t==="update-feature"||t==="create-features"&&!et(e.data.creationInfo?.layer)}static _createWorkflowSteps(e,t="awaiting-feature-to-update"){const{data:i}=e;return Dr(["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],t,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",async setUp(){const{spinnerViewModel:r}=i.viewModel,o=i.viewModel.view;o.activeTool=null;let a=null;e.addHandles(L(()=>{a=De(a)}),this.id),i.rootFeatures.removeAll(),i.candidates=[];const l=o.on("immediate-click",async d=>{const u=Rt();e._updatingHandles.addPromise(u.promise);try{r.location=d.mapPoint,r.visible=!0,a?.abort();const{editorItems:p}=i.viewModel;a=new AbortController;const h=await d.defer(()=>new Promise((m,g)=>{ar(a?.signal,()=>g(Uo())),m(td(p,o,d,a?.signal))}));if(pt(a),i.candidates=h.filter(m=>m.status==="fulfilled").flatMap(m=>m.value).filter(m=>!m.isAggregate),r.visible=i.candidates.length===1,i.candidates.length===0)return;if(d.stopPropagation(),i.candidates.length===1){const{rootFeatures:m}=i;m.removeAll(),m.add(i.candidates[0]),e.go("editing-existing-feature").catch(()=>{}).then(()=>r.visible=!1)}else e.next()}finally{u.resolve()}},tn.TOOL),c=Ve(()=>o.activeTool!=null,()=>e.cancel({force:!0}),{once:!0});o.focus(),e.addHandles([l,c],this.id)},async tearDown(){i.candidates.length===0&&(i.viewModel.spinnerViewModel.visible=!1),e.removeHandles(this.id)}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",async setUp(){i.rootFeatures.removeAll();const{view:r}=i.viewModel;if(!r)return;const o=new ze({view:r,highlightName:Ft});e.addHandles([Z(()=>i.rootFeatures,"change",({added:a,removed:l})=>{l.forEach(c=>o.remove(c)),a.forEach(c=>o.add(c))},Pt),L(()=>o.removeAll())],this.id)},async tearDown(){e.removeHandles(this.id)}}),"editing-existing-feature":()=>({id:"editing-existing-feature",async setUp(){await mu(e);const{data:r}=e;r.viewModel.spinnerViewModel.visible=!1;const o=ht(async()=>{await O(()=>!e.updating),e.previous()});e.addHandles([x(()=>e.nestedWorkflowCount,(a,l)=>{a===0&&l!==0&&o()},Pt)],this.id)},async tearDown(){await e.cancelAll(),e.removeHandles(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){i.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){i.viewModel.attachmentsViewModel.mode="view"}})})}_logContinuingWithoutRelationshipWarning(e,t){z.getLogger(this).warn(`editor:${e}`,t,"The create operation will be allowed to proceed, but the resulting feature may not be related to the given parent feature.")}};function So(e,{keyField:t}){return e.getField(t)?.name??t}function fu(e){if(e.pendingSubtypeChoice)return!0;const t=e.getValues();return e.validateContingencyConstraints(t,{includeIncompleteViolations:!0}).length>0}async function mu(e){const{data:t}=e,{rootWorkflowOptions:i}=t;if(Rc(i)){const{rootFeatureInfos:a}=t,l=a.length>0?a:ki(t.rootFeatures.toArray());if(l.length===0)throw new v("editing:invalid-parameter","Must supply `rootFeatureInfos` or `rootFeatures` when root workflow type is 'update-multiple'");return await e.startUpdatingMultiple(l,i.props)}const{rootFeatures:r}=t,o=r.getItemAt(0);if(!o)throw new v("editor:no-feature-specified","Cannot setup the 'updating-existing-feature' step until one or more root features are provided");Oc(i)?await e.startMergingFeatures(r.toArray(),i.props):Wc(i)?await e.startSplittingFeature(o,i.props):await e.startUpdatingSingle(o)}s([n()],B.prototype,"formViewModel",null),s([n()],B.prototype,"activeUtilityNetworkAssociationAddAssociationViewModel",null),s([n()],B.prototype,"activeSketchViewModel",null),s([n()],B.prototype,"canDeleteAssociation",null),s([n()],B.prototype,"activeWorkflow",null),s([n()],B.prototype,"updating",null),s([n()],B.prototype,"data",void 0),s([n()],B.prototype,"hasPreviousStep",null),s([n()],B.prototype,"hasUpdatableCandidates",null),s([n()],B.prototype,"nestedWorkflowCount",null),s([n()],B.prototype,"shouldShowAttachments",null),s([n()],B.prototype,"shouldAllowAttachmentEditing",null),s([n()],B.prototype,"hasPendingEdits",null),s([n()],B.prototype,"helpMessage",null),s([n()],B.prototype,"noticeMessage",null),s([n()],B.prototype,"reliesOnOwnerAdminPrivileges",null),s([n()],B.prototype,"hasInvalidFormTemplate",null),B=kr=s([M("esri.widgets.Editor.UpdateWorkflow")],B);const gu=B;let ve=class extends j{constructor(t){super(t),this.layer=null}get attachments(){return{enabled:this._effectiveEnabled&&!!this._effectiveCapabilities?.data.supportsAttachment}}get create(){const{_effectiveCapabilities:t,layer:i}=this,r=this._createEnabled,o=r,a=i.capabilities?.operations.supportsAdd,l=!!t?.operations.supportsAdd;return{attachments:{enabled:r&&this.attachments.enabled},attributes:r,enabled:r,geometry:o,reliesOnOwnerAdminPrivileges:!a&&l}}get delete(){const{_effectiveCapabilities:t,layer:i}=this,r=i.capabilities?.operations.supportsDelete,o=!!t?.operations.supportsDelete;return{enabled:this._effectiveEnabled&&!!t?.operations.supportsDelete,reliesOnOwnerAdminPrivileges:!r&&o}}get reliesOnOwnerAdminPrivileges(){return this._effectiveEnabled&&!this.layer.editingEnabled||this.create.reliesOnOwnerAdminPrivileges||this.update.reliesOnOwnerAdminPrivileges||this.delete.reliesOnOwnerAdminPrivileges}get update(){const{_effectiveCapabilities:t,layer:i}=this,r=this._updateEnabled,o=!(!r||!t?.editing.supportsGeometryUpdate),a=i.capabilities?.operations.supportsUpdate,l=!!t?.operations.supportsUpdate,c=this.attachments.enabled,d=c&&this._canCreateOrUpdate;return{attachments:{enabled:c,create:d,update:d},attributes:r,enabled:r,geometry:o,reliesOnOwnerAdminPrivileges:!a&&l}}get _createEnabled(){return this._effectiveEnabled&&!!this._effectiveCapabilities?.operations.supportsAdd}get _updateEnabled(){return this._effectiveEnabled&&!!this._effectiveCapabilities?.operations.supportsUpdate}get _canCreateOrUpdate(){return!(!this._createEnabled&&!this._updateEnabled)}get _effectiveEnabled(){return rn(this.layer)}get _effectiveCapabilities(){return on(this.layer)}};s([n()],ve.prototype,"attachments",null),s([n()],ve.prototype,"create",null),s([n()],ve.prototype,"delete",null),s([n()],ve.prototype,"layer",void 0),s([n()],ve.prototype,"reliesOnOwnerAdminPrivileges",null),s([n()],ve.prototype,"update",null),s([n()],ve.prototype,"_createEnabled",null),s([n()],ve.prototype,"_updateEnabled",null),s([n()],ve.prototype,"_canCreateOrUpdate",null),s([n()],ve.prototype,"_effectiveEnabled",null),s([n()],ve.prototype,"_effectiveCapabilities",null),ve=s([M("esri.layers.support.EditingCapabilities")],ve);const Lo=ve,At="esri.views.layers.support.editableLayerViews";function yu(e,t){const{associatedLayer:i}=e,r=i?.infoFor3D;if(!r)return!1;const o=an(r);if(!(o!=null&&r.queryFormats.includes(o)))return z.getLogger(At).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because it does not support GLB queries.`),!1;const a=e.spatialReference,l=i.spatialReference;if(!Bi(a,l))return z.getLogger(At).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because its spatial reference (wkid:${a.wkid}) is different from its associated FeatureLayer's spatial reference (wkid:${l.wkid}).`),!1;const c=i.sourceJSON?.sourceSpatialReference;if(!(c==null||Bi(c,l)))return z.getLogger(At).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because the spatial reference of its associated FeatureLayer's service (wkid:${l.wkid}) is different from its source spatial reference (wkid:${c.wkid}).`),!1;const{view:d}=t;if(t.destroyed||d==null)return!1;const u=d.spatialReference,{viewingMode:p}=d.state,h=sn(a),m=p===1;return h&&!m?(z.getLogger(At).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits in local viewing mode because its spatial reference (wkid:${a.wkid}) is geographic. Please consider changing the viewing mode to global.`),!1):!h&&m?(z.getLogger(At).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits in global viewing mode because its spatial reference (wkid:${a.wkid}) is projected. Please consider changing the viewing mode to local.`),!1):!!(Bi(a,u)||m&&nn(u)&&ln(a))||(z.getLogger(At).warnOnce(`SceneLayer (${e.title??"Untitled layer"}, ${e.id}) does not support geometry edits because its spatial reference (wkid:${a.wkid}) does not match the view spatial reference (wkid:${u.wkid}).`),!1)}let Le=class extends Lo{constructor(t){super(t),this.layerInfo=null,this.layerView=null}get attachments(){const t=this.defaults.attachments.enabled,i=this.layerInfo;return{enabled:t&&i?.enabled!==!1}}get create(){const{attachments:t,defaults:i,layerInfo:r,layer:o,layerView:a}=this,l=i.create,c=r?.enabled!==!1&&r?.addEnabled!==!1,d=l.enabled&&c;return{attributes:d&&l.attributes,enabled:d,geometry:d&&l.geometry&&Vo(o,a),attachments:{enabled:t.enabled&&d&&r?.attachmentsOnCreateEnabled!==!1},reliesOnOwnerAdminPrivileges:l.reliesOnOwnerAdminPrivileges}}get defaults(){return new Lo({layer:this.layer})}get delete(){const{defaults:t,layerInfo:i}=this,r=t.delete,o=i?.enabled!==!1&&i?.deleteEnabled!==!1;return{enabled:r.enabled&&o,reliesOnOwnerAdminPrivileges:r.reliesOnOwnerAdminPrivileges}}get formTemplate(){const{layer:t,layerInfo:i}=this;return i?.formTemplate?i.formTemplate:t&&"formTemplate"in t?t.formTemplate:null}get relationship(){const{layer:t}=this,i=!(!il(t)||!t.relationships?.length),r=!!this.formTemplate?.elements?.some(o=>o.type==="relationship");return{enabled:i&&r}}get update(){const{attachments:t,defaults:i,layerInfo:r,layer:o,layerView:a}=this,l=i.update,c=r?.enabled!==!1&&r?.updateEnabled!==!1,d=l.enabled&&c,u=d&&l.attributes&&r?.attributeUpdatesEnabled!==!1,p=d&&l.geometry&&r?.geometryUpdatesEnabled!==!1&&Vo(o,a),h=t.enabled&&r?.attachmentsOnUpdateEnabled!==!1;return{attributes:u,enabled:d,geometry:p,attachments:{enabled:h,create:h&&l.attachments.create,update:h&&l.attachments.update},reliesOnOwnerAdminPrivileges:l.reliesOnOwnerAdminPrivileges}}};function Vo(e,t){return e.type!=="scene"||t!=null&&"type"in t&&t.type==="scene-layer-3d"&&yu(e,t)}s([n()],Le.prototype,"attachments",null),s([n()],Le.prototype,"create",null),s([n()],Le.prototype,"defaults",null),s([n()],Le.prototype,"delete",null),s([n()],Le.prototype,"formTemplate",null),s([n()],Le.prototype,"layerInfo",void 0),s([n()],Le.prototype,"layerView",void 0),s([n()],Le.prototype,"relationship",null),s([n()],Le.prototype,"update",null),Le=s([M("esri.widgets.Editor.support.EditorEditingCapabilities")],Le);const wu=Le;let Y=class extends j{constructor(t){super(t),this.disabled=!1,this.layer=null,this.layerInfo=null,this.layerView=null}get _suspended(){return!!this.layerView?.suspended}get capabilities(){return new wu({layer:this.layer,layerInfo:this.layerInfo,layerView:this.layerView})}get editable(){const{create:t,relationship:i,update:r,delete:{enabled:o}}=this.capabilities,a=t.attachments.enabled||r.attachments.enabled;return!this.disabled&&(t.enabled||r.enabled||a||o||i.enabled)}get formTemplate(){return this.capabilities.formTemplate}get hasInvalidFormTemplate(){return En(this.layer,this.formTemplate)}get isTable(){return et(this.layer)}get supportsCreateFeaturesWorkflow(){if(this.disabled)return!1;const{enabled:t,geometry:i}=this.capabilities.create;return this.isTable?t:t&&i}get supportsMergeFeaturesWorkflow(){const{capabilities:t,layer:i}=this;return!this.disabled&&t.update.enabled&&t.update.geometry&&t.delete.enabled&&!et(i)&&Td(i.geometryType)}get supportsSplitFeatureWorkflow(){const{capabilities:t}=this;return!this.disabled&&t.update.enabled&&t.update.geometry&&t.create.enabled&&Jd(this.layer.geometryType)}get supportsUpdateWorkflow(){const{capabilities:t}=this;return!this.disabled&&(t.update.enabled||t.update.attachments.enabled||t.delete.enabled)}get visible(){const{layer:t}=this,i=t.parent;return!this._suspended&&t.visible&&(!i||!("visible"in i)||i.visible)}};s([n()],Y.prototype,"_suspended",null),s([n()],Y.prototype,"capabilities",null),s([n()],Y.prototype,"disabled",void 0),s([n()],Y.prototype,"editable",null),s([n()],Y.prototype,"formTemplate",null),s([n()],Y.prototype,"hasInvalidFormTemplate",null),s([n()],Y.prototype,"isTable",null),s([n()],Y.prototype,"layer",void 0),s([n()],Y.prototype,"layerInfo",void 0),s([n()],Y.prototype,"layerView",void 0),s([n()],Y.prototype,"supportsCreateFeaturesWorkflow",null),s([n()],Y.prototype,"supportsMergeFeaturesWorkflow",null),s([n()],Y.prototype,"supportsSplitFeatureWorkflow",null),s([n()],Y.prototype,"supportsUpdateWorkflow",null),s([n()],Y.prototype,"visible",null),Y=s([M("esri.widgets.Editor.support.EditorItem")],Y);const vu=Y;function Ga(e){return e.flatMap(t=>He(t)?t.featureItems:lt(t)?t.items.flatMap(i=>Ga([i])):t).filter(Q)}function ja(e){return e.flatMap(t=>lt(t)?t.items.flatMap(i=>ja([i])):He(t)&&t.total?t:null).filter(Q)}function Ba(e){let t=0;for(const i of e)He(i)&&(t+=i.total),lt(i)&&(t+=Ba(i.items));return t}function lt(e){return e!=null&&typeof e=="object"&&"items"in e}function He(e){return e!=null&&typeof e=="object"&&"featureItems"in e}function xr(e){return e!=null&&typeof e=="object"&&"graphic"in e}let Be=class extends j{constructor(t){super(t),this.layer=null,this.viewModel=null}get iconName(){return Pn(this.layer)}get key(){return this.layer.id}get layerView(){return this.viewModel.layerViewMap.get(this.layer.id)}get title(){return this.layer.title}get view(){return this.viewModel.view}};s([n()],Be.prototype,"iconName",null),s([n()],Be.prototype,"key",null),s([n()],Be.prototype,"layer",void 0),s([n()],Be.prototype,"layerView",null),s([n()],Be.prototype,"title",null),s([n()],Be.prototype,"view",null),s([n()],Be.prototype,"viewModel",void 0),Be=s([M("esri.widgets.support.SelectionList.ItemBase")],Be);const Nr=Be;let Ze=class extends Nr{constructor(t){super(t),this.items=[],this.layer=null}get layers(){const{layer:t}=this;return t.type==="group"||t.type==="knowledge-graph"?t.layers.toArray().reverse():t.type==="subtype-group"?t.sublayers.toArray().reverse():[]}get maxVisibleFeatureCountExceeded(){return this.items.some(t=>t.maxVisibleFeatureCountExceeded)}get total(){return this.items.reduce((t,i)=>t+i.total,0)}get visible(){return this.items.some(t=>t.visible)}get visibleTotal(){return this.items.reduce((t,i)=>t+i.visibleTotal,0)}reset(){this.items.forEach(t=>t.reset())}async sync({controller:t,promises:i}){const{layers:r,viewModel:o}=this;this.items=o.layersToItems({controller:t,groupLayerItem:this,layers:r,promises:i})}};s([n()],Ze.prototype,"items",void 0),s([n()],Ze.prototype,"layer",void 0),s([n()],Ze.prototype,"layers",null),s([n()],Ze.prototype,"maxVisibleFeatureCountExceeded",null),s([n()],Ze.prototype,"total",null),s([n()],Ze.prototype,"visible",null),s([n()],Ze.prototype,"visibleTotal",null),Ze=s([M("esri.widgets.support.SelectionList.GroupLayerItem")],Ze);const _u=Ze;let fe=class extends Nr{constructor(t){super(t),this._thumbnail=null,this.graphic=null,this.layer=null,this.layerItem=null,this.thumbnailSize=24}get _filterTerms(){return[this.title,this.layerItem.title,this.layerItem.groupLayerItem?.title].filter(Q)}get key(){return`${this.layer.id}:${this.objectId??this.graphic.uid}`}get objectId(){return this.graphic.getObjectId()}get title(){const{objectId:t}=this;if(t!=null)return this.layerItem.featureTitleMap.get(t)||`${t}`}get thumbnail(){return this._thumbnail??void 0}get thumbnailKey(){return`${this.key}-${this.graphic.uid}`}get visible(){const{_filterTerms:t,viewModel:{activeLayerItem:i,filterText:r}}=this;if(i&&i.layer!==this.layer)return!1;if(r==null||r===""||!t.length)return!0;const o=new RegExp(r,"iu");return t.some(a=>o.test(a))}async fetchThumbnail(t){return this._thumbnail=await Cr(this.graphic,this.layer,{maxSize:this.thumbnailSize,ariaLabel:t?.ariaLabel})}};s([n()],fe.prototype,"_filterTerms",null),s([n()],fe.prototype,"_thumbnail",void 0),s([n()],fe.prototype,"graphic",void 0),s([n()],fe.prototype,"key",null),s([n()],fe.prototype,"layer",void 0),s([n()],fe.prototype,"layerItem",void 0),s([n()],fe.prototype,"objectId",null),s([n()],fe.prototype,"title",null),s([n()],fe.prototype,"thumbnail",null),s([n()],fe.prototype,"thumbnailKey",null),s([n()],fe.prototype,"thumbnailSize",void 0),s([n()],fe.prototype,"visible",null),fe=s([M("esri.widgets.support.SelectionList.FeatureItem")],fe);const bu=fe;let me=class extends Nr{constructor(t){super(t),this._onChangeController=null,this.featureItems=[],this.featureTitleMap=new le,this.groupLayerItem=null,this.layer=null}get effectiveObjectIds(){return this.objectIds.slice(0,this.maxVisibleFeatureCountPerLayer)}get maxVisibleFeatureCountExceeded(){const{viewModel:t}=this;return this.objectIds.length>t.maxVisibleFeatureCountPerLayer&&this.visibleTotal===t.maxVisibleFeatureCountPerLayer}get maxVisibleFeatureCountPerLayer(){return this.viewModel.maxVisibleFeatureCountPerLayer}get objectIds(){return this.viewModel.effectiveSelectionManager?.getSelection(this.layer)??[]}get total(){return this.objectIds.length}get visible(){return this.featureItems.some(t=>t.visible)}get visibleTotal(){return cn(this.featureItems,t=>t.visible)}cancel(){this._onChangeController?.abort()}reset(){this.featureItems.forEach(t=>t.destroy()),this.featureItems=[]}async sync({controller:t,promises:i}){this.cancel();const r=new Map(this.featureItems.map(c=>[c.objectId,c])),o=new Map,a=[],l=[];for(const c of this.effectiveObjectIds){const d=r.get(c);d?o.set(c,d):(a.push(c),o.set(c,null))}if(this._onChangeController=t,a.length>0){const c=await this._createFeatureItems(a,t);jo(l,c);for(const d of l)d.objectId!=null&&o.set(d.objectId,d)}t.signal.aborted||(this.featureItems=Array.from(o.values()).filter(Q),i.push(this.syncTitles(l)))}async syncTitles(t=this.featureItems){const{layer:i}=this,r=t.map(o=>o.graphic);if("getFeatureTitles"in i&&i.getFeatureTitles)(await i.getFeatureTitles(r,{fetchMissingFields:!0,removeHTML:!0})).forEach((o,a)=>this.featureTitleMap.set(a,o));else{const o=i.displayField||dn(i.fields);o&&r.forEach(a=>{const l=a.getObjectId(),c=a.attributes[o];l!=null&&c&&this.featureTitleMap.set(l,c)})}}async _createFeatureItems(t,i){const{layer:r,layerView:o,viewModel:a}=this,l=new Map;if(o){const d=o.createQuery();d.objectIds=t,d.outFields=["*"],d.returnGeometry=!0;const u=await o.queryFeatures(d,i);for(const p of u.features){const h=p.getObjectId();h!=null&&l.set(h,p)}}if(i.signal.aborted)return[];const c=t.filter(d=>!l.has(d));if(c.length){const{view:d}=this,u=r.createQuery();u.objectIds=c,u.outSpatialReference=d?.spatialReference,u.outFields=d?rl(r,d,!0):["*"],u.returnGeometry=!0;const p=await r.queryFeatures(u,i);for(const h of p.features){const m=h.getObjectId();m!=null&&l.set(m,h)}}return Array.from(l.values()).map(d=>new bu({graphic:d,layer:r,layerItem:this,viewModel:a}))}};s([n()],me.prototype,"_onChangeController",void 0),s([n()],me.prototype,"effectiveObjectIds",null),s([n()],me.prototype,"featureItems",void 0),s([n()],me.prototype,"featureTitleMap",void 0),s([n()],me.prototype,"groupLayerItem",void 0),s([n()],me.prototype,"layer",void 0),s([n()],me.prototype,"maxVisibleFeatureCountExceeded",null),s([n()],me.prototype,"maxVisibleFeatureCountPerLayer",null),s([n()],me.prototype,"objectIds",null),s([n()],me.prototype,"total",null),s([n()],me.prototype,"visible",null),s([n()],me.prototype,"visibleTotal",null),me=s([M("esri.widgets.support.SelectionList.LayerItem")],me);const ku=me,xu=100;let $=class extends j{constructor(e){super(e),this._allLayerItems=null,this._groupItemCache=new Map,this._hoverHighlightHandle=null,this._layerEditAbortControllers=new Map,this._layerEditHandles=new ye,this._layerItemCache=new Map,this._onChangeAbortController=null,this._updatingHandles=new Dt,this.filterText=void 0,this.layer=null,this.maxVisibleFeatureCountPerLayer=500,this.selectionManager=null,this._onSelectionChangeController=async()=>{this._cancelOnSelectionChange();const t=new AbortController;this._onChangeAbortController=t,await this._updatingHandles.addPromise(St(this._generateListItems(t))),this._onChangeAbortController===t&&(this._onChangeAbortController=null),(this.layer&&this.effectiveSelectionManager?.getSelection(this.layer))?.length||(this.layer=null)},this._cancelOnSelectionChange=()=>this._onChangeAbortController?.abort(),this._onSelectionChangeDebounced=ht(this._onSelectionChangeController,xu),this._cancelOnLayerEdit=t=>this._layerEditAbortControllers.get(t)?.abort()}initialize(){this.addHandles([x(()=>[this.view,this.effectiveSelectionManager,...this._sources],()=>{this._onSelectionChange(),this._refreshLayerEditHandles()}),Z(()=>this.effectiveSelectionManager?.sources,"change",()=>{this._onSelectionChange(),this._refreshLayerEditHandles()}),Z(()=>this.effectiveSelectionManager,"selection-change",()=>this._onSelectionChange())])}destroy(){this._cancelOnSelectionChange(),this.removeTemporaryHighlight(),this._updatingHandles.destroy(),this._layerEditHandles.drain(bt),this._layerEditAbortControllers.forEach(De)}get _sources(){return this.effectiveSelectionManager?.sources.toArray()??[]}get activeLayerItem(){const{layer:e}=this;return e&&this.layerItems.find(t=>t.layer===e)}get allLayerItems(){return this._allLayerItems??[]}get effectiveCount(){return Ba(this.allLayerItems)}get effectiveSelectionManager(){return this.selectionManager??this.view?.selectionManager}get isUpdating(){return!(!this._onChangeAbortController&&!this._updatingHandles.updating)}get layerItems(){return ja(this.allLayerItems)}get layerViewMap(){const e=new Map,{view:t}=this;if(!t)return e;for(const i of t.allLayerViews)if(e.set(i.layer.id,i),tt(i.layer))for(const r of i.layer.sublayers)e.set(r.id,i);return e}get maxVisibleFeatureCountExceeded(){return this.allLayerItems.some(e=>e.maxVisibleFeatureCountExceeded)}get state(){const{view:e}=this;return e?e.ready?this.effectiveSelectionManager?"ready":"error":"loading":"disabled"}get viewLayersAndTables(){const{view:e}=this;return e?.map?[...e.map.layers.toArray().reverse(),...e.map.tables.toArray().reverse()]:[]}get visibleFeatureCount(){return this.activeLayerItem?.visibleTotal??this.visibleFeatureItems.length}get visibleFeatureItems(){return this.layerItems.flatMap(e=>e.featureItems.filter(t=>t.visible))}get visibleLayerCount(){const{effectiveSelectionManager:e}=this;return e&&e.count!==0?e.count===1||this.activeLayerItem?1:this.layerItems.filter(t=>t.visible).length:0}addTemporaryHighlight({graphic:e,layerView:t}){this.removeTemporaryHighlight(),t&&e&&(this._hoverHighlightHandle=t.highlight(e,{name:"temporary"}))}clear(){this.effectiveSelectionManager?.clear()}deselectFeatureItem(e){const t=e.graphic.getObjectId();t!=null&&this.effectiveSelectionManager?.removeFromSelection(e.layer,[t])}deselectGroupItem(e){e.items.forEach(t=>{He(t)?this.deselectLayerItem(t):this.deselectGroupItem(t)})}deselectLayerItem(e){this.effectiveSelectionManager?.setSelection(e.layer,[])}deselectItem(e){lt(e)?this.deselectGroupItem(e):He(e)?this.deselectLayerItem(e):this.deselectFeatureItem(e)}goToItem(e){He(e)||lt(e)?this._goTo(Ga([e]).map(t=>t.graphic)):this._goTo(e.graphic)}layersToItems(e){const{controller:t,groupLayerItem:i,layers:r,promises:o}=e,{_groupItemCache:a,_layerItemCache:l,effectiveSelectionManager:c,viewLayersAndTables:d}=this,u=r??d;if(!c||c.count===0)return[];const p=[];for(const h of u)switch(h.type){case"subtype-group":case"knowledge-graph":case"group":{const m=a.get(h),g=m??new _u({layer:h,viewModel:this});m||a.set(h,g),o.push(g.sync({controller:t,promises:o})),p.push(g)}break;default:if(lr(h)||We(h)){const m=h;if(!c.getSelection(m)?.length)continue;const y=l.get(m),b=y??new ku({groupLayerItem:i,layer:m,viewModel:this});y||l.set(m,b),o.push(b.sync({controller:t,promises:o})),p.push(b)}}return p}removeFromSelection(e){this.effectiveSelectionManager?.removeFromSelection(e.layer,e.objectIds)}removeTemporaryHighlight(){this._hoverHighlightHandle=bt(this._hoverHighlightHandle)}selectSingleFeatureItem(e){const t=e.objectId;if(t!=null&&this.effectiveSelectionManager)for(const{layer:i}of this.effectiveSelectionManager.selections)this.setSelection({layer:i,objectIds:i===e.layer?[t]:[]})}selectSingleGroupItem(e){if(this.effectiveSelectionManager)for(const{layer:t,selection:i}of this.effectiveSelectionManager.selections)this.setSelection({layer:t,objectIds:t.parent===e.layer?i:[]})}selectSingleItem(e){lt(e)?this.selectSingleGroupItem(e):He(e)?this.selectSingleLayerItem(e):this.selectSingleFeatureItem(e)}selectSingleLayerItem(e){if(this.effectiveSelectionManager)for(const{layer:t,selection:i}of this.effectiveSelectionManager.selections)this.setSelection({layer:t,objectIds:t===e.layer?i:[]})}setSelection(e){this.effectiveSelectionManager?.setSelection(e.layer,e.objectIds)}async _goTo(e){const{view:t}=this;if(t)try{await qt(t,e)}catch(i){i.name!=="AbortError"&&z.getLogger(this).warn("Failed to go to feature(s)",i)}}async _generateListItems(e){try{this.removeTemporaryHighlight();const t=[],i=this.layersToItems({controller:e,promises:t});t.length>0&&await Promise.all(t),this._onChangeAbortController===e&&(this._allLayerItems=i)}catch(t){z.getLogger(this).warn("Failed updating selection",t)}}_onSelectionChange(){St(this._onSelectionChangeDebounced())}_refreshLayerEditHandles(){const{effectiveSelectionManager:e}=this;if(this._layerEditHandles.drain(bt),!e?.sources.length)return;const t=new Set(e.sources.map(i=>We(i)?i.parent:i));for(const i of t)lr(i)&&"on"in i&&this._layerEditHandles.push(i.on("edits",r=>{this._onLayerEdit(r,i)}))}async _onLayerEdit(e,t){try{if(this.removeTemporaryHighlight(),this._cancelOnLayerEdit(t),!e.updatedFeatures.some(o=>o.objectId!=null&&!o.error))return;const i=new AbortController;this._layerEditAbortControllers.set(t,i);const r=t.type==="subtype-group"||t.type==="knowledge-graph"?this.allLayerItems.find(o=>o.layer===t):this.layerItems.find(o=>o.layer===t);if(r?.layerView){const o=r.layerView;if(await this._onLayerViewUpdate(o),i.signal.aborted)return;r.reset(),this._onSelectionChange()}this._layerEditAbortControllers.get(t)===i&&this._layerEditAbortControllers.delete(t)}catch(i){z.getLogger(this).warn("Failed updating selected features",i)}}async _onLayerViewUpdate(e){await un(O(()=>e.updating),2e3),await O(()=>!e.updating)}};s([n()],$.prototype,"_allLayerItems",void 0),s([n()],$.prototype,"_groupItemCache",void 0),s([n()],$.prototype,"_hoverHighlightHandle",void 0),s([n()],$.prototype,"_layerEditAbortControllers",void 0),s([n()],$.prototype,"_layerEditHandles",void 0),s([n()],$.prototype,"_layerItemCache",void 0),s([n()],$.prototype,"_onChangeAbortController",void 0),s([n()],$.prototype,"_sources",null),s([n()],$.prototype,"_updatingHandles",void 0),s([n()],$.prototype,"activeLayerItem",null),s([n()],$.prototype,"allLayerItems",null),s([n()],$.prototype,"effectiveCount",null),s([n()],$.prototype,"effectiveSelectionManager",null),s([n()],$.prototype,"filterText",void 0),s([n()],$.prototype,"isUpdating",null),s([n()],$.prototype,"layer",void 0),s([n()],$.prototype,"layerItems",null),s([n()],$.prototype,"layerViewMap",null),s([n()],$.prototype,"maxVisibleFeatureCountExceeded",null),s([n()],$.prototype,"maxVisibleFeatureCountPerLayer",void 0),s([n()],$.prototype,"selectionManager",void 0),s([n()],$.prototype,"state",null),s([n()],$.prototype,"view",void 0),s([n()],$.prototype,"viewLayersAndTables",null),s([n()],$.prototype,"visibleFeatureCount",null),s([n()],$.prototype,"visibleFeatureItems",null),s([n()],$.prototype,"visibleLayerCount",null),$=s([M("esri.widgets.support.SelectionList.SelectionListViewModel")],$);const Za=$;function Fu(e,t){return e?.find(i=>i.layer===t)}let I=class extends Ir{constructor(e){super(e),this._queuedSelectionTool=null,this._sketchEventListenerHandle=null,this._sketchGraphicsLayer=new It({listMode:"hide",internal:!0,title:"Editor sketch layer"}),this._snappingManager=null,this._templatesByLayer=new Map,this._updateItemsTask=null,this._updateTemplatesTask=null,this._updatingHandles=new Dt,this._featureTemplatesViewModelIsRestricted=!1,this.activeWorkflow=null,this._activityQueue=new ye,this.editorItems=new ye,this.failures=[],this.hideTemplatesForInactiveLayers=!1,this.attachmentsViewModel=new aa({capabilities:{editing:!0}}),this.featureTemplatesViewModel=new ia({disabledItemFunction:({layer:t})=>this._itemIsSuspended(t)}),this.layerInfos=null,this.ownSketchViewModel=new ci({layer:this._sketchGraphicsLayer}),this.selectionListViewModel=new Za,this.selectionManager=new pn,this.selectionToolbarViewModel=new ol({continuousSelectionEnabled:!0,defaultOperationType:"replace",persistSelection:!1,returnGeometry:!1}),this.sketchOptions=new zt,this.snappingOptions=new oa({attributeRulesEnabled:!0}),this.spinnerViewModel=new jn,this.pageStack=[],this.showDiscardEditsPrompt=()=>Promise.resolve(!0),this._candidateCommitted=!1,this.back=async()=>{if(this.state==="viewing-selection-list")return this.selectionListViewModel.filterText=void 0,void this.effectiveSelectionManager.clear();this.canGoBack&&(this.activeWorkflow?.hasPreviousStep?await this.activeWorkflow.back(this.showDiscardEditsPrompt):await this._cancelWorkflow({force:!this.hasPendingEdits}))},this.saveWorkflow=async()=>await this.activeWorkflow?.save(),this.selectFeature=(t,i=!1)=>{const r=this.activeWorkflow;if(this._candidateCommitted||r?.type!=="update")return;const{rootFeatures:o}=r.data;o.removeAll(),t&&o.add(t),i&&(r.next(),this._candidateCommitted=!0)}}initialize(){this.addHandles([x(()=>{const e=this.view,t=e?.map?.editableLayers.toArray(),i=e?.allLayerViews,r=i?.filter(o=>!!t?.includes(o.layer));return[t,r,this.layerInfos]},()=>this._updateEditorItems(),rt),x(()=>this.hideTemplatesForInactiveLayers,()=>this.syncFeatureTemplates()),x(()=>this._selectionSources,()=>this._syncSelectionSources(),re),Z(()=>this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),Z(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),Z(()=>this.activeWorkflow,"complete",()=>{this.emit("workflow-commit"),this._set("activeWorkflow",null)}),Ve(()=>!this.activeWorkflow&&this._queuedSelectionTool,()=>this._queuedSelectionTool&&this.selectionToolbarViewModel.activateTool(this._queuedSelectionTool)),x(()=>this.activeWorkflow,e=>this.selectionManager.showHighlight=!e),Ve(()=>this.view?.map,e=>e.add(this._sketchGraphicsLayer),re),Z(()=>this.editorItems,"change",()=>this._afterEditorItemsChange()),x(()=>[this.canCreate,this.canUpdateVisible],()=>this._afterEditorItemsChange()),x(()=>this.page,(e,t)=>{const i=[...this.pageStack];if(i.indexOf(e)===-1)i.push(e);else for(;i.length&&i.at(-1)!==e;)i.pop();this.pageStack=i},rt),Ve(()=>this.state==="awaiting-update-feature-candidate",()=>this._candidateCommitted=!1),Z(()=>this.featureTemplatesViewModel,"select",async({item:e,oldItem:t})=>{const{activeWorkflow:i}=this;if(i){if(i.type==="update"&&i.activeWorkflow?.stepId==="awaiting-feature-creation-info")return;try{await this.cancelWorkflow({force:!this.hasPendingEdits})}catch{return void this.featureTemplatesViewModel.select(t,{emit:!1})}}if(!e)return;const r={layer:e.layer,template:e.template};if(e.supportsUpload)return this.featureTemplatesViewModel.select(t,{emit:!1}),this.startCreateFeaturesWorkflow(r);await this.startCreateFeaturesWorkflowAtFeatureCreation(r)}),x(()=>[this.view,this.featureTemplatesViewModel],([e,t])=>{t.view=e},rt),Z(()=>this.view,"key-down",e=>{e.key==="Escape"&&this.activeWorkflow?.keyboardCancellationEnabled&&(e.stopPropagation(),this.back())}),Z(()=>this.sketchViewModel,["create","delete","update"],e=>{const{activeWorkflow:t}=this,i=fd(t),r=`sketch-${e.type}`;this.emit(r,{type:r,detail:e,layer:i[0],layers:i})},Pt),x(()=>this.view,e=>{if(this._snappingManager=ct(this._snappingManager),!e)return;const t=this.snappingOptions;this._snappingManager=new Zn({view:e,options:t}),this.ownSketchViewModel.snappingManager=this._snappingManager},rt),x(()=>this.snappingOptions,e=>{this._snappingManager&&(this._snappingManager.options=e)},rt),Z(()=>this.selectionToolbarViewModel,"complete",e=>this._onSelectionComplete(e)),x(()=>({view:this.view,selectionManager:this.effectiveSelectionManager,selectionListViewModel:this.selectionListViewModel,selectionToolbarViewModel:this.selectionToolbarViewModel}),({view:e,selectionManager:t,selectionListViewModel:i,selectionToolbarViewModel:r})=>{t.view=e,i.view=e,r.view=e},rt),x(()=>this.effectiveSelectionManager,e=>{this.selectionListViewModel.selectionManager=e,this.selectionToolbarViewModel.selectionManager=e},rt)])}destroy(){this._cancelWorkflow({warnIfNoWorkflow:!1}).then(()=>{this.view?.map?.remove(this._sketchGraphicsLayer),this.view=null}),this._updateItemsTask=De(this._updateItemsTask),this._updatingHandles.destroy(),this._sketchEventListenerHandle=bt(this._sketchEventListenerHandle),this.selectionListViewModel?.destroy(),this.selectionToolbarViewModel?.destroy(),this.selectionManager.destroy()}get _featureTemplatesLayersAndTables(){const e=new ye;for(const t of this.editorItems){const i=this.hideTemplatesForInactiveLayers&&!t.visible;t.supportsCreateFeaturesWorkflow&&!i&&e.push(t.layer)}return e}get _selectionSources(){const e=new ye;for(const t of this.editorItems)lr(t.layer)&&t.supportsUpdateWorkflow&&t.visible&&e.push(t.layer);return e}get activeFeatureCount(){const e=this.activeLeafWorkflow;return Qt(e)?e.pendingFeatures.length:Kt(e)&&e.data.edits.feature?1:nt(e)?e.data.fullFeatures.length:$r(e)?e.data.features.length:Ut(e)?2:0}get activeLeafWorkflow(){const e=this.activeWorkflow;return e&&oi(e)?e.activeWorkflow??e:e}get canCreate(){return this.editorItems.some(e=>e.supportsCreateFeaturesWorkflow)}get canCreateVisible(){return!!this.featureTemplatesLayers.length}get canUpdate(){return this.editorItems.some(e=>e.supportsUpdateWorkflow)}get canUpdateVisible(){return this.editorItems.some(e=>e.supportsUpdateWorkflow&&e.visible)}get featureTemplatesLayers(){return this._featureTemplatesLayersAndTables.filter(e=>e.type==="scene"||!e.isTable)}get effectiveSelectionManager(){return this.selectionManager}get featureFormViewModel(){const e=this.activeWorkflow?.formViewModel;return Ke(e)?e:null}get formViewModel(){return this.activeWorkflow?.formViewModel}get utilityNetworkAssociationAddAssociationViewModel(){const{activeWorkflow:e}=this;return e?.type==="update"?e.activeUtilityNetworkAssociationAddAssociationViewModel:null}get labelOptions(){return this.sketchOptions.labels}set labelOptions(e){this.sketchOptions.labels=e}get sketchViewModel(){const{activeWorkflow:e}=this;return e?.type==="update"?e.activeSketchViewModel:e?.type==="create-features"?e.sketchViewModel:this.ownSketchViewModel}get state(){if(!this.view?.ready)return"disabled";const e=this.attachmentsViewModel.mode;if(e==="add")return"adding-attachment";if(e==="edit")return"editing-attachment";const{activeWorkflow:t}=this,i=!t?.stepId;return this.effectiveSelectionManager.count&&i?"viewing-selection-list":i?"ready":t.type==="update"&&t.activeWorkflow?.stepId?t.activeWorkflow.stepId:t.stepId}get syncing(){return this._activityQueue.length>0}get updating(){return this._updatingHandles.updating||this.activeWorkflow?.updating===!0}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(e){this.sketchOptions.tooltips=e}get valueOptions(){return this.sketchOptions.values}set valueOptions(e){this.sketchOptions.values=e}set view(e){this.ownSketchViewModel.view=e,this.spinnerViewModel.view=e,this._set("view",e)}get canZoomTo(){const e=this.sketchViewModel,t=e?.createGraphic?.geometry?.type;return!(!e?.updateGraphics?.length&&t!=="multipoint")}get page(){const{activeWorkflow:e,state:t}=this;if(e?.type==="update"&&Ke(e.formViewModel)){const{associatedLayer:i,associationId:r}=e.formViewModel;if(i||r!=null)return"viewing-associated-features"}if(e?.type==="update"&&e.stepId==="awaiting-feature-to-update")return"ready";if(e?.type==="create-features"&&e.numPendingFeatures===0){const i=e.data.upload;if(i)return i.state==="default"?"ready":"creating-features-upload-details"}return t??"disabled"}get featureFormDisabled(){const{activeLeafWorkflow:e}=this;if(Kt(e))return e.data.editorItem?.capabilities.update.attributes===!1||e.formViewModel.disabled===!0;if(nt(e)){const{formViewModel:t}=e;return t.disabled||t.readOnly}return!1}get featureFormHasAssociation(){return!!this.featureFormViewModel?.activeAssociation}get canGoBack(){return this.activeWorkflow!=null&&!this.syncing}get shouldShowDeleteButton(){const{activeLeafWorkflow:e}=this;if(Kt(e)){const{data:t}=e;return t.editorItem?.capabilities.delete.enabled&&!t.readOnly}return!!nt(e)&&e.data.editorItems.every(t=>t.capabilities.delete.enabled)}get hasPendingEdits(){return this.activeWorkflow?.hasPendingEdits??!1}get snappingManager(){return this._snappingManager}getTemplatesForLayer(e){return this._templatesByLayer.get(e)??[]}async startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.startCreateFeaturesWorkflow()}async startCreateFeaturesWorkflowAtFeatureCreation(e){return this.startCreateFeaturesWorkflow(e,"creating-features")}async startCreateFeaturesWorkflow(e,t="awaiting-feature-creation-info"){if(await O(()=>!this.updating),!this.canCreate)throw new v("editing:unsupported-workflow","Creating features is unsupported or disabled.");const i=this._createUpdatingResolver();try{await this._cancelWorkflow();const r=this._createCreateFeaturesWorkflow(e,t);this._set("activeWorkflow",r),await r.start()}catch(r){this._logErrorAndCancelWorkflow(r)}finally{i.resolve()}}async startCreateFeaturesWorkflowAtFeatureEdit(e){await O(()=>!this.updating);const t=this._createUpdatingResolver();try{const{initialFeature:i}=e,r=i.sourceLayer=i.layer,o=r?Lt(this.editorItems,r):void 0;if(!o?.supportsCreateFeaturesWorkflow)throw new v("editing:unsupported-workflow","Creating features is unsupported or disabled for this layer.");await this._cancelWorkflow();const a=this._createCreateFeaturesWorkflow({initialFeature:i,layer:o.layer,maxFeatures:1},"creating-features");this._set("activeWorkflow",a),await a.start()}catch(i){this._logErrorAndCancelWorkflow(i)}finally{t.resolve()}}async startMergeFeaturesWorkflow(e,t={}){await O(()=>!this.updating),Vi(this,"merge-features");const i=Array.isArray(e)?ki(e):[e];if(i.length>1)throw new Yt;if(i.length===0||i[0].objectIds.length<2)throw new yr(2);const r=i[0],o=r.layer;if(!o)throw new Io;const a=Lt(this.editorItems,o);Da(a);const l=this._createUpdatingResolver(),c=new AbortController;this.addHandles(xt(c));try{await this._cancelWorkflow(),this.selectionToolbarViewModel.cancel();const d=await Wr(r.objectIds,o,this.view?.spatialReference,c.signal);if(d.length!==r.objectIds.length)throw new xo;let u;if(t.keyFeature){const h=t.keyFeature.getObjectId();u=d.find(m=>m.getObjectId()===h)??t.keyFeature}const p=this._createUpdateWorkflow("editing-existing-feature",{rootFeatures:new ye(d),rootWorkflowOptions:{type:"merge",props:{...t,keyFeature:u}}});this._set("activeWorkflow",p),this.addHandles(this._destroyWorkflowOnCommit(p)),await p.start()}catch(d){this._logErrorAndCancelWorkflow(d)}finally{l.resolve()}}async startSplitFeatureWorkflow(e,t={}){await O(()=>!this.updating),Vi(this,"split-feature");const i=Vr(e);if(!i)throw new Io;const r=Lt(this.editorItems,i);za(r);const o=this._createUpdatingResolver(),a=new AbortController;this.addHandles(xt(a));try{await this._cancelWorkflow();const l=await Va([e],i,this.view?.spatialReference,a.signal);if(l.length!==1)throw new xo;const c=this._createUpdateWorkflow("editing-existing-feature",{rootFeatures:new ye(l),rootWorkflowOptions:{type:"split",props:t}});this._set("activeWorkflow",c),this.addHandles(this._destroyWorkflowOnCommit(c)),await c.start()}catch(l){this._logErrorAndCancelWorkflow(l)}finally{o.resolve()}}async startUpdateFeaturesWorkflow(e){if(await O(()=>!this.updating),!this.canUpdate)return void this._logError("editing:unsupported-workflow","Update features workflow is unsupported or disabled.");const t=Array.isArray(e)?ki(e):[e];if(t.length>1)throw new Yt;const i=this._createUpdatingResolver();try{await this._cancelWorkflow();const r=this._createUpdateWorkflow("editing-existing-feature",{rootFeatureInfos:t,rootWorkflowOptions:{type:"update-multiple"}});r.addHandles(this._destroyWorkflowOnCommit(r)),this._set("activeWorkflow",r),await r.start()}catch(r){this._logErrorAndCancelWorkflow(r)}finally{i.resolve()}}async startUpdateWorkflowAtFeatureSelection(){if(await O(()=>!this.updating),!this.canUpdate)return void this._logError("editing:unsupported-workflow","Update workflow is unsupported or disabled.");const e=this._createUpdatingResolver();try{await this._cancelWorkflow();const t=this._createUpdateWorkflow();this._set("activeWorkflow",t),await t.start()}catch(t){this._logErrorAndCancelWorkflow(t)}finally{e.resolve()}}async startUpdateWorkflowAtMultipleFeatureSelection(e){if(await O(()=>!this.updating),!this.canUpdate)return void this._logError("editing:unsupported-workflow","Update workflow is unsupported or disabled.");const t=this._createUpdatingResolver();try{await this._cancelWorkflow();const i=this._createUpdateWorkflow("awaiting-update-feature-candidate");i.data.candidates=e,this._set("activeWorkflow",i),await i.start()}catch(i){this._logErrorAndCancelWorkflow(i)}finally{t.resolve()}}async startUpdateWorkflowAtFeatureEdit(e){if(await O(()=>!this.updating),!this.canUpdate)return void this._logError("editing:unsupported-workflow","Update workflow is unsupported or disabled.");const t=this._createUpdatingResolver();try{await this._cancelWorkflow(),this.selectionToolbarViewModel.cancel();const i=this._createUpdateWorkflow("editing-existing-feature",{rootFeatures:new ye([e])});i.addHandles(this._destroyWorkflowOnCommit(i)),this._set("activeWorkflow",i),await i.start()}catch(i){this._logErrorAndCancelWorkflow(i)}finally{t.resolve()}}async startUpdateWorkflowWithActiveSelection(){const{selectionListViewModel:e}=this;if(!e.visibleFeatureCount||!e.visibleLayerCount)throw new v("editing:missing-selection","Unable to determine visible selection.");if(e.visibleLayerCount>1)throw new v("editing:features-different-layers","Cannot start workflow with features from different layers.");const t=e.layerItems.find(i=>i.visible);t&&await this._startUpdateWorkflowWithLayerItem(t,"update")}async deleteFeatureFromWorkflow(){Jo(z.getLogger(this),"EditorViewModel.deleteFeatureFromWorkflow is deprecated. Use EditorViewModel.deleteFeatures instead.",{version:"4.33",replacement:"EditorViewModel.deleteFeatures",warnOnce:!0}),await this.deleteFeatures()}async deleteFeatures(){const e=this.activeWorkflow;if(oi(e))return e.deleteActiveFeatures();this._logError("editing:unsupported-workflow","Deleting features requires an active update workflow.")}async deleteAssociationFromWorkflow(){const{activeWorkflow:e}=this;e&&e.type==="update"?await e.deleteActiveAssociation():this._logError("editing:unsupported-workflow","Deleting an association requires an active update workflow.")}async cancelWorkflow(e){return this._cancelWorkflow({warnIfNoWorkflow:!0,...e})}itemHasInvalidFormTemplate(e){return e!=null&&it(this.editorItems,e.layer)?.hasInvalidFormTemplate===!0}syncFeatureTemplates(){this._featureTemplatesViewModelIsRestricted||this._updateTemplates()}zoomTo(e){const{view:t,sketchViewModel:i}=this;if(!t)return;const r=void 0,o=e??i?.createGraphic;if(o)o.geometry?.type==="mesh"?qt(t,o.geometry,r):qt(t,o,r);else{const a=i?.updateGraphics?.toArray();t.type==="3d"&&a?.some(l=>l.geometry?.type==="mesh")?qt(t,a.map(l=>l.geometry).filter(Q),r):a&&qt(t,a,r)}}async toggleUpdateWorkflow(){this.canUpdate&&(this.hasPendingEdits&&!await this.showDiscardEditsPrompt()||(this.activeWorkflow&&this.state==="awaiting-feature-to-update"?await this.cancelWorkflow({force:!0}):await this.startUpdateWorkflowAtFeatureSelection()))}async onSelectionListItemSelect(e){xr(e)&&await this.startUpdateWorkflowAtFeatureEdit(e.graphic)}async onSelectionListMenuItemSelect(e,t){xr(e)?await this.startUpdateWorkflowAtFeatureEdit(e.graphic):He(e)&&await this._startUpdateWorkflowWithLayerItem(e,t)}restrictFeatureTemplatesViewModelToLayer(e){return this._featureTemplatesViewModelIsRestricted=!0,this._setFeatureTemplatesViewModelLayers([e]),L(()=>{this._featureTemplatesViewModelIsRestricted=!1,this._setFeatureTemplatesViewModelLayers(this.featureTemplatesLayers)})}async _getEditorItemCandidates(e){const{view:t}=this;if(!t?.map)return[];const{map:i}=t,r=i.editableLayers.toArray(),o=i.allTables.toArray().filter(a=>Ar(a)||tt(a));return await Promise.allSettled([...r.flatMap(a=>this._getLayerLoadPromise(a)),...o.flatMap(a=>this._getLayerLoadPromise(a))]),pt(e),[...r.reverse(),...o.reverse()].filter(a=>nr(a)&&(a.geometryType!=="mesh"||t.type==="3d")).flatMap(a=>a.type==="subtype-group"?a.sublayers.toArray():a)}_getLayerLoadPromise(e){return tt(e)?e.loadAll():e.load()}_drainEditorItems(){this.editorItems.drain(e=>e.destroy())}_updateEditorItems(){De(this._updateItemsTask);const{view:e}=this,t=Ti(async i=>{if(!e?.map||!e?.allLayerViews)return;const r=await this._getEditorItemCandidates(i);if(!r.length)return void this._drainEditorItems();const o=[],a=[],l=[],{layerInfos:c}=this;for(const u of r){const p=Fu(c,u),h=await ut(e,u).catch(()=>null);(p?o:h?a:l).push(new vu({layer:u,layerInfo:p,layerView:h}))}c?.length&&o.sort((u,p)=>c.findIndex(({layer:h})=>h===u.layer)-c.findIndex(({layer:h})=>h===p.layer));const d=[...o,...a,...l];i.aborted||(this._drainEditorItems(),this.editorItems.addMany(d))});this._updatingHandles.addPromise(t.promise),this._updateItemsTask=t}_updateTemplates(){De(this._updateTemplatesTask);const e=Ti(async t=>{const i=this._templatesByLayer,r=this._featureTemplatesLayersAndTables.filter(o=>!i.has(o));if(r.length>0){const o=await zn({layers:r.toArray(),view:this.view,signal:t,queryOptions:{returnVisibleTemplatesOnly:!0}});for(const{layer:a,templates:l}of o)i.set(a,l)}this._setFeatureTemplatesViewModelLayers(this.featureTemplatesLayers)});this._updatingHandles.addPromise(e.promise),this._updateTemplatesTask=e}_setFeatureTemplatesViewModelLayers(e){const t=this._templatesByLayer,i=[];for(const r of e){const o=t.get(r);o&&o.length>0&&i.push(Un(r,o))}this.featureTemplatesViewModel.templateInfos=i}_afterEditorItemsChange(){const{activeWorkflow:e}=this;if(this.syncFeatureTemplates(),!e)return;const{stepId:t}=e;e.type!=="create-features"?e.type==="update"&&(t==="awaiting-feature-to-update"&&!this.canUpdateVisible||t==="awaiting-update-feature-candidate"&&!e.hasUpdatableCandidates)&&this._cancelWorkflow():t!=="awaiting-feature-creation-info"||this.canCreate||this._cancelWorkflow()}async _cancelWorkflow(e){const t=this.activeWorkflow;if(!t)return void(e?.warnIfNoWorkflow&&this._logError("editing:no-active-workflow","There is no active workflow to cancel."));if(!e||e.force!==!1){this.emit("workflow-cancel"),this._set("activeWorkflow",null);try{await t.cancel(e)}finally{t.destroy()}}else try{await t.cancel(e),this._set("activeWorkflow",null),t.destroy()}catch{}}_createCreateFeaturesWorkflow(e,t){return Ra.create({viewModel:this,creationInfo:e,sketchOptions:this.sketchOptions,snappingManager:this._snappingManager,startAt:t,applyEdits:(i,r,o)=>this._applyEdits(i,r,o),applyEditsFeatureService:(i,r,o)=>this._applyEditsFeatureService(i,r,o),addAttachmentsCallback:(i,r)=>this._addAttachments(i,r)})}_createUpdateWorkflow(e,t){return gu.create({viewModel:this,sketchOptions:this.sketchOptions,snappingManager:this._snappingManager,startAt:e,...t,applyEdits:(r,o,a)=>this._applyEdits(r,o,a),applyEditsFeatureService:(r,o,a)=>this._applyEditsFeatureService(r,o,a),addAttachmentsCallback:(r,o)=>this._addAttachments(r,o)})}_addAttachments(e,t){const i=t.map(r=>this._addAttachment(e,r.feature,r.attachment))??[];return Promise.all(i)}async _addAttachment(e,t,i){let r=null;if(!("addAttachment"in e)||e.capabilities?.attachment==null)throw new v("editor:attachments-not-supported","Adding attachments is not supported for this layer type");return await this._queueOperation(async()=>(r=await e.addAttachment?.(t,i).catch(o=>{throw o?.error||o})??null,r)),r}async _applyEdits(e,t,i){let r=null;const o=e.url?await hn(e.url):null,a={returnServiceEditsOption:(!o||!fn(o))&&!/\/hosted\//i.test(e.url)?"original-and-current-features":void 0,...i};return await this._queueOperation(async()=>{const{view:l}=this;if(!l)return null;const c=await ut(l,e).catch(()=>null);return r=await e.applyEdits(t,a),c&&await O(()=>!c.updating),r}),r}async _applyEditsFeatureService(e,t,i){let r=null;return await this._queueOperation(async()=>r=await e.applyEdits(t,i)),r}_destroyWorkflowOnCommit(e){return Z(()=>e,"commit",()=>{e.destroy(),this.activeWorkflow===e&&this._set("activeWorkflow",null)})}_queueOperation(e){this._activityQueue.push(e);const t=(i,r)=>{const o=r.indexOf(i);o>-1&&r.splice(o,1)};return e().then(i=>(Array.isArray(i)?i.forEach(r=>this._handleEditsResultError(r)):this._handleEditsResultError(i),i)).catch(i=>{this._logError("editing:operation-error","An error occurred.",{error:i});const r={error:i,retry:()=>(t(r,this.failures),this._queueOperation(e)),cancel:()=>{t(r,this.failures)}};this._set("failures",[...this.failures,r])}).then(()=>{t(e,this._activityQueue)})}_handleEditsResultError(e){if(e!=null&&"error"in e&&e.error!=null)throw e.error;if(e!=null&&"addFeatureResults"in e){const{addFeatureResults:t,deleteFeatureResults:i,updateFeatureResults:r}=e,o=t.find(a=>!!a.error)||r.find(a=>!!a.error)||i.find(a=>!!a.error);if(o)throw o.error}}_createUpdatingResolver(){const e=Rt();return this._updatingHandles.addPromise(e.promise),e}_logErrorAndCancelWorkflow(e){const{name:t,message:i,details:r}=e;this._logError(t??"editing:workflow-start-failed",i??void 0,r??e),this._cancelWorkflow({force:!0})}_itemIsSuspended(e){const t=Lt(this.editorItems,e);return t!=null&&(!t.visible||t.disabled)}_logError(e,t,i){z.getLogger(this).error(new v(e,t,i))}_syncSelectionSources(){this.selectionManager.sources.items=this._selectionSources.toArray()}async _onSelectionComplete(e){if(e.aborted)return;const{operationType:t,selection:i}=e,{effectiveSelectionManager:r}=this,o=this.state==="ready",a=i.length===1;if(this._queuedSelectionTool=void 0,o&&a&&t==="replace")return this._queuedSelectionTool=e.toolName,this.startUpdateWorkflowAtFeatureEdit(i[0]);switch(t){case"remove":r.updateSelection({current:[],added:[],removed:i});break;case"replace":r.clear(),r.updateSelection({current:i,added:[],removed:[]});break;case"add":r.updateSelection({current:i,added:[],removed:[]})}}async _startUpdateWorkflowWithLayerItem(e,t){if(!e.objectIds?.length)return;const i=e.featureItems.filter(a=>a.visible).map(a=>a.graphic),r=this.selectionListViewModel.filterText;if(i.length===1)return await this.startUpdateWorkflowAtFeatureEdit(i[0]);let o;if(r!=null&&r!==""){const a=ki(i);if(a.length>1)throw new Yt;if(o=a[0],!o)throw new yr(t==="merge"?2:1)}else o={layer:e.layer,objectIds:e.objectIds};t==="update"?await this.startUpdateFeaturesWorkflow(o):t==="merge"&&await this.startMergeFeaturesWorkflow(o)}};s([n()],I.prototype,"_featureTemplatesLayersAndTables",null),s([n()],I.prototype,"_queuedSelectionTool",void 0),s([n()],I.prototype,"_snappingManager",void 0),s([n()],I.prototype,"_selectionSources",null),s([n()],I.prototype,"activeFeatureCount",null),s([n({readOnly:!0})],I.prototype,"activeWorkflow",void 0),s([n()],I.prototype,"activeLeafWorkflow",null),s([n({readOnly:!0})],I.prototype,"_activityQueue",void 0),s([n({readOnly:!0})],I.prototype,"canCreate",null),s([n()],I.prototype,"canCreateVisible",null),s([n({readOnly:!0})],I.prototype,"canUpdate",null),s([n()],I.prototype,"canUpdateVisible",null),s([n()],I.prototype,"featureTemplatesLayers",null),s([n()],I.prototype,"editorItems",void 0),s([n()],I.prototype,"effectiveSelectionManager",null),s([n({readOnly:!0})],I.prototype,"failures",void 0),s([n()],I.prototype,"hideTemplatesForInactiveLayers",void 0),s([n({type:aa})],I.prototype,"attachmentsViewModel",void 0),s([n()],I.prototype,"featureFormViewModel",null),s([n()],I.prototype,"formViewModel",null),s([n()],I.prototype,"utilityNetworkAssociationAddAssociationViewModel",null),s([n({type:ia})],I.prototype,"featureTemplatesViewModel",void 0),s([n()],I.prototype,"labelOptions",null),s([n()],I.prototype,"layerInfos",void 0),s([n()],I.prototype,"ownSketchViewModel",void 0),s([n()],I.prototype,"selectionListViewModel",void 0),s([n()],I.prototype,"selectionManager",void 0),s([n()],I.prototype,"selectionToolbarViewModel",void 0),s([n()],I.prototype,"sketchOptions",void 0),s([n()],I.prototype,"sketchViewModel",null),s([n({type:oa,nonNullable:!0})],I.prototype,"snappingOptions",void 0),s([n()],I.prototype,"spinnerViewModel",void 0),s([n()],I.prototype,"state",null),s([n({readOnly:!0})],I.prototype,"syncing",null),s([n()],I.prototype,"updating",null),s([n()],I.prototype,"tooltipOptions",null),s([n()],I.prototype,"valueOptions",null),s([n()],I.prototype,"view",null),s([n()],I.prototype,"canZoomTo",null),s([n()],I.prototype,"pageStack",void 0),s([n()],I.prototype,"showDiscardEditsPrompt",void 0),s([n()],I.prototype,"_candidateCommitted",void 0),s([n()],I.prototype,"page",null),s([n()],I.prototype,"featureFormDisabled",null),s([n()],I.prototype,"featureFormHasAssociation",null),s([n()],I.prototype,"canGoBack",null),s([n()],I.prototype,"shouldShowDeleteButton",null),s([n()],I.prototype,"hasPendingEdits",null),s([n()],I.prototype,"snappingManager",null),I=s([M("esri.widgets.Editor.EditorViewModel")],I);const Iu=I;let q=class extends j{constructor(t){super(t),this.batchUpdateActions=!0,this.createFeaturesSection=!0,this.directionModePicker=!1,this.editFeaturesSection=!0,this.flow=!0,this.labelsToggle=!0,this.mergeButton=!0,this.selectionToolbar=!0,this.settingsMenu=!0,this.sketch=!0,this.snappingControls=!0,this.snappingControlsElements=new Tr,this.splitButton=!0,this.tooltipsToggle=!0,this.undoRedoButtons=!0,this.zoomToButton=!0}};s([n({type:Boolean,nonNullable:!0})],q.prototype,"batchUpdateActions",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"createFeaturesSection",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"directionModePicker",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"editFeaturesSection",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"flow",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"labelsToggle",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"mergeButton",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"selectionToolbar",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"settingsMenu",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"sketch",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"snappingControls",void 0),s([n({type:Tr,nonNullable:!0})],q.prototype,"snappingControlsElements",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"splitButton",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"tooltipsToggle",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"undoRedoButtons",void 0),s([n({type:Boolean,nonNullable:!0})],q.prototype,"zoomToButton",void 0),q=s([M("esri.widgets.Editor.VisibleElements")],q);const qa=q,Bt="esri-editor__panel-content",ai={base:Bt,message:`${Bt}__message`,section:`${Bt}__section`,sectionGroup:`${Bt}__section__group`,scrimContainer:`${Bt}__scrim-container`},di=()=>Pe({scrim:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OO),__vite__mapDeps([1,2]))});function Re(e,...t){return f("div",{class:Xt(ai.base,e?.showScrimOverlay?ai.scrimContainer:void 0),key:e?.key??"panel-content"},...t,e?.showScrimOverlay?f("calcite-scrim",null):void 0)}function Ja(e,...t){return f("div",{class:ai.message,"data-testid":"panel-content-message",key:e?.key??"panel-content-message"},...t)}function $e(e,...t){return f("div",{class:Xt(ai.section,e?.class),key:e?.key??"panel-content-section"},...t)}function Au(e,...t){return f("div",{class:ai.sectionGroup,key:e?.key??"panel-content-section-group"},...t)}const Qa={notice:"esri-editor__notice",noticesPanelSection:"esri-editor__notices-panel-section"},Ka=()=>Pe({notice:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.P3),__vite__mapDeps([1,2]))});function Mu({activeFeatureCount:e,workflow:t,messages:i}){const r=[],o="content-start";if(t?.reliesOnOwnerAdminPrivileges){const a=i.ownerAdminNotice;r.push(f(Vt,{key:"owner-admin-notice",message:a,slot:o}))}if(t?.hasInvalidFormTemplate){const a=e>1?i.multiFeature.formFieldUpdateError:i.singleFeature.formFieldUpdateError;r.push(f(Vt,{key:"form-field-error",kind:"warning",message:a,slot:o}))}if(t?.type==="create-features"){const a=i.helpMessages3d;switch(t.data.upload?.result?.type){case"georeferenced-reprojected":r.push(f(Vt,{key:"mesh-reprojected",kind:"warning",message:a.meshReprojected,slot:o}));break;case"georeferenced":r.push(f(Vt,{key:"mesh-georeferenced",kind:"info",message:a.meshGeoreferenced,slot:o}))}}return r.length===0?f(dt,null,void 0):f($e,{class:Qa.noticesPanelSection},r)}function Vt(e){const t=e.kind??"brand";return f("calcite-notice",{class:Qa.notice,icon:Rn[t],key:e.key,kind:t,open:!0,scale:"s"},e.title?f("div",{slot:"title"},e.title):null,f("div",{slot:"message"},e.message))}const Cu=()=>di();function $o({helpMessage:e,noticeMessage:t,renderSketchToolbar:i}){return f(dt,null,i(),f(Re,{key:"creating-features-panel-content"},t?f(Vt,{key:"creating-features-notice",kind:"warning",message:t}):void 0,f(Ja,{key:"content-message"},e)))}const Eu=()=>Promise.all([di(),Pe({action:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OP),__vite__mapDeps([1,2]))})]);function Tu({editorItems:e,filterText:t,id:i,messagesTemplates:r,onFilterTextChange:o,onSelectFeature:a,onZoomTo:l,workflow:c,editorMessages:d}){const u=new Map,p=c.data.candidates;let h=0;p.map(y=>({label:Su(y),id:y.attributes[y.layer.objectIdField],data:y})).filter(({label:y,data:b})=>{const w=t.toLowerCase(),{title:k}=b.layer,F=it(e,b.sourceLayer);return F?F.supportsUpdateWorkflow&&(!w||y?.toLowerCase().includes(w)||k?.toLowerCase().includes(w)):null}).filter(Q).forEach(y=>{h++;const b=y.data.layer;u.has(b)?u.get(b)?.items.push(y):u.set(b,{id:`${b.id}`,label:b.title??"",items:[y]})});const m=e.toArray().map(({layer:y})=>u.get(y)).filter(Q),g=h>10||t.length>0;return f(Re,{key:"feature-list"},f($e,null,Er({enableListScroll:!1,filterEnabled:g,filterText:t,id:i,items:m,messages:{filterPlaceholder:r.filterPlaceholder,noItems:r.noItems,noMatches:r.noMatches},onFilterChange:y=>o(y),onItemMouseEnter:y=>a(y.data),onItemMouseLeave:()=>a(null),onItemSelect:y=>a(y.data,!0),renderItemActionEnd:y=>Lu(y.data,l,d.zoomTo)})))}function Su(e){const t=e.sourceLayer??e.layer;if(!t)return null;const i=t.fieldsIndex.get(t.objectIdField);if(!i)return null;const r=Yo(i,t)||i.name,o=e.attributes,a=Zo(t);return a&&o[a]&&`${o[a]}`||`${r}: ${o[i.name]}`}function Lu(e,t,i){return f("calcite-action",{appearance:"transparent",icon:"zoom-to-object",onclick:()=>t(e),scale:"s",slot:"actions-end",text:i,title:i})}const Oo={base:"esri-editor__actions",notice:"esri-editor__actions--notice"},Gr=()=>Pe({button:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OG),__vite__mapDeps([1,2])),"split-button":()=>_(()=>import("./index-B7G391H4.js"),__vite__mapDeps([94,1,2])),"dropdown-group":()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OV),__vite__mapDeps([1,2])),"dropdown-item":()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OU),__vite__mapDeps([1,2])),icon:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.Os),__vite__mapDeps([1,2]))});function _t({buttons:e,key:t,notice:i}){return f("div",{class:Oo.base,key:t??"footer-actions",slot:"footer"},i?f("div",{class:Oo.notice},i.icon?f("calcite-icon",{icon:i.icon,scale:"s"}):void 0,f("span",null,i.text)):void 0,f("div",null,e.filter(Q).map((r,o)=>r.type==="split-button"?$u(r,o):Vu(r,o))))}const Vu=({disabled:e,onClick:t,label:i,key:r,...o},a)=>f("calcite-button",{disabled:e??!1,key:r??`action-${a}`,onclick:t,width:"full",...o},i),$u=({disabled:e,onClick:t,key:i,dropdownItems:r,...o},a)=>f("calcite-split-button",{disabled:e??!1,key:i??`split-action-${a}`,width:"full",onCalciteSplitButtonPrimaryClick:t,...o},f("calcite-dropdown-group",{selectionMode:"none"},r.filter(Q).map(Ou))),Ou=({disabled:e,onClick:t,label:i,key:r,...o},a)=>f("calcite-dropdown-item",{disabled:e??!1,key:r??`dropdown-item-${a}`,onCalciteDropdownItemSelect:t,...o},i),Wu={settingsContainer:"esri-editor__settings"},Pu=()=>Pe({accordion:()=>_(()=>import("./index-DyJBVOCy.js"),__vite__mapDeps([95,1,2])),"accordion-item":()=>_(()=>import("./index-DqsaUgdy.js"),__vite__mapDeps([96,1,2]))});function Ru({editorViewModel:e,messagesCommon:t,visibleElements:i}){const{snappingOptions:r,sketchOptions:o,view:a,snappingManager:l}=e,c=[],d={directionModePicker:i.directionModePicker,labelsToggle:i.labelsToggle,tooltipsToggle:i.tooltipsToggle};return Object.values(d).includes(!0)&&c.push(f(sl,{sketchOptions:o,viewType:a?.type,visibleElements:new al(d)})),i.snappingControls&&c.push(f(nl,{afterCreate:u=>u.layerListOpen=!1,snappingManager:l,snappingOptions:r,view:a,visibleElements:i.snappingControlsElements??new Tr})),c.length===0?null:f("calcite-accordion",{appearance:"transparent",class:Wu.settingsContainer,key:"settings"},f("calcite-accordion-item",{"data-testid":"settings",heading:t.settings,iconStart:"gear"},c))}const Hu={base:"esri-editor__panel-toolbar"},Du=()=>Pu();function zu({editorViewModel:e,messagesCommon:t,visibleElements:i}){return f("div",{class:Hu.base,key:"panel-toolbar"},f(Ru,{editorViewModel:e,messagesCommon:t,visibleElements:i}))}let vt=class extends si{constructor(){super(...arguments),this.workflow=null,this.headingLevel=4,this._iconIntersectionObserver=new IntersectionObserver((t,i)=>{t.forEach(async r=>{if(r.isIntersecting){const o=r.target;if(Nu(o))return void i.unobserve(o);const a=Uu(o),{graphic:l}=a,c=l.sourceLayer??this.workflow?.layer;if(!c||!l)return;Wo(o,!0);const d=a.id?X(this.messages.previewTemplateAriaLabel,{label:a.id}):this.messagesCommon.preview,u=await Cr(l,c,{ariaLabel:d}).catch(()=>(Wo(o,!1),null));if(u==null)return;o.appendChild(u)}})}),this.messages=null,this.messagesCommon=null,this._renderItemContentEnd=({graphic:t})=>{const{workflow:i}=this;if(i?.isKeyFeature(t)){const r=this.messages.preserved;return f("calcite-chip",{class:ge.mergeFeaturesListItemPreserved,icon:"check",label:r,scale:"s",slot:"content-end"},r)}if(i?.isTemporaryHighlightFeature(t)){const r=this.messages.preserve;return f("calcite-chip",{label:r,scale:"s",slot:"content-end"},r)}},this._renderItemIcon=t=>{if(t?.graphic?.geometry!=null)return f("span",{afterCreate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,afterUpdate:this._afterItemCreateOrUpdate,"data-has-icon":!1,"data-item":t,key:"icon"})},this._afterItemCreateOrUpdate=t=>{this._iconIntersectionObserver?.observe(t)},this._afterItemRemoved=t=>{this._iconIntersectionObserver?.unobserve(t)}}loadDependencies(){return Pe({chip:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.Ot),__vite__mapDeps([1,2])),list:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OZ),__vite__mapDeps([1,2]))})}destroy(){this._iconIntersectionObserver?.disconnect(),this._iconIntersectionObserver=null}render(){const{workflow:t}=this;if(!t)return f(dt,null,void 0);const i=this.messages,r=t.data.features.map((o,a)=>({disabled:!1,id:`${t.getFeatureTitle(o)??a}`,graphic:o,selected:o===t.data.keyFeature}));return f("div",{class:ge.mergeFeaturesList},f(ti,{level:Ot(this.headingLevel)},i.editFeaturesList),f("calcite-list",{label:i.result},Er({enableListScroll:!1,filterEnabled:!1,id:"merge-features-pick-list",items:r,messages:{filterPlaceholder:"",noItems:"",noMatches:""},selectionMode:"single",renderIcon:this._renderItemIcon,renderItemLabel:o=>o.id,onItemMouseEnter:o=>{t&&(t.data.temporaryHighlightFeature=o.graphic)},onItemMouseLeave:()=>{t&&(t.data.temporaryHighlightFeature=null)},onItemSelect:o=>{this.workflow?.setKeyFeature(o.graphic)},renderItemContentEnd:this._renderItemContentEnd})))}};function Uu(e){return e?.["data-item"]}function Nu(e){return!!e?.["data-has-icon"]}function Wo(e,t){e&&(e["data-has-icon"]=t)}s([n()],vt.prototype,"workflow",void 0),s([n()],vt.prototype,"headingLevel",void 0),s([n(),xe("esri/widgets/Editor/t9n/Editor")],vt.prototype,"messages",void 0),s([n(),xe("esri/t9n/common")],vt.prototype,"messagesCommon",void 0),vt=s([M("esri.widgets.Editor.components.MergeFeaturesList")],vt);const Gu=vt;let Ci=class extends j{constructor(e){super(),this._workflow=e.workflow}get allowCancel(){return!this._workflow.data.isSharedTemplateWorkflow}get layer(){return this._workflow.data.editorItem?.layer}get features(){return this._workflow.data.pendingFeatures.toArray()}cancelFeature(e){this._workflow.cancelFeature(e)}clearHighlights(){this._workflow.data.temporaryHighlightFeature=null}highlightFeature(e){this._workflow.data.temporaryHighlightFeature=e}getFeatureTitle(e){return this._workflow.data.getFeatureTitle(e)}isSubmittable(e){return this._workflow.data.isSubmittable(e)}isVisible(e){return this._workflow.data.isDisplayable(e)}onSelectFeature(e){this._workflow.updatePendingFeature(e)}zoomToFeature(e){this._workflow.data.viewModel.zoomTo(e)}};s([n()],Ci.prototype,"_workflow",void 0),Ci=s([M("esri.widgets.Editor.components.workflowAdapters.pendingFeatureList.CreateFeaturesWorkflowPendingFeatureListAdapter.ts")],Ci);const ju=()=>z.getLogger("esri.widgets.Editor.components.workflowAdapters.pendingFeatureList.SplitFeatureWorkflowPendingFeatureListAdapter");let Ei=class extends j{constructor(e){super(),this._workflow=e.workflow}get allowCancel(){return!1}get layer(){return this._workflow.data.editorItem?.layer}get features(){const{existingFeatureEdits:e,newFeatureEdits:t}=this._workflow.data,i=[];return Zt(i,e?.feature,t?.feature),i}cancelFeature(){ju().error(new v("editing:cannot-cancel-feature","Cannot cancel or remove features in a SplitFeatureWorkflow"))}clearHighlights(){this._workflow.data.temporaryHighlightFeature=null}highlightFeature(e){this._workflow.data.temporaryHighlightFeature=e}getFeatureTitle(e){return this._workflow.data.getEditsForFeature(e)?.displayTitle}isSubmittable(e){return this._workflow.data.getEditsForFeature(e)?.submittable??!0}isVisible(){return!0}onSelectFeature(e){this._workflow.setActiveFeature(e)}zoomToFeature(e){this._workflow.data.viewModel.zoomTo(e)}};s([n()],Ei.prototype,"_workflow",void 0),Ei=s([M("esri.widgets.Editor.components.workflowAdapters.pendingFeatureList.SplitFeatureWorkflowPendingFeatureListAdapter")],Ei);let ot=class extends si{constructor(){super(...arguments),this.workflow=null,this.workflowAdapter=null,this.headingLevel=4,this._iconIntersectionObserver=new IntersectionObserver((t,i)=>{t.forEach(async r=>{if(r.isIntersecting){const o=r.target;if(Zu(o))return void i.unobserve(o);const a=Bu(o),{graphic:l}=a,c=l.sourceLayer??this.workflowAdapter?.layer;if(!c||!l)return;Po(o,!0);const d=a.id?X(this.messages.previewTemplateAriaLabel,{label:a.id}):this.messagesCommon.preview,u=await Cr(l,c,{ariaLabel:d}).catch(()=>(Po(o,!1),null));if(u==null)return;o.appendChild(u)}})}),this.messages=null,this.messagesCommon=null,this._renderActionEnd=({graphic:t})=>{const{workflowAdapter:i,messages:r}=this;if(!i)return;const o=t.geometry?f("calcite-action",{appearance:"transparent",icon:"zoom-to-object",onblur:()=>i.clearHighlights(),onclick:()=>i.zoomToFeature(t),onfocus:()=>i.highlightFeature(t),scale:"s",slot:"actions-end",text:this.messages.zoomTo,title:this.messages.zoomTo}):void 0,a=i.allowCancel?f("calcite-action",{appearance:"transparent",icon:"trash",onblur:()=>i.clearHighlights(),onclick:()=>i.cancelFeature(t),onfocus:()=>i.highlightFeature(t),scale:"s",slot:"actions-end",text:r.createFeaturesSelectionList.discard,title:r.createFeaturesSelectionList.discard}):void 0;return f(dt,null,o,a)},this._renderItemContentEnd=({graphic:t})=>{const{workflowAdapter:i}=this;return[i?.isSubmittable(t)?void 0:f("calcite-icon",{class:ge.pendingFeatureListIcon,icon:"exclamation-mark-triangle",scale:"s",slot:"content-end"})]},this._renderItemIcon=t=>{if(t?.graphic?.geometry!=null)return f("span",{afterCreate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,afterUpdate:this._afterItemCreateOrUpdate,"data-has-icon":!1,"data-item":t,key:"icon"})},this._afterItemCreateOrUpdate=t=>{this._iconIntersectionObserver?.observe(t)},this._afterItemRemoved=t=>{this._iconIntersectionObserver?.unobserve(t)}}loadDependencies(){return Pe({action:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OP),__vite__mapDeps([1,2])),icon:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.Os),__vite__mapDeps([1,2])),list:()=>_(()=>import("./index-Bp3GeDhQ.js").then(t=>t.OZ),__vite__mapDeps([1,2]))})}initialize(){this.workflowAdapter=qu(this.workflow)}destroy(){this._iconIntersectionObserver?.disconnect(),this._iconIntersectionObserver=null}render(){const t=this.workflowAdapter;if(!t)return f(dt,null,void 0);const i=this.messages,r=t.features.filter(a=>t.isVisible(a)).map((a,l)=>{const c=t.isSubmittable(a),d=c?i.createFeaturesSelectionList.featureReadyToSubmit:i.createFeaturesSelectionList.featureNotReadyToSubmit;return{disabled:!1,id:`${t.getFeatureTitle(a)??l}`,graphic:a,label:d,submittable:c}}),o=Ut(this.workflow)?i.result:i.createFeaturesSelectionList.heading;return f("div",null,f(ti,{level:Ot(this.headingLevel)},o),f("calcite-list",{label:o},Er({enableListScroll:!1,filterEnabled:!1,filterText:"",id:"update-features-pick-list",items:r,messages:{filterPlaceholder:"",noItems:"",noMatches:""},renderIcon:this._renderItemIcon,renderItemTitle:a=>a.label,renderItemLabel:a=>a.id,onItemMouseEnter:a=>this.workflowAdapter?.highlightFeature(a.graphic),onItemMouseLeave:()=>this.workflowAdapter?.clearHighlights(),onItemSelect:a=>this.workflowAdapter?.onSelectFeature(a.graphic),renderItemContentEnd:this._renderItemContentEnd,renderItemActionEnd:this._renderActionEnd})))}};function Bu(e){return e?.["data-item"]}function Zu(e){return!!e?.["data-has-icon"]}function Po(e,t){e&&(e["data-has-icon"]=t)}function qu(e){return Qt(e)?new Ci({workflow:e}):Ut(e)?new Ei({workflow:e}):null}s([n()],ot.prototype,"workflow",void 0),s([n()],ot.prototype,"workflowAdapter",void 0),s([n()],ot.prototype,"headingLevel",void 0),s([n(),xe("esri/widgets/Editor/t9n/Editor")],ot.prototype,"messages",void 0),s([n(),xe("esri/t9n/common")],ot.prototype,"messagesCommon",void 0),ot=s([M("esri.widgets.Editor.components.PendingFeatureList")],ot);const Ro=ot,Ju=()=>Promise.all([Pe({"action-bar":()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.P6),__vite__mapDeps([1,2])),action:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OP),__vite__mapDeps([1,2]))}),Gr(),Ka(),di()]);function gi(e){const{editorViewModel:t,headingLevel:i,messages:r,renderAttachments:o,renderFeatureForm:a,renderBatchAttributeForm:l,renderSketchToolbar:c}=e,{activeFeatureCount:d,activeLeafWorkflow:u,activeWorkflow:p,formViewModel:h}=t;if(!u||!p||!h)return null;const m=ka(h),g=Qt(u)&&!u.data.selectedPendingFeature||Ut(u)&&!u.activeFeature,y=$r(u),b=u.shouldShowAttachments&&!m&&!h.activeRelationshipInput&&!h.activeAssociationInput,w=m?h.activeForm.inputs:h.inputs,k=Qt(u)&&w.every(ue=>!ue.visible)&&!b,F=t.featureFormViewModel?.activeAssociationInput!=null,A=!g&&!k&&!F,V=k||Qt(u)&&!b&&!A&&!F,P=nt(u)?l:a,R=k?f($e,null,f(Ro,{headingLevel:i,key:"pending-feature-list",workflow:u})):f(dt,null,f(Mu,{activeFeatureCount:d,messages:r,workflow:p}),y?f($e,{class:ge.mergeFeaturesListSection,key:"panel-section-merge"},f(Gu,{headingLevel:i,key:"merge-features-list",workflow:u})):void 0,f($e,{key:"panel-content-section-main"},f(Au,null,g?f(Ro,{headingLevel:i,key:"pending-feature-list",workflow:u}):P(),b?f("div",{key:"attachments"},f(ti,{level:Ot(i)},r.attachments),o()):null)));return f(dt,null,A?Qu(u,e):void 0,V?c?.():void 0,f(Re,{key:"attribute-panel-content"},R),f(_t,{buttons:Ku(e)}))}function Qu(e,t){const i=[],r=t.editorViewModel.view?.type==="3d",{visibleElements:o}=t;if(o.zoomToButton&&t.editorViewModel.canZoomTo&&i.push(f("calcite-action",{alignment:"center",appearance:"transparent",icon:"zoom-to-object",key:"zoom-to-button",onclick:()=>t.editorViewModel.zoomTo(),scale:"s",text:t.messages.zoomTo,title:t.messages.zoomTo})),o.splitButton&&xa(e)&&e.editorItem.supportsSplitFeatureWorkflow&&!r&&t.onSplit){const{onSplit:a,messages:l}=t;i.push(f("calcite-action",{icon:"split-geometry",key:"split-button",onclick:a,scale:"s",text:l.split,title:l.split}))}if(o.mergeButton&&nt(e)&&e.supportsMergeFeaturesWorkflow&&!r&&t.onMerge){const{onMerge:a,messages:l}=t;i.push(f("calcite-action",{icon:"merge",key:"merge-button",onclick:a,scale:"s",text:l.mergeFeatures,title:l.mergeFeatures}))}return i.length>0?f("calcite-action-bar",{class:Xt(ge.sketchContainer,ge.updateActionBar),"data-testid":"update-feature-panel-action-bar",expandDisabled:!0,layout:"horizontal"},i):void 0}function Ku({editorViewModel:e,messages:t,messagesCommon:i,onDelete:r,onDeleteAssociation:o,onSave:a}){const{activeFeatureCount:l,activeLeafWorkflow:c,syncing:d}=e;if(!c)return[];const{page:u}=e;if(u==="viewing-associated-features"||u==="viewing-associated-layers")return[{appearance:"outline",onClick:()=>{const{featureFormViewModel:b}=e;b?.associationId!=null&&(b.associationId=null)},disabled:d,label:i.cancel,type:"button"}];const p=[],h=l>1?t.multiFeature:t.singleFeature,m=!c.allowSave||d,g=X(h[c.saveActionLabel],{count:l});p.push({appearance:"solid",onClick:a,disabled:m,label:g,type:"button"});const y={appearance:"outline",disabled:d,kind:"danger",label:X(h.delete,{count:l}),type:"button"};return e.shouldShowDeleteButton&&!e.featureFormHasAssociation&&r&&p.push({...y,onClick:r}),e.featureFormHasAssociation&&!e.shouldShowDeleteButton&&o&&p.push({...y,onClick:o,label:t.deleteAssociationTitle}),e.featureFormHasAssociation&&e.shouldShowDeleteButton&&o&&r&&p.push({...y,primaryLabel:i.delete,primaryText:i.delete,onClick:r,dropdownItems:[{onClick:o,label:t.deleteAssociationTitle}],type:"split-button"}),p}const we="esri-editor__upload-details",Oe={base:we,status:`${we}__status`,titleWrapper:`${we}__title-wrapper`,title:`${we}__title`,description:`${we}__description`,loader:`${we}__loader`,iconSuccess:`${we}__icon ${we}__icon--success`,iconError:`${we}__icon ${we}__icon--error`,fileList:`${we}__file-list`,file:`${we}__file`,fileIcon:`${we}__file-icon`,fileName:`${we}__file-name`},Yu=()=>Promise.all([Pe({icon:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.Os),__vite__mapDeps([1,2])),loader:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OF),__vite__mapDeps([1,2]))}),Gr(),di()]);function Xu(e){const{messages:t,key:i,upload:r}=e;return f(dt,null,f(Re,{key:i??"upload-details"},f($e,null,ep(e))),r.state==="error"?f(_t,{buttons:[{onClick:()=>r.retry(),label:t.modelUploads.error.uploadNew,iconStart:"upload-to",type:"button"}],key:"upload-details-footer-actions"}):null)}function ep(e){const t=tp(e);return t?f("div",{class:Oe.base,"data-testid":"upload-details",key:"upload-details-content"},f("div",{class:Oe.status,key:"status"},t.iconContent,f("div",{class:Oe.titleWrapper,key:"text"},f("div",{class:Oe.title,key:"title"},t.title),f("div",{class:Oe.description,key:"description"},t.description))),rp(e.upload)):null}function tp({helpMessage:e,messages:t,upload:i}){switch(i.state){case"pending":{const{title:r,description:o}=t.modelUploads.pending;return{title:r,description:o,iconContent:f("calcite-loader",{"aria-hidden":"true",class:Oe.loader,label:"",scale:"s",type:"determinate",value:Math.min(Math.round(100*i.progress),i.progress===1?100:99)})}}case"success":{const{title:r}=t.modelUploads.success;return{title:r,description:e||t.helpMessages3d.mesh,iconContent:f("calcite-icon",{class:Xt(Oe.iconSuccess),icon:"check",scale:"l"})}}case"error":{const{title:r}=t.modelUploads.error;return{title:r,description:ip(i.error,t),iconContent:f("calcite-icon",{class:Xt(Oe.iconError),icon:"exclamation-mark-circle",scale:"l"})}}default:return null}}function ip(e,t){if(!e)return null;const i=t.modelUploads.error.messages;switch(e.constructor){case ml:return i.noModel;case fl:return i.multipleModels;case hl:return i.conversionFailed;case v:switch(e.name){case"glt-loader-error":case"gltf-loader-invalid-glb":return i.loadFailed;case"gltf-loader-unsupported-feature":case"mesh-load-external:draco-not-supported":return i.unsupportedFeature;case"glt-loader-request-error":return i.resourceRequestFailed;default:return i.default}default:return i.default}}function rp(e){return f("div",{class:Oe.fileList,key:"file-list"},e.files.map(t=>f("div",{class:Oe.file,key:`file-${t.name}`},f("calcite-icon",{class:Oe.fileIcon,icon:ap(t),scale:"s"}),f("span",{class:Oe.fileName},op(t.name)))))}function op(e){return e.split("/").pop()?.split("\\").pop()??""}function ap(e){const t=e.name.split(".").pop()?.toLowerCase();return(t?np[t]:null)??sp}const sp="file",Ho="file-shape",yi="file-image",np={glb:Ho,gltf:Ho,jpeg:yi,jpg:yi,png:yi,svg:yi,zip:"file-zip"},lp=500,cp=1e3;function dp({getLoading:e,setEffectiveLoading:t}){let i,r;function o(){clearTimeout(r),r=void 0}function a(c){i=c?Date.now():void 0,t(c)}function l(c,d){if(c<=0)return a(d);r=setTimeout(()=>{o(),a(d)},c)}return a(e()),de([x(e,c=>{o(),c?l(lp,!0):l(i!=null?cp-(Date.now()-i):0,!1)},Pt),L(o)])}let _e=class extends j{constructor(e){super(e),this.filter=!0,this.filterNotice=!0,this.itemCloseActions=!0,this.itemCount=!0,this.itemIcons=!0,this.itemMenus=!0,this.header=!0,this.layerFilter=!0,this.menu=!0,this.totalCount=!0,this.zoomToButton=!0}};s([n({type:Boolean,nonNullable:!0})],_e.prototype,"filter",void 0),s([n({type:Boolean,nonNullable:!0})],_e.prototype,"filterNotice",void 0),s([n({type:Boolean,nonNullable:!0})],_e.prototype,"itemCloseActions",void 0),s([n({type:Boolean,nonNullable:!0})],_e.prototype,"itemCount",void 0),s([n({type:Boolean,nonNullable:!0})],_e.prototype,"itemIcons",void 0),s([n({type:Boolean,nonNullable:!0})],_e.prototype,"itemMenus",void 0),s([n({type:Boolean,nonNullable:!0})],_e.prototype,"header",void 0),s([n({type:Boolean,nonNullable:!0})],_e.prototype,"layerFilter",void 0),s([n({type:Boolean,nonNullable:!0})],_e.prototype,"menu",void 0),s([n({type:Boolean,nonNullable:!0})],_e.prototype,"totalCount",void 0),s([n({type:Boolean,nonNullable:!0})],_e.prototype,"zoomToButton",void 0),_e=s([M("esri.widgets.support.SelectionList.VisibleElements")],_e);const jr=_e,Ye="esri-selection-list",ir=`${Ye}__list-item`,Ae={base:Ye,container:`${Ye}__container`,flowItem:`${Ye}__flow-item`,layerDropdown:`${Ye}__layer-dropdown`,listItemFeature:`${ir}__feature`,listItemFeatureIcon:`${ir}__feature-icon`,listItemIcon:`${ir}__icon`,itemCount:`${Ye}__item-count`,notice:`${Ye}__notice`,panel:`${Ye}__panel`,totalCount:`${Ye}__total-count`};let S=class extends si{constructor(e,t){super(e,t),this._iconIntersectionObserver=new IntersectionObserver((i,r)=>{i.forEach(async o=>{if(o.isIntersecting){const a=o.target;if(this._hasIcon(a))return void r.unobserve(a);const l=this._getListItem(a);if(!l)return;this._setHasIcon(a,!0);const c=l.title?X(this.messagesLegend.previewTemplateAriaLabel,{label:l.title}):this.messagesCommon.preview,d=l.thumbnail??await l.fetchThumbnail({ariaLabel:c}).catch(()=>(this._setHasIcon(a,!1),null));if(d==null)return;a.appendChild(d)}})}),this._itemWithOpenMenu=null,this._list=null,this.displayMode="group",this.highlightOnHoverEnabled=!1,this.itemActionConfigs=null,this.menuScale="m",this.messages=null,this.messagesCommon=null,this.messagesLegend=null,this.onListItemSelect=null,this.scale="s",this.viewModel=new Za,this.visibleElements=new jr,this._afterItemCreate=i=>{this._iconIntersectionObserver?.observe(i)},this._afterItemRemoved=i=>{this._iconIntersectionObserver?.unobserve(i)},this.clear=this.clear.bind(this),this.collapseItems=this.collapseItems.bind(this),this.removeTemporaryHighlight=this.removeTemporaryHighlight.bind(this)}initialize(){this.addHandles([Z(()=>this.effectiveSelectionManager,"selection-change",()=>this._closeItemMenu()),x(()=>this.highlightOnHoverEnabled,e=>{e||this.removeTemporaryHighlight()})])}destroy(){this._iconIntersectionObserver?.disconnect(),this._iconIntersectionObserver=null}loadDependencies(){return Pe({action:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OP),__vite__mapDeps([1,2])),chip:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.Ot),__vite__mapDeps([1,2])),combobox:()=>_(()=>import("./index-Df8y7Bmz.js"),__vite__mapDeps([6,1,2,7,8])),"combobox-item":()=>_(()=>import("./index-Dwxj2UE3.js"),__vite__mapDeps([7,1,2,8])),dropdown:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OT),__vite__mapDeps([1,2])),"dropdown-group":()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OV),__vite__mapDeps([1,2])),"dropdown-item":()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OU),__vite__mapDeps([1,2])),flow:()=>_(()=>import("./index-TKhwHmwK.js"),__vite__mapDeps([97,1,2])),"flow-item":()=>_(()=>import("./index-CnRlY83M.js"),__vite__mapDeps([98,1,2])),icon:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.Os),__vite__mapDeps([1,2])),input:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OY),__vite__mapDeps([1,2])),list:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OZ),__vite__mapDeps([1,2])),"list-item":()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.O$),__vite__mapDeps([1,2])),notice:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.P3),__vite__mapDeps([1,2])),panel:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OS),__vite__mapDeps([1,2]))})}get _hasFilterText(){const{filterText:e}=this;return e!=null&&e!==""}get activeLayerItem(){return this.viewModel.activeLayerItem}get allLayerItems(){return this.viewModel.allLayerItems}get effectiveCount(){return this.viewModel.effectiveCount}get effectiveSelectionManager(){return this.viewModel.effectiveSelectionManager}get filterText(){return this.viewModel.filterText}set filterText(e){this.viewModel.filterText=e}get icon(){return"selection"}set icon(e){this._overrideIfSome("icon",e)}get isUpdating(){return this.viewModel.isUpdating}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get layerItems(){return this.viewModel.layerItems}get layerViewMap(){return this.viewModel.layerViewMap}get maxVisibleFeatureCountExceeded(){return this.viewModel.maxVisibleFeatureCountExceeded}get maxVisibleFeatureCountPerLayer(){return this.viewModel.maxVisibleFeatureCountPerLayer}set maxVisibleFeatureCountPerLayer(e){this.viewModel.maxVisibleFeatureCountPerLayer=e}get selectionManager(){return this.viewModel.selectionManager}set selectionManager(e){this.viewModel.selectionManager=e}get state(){return this.viewModel.state}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get viewLayersAndTables(){return this.viewModel.viewLayersAndTables}get visibleFeatureCount(){return this.viewModel.visibleFeatureCount}get visibleFeatureItems(){return this.viewModel.visibleFeatureItems}get visibleLayerCount(){return this.viewModel.visibleLayerCount}addTemporaryHighlight(e){this.viewModel.addTemporaryHighlight(e)}clear(){this.viewModel.clear()}deselectFeatureItem(e){this.viewModel.deselectFeatureItem(e)}deselectGroupItem(e){this.viewModel.deselectGroupItem(e)}deselectLayerItem(e){this.viewModel.deselectLayerItem(e)}deselectItem(e){this.viewModel.deselectItem(e)}collapseItems(){this._list?.filteredItems.forEach(e=>e.expanded=!1)}goToItem(e){this.viewModel.goToItem(e)}removeFromSelection(e){this.viewModel.removeFromSelection(e)}removeTemporaryHighlight(){this.viewModel.removeTemporaryHighlight()}selectSingleFeatureItem(e){this.viewModel.selectSingleFeatureItem(e)}selectSingleGroupItem(e){this.viewModel.selectSingleGroupItem(e)}selectSingleItem(e){this.viewModel.selectSingleItem(e)}selectSingleLayerItem(e){this.viewModel.selectSingleLayerItem(e)}setSelection(e){this.viewModel.setSelection(e)}render(){return f("div",{class:this.classes(Ae.base,st.widget,st.panel)},f("calcite-flow",null,f("calcite-flow-item",{class:Ae.flowItem,heading:this.visibleElements.header?this.messages.selection:void 0,loading:this.state==="loading",overlayPositioning:"fixed",scale:this.scale,selected:!0},f("calcite-panel",{class:Ae.panel,overlayPositioning:"fixed",scale:this.scale},f("div",{class:Ae.container},this._renderActiveLayerDropdown(),this._renderFilterInput(),this._renderList(),this._renderFilterNotice())),this._renderTotalChip(),this._renderMenuActions())))}_renderTotalChip(){const{visibleElements:e}=this;if(!e.totalCount||!e.header)return;const{effectiveCount:t}=this,i=pi(t),r=X(this.messages.selectionCount,{count:i});return f("calcite-chip",{appearance:"outline",class:Ae.totalCount,closable:t>0,closed:t===0,icon:this.maxVisibleFeatureCountExceeded?"exclamation-mark-triangle":void 0,label:i,scale:this.scale,slot:"header-actions-end",title:r,onCalciteChipClose:this.clear},i)}_renderMenuActions(){const{visibleElements:e}=this;if(!e.header||!e.menu)return;const{menuScale:t}=this,i=this.effectiveCount===0;return[f("calcite-action",{disabled:i,icon:"reset",key:"clear-action",onclick:this.clear,scale:t,slot:"header-menu-actions",text:this.messagesCommon.clear,textEnabled:!0}),f("calcite-action",{disabled:i,icon:"folders",key:"collapse-action",onclick:this.collapseItems,scale:t,slot:"header-menu-actions",text:this.messages.collapseAll,textEnabled:!0})]}_renderActiveLayerDropdown(){const{layerItems:e,messages:t}=this;if(!(this.effectiveCount===0||e.length<2)&&this.visibleElements.layerFilter)return f("calcite-combobox",{class:Ae.layerDropdown,clearDisabled:!0,label:t.filterByLayer,overlayPositioning:"fixed",placeholder:t.filterByLayer,scale:this.scale,selectionMode:"single-persist",onCalciteComboboxChange:({currentTarget:i})=>{this.filterText=void 0;const r=i.selectedItems[0]?.value??void 0;this.layer=r==="all-layers"?void 0:r}},f("calcite-combobox-item",{heading:X(t.allLayersCount,{count:e.length}),icon:"layers",key:"all-layers",selected:this.layer==null,value:"all-layers"}),this.layerItems.map(i=>this._renderActiveLayerDropdownItem(i)))}_renderFilterInput(){if(this.visibleElements.filter&&this.effectiveCount!==0)return f("calcite-input",{clearable:!0,icon:"search",placeholder:this.messages.filter,scale:this.scale,value:this.filterText,onCalciteInputInput:({target:{value:e}})=>{this.filterText=e}})}_renderActiveLayerDropdownItem(e){const t=e.title||this.messages.untitledLayer;return f("calcite-combobox-item",{heading:t,icon:e.iconName,key:e.key,selected:e.layer===this.layer,value:e.layer})}_renderList(){const{messages:e}=this;if(this.visibleFeatureCount!==0)return f("calcite-list",{afterCreate:mn,bind:this,"data-node-ref":"_list",displayMode:"nested",interactionMode:"interactive",label:e.widgetLabel,loading:this.isUpdating,scale:this.scale,selectionMode:"none"},this._renderListContent(this.allLayerItems))}_renderListContent(e){return this.activeLayerItem?this._renderLayerItem(this.activeLayerItem):e.map(t=>lt(t)?this._renderGroupItem(t):He(t)?this._renderLayerItem(t):null).filter(Q)}_renderFilterNotice(){const{visibleElements:e}=this;if(!(this.state==="disabled"||this.visibleFeatureCount>0)&&e.filter&&e.filterNotice)return f("calcite-notice",{class:Ae.notice,icon:"exclamation-mark-triangle",kind:"info",open:!0,scale:this.scale,width:"full"},f("div",{slot:"message"},this.messages.noMatchingFeatures))}_renderItemCount(e){if(!this.visibleElements.itemCount)return;const{messages:t}=this,i=pi(e.total),r=pi(e.visibleTotal),o=X(t.selectionCount,{count:i});return!this._hasFilterText&&e.maxVisibleFeatureCountExceeded?f("span",{class:Ae.itemCount,slot:"content-end",title:o},f("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s",title:t.tooManyFeatures}),`${pi(this.maxVisibleFeatureCountPerLayer)}+`):f("span",{class:Ae.itemCount,slot:"content-end",title:o},r)}_renderItemActions(e){if(!this.visibleElements.itemMenus)return;const{messages:t,messagesCommon:i}=this,r=this._itemWithOpenMenu===e,o=xr(e),a=He(e),l=lt(e),c=o?t.deselectFeature:a?t.deselectLayer:t.deselectGroup;return[f("calcite-dropdown",{"data-testid":"selection-list-dropdown",open:r,overlayPositioning:"fixed",scale:this.menuScale,slot:"actions-end",width:"m",onCalciteDropdownClose:()=>this._closeItemMenu(e),onCalciteDropdownOpen:()=>{this._itemWithOpenMenu=e}},f("calcite-action",{appearance:"transparent","data-testid":"selection-list-dropdown-trigger",icon:"ellipsis",scale:this.scale,slot:"trigger",text:i.menu,textEnabled:!1}),r?f("calcite-dropdown-group",{selectionMode:"none"},this.visibleElements.zoomToButton?f("calcite-dropdown-item",{iconStart:"layer-zoom-to",onCalciteDropdownItemSelect:()=>this.goToItem(e)},t.zoomTo):void 0,f("calcite-dropdown-item",{iconStart:"selection-filter",onCalciteDropdownItemSelect:()=>this.selectSingleItem(e)},o?t.onlySelectFeature:t.onlySelectThis),f("calcite-dropdown-item",{iconStart:"selection-x",onCalciteDropdownItemSelect:()=>this.deselectItem(e)},c),this.itemActionConfigs?.map(d=>{const{disabled:u,hidden:p,type:h}=d;if(!(typeof p=="function"?p({item:e}):p)&&(!h||h==="feature"&&o||h==="layer"&&a||h==="group"&&l))return f("calcite-dropdown-item",{disabled:typeof u=="function"?u({item:e}):!!u,iconStart:d.icon??void 0,onCalciteDropdownItemSelect:()=>d.callback({item:e})},d.label)})):void 0)]}_renderGroupItem(e){const t=e.title||this.messages.untitledLayer;if(e.visibleTotal===0)return;const{displayMode:i}=this;if(i==="layer"||i==="feature")return this._renderListContent(e.items);const{visibleElements:r}=this;return f("calcite-list-item",{bind:this,closable:!!r.itemCloseActions,"data-type":"group",expanded:!0,iconStart:r.itemIcons?e.iconName:void 0,key:e.key,label:t,value:e.title,onCalciteListItemClose:o=>{o.stopPropagation(),this.deselectItem(e)},onCalciteListItemSelect:o=>this._onListItemSelect(e,o)},this._renderItemActions(e),this._renderListContent(e.items))}_renderLayerItem(e){if(e.visibleTotal===0||!e.visible)return;if(this.displayMode==="feature")return this._renderItems(e.featureItems);const{messages:t,visibleElements:i}=this,r=e.title||t.untitledLayer;return f("calcite-list-item",{bind:this,closable:!!i.itemCloseActions,"data-type":"layer",expanded:!0,iconStart:i.itemIcons?e.iconName:void 0,key:e.key,label:r,scale:this.scale,value:e.title,onCalciteListItemClose:o=>{o.stopPropagation(),this.deselectItem(e)},onCalciteListItemSelect:o=>this._onListItemSelect(e,o)},this._renderItemCount(e),this._renderItemActions(e),this._renderItems(e.featureItems),e.maxVisibleFeatureCountExceeded?f("calcite-notice",{class:Ae.notice,icon:"exclamation-mark-triangle",kind:"info",open:!0,scale:this.scale},f("div",{slot:"message"},t.tooManyFeatures)):void 0)}_renderItems(e){return e.map(t=>this._renderItem(t))}_renderItem(e){if(!e.visible)return;const{highlightOnHoverEnabled:t,messages:i,visibleElements:r}=this,o=e.title||i.untitledFeature,a=r.itemIcons&&this.displayMode!=="feature";return f("calcite-list-item",{bind:this,class:a?Ae.listItemFeatureIcon:Ae.listItemFeature,closable:!!r.itemCloseActions,"data-item":e,"data-type":"feature",key:e.key,label:o,name:o,onblur:t?()=>this.removeTemporaryHighlight():void 0,onfocus:t?()=>this.addTemporaryHighlight(e):void 0,onpointerenter:t?()=>this.addTemporaryHighlight(e):void 0,onpointerleave:t?()=>this.removeTemporaryHighlight():void 0,scale:this.scale,value:o,onCalciteListItemClose:l=>{l.stopPropagation(),this.deselectItem(e)},onCalciteListItemSelect:l=>this._onListItemSelect(e,l)},this._renderItemIcon(e),this._renderItemActions(e))}_renderItemIcon(e){if(this.visibleElements.itemIcons)return f("div",{class:Ae.listItemIcon,key:"content-start",slot:"content-start"},f("span",{afterCreate:this._afterItemCreate,afterRemoved:this._afterItemRemoved,"data-has-icon":!1,"data-item":e,key:e.thumbnailKey}))}_getListItem(e){return e?.["data-item"]}_hasIcon(e){return!!e?.["data-has-icon"]}_setHasIcon(e,t){e&&(e["data-has-icon"]=t)}_onListItemSelect(e,t){t.stopPropagation(),this._closeItemMenu(),this.onListItemSelect?.({item:e})}_closeItemMenu(e){e&&e!==this._itemWithOpenMenu||(this._itemWithOpenMenu=null)}};s([n()],S.prototype,"_hasFilterText",null),s([n()],S.prototype,"_itemWithOpenMenu",void 0),s([n()],S.prototype,"_list",void 0),s([n()],S.prototype,"activeLayerItem",null),s([n()],S.prototype,"allLayerItems",null),s([n()],S.prototype,"displayMode",void 0),s([n()],S.prototype,"effectiveCount",null),s([n()],S.prototype,"effectiveSelectionManager",null),s([n()],S.prototype,"filterText",null),s([n()],S.prototype,"highlightOnHoverEnabled",void 0),s([n()],S.prototype,"icon",null),s([n()],S.prototype,"itemActionConfigs",void 0),s([n()],S.prototype,"isUpdating",null),s([n()],S.prototype,"label",null),s([n()],S.prototype,"layer",null),s([n()],S.prototype,"layerItems",null),s([n()],S.prototype,"layerViewMap",null),s([n()],S.prototype,"maxVisibleFeatureCountExceeded",null),s([n()],S.prototype,"maxVisibleFeatureCountPerLayer",null),s([n()],S.prototype,"menuScale",void 0),s([n(),xe("esri/widgets/support/SelectionList/t9n/SelectionList")],S.prototype,"messages",void 0),s([n(),xe("esri/t9n/common")],S.prototype,"messagesCommon",void 0),s([n(),xe("esri/widgets/Legend/t9n/Legend")],S.prototype,"messagesLegend",void 0),s([n()],S.prototype,"onListItemSelect",void 0),s([n()],S.prototype,"scale",void 0),s([n()],S.prototype,"selectionManager",null),s([n()],S.prototype,"state",null),s([n()],S.prototype,"view",null),s([n()],S.prototype,"viewLayersAndTables",null),s([n()],S.prototype,"viewModel",void 0),s([n({type:jr,nonNullable:!0})],S.prototype,"visibleElements",void 0),s([n()],S.prototype,"visibleFeatureCount",null),s([n()],S.prototype,"visibleFeatureItems",null),s([n()],S.prototype,"visibleLayerCount",null),S=s([M("esri.widgets.support.SelectionList")],S);const up=S,Do=Symbol("sketch-setup-handles");let C=class extends si{constructor(e,t){super(e,t),this._batchAttributeForm=new gc({visibleElements:new Xe({loadingIndicator:!1})}),this._featureForm=new Wn,this._sketchToolbar=null,this._attachments=new Fn({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}}),this._associationItemList=null,this._associationSettings=null,this._featureTemplates=new Nn({enableListScroll:!1,renderItemContentEnd:i=>i.supportsUpload?f("calcite-icon",{class:ge.templateItemContentEnd,icon:"upload-to",key:"upload-icon"}):null,renderItemLabel:i=>i.label,renderCustomGroupContent:i=>this._renderCustomTemplateGroupContent(i)}),this._filterText="",this._prompt=null,this._spinner=new Bn,this._loading=!1,this._selectionList=new up({displayMode:"layer",itemActionConfigs:this._selectionListItemActionConfigs,onListItemSelect:({item:i})=>this._onSelectionListItemSelect(i),visibleElements:new jr({header:!1})}),this._selectionToolbar=new ll({visibleElements:new cl({chip:!1})}),this._updatingHandles=new Dt,this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.messagesTemplates=null,this.messagesFeature=null,this.supportingWidgetDefaults=null,this.viewModel=new Iu,this.visibleElements=new qa,this._renderAttachments=()=>this._attachments.render(),this._renderFeatureForm=()=>this._featureForm.render(),this._renderBatchAttributeForm=()=>this._batchAttributeForm.render(),this._renderFeatureTemplates=()=>this._featureTemplates.render(),this._renderSelectionList=()=>this._selectionList.render(),this._renderSelectionToolbar=()=>this._selectionToolbar.render(),this._renderSketch=()=>this._sketchToolbar?f("div",{class:ge.sketchContainer,key:"editor-sketch-container"},this._sketchToolbar?.render()):void 0,this._renderSelectIcon=()=>f("calcite-icon",{icon:"cursor",slot:"content-start"}),this.EditorPanel=({heading:i,key:r,selected:o},...a)=>{const{visibleElements:l}=this;return f("calcite-flow-item",{closable:!1,heading:i,headingLevel:this.headingLevel,key:r,loading:this._loading,selected:o,onCalciteFlowItemBack:this._onBack},l.settingsMenu?f(zu,{editorViewModel:this.viewModel,messagesCommon:this.messagesCommon,visibleElements:l}):null,...a)},this._showDiscardEditsPrompt=()=>{const{messages:i,activeWorkflow:r}=this,o={title:i.cancelEditTitle,message:i.cancelEditWarningMessage,yesLabel:i.discardEdits,noLabel:i.continueEditing};return r?.type==="create-features"&&Qe(r.data.creationInfo)?this._showPromptAndWait(r.data.upload?.state==="success"?i.modelUploads.cancelPlacementPrompt:i.modelUploads.cancelUploadPrompt):r?.type==="update"&&Ke(r.formViewModel)&&r.formViewModel.activeAssociation?this._showPromptAndWait({...o,message:i.cancelAssociationEditWarning}):this._showPromptAndWait(o)},this._showGenericCancelPrompt=()=>{const{messages:i,messagesCommon:r}=this;return this._showPromptAndWait({title:i.cancelRequestTitle,message:i.cancelRequestWarningMessage,yesLabel:r.form.yes,noLabel:r.form.no})},this._showPrompt=i=>{this._prompt?.cancel?.(),this._prompt=i},this._clearPrompt=()=>{this._prompt=null},this._onSave=()=>{this.viewModel.saveWorkflow()},this._onMerge=()=>{const{activeWorkflow:i}=this.viewModel;if(oi(i)){const r=i.activeWorkflow;nt(r)&&i.startMergingFeatures(r.viewGraphics,{initialFeatures:r.data.initialFeatures})}},this._onSplit=()=>{const{activeWorkflow:i}=this.viewModel;if(oi(i)){const r=i.activeWorkflow;if(xa(r)){const o=r.viewGraphic;o&&i.startSplittingFeature(o,{initialFeature:r.data.edits.initialFeature??o})}}},this._onDelete=()=>{const i=this.viewModel.activeFeatureCount,r=i>1?this.messages.multiFeature:this.messages.singleFeature;this._showPrompt({title:r.deleteWarningTitle,message:r.deleteWarningMessage,context:"danger",actions:{primary:{label:X(r.delete,{count:i}),action:()=>{this.deleteFeatures(),this._clearPrompt()}},secondary:{label:r.keep,action:this._clearPrompt}}})},this._onDeleteAssociation=()=>{const{messages:i,messagesCommon:r}=this;this._showPrompt({title:i.deleteAssociationTitle,message:i.deleteAssociationMessage,context:"danger",actions:{primary:{label:r.delete,action:()=>{this.deleteAssociationFromWorkflow(),this._clearPrompt()}},secondary:{label:i.keepAssociation,action:this._clearPrompt}}})},this._onToggleUpdateWorkflow=()=>this.viewModel.toggleUpdateWorkflow(),this._onBack=i=>(i?.stopPropagation(),this.viewModel.back()),this._onAttachmentAdd=()=>{const{activeWorkflow:i}=this.viewModel;i&&(i.type==="create-features"||i.type==="update"&&i.activeWorkflow?.type==="create-features"?(this._attachments.addFile(),i.back()):this._attachments.addAttachment().then(()=>i.back()))},this._onAttachmentUpdate=()=>{const{activeWorkflow:i}=this.viewModel;i&&(i.type==="create-features"?(this._attachments.updateFile(),i.back()):this._attachments.updateAttachment().then(()=>i.back()))},this._onAttachmentDelete=()=>{const{messages:i,messagesCommon:r}=this;this._showPrompt({title:i.deleteAttachmentWarningTitle,message:i.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:r.delete,action:this._onAttachmentDeleteConfirm},secondary:{label:i.keepAttachment,action:this._clearPrompt}}})},this._onAttachmentDeleteConfirm=async()=>{const i=this._attachments,{activeWorkflow:r}=this.viewModel;r&&(r.type==="create-features"?i.deleteFile():(await i.deleteAttachment(i.viewModel.activeAttachmentInfo),this._clearPrompt()),await r.back(),this._clearPrompt())},this._onAttachmentsError=i=>{this._showPrompt({title:this.messages.errorWarningTitle,message:i.message,context:"warning",actions:{primary:{label:this.messagesCommon.form.ok,action:this._clearPrompt}}})}}initialize(){this._featureForm.showPrompt=this._showPrompt,this._featureForm.clearPrompt=this._clearPrompt,this.addHandles([x(()=>Ot(this.headingLevel),e=>{this._featureForm.headingLevel=e,this._featureTemplates.headingLevel=e},re),Z(()=>this.viewModel.activeWorkflow,"cancel-request",({controller:e})=>{(this.viewModel.hasPendingEdits?this._showDiscardEditsPrompt():this._showGenericCancelPrompt()).then(t=>t?e.allow():e.deny())}),Ve(()=>this.viewModel.formViewModel,e=>{ka(e)?this._batchAttributeForm.viewModel=e:this._featureForm.viewModel=e},re),Ve(()=>this.viewModel.utilityNetworkAssociationAddAssociationViewModel,e=>{this._associationItemList?this._associationItemList.viewModel=e:this._updatingHandles.addPromise(this._initializeAssociationItemList(e))},re),Ve(()=>this.viewModel.utilityNetworkAssociationAddAssociationViewModel?.association,()=>{this._setUpAssociationSettings()}),x(()=>[this.viewModel,this.viewModel?.attachmentsViewModel,this.viewModel?.featureTemplatesViewModel,this.viewModel?.spinnerViewModel,this.viewModel?.selectionListViewModel,this.viewModel?.selectionToolbarViewModel],([e,t,i,r,o,a])=>{this._attachments.viewModel=t,this._featureTemplates.viewModel=i,this._spinner.viewModel=r,this._selectionList.viewModel=o,this._selectionToolbar.viewModel=a,e.showDiscardEditsPrompt=this._showDiscardEditsPrompt},re),x(()=>this.view,(e,t)=>{const i=`editor-${this.id}-spinner`;t?.ui.remove(this._spinner,i),e?.ui.add(this._spinner,{key:i,position:"manual"}),this._associationItemList&&(this._associationItemList.view=e)},re),x(()=>[this.supportingWidgetDefaults,this.viewModel.sketchViewModel],([e])=>{e&&(this._featureForm.set(e.featureForm),this._attachments.set(e.attachments),this._featureTemplates.set(e.featureTemplates),this.viewModel.sketchViewModel?.set(e.sketch))},re),Ve(()=>this._attachments?.error,e=>this._onAttachmentsError(e)),Ve(()=>this._selectionListItemActionConfigs,()=>{this._selectionList.itemActionConfigs=this._selectionListItemActionConfigs}),Ve(()=>this.viewModel?.failures,e=>{const{messages:t}=this,[{error:i,retry:r,cancel:o}]=e;this._showPrompt({title:t.errorWarningTitle,message:X(t.errorWarningMessageTemplate,{errorMessage:i.message}),context:"warning",actions:{primary:{label:t.retry,action:()=>{r(),this._clearPrompt()}},secondary:{label:t.ignore,action:()=>{o(),this._clearPrompt()}}}})}),x(()=>this.viewModel?.state,e=>{switch(e){case"awaiting-feature-to-update":case"ready":case"disabled":this._filterText="",this._featureTemplates.filterText=""}}),x(()=>this.viewModel.featureFormDisabled,e=>this._featureForm.disabled=e),x(()=>this.visibleElements.sketch,()=>this._setupSketch(),re),x(()=>this.visibleElements.zoomToButton,e=>this._selectionList.visibleElements.zoomToButton=e,re),dp({getLoading:()=>{const{viewModel:e}=this;return e.syncing||e.updating||this._attachments.submitting||this._updatingHandles.updating},setEffectiveLoading:e=>{this._loading=e}})])}destroy(){this._associationItemList?.destroy(),this._associationSettings?.destroy(),this._selectionList.destroy(),this._selectionToolbar.destroy(),this._attachments.destroy(),this._batchAttributeForm.destroy(),this._featureForm.destroy(),this._featureTemplates.destroy(),this._spinner.destroy(),this._sketchToolbar=ct(this._sketchToolbar),this._sketchImportAbortController=De(this._sketchImportAbortController)}loadDependencies(){return Promise.all([Pe({flow:()=>_(()=>import("./index-TKhwHmwK.js"),__vite__mapDeps([97,1,2])),"flow-item":()=>_(()=>import("./index-CnRlY83M.js"),__vite__mapDeps([98,1,2])),icon:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.Os),__vite__mapDeps([1,2])),list:()=>_(()=>import("./index-Bp3GeDhQ.js").then(e=>e.OZ),__vite__mapDeps([1,2]))}),Cu(),Eu(),Gr(),Ka(),di(),Du(),Hn(),Ju(),Yu()])}get _hasInvalidBatchSelection(){return this._hasSelectionFromMultipleLayers||this._selectionCountExceedsMaximum||this._selectionList.visibleFeatureCount===0}get _hasSelectionFromMultipleLayers(){return this._selectionList.visibleLayerCount>1}get _deleteButtonCommonInfo(){return{appearance:"outline",kind:"danger"}}get _selectionCountExceedsMaximum(){const e=this._batchAttributeForm.maximumFeatureCount,{activeLayerItem:t,effectiveCount:i,filterText:r,visibleFeatureCount:o}=this._selectionList;return r!=null&&r!==""?o>e:t?t.total>e:i>e}get _selectionListItemActionConfigs(){const{messages:e,visibleElements:t}=this,i=t?.mergeButton??!0;return[{label:e?.batchEditing?.editThisFeature,icon:"edit-attributes",type:"feature",callback:({item:r})=>this._onSelectionListMenuItemSelect(r,"update")},{label:e?.batchEditing.editTheseFeatures,icon:"edit-attributes",type:"layer",callback:({item:r})=>this._onSelectionListMenuItemSelect(r,"update")},{label:e?.batchEditing.mergeTheseFeatures,icon:"merge",type:"layer",hidden:!i||(({item:r})=>He(r)?!it(this.viewModel.editorItems,r.layer)?.supportsMergeFeaturesWorkflow||r.visibleTotal<2:!0),callback:({item:r})=>this._onSelectionListMenuItemSelect(r,"merge")}]}get _visibleSelectionCount(){const{activeLayerItem:e,effectiveCount:t,filterText:i,visibleFeatureCount:r}=this._selectionList;return i!=null&&i!==""?r:e?e.total:t}get activeWorkflow(){return this.viewModel.activeWorkflow}get effectiveSelectionManager(){return this.viewModel.effectiveSelectionManager}get hideTemplatesForInactiveLayers(){return this.viewModel.hideTemplatesForInactiveLayers}set hideTemplatesForInactiveLayers(e){this.viewModel.hideTemplatesForInactiveLayers=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()}startCreateFeaturesWorkflowAtFeatureCreation(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(e)}startCreateFeaturesWorkflowAtFeatureEdit(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureEdit(e)}startMergeFeaturesWorkflow(e,t={}){return this.viewModel.startMergeFeaturesWorkflow(e,t)}startSplitFeatureWorkflow(e,t={}){return this.viewModel.startSplitFeatureWorkflow(e,t)}async startUpdateFeaturesWorkflow(e){return this.viewModel.startUpdateFeaturesWorkflow(e)}startUpdateWorkflowAtFeatureSelection(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()}startUpdateWorkflowAtMultipleFeatureSelection(e){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(e)}startUpdateWorkflowAtFeatureEdit(e){return this.viewModel.startUpdateWorkflowAtFeatureEdit(e)}startUpdateWorkflowWithActiveSelection(){return this.viewModel.startUpdateWorkflowWithActiveSelection()}deleteFeatureFromWorkflow(){return Jo(z.getLogger(this),"Editor.deleteFeatureFromWorkflow is deprecated. Use Editor.deleteFeatures instead.",{version:"4.33",replacement:"Editor.deleteFeatures",warnOnce:!0}),this.deleteFeatures()}async deleteFeatures(){await this.viewModel.deleteFeatures()}deleteAssociationFromWorkflow(){return this.viewModel.deleteAssociationFromWorkflow()}cancelWorkflow(e){return this.viewModel.cancelWorkflow(e)}render(){const{visibleElements:e,viewModel:t}=this,i=this.classes(ge.base,st.widget,st.panel);if(!t)return f("div",{class:i,key:"empty"});const{pageStack:r}=t,o=r.length-1,a=r.map((l,c)=>this._renderPage(l,c===o));return f("div",{class:i,key:"base"},e.flow?f("calcite-flow",{inert:!!this._prompt,key:"flow"},a):a,this._prompt?f(Dn,{...this._prompt,headingLevel:this.headingLevel}):void 0)}_renderPage(e,t){const i={selected:t};switch(e){case"disabled":break;case"ready":return this._renderReady(i);case"viewing-selection-list":return this._renderSelectionListPage(i);case"awaiting-feature-creation-info":return this._renderAwaitingFeatureCreationInfo(i);case"creating-features-upload-details":return this._renderUploadDetails(i);case"creating-features":return this._renderCreatingFeatures(i);case"editing-existing-feature":case"editing-features":case"editing-attributes":case"choosing-key-feature":return this._renderUpdateFeature(i);case"awaiting-update-feature-candidate":return this._renderFeatureList(i);case"adding-attachment":return this._renderAttachmentAdding(i);case"editing-attachment":return this._renderAttachmentEditing(i);case"viewing-associated-layers":case"viewing-associated-features":return this._renderViewAssociatedLayers(i);case"add-association-select-layer":case"add-association-select-feature":return this._renderSelectFeature(i);case"add-association-create-association":return this._renderAddAssociation(i);case"drawing-splitter-geometry":return this._renderDrawingSplitGeometry(i);case"reviewing-features":return this._renderReviewingSplitFeatures(i)}return f("div",{key:"empty-page"})}_renderAwaitingFeatureCreationInfo(e){const{EditorPanel:t,messages:i}=this;return f(t,{heading:i.selectTemplate,key:"templates-panel",...e},f(Re,{key:"feature-templates"},f($e,null,this._renderFeatureTemplates())))}_renderUploadDetails(e){const{EditorPanel:t,activeWorkflow:i,messages:r}=this;if(i?.type!=="create-features")return null;const o=i.data.upload;return o?f(t,{heading:r.createFeatures,key:"upload-details-panel",...e},f(Xu,{helpMessage:this._helpMessage,messages:r,upload:o})):null}_renderCreatingFeatures(e){const{EditorPanel:t,activeWorkflow:i,messages:r,messagesCommon:o,headingLevel:a,viewModel:l}=this;if(!i)return null;const c=i.type==="create-features"&&i.numPendingFeatures>0||i.type==="update"&&i?.activeWorkflow?.type==="create-features"&&i.activeWorkflow?.numPendingFeatures>0;return f(t,{heading:r.createFeatures,key:"create-features-panel",...e},c?f(gi,{editorViewModel:l,headingLevel:a,messages:r,messagesCommon:o,renderAttachments:this._renderAttachments,renderBatchAttributeForm:this._renderBatchAttributeForm,renderFeatureForm:this._renderFeatureForm,renderSketchToolbar:this._renderSketch,visibleElements:this.visibleElements,onDelete:this._onDelete,onDeleteAssociation:this._onDeleteAssociation,onSave:this._onSave}):f($o,{helpMessage:this._helpMessage,renderSketchToolbar:this._renderSketch}))}_renderUpdateFeature(e){const{EditorPanel:t,messages:i,messagesCommon:r,headingLevel:o,viewModel:a}=this,l=a.activeFeatureCount>1?i.multiFeature.editPanelTitle:i.singleFeature.editPanelTitle;return f(t,{heading:l,key:"update-feature-panel",...e},f(gi,{editorViewModel:a,headingLevel:o,messages:i,messagesCommon:r,renderAttachments:this._renderAttachments,renderBatchAttributeForm:this._renderBatchAttributeForm,renderFeatureForm:this._renderFeatureForm,visibleElements:this.visibleElements,onDelete:this._onDelete,onDeleteAssociation:this._onDeleteAssociation,onMerge:this._onMerge,onSave:this._onSave,onSplit:this._onSplit}))}_renderDrawingSplitGeometry(e){const{EditorPanel:t}=this;return f(t,{heading:this.messages.splitFeature,key:"draw-split-geometry-panel",...e},f($o,{helpMessage:this._helpMessage,noticeMessage:this._noticeMessage,renderSketchToolbar:this._renderSketch}))}_renderReviewingSplitFeatures(e){const{EditorPanel:t,messages:i,messagesCommon:r,headingLevel:o,viewModel:a}=this;return f(t,{heading:i.splitFeature,key:"review-split-features-panel",...e},f(gi,{editorViewModel:a,headingLevel:o,messages:i,messagesCommon:r,renderAttachments:this._renderAttachments,renderBatchAttributeForm:this._renderBatchAttributeForm,renderFeatureForm:this._renderFeatureForm,visibleElements:this.visibleElements,onSave:this._onSave}))}_getAssociationTypeTitle(e){const{messages:t}=this;if(!e)return t.singleFeature.editPanelTitle;if(e.title)return e.title;const{messagesFeature:i}=this;switch(e.type){case"attachment":return i.associationsAttachments;case"connectivity":return i.associationsConnectivity;case"structure":return i.associationsStructure;case"content":return i.associationsContents;case"container":return i.associationsContainer}}_getAddAssociationTypeTitle(e){const{messages:t}=this;if(!e)return t.singleFeature.editPanelTitle;const i=t.associations;switch(e.type){case"attachment":return i.addAttachment;case"connectivity":return i.addConnectivity;case"structure":return i.addStructure;case"content":return i.addContent;case"container":return i.addContainer}}async _initializeAssociationItemList(e){const t=(await _(async()=>{const{default:i}=await import("./UtilityNetworkAssociationItemList-DaA8Cj3y.js");return{default:i}},__vite__mapDeps([99,1,2,91,35,92,93,43,29,38,39,67,30,31,68,49,50,51,52,55,63]))).default;this._associationItemList=new t({view:this.view,viewModel:e})}async _initializeAssociationSettings(){const e=new(await _(async()=>{const{default:t}=await import("./UtilityNetworkAssociationSettings-BFyyQfkm.js");return{default:t}},__vite__mapDeps([100,1,2,101]))).default;return this._associationSettings=e,e}_renderViewAssociatedLayers(e){const{EditorPanel:t,messages:i,messagesCommon:r,headingLevel:o,viewModel:a}=this,l=a.featureFormViewModel?.activeAssociationInput?.activeAssociationType,c=this._getAssociationTypeTitle(l);return f(t,{heading:c,key:"viewing-associated-layers-panel",...e},f(gi,{editorViewModel:a,headingLevel:o,messages:i,messagesCommon:r,renderAttachments:this._renderAttachments,renderBatchAttributeForm:this._renderBatchAttributeForm,renderFeatureForm:this._renderFeatureForm,renderSketchToolbar:this._renderSketch,visibleElements:this.visibleElements,onDelete:this._onDelete,onDeleteAssociation:this._onDeleteAssociation,onSave:this._onSave}))}_renderSelectFeature(e){const{_associationItemList:t,EditorPanel:i,viewModel:r,messagesCommon:o}=this,a=r.utilityNetworkAssociationAddAssociationViewModel,l=this._getAddAssociationTypeTitle(a?.associationType),c=a?.state!=="ready"||this.viewModel.featureFormDisabled;return t?f(i,{heading:l,key:"add-association-select-feature",...e},f(Re,{key:"select-feature"},f($e,null,t.render())),f(_t,{buttons:[t.filterOptionsVisible?{appearance:"solid",label:o.apply,disabled:c,onClick:()=>t.applyFilterOptions(),type:"button"}:void 0,{appearance:"outline",label:o.cancel,disabled:c,onClick:()=>{r.activeWorkflow?.type==="update"&&(a?.reset(),r.activeWorkflow.cancelActiveWorkflow())},type:"button"}]})):f(i,{heading:l,key:"add-association-select-feature",...e})}async _setUpAssociationSettings(){const{viewModel:e}=this,t=this._associationSettings??await this._updatingHandles.addPromise(this._initializeAssociationSettings()),i=e.utilityNetworkAssociationAddAssociationViewModel,r=e.activeWorkflow?.type==="update"?e.activeWorkflow:null,o=r?r.activeWorkflow:null,a=o?.type==="add-association"?o.sourceFeatureItem:null,l=i?.selectedFeature,c=i?.association,d=i?.utilityNetwork;a&&l&&c&&d&&(t.sourceFeature=a,t.targetFeature=l,t.association=c,t.utilityNetwork=d)}_renderAddAssociation(e){const{_associationSettings:t,EditorPanel:i,viewModel:r,messagesCommon:o}=this;if(!t)return null;const a=r.utilityNetworkAssociationAddAssociationViewModel,l=this._getAddAssociationTypeTitle(a?.associationType),c=a?.state!=="ready";return f(i,{heading:l,key:"add-association",...e},f(Re,{key:"add-association-content"},f($e,null,t.render())),f(_t,{buttons:[{label:o.add,disabled:c||!a.canAddAssociation,onClick:()=>this._onSave(),type:"button"},{appearance:"outline",label:o.cancel,disabled:c,onClick:()=>{r.activeWorkflow?.type==="update"&&r.activeWorkflow.cancelActiveWorkflow()},type:"button"}]}))}_renderCustomTemplateGroupContent(e){const{messages:t,viewModel:i}=this,r=gn(e.group.items,o=>i.itemHasInvalidFormTemplate(o)?t.formFieldCreateError:void 0);return r?f(Vt,{kind:"warning",message:r}):null}_renderAttachmentAdding(e){const{EditorPanel:t,_attachments:i,messages:r,messagesCommon:o}=this;return f(t,{heading:r.addAttachment,key:"attachment-adding-panel",...e},f(Re,{key:"attachments"},this._renderAttachments()),f(_t,{buttons:[{label:i.submitting?o.cancel:o.add,disabled:i.submitting||!i.selectedFile,onClick:this._onAttachmentAdd,type:"button"}]}))}_renderSelectionListPage(e){const{_hasSelectionFromMultipleLayers:t,_hasInvalidBatchSelection:i,_selectionCountExceedsMaximum:r,_selectionList:o,_visibleSelectionCount:a,messages:l,EditorPanel:c}=this,{batchUpdateActions:d}=this.visibleElements,{maxVisibleFeatureCountPerLayer:u}=o;return f(c,{heading:l.widgetLabel,key:"selection-list-panel",...e},this.visibleElements.selectionToolbar&&this.view?.type!=="3d"?f("div",{class:ge.selectionToolbarContainer},this._renderSelectionToolbar()):void 0,f(Re,{key:"selection-list"},f($e,null,this._renderSelectionList())),f(_t,{buttons:[d?{label:X(l.batchEditing.editCount,{count:a}),disabled:i,onClick:()=>this.startUpdateWorkflowWithActiveSelection(),type:"button"}:void 0],notice:d&&t?{text:l.batchEditing.selectOneLayer,icon:"information"}:d&&r?{text:X(this.messages.multiFeature.formFailedToLoadTooManyFeatures,{num:u}),icon:"information"}:void 0}))}_renderAttachmentEditing(e){const{EditorPanel:t,_attachments:i,activeWorkflow:r,messages:o,messagesCommon:a}=this;return r?f(t,{heading:o.editAttachment,key:"attachment-editing-panel",...e},f(Re,{key:"attachments"},this._renderAttachments()),r.shouldAllowAttachmentEditing?f(_t,{buttons:[{label:a.update,disabled:i.submitting||!i.selectedFile,onClick:this._onAttachmentUpdate,type:"button"},{...this._deleteButtonCommonInfo,onClick:this._onAttachmentDelete,disabled:i.submitting,label:a.delete,type:"button"}]}):void 0):null}_renderReady(e){const{EditorPanel:t,messages:i,viewModel:r,visibleElements:o}=this,a=this._helpMessage;return f(t,{heading:i.widgetLabel,key:"landing-panel",...e},f(Re,{key:"landing-content"},r.editorItems.length?[o.editFeaturesSection?f($e,{key:"edit-actions"},this._renderUpdateActions()):null,o.createFeaturesSection&&r.canCreateVisible?f($e,{key:"create-actions"},this._renderCreateActions()):null]:f(Ja,{key:"no-content"},i.noEditableLayers)),a?f("div",{class:ge.helpMessage,key:"footer-actions",slot:"footer"},a):void 0)}get _helpMessage(){return this.getHelpMessageString(this.activeWorkflow?.helpMessage)}get _noticeMessage(){return this.getHelpMessageString(this.activeWorkflow?.noticeMessage)}_renderUpdateActions(){const{messages:e,messagesCommon:t,viewModel:i}=this,r={id:"select",label:t.select};return f("div",{class:ge.updateActions,key:"update-actions"},f(ti,{level:Ot(this.headingLevel)},e.editFeatures),this.visibleElements.selectionToolbar&&this.view?.type!=="3d"?f("div",{class:ge.selectionToolbarContainer},this._renderSelectionToolbar()):f("calcite-list",{class:ge.updateActionsList,label:e.editFeaturesList,selectionAppearance:"border",selectionMode:"single"},Gn({disabled:!i.canUpdateVisible,grouped:!1,item:r,selectedItem:i.activeWorkflow?.stepId==="awaiting-feature-to-update"?r:void 0,renderIcon:this._renderSelectIcon,onItemSelect:this._onToggleUpdateWorkflow})))}_renderCreateActions(){return f("div",{key:"create-actions"},f(ti,{level:Ot(this.headingLevel)},this.messages.createFeatures),f("div",{class:ge.featureTemplatesContainer,key:"templates"},this._renderFeatureTemplates()))}_renderFeatureList(e){const{EditorPanel:t,viewModel:i}=this,{activeWorkflow:r}=i;if(r?.type!=="update")return null;const o=r.data.candidates,a=X(this.messages.multipleFeaturesTemplate,{total:o.length});return f(t,{heading:a,key:"feature-list",...e},f(Tu,{editorItems:i.editorItems,editorMessages:this.messages,filterText:this._filterText,id:this.id,messagesTemplates:this.messagesTemplates,workflow:r,onFilterTextChange:l=>this._filterText=l,onSelectFeature:(l,c)=>i.selectFeature(l,c),onZoomTo:l=>i.zoomTo(l)}))}_showPromptAndWait({title:e,message:t,yesLabel:i,noLabel:r}){const o=Rt(),{view:a}=this,l=a?.focused;return this._showPrompt({title:e,message:t,context:"danger",actions:{primary:{label:i,action:()=>o.resolve(!0)},secondary:{label:r,action:()=>o.resolve(!1)}}}),o.promise.finally(()=>{this._clearPrompt(),l&&a?.focus()})}async _onSelectionListItemSelect(e){await this.viewModel.onSelectionListItemSelect(e)}async _onSelectionListMenuItemSelect(e,t){await this.viewModel.onSelectionListMenuItemSelect(e,t)}async _setupSketch(){if(!this.visibleElements.sketch)return this._sketchImportAbortController=De(this._sketchImportAbortController),this._sketchToolbar=ct(this._sketchToolbar),void this.removeHandles(Do);if(this._sketchImportAbortController)return;const e=new AbortController;this._sketchImportAbortController=e;const t=await _(()=>import("./Sketch-Co3rAk_s.js"),__vite__mapDeps([102,1,2,30,31,58,47,59,55,48,49,50,51,52,60,61,62,63,67,68]));if(!e.signal.aborted)try{this._sketchToolbar=new t.default({toolbarKind:"docked",contextualToolLocation:"inline-end",scale:"s",visibleElements:new dl({deleteButton:!1,settingsMenu:!1,directionModePicker:!1,selectionCountLabel:!1,duplicateButton:!1,createTools:new pl({freehandPolygon:!0,freehandPolyline:!0}),selectionTools:new ul({"lasso-selection":!1,"rectangle-selection":!1})})}),this.addHandles([x(()=>{const i=this.viewModel.activeLeafWorkflow;return i&&"availableCreateTools"in i?i.availableCreateTools:null},i=>{this._sketchToolbar&&(this._sketchToolbar.availableCreateTools=i)},re),x(()=>this.visibleElements.undoRedoButtons,i=>{this._sketchToolbar&&(this._sketchToolbar.visibleElements.undoRedoMenu=i)},re),Ve(()=>this.viewModel?.sketchViewModel,i=>{this._sketchToolbar&&(this._sketchToolbar.viewModel=i)},re)],Do)}finally{this._sketchImportAbortController=null}}getHelpMessageString(e){const{messages:t,view:i}=this;return e?t[i?.type==="3d"?"helpMessages3d":"helpMessages2d"]?.[e]:void 0}get test(){return{sketch:this._sketchToolbar,showPrompt:this._showPromptAndWait.bind(this)}}};s([n()],C.prototype,"_batchAttributeForm",void 0),s([n()],C.prototype,"_featureForm",void 0),s([n()],C.prototype,"_sketchToolbar",void 0),s([n()],C.prototype,"_attachments",void 0),s([n()],C.prototype,"_associationItemList",void 0),s([n()],C.prototype,"_associationSettings",void 0),s([n()],C.prototype,"_featureTemplates",void 0),s([n()],C.prototype,"_filterText",void 0),s([n()],C.prototype,"_hasInvalidBatchSelection",null),s([n()],C.prototype,"_hasSelectionFromMultipleLayers",null),s([n()],C.prototype,"_prompt",void 0),s([n()],C.prototype,"_spinner",void 0),s([n()],C.prototype,"_deleteButtonCommonInfo",null),s([n()],C.prototype,"_loading",void 0),s([n()],C.prototype,"_selectionCountExceedsMaximum",null),s([n()],C.prototype,"_selectionList",void 0),s([n()],C.prototype,"_selectionListItemActionConfigs",null),s([n()],C.prototype,"_selectionToolbar",void 0),s([n()],C.prototype,"_visibleSelectionCount",null),s([n({readOnly:!0})],C.prototype,"activeWorkflow",null),s([n()],C.prototype,"effectiveSelectionManager",null),s([n()],C.prototype,"headingLevel",void 0),s([n()],C.prototype,"hideTemplatesForInactiveLayers",null),s([n()],C.prototype,"icon",null),s([n()],C.prototype,"label",null),s([n()],C.prototype,"labelOptions",null),s([n()],C.prototype,"layerInfos",null),s([n(),xe("esri/widgets/Editor/t9n/Editor")],C.prototype,"messages",void 0),s([n(),xe("esri/t9n/common")],C.prototype,"messagesCommon",void 0),s([n(),xe("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],C.prototype,"messagesTemplates",void 0),s([n(),xe("esri/widgets/Feature/t9n/Feature")],C.prototype,"messagesFeature",void 0),s([n()],C.prototype,"snappingOptions",null),s([n()],C.prototype,"tooltipOptions",null),s([n()],C.prototype,"supportingWidgetDefaults",void 0),s([n({type:xn,nonNullable:!0})],C.prototype,"valueOptions",null),s([n()],C.prototype,"view",null),s([n(),zo(["sketch-create","sketch-delete","sketch-update","workflow-cancel","workflow-commit"])],C.prototype,"viewModel",void 0),s([n({type:qa,nonNullable:!0})],C.prototype,"visibleElements",void 0),s([n()],C.prototype,"_helpMessage",null),s([n()],C.prototype,"_noticeMessage",null),C=s([M("esri.widgets.Editor")],C);const pp=C;const hp=bn`.esri-attachments__progress-bar:before,.esri-attachments__progress-bar:after{opacity:var(--calcite-opacity-100);content:"";height:1px;transition:opacity .5s ease-in-out;position:absolute;top:0}.esri-attachments__progress-bar:before{z-index:0;background-color:var(--calcite-color-foreground-2);width:100%}.esri-attachments__progress-bar:after{z-index:0;background-color:var(--calcite-color-text-2);width:20%;animation:1.5s linear infinite looping-progresss-bar-ani}.esri-attachments{background-color:var(--calcite-color-background)!important;width:100%}.esri-attachments__loader-container{justify-content:center;align-items:center;height:150px;padding:0;display:flex}.esri-attachments__loader{background:url(data:image/gif;base64,R0lGODlhIQAnALMKAAB6wrze86TR7Y3F53W44V6s2kaf1C+TzheGyNPq+f///wAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1MkRGQzEzOEQ3MUIxMUU0QjJCRTkxRjI3NjA5MTc2MyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2RDdDRTgwM0Q3MjAxMUU0QjJCRTkxRjI3NjA5MTc2MyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2RDdDRTgwMkQ3MjAxMUU0QjJCRTkxRjI3NjA5MTc2MyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNCAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmQyYThhNjgzLWIwNjctNDhhZi05Nzc0LTZiOTZkM2RhMjI2OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1MkRGQzEzOEQ3MUIxMUU0QjJCRTkxRjI3NjA5MTc2MyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAkEAAoALAAAAAAhACcAAASOUMlJq70W6L2xv1z4jVPIkaTZoZ+qsa0Ley4wY7WU7Dyv9z1JTgEMEos7oeyI/DUVQ2SSWVSqnFUq0GrCbrXGqNQbXkoTZB/UPAarxc8zV+SeytfXOlo/P/H/cFl3gV+DbHFthEaGeXeMXX+PdI6Jh4KVjW2SfpRPQzcVn6AlS6OkeaZ9K6l4kKyirLEXEQAh+QQJBAAKACwAAAAAIQAnAAAEqFDJSau9OOutkP8fx4GkuJGgqaGhirGe+8JSYN+3CCM1jkuJoFAo2fV8NuBwWKQpkDnFktlxQpPSabDJOiKVWi7K6wNPxaXn1bxEp9RQNtUI/2bD1W69fD/nx3s/fW1/aVcBckSFb4eJW4stjYNzVmuTinSSWo+ZlpsJbpGem6ExgVGfpTynWKmQppqkr6uxeJ1xl5yVuCdOMhV0vxTBwqrFw77HysvFEQAh+QQFBAAKACwAAAAAIQAnAAAEqFDJSau9OOvNez5gGHqaaJKfOaKXugpwHHcuKMk4Xd/4rCTAYFBSO/B6AolwSdwpkDDlcqgoHnvSaaLpuuZ+2m3VCU2CtVyVV5adpk9PaJs57saRc+FbtPaFxVZ3WGdudWqCX397L3KEdIFleVSQjYqGcJGOepd8iGyak2SVYYs2nn6knIx4oEClRqdRrYCirJaUtqm4gxu7X71OLBWBwhTExcjJysseEQAh+QQJBAAKACwBAAMAFAAhAAAEU9DIOZW9WNGd+6Zd9lXKYJ7nKFloqxpsm6qxPLy1jJf2TfO2Xc83yrl+Q2FPGUQunc0iUAelSpPV4/W5jX6MKKb1O9WSsd0xpxzOtqUhyy6u+dEjACH5BAkEAAoALAAAAAAhACcAAASAUMlJq7046827/10hjiOIkahErCwboqXSzi9cqLPL2SKeEzWYLxdMyX7AHW9IU9qYrSIJqtvwbsefNIZMWpdZolMYbn6f5ejY2N320lXNlbpyY9vrKbye5yLtdF5yYHhnZIWDaIgZc3uCjIR/fW+LJ5Fak3eShkYmnp+goaKjHREAIfkECQQACgAsAAAAACEAJwAABKhQyUmrvTjrzbv/IFaMJNkRaJpKZXuqKtuaHBwrM73ZK54XkoRwOJTwULJckEg0HpOzJVPo5EFdimlRcSRcS9Jp1falaancp0+ZPY9h5VGY+b79gG1tvXefN9NWa1F5YoBkglhnCXtIiGCEdIZwjmZuknY/fltdcXiKjF6UcpB/nKKelqZ9pJtqq5+XfJmsaKqzsLZsuK6zO7xsvoGrIRXDxMfIycrLxBEAIfkEBQQACgAsAAAAACEAJwAABKdQyUmrvTjrzbu3RiiKXzaeJXaO3eC+r7SSHGzLs9HasZLrioRwOJTwej8JcWk8DnAz5bKocD59Oek00TxCV9ppl/dFBbfcqrPMOm/HN2zULVZ75WA6007Gm9FpVmw0gHAwgyFhe4J+bYV8cUl6RIZIWZNUjJKPmpeca42EaJUuiECfd5ujkIehiZhCpFeqb6yWc6h9khudcykVu78TwcKuQMXIycrKEQAh+QQJBAAKACwBAAMAFAAhAAAEVVDJSdW5GNed+65dJowkKYVYqZ7ooZYs+ppWO49xeAt5t/eiGzAlrMmKLRfStjzOhpefUdekPqe+avaalHa1QS5T7HxBlWSrGRtef9OezyQpn7fq5wgAIfkECQQACgAsAAAAACEAJwAABIBQyUmrvTjrzZH/H9eBoLiRpZmhoYqxnhjMNC3BiFzXN6zvsx7rBxSiiDsjCclT4Jg2p48DjD6p1YAytclqpUNsddvqZskxcRF8VCfZS3fzah7DuRovOie3TutrdHlnd2WDdoIZeoVpgG+JGIuQF5J/LhWTl5kumyqdJp+XoqMiEQAh+QQJBAAKACwAAAAAIQAnAAAEjlDJSau9OIPNef5VJ4KkInYleHqptgKtu8bYC5NJruuSLe3AH5BnegmHieOwZ1Qgc8pgceZ8RndM6jNZRWZPV+L2O+ouzVIfGrsmqsdt6BQc58Lf1joZpe/jvX5NcHeCeYRahnl/Z4d0g4qFgI1lj4CLUpN8lWeXbCpNNCGgoRNqpKWjp6anc2WsrXyvrBEAIfkECQQACgAsAAAAACEAJwAABKlQyUmrvTjrzZH/H9eBoLiRpZmhoYqxnvvCUmDft5TsPC/BiBoOp+v1fjTFkKgwHhVA4TJQdCaQLOmy6sSitEOu0UsCM607cmpqEz+jSrbbB02yqU20unWfp+tZcVN+V4Bfglt5VnsxiGGKXYZljmd6kmtykGOXfJlohXB9mm92npahpoucjaKfjEGUOaN0qIOzf7WJJ6W2u4EyFXDAFMLDr8bEScjLzBoRACH5BAUEAAoALAAAAAAhACcAAASqUMlJq7046827t0coil82niV2jum1koogz3P3hhKtS0nv+5LbIaerKX7I4I1YFPCQQIWQWXxCE8oXdXe8YqXLWNPZvWZXW5oVekaJm+skWPuultlzdJ3r/U73andyf2NkfW0sgEaHeW6FcT+IMI+CkY2JlIyEY5BRm3CVnmGZXpI4ijKdPaZDqIall5Ocoauxp6Rmtq2UG592vaOzwHQtFH/FE8fIy8zNzBEAIfkECQQACgAsDAADABQAIQAABFPQyDmVvVjRnfumXfZVymCe5yhZaKsabJuqsTy8tYyX9k3ztl3PN8q5fkNhTxlELp3NIlAHpUqT1eP1uY1+jCim9TvVkrHdMacczralIcsurvnRIwAh+QQJBAAKACwAAAAAIQAnAAAEgFDJSau9OOvNu/8gVowkGV5lKhFs23ZpubouHI8zzdp3rvMxHw2oUuhenBvOeCQQZczj0xT9JZXC2rVXHW6DXe1GWcgix9jwWUM2777FphMOlU+Xdjo1j+by2Wl/GW1qb31ggiKBTXdlhXOHcYx6eJORdZaAfpmDaSefoKGio58RACH5BAkEAAoALAAAAAAhACcAAASoUMlJq7046827/2AoFWRZdkSqqqNpouvauiQcpzMtJXzfSzeWgnZS+I7AICHn2h1/CuVySCw4n4lkkPkyYrNRJbf4BUvHNS9We0Nb1U92zH2Nh7dUYh15b+d1cHxnf02BPnIyhF1liEJVb4x9c4pkX404lGmRg497h5KJnYZQnFWepGKZkJagjqajPJdTopuptKylehy5gBu8hb62ryIUosTHyMnKyxIRACH5BAUEAAoALAAAAAAhACcAAASpUMlJq7046827/5IhjiOIkah5oWQ3vDAcsqIbxzMtJXzfSzecglZT+I7A4CvH2h1/CuVySHQ+E0klM2W8YqPSbat7zQbFJfLTfEMXvV/pwG2wrsFaqk6NxJ/1TXw+bEJEdYJQcnR2fYqAXHCEMo9jkX5tlGmWjoaMg5eFVYg8klOdo3FhmW9epXOrh5uqp7J5tK2gk6cbnKK8s74qE7vCi8XDwcfKy8wWEQAh+QQJBAAKACwMAAMAFAAhAAAEVVDJSdW5GNed+65dJowkKYVYqZ7ooZYs+ppWO49xeAt5t/eiGzAlrMmKLRfStjzOhpefUdekPqe+avaalHa1QS5T7HxBlWSrGRtef9OezyQpn7fq5wgAIfkECQQACgAsAAAAACEAJwAABIBQyUmrvTjrzTf6INh5YThqpXliqbhe7dcFdF1LMTLbNh7vPJqvBQwOU0XesZTsKXLN2/PHCUqhVWtgqdpot1Ni1sp1ebVl2dgYRq6VbebbiT2T413NN62bX6l2bHV6aHhmhHeDGXuGaoFwihiMkReTgC8UlC+aK5wnniOgmKOjEQAh+QQJBAAKACwAAAAAIQAnAAAEjlDJSau9OGsFuvdbyH2fuJGlmaGgirGd+8LyBQNSou97zvOSm++nGxKDNAWxp1wmkCzjTwocRZtLKlOIPXanVpS2+K1ync/yNokep89ON1SsJrfDJHn9zY7v53l/gnBZg32Fd4ReiYeLfopgjFd3knSUj42RmJN+lYE1FFygE6KjeCmmpy2ppaOtoK+pFhEAIfkECQQACgAsAAAAACEAJwAABI1QyUmrvTjrzTf6INh5YThqpXliqbhe7ffCsZTcOG7nuRQjO94tKPTVFEIdMpkwtog8aE/xkyqZTeoRax1qn8tkN1sNF83Rb2rMVpfaXLcqHi/Tmc41elrf4vdKdn99YHdici6GZ4KHhHqKaYxnjm+AXpRzg3+SaZguMxRloBOio4gypnmVqaWjramwLxEAIfkEBQQACgAsAAAAACEAJwAABIpQyUmrvTjrzbv/0iGOI4iRqHmhpGqxpUvBopTcOG7neUjvvBsw6IMNeceegnZI6hTBJ9MphEYTRRYVa41mU11iGLn8jZVX7vT8TH9b7Kq7bIxz5+s53qy/vmN9XnRadlt/NYWJeX6KfIx7dYFii4KQhJJklGKWYJhKazKHTaGipKWmoKGppqytrBEAIfkECQQACgAsFwADAAkAIQAABBLQyEmrvTjrzbv/YCiOZGmeZQQAIfkECQQACgAsAAAAACEAJwAABFBQyUmrvTjrzbv/YCgVZFmKlqmilWqylHvCo1zQtYwr9o33O+DPFiQOdUdXEUkTNo1PJsw5hValLGrWusWitF9u2CsCl8Vncsi8Ru/e8PguAgAh+QQJBAAKACwAAAAAIQAnAAAEhlDJSau9OOvNu/9gKIZEaZpjda4ptZ5SIs9zTNPSiyo3zveynI5gAxZ7Qt3xtvQNiT9jFKl4NmtTZnV4DWad3C8W6LWKveRE8tVVn93mdHvNes+3Srs+Tr7zpXJ4bHqBf1SFYYGIeYp9gnWNUoZai4ORVJM+lXUtjzCdnjudZqClpqeoqRsRACH5BAUEAAoALAAAAAAhACcAAASFUMlJq7046827/2AojuQ2nChaTmkrJXAcv7IstSldw/p+46deTWhTAIOK3SypTPyAxGXTaTxGeUzlE3elTreurE88rELJxa+Zi5Y2wbk2Vn0cdO/rsJpulXvfeXF7gHV4fGeDWoEqfniFjZCPiWOSgIdsk2WVipdhK4+ffSujpKWmp6grEQAh+QQJBAAKACwXAAYACQAbAAAEEFDISau9OOvNu/9gKI5kyUUAIfkECQQACgAsAAAAACEAJwAABElQyUmrvTjrzbv/YCiOZGkqQaqqJ7qu7QufMkvXQYzrNS/7L+DMhMvdesdfMrgclopCG3HXlD6pU2RWuWV2nSRoa0wum8/o9CYCACH5BAUEAAoALAAAAAAhACcAAARsUMlJq7046827/2AojmRpckmqqtLqti6rxDKdwjQe6+9s8ytg7efLFXfHni0hvCWDz6Fx2WRGndSrNcsldqfeMHiM/JbFZ7ISvVZDze20PE5/s+1u6Ry/19f9fH9Yd4CFTieIiYqLjI2OjyQRACH5BAUEAAoALAAAAAABAAEAAAQCUEUAIfkEBQQACgAsAAAAAAEAAQAABAJQRQA7) 50% no-repeat;width:100%;height:64px}.esri-attachments__actions{flex-flow:wrap;padding:6px 7px;display:flex}.esri-attachments__item-add-icon{font-size:var(--calcite-font-size-xl);margin:0;padding:0 7px}.esri-attachments__delete-button{color:var(--calcite-color-status-danger);width:auto;margin-right:auto}.esri-attachments .esri-attachments__items{width:100%;margin:0;padding:0;display:flex}.esri-attachments .esri-attachments__item{margin:0;line-height:var(--calcite-font-line-height-relative-tight);list-style-type:none}.esri-attachments__item-button{outline-offset:-4px;cursor:pointer;width:100%;text-align:unset;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-2);border:1px solid var(--calcite-color-foreground-1);border-radius:var(--calcite-border-width-md);align-items:center;margin:0 0 var(--calcite-spacing-xs);padding:var(--calcite-spacing-xs) 7px;text-decoration:none;transition:border-color .125s ease-in-out;display:flex;box-shadow:0 1px var(--calcite-color-foreground-1)}.esri-attachments__item-button:focus,.esri-attachments__item-button:hover{border-color:var(--calcite-color-border-white)}.esri-attachments__item-link{text-decoration:none;display:block;position:relative}.esri-attachments__item-link:hover .esri-attachments__item-link-overlay,.esri-attachments__item-link:focus .esri-attachments__item-link-overlay{opacity:1}.esri-attachments__item-add{background-color:var(--calcite-color-background);padding:6px 0}.esri-attachments__add-attachment-button{align-items:baseline!important;border-radius:var(--calcite-corner-radius-xs);border:none!important;justify-content:flex-start!important;padding:12px 3px!important;font-size:var(--calcite-font-size-sm)!important;transition:background-color .25s ease-in-out}.esri-attachments__add-attachment-button:hover{background-color:var(--calcite-color-foreground-1)!important;text-decoration:none;box-shadow:0 1px 2px #0000004d}.esri-attachments__item-link-overlay{opacity:0;pointer-events:none;-webkit-user-select:none;user-select:none;justify-content:center;align-items:center;transition:opacity .25s ease-in-out;display:flex;position:absolute;inset:0}.esri-attachments__item-link-overlay-icon{color:var(--calcite-color-foreground-2);background-color:var(--calcite-color-foreground-1);border-radius:100%;justify-content:center;align-items:center;padding:18px;display:flex}.esri-attachments__item-link-overlay-icon svg{fill:var(--calcite-color-foreground-1)}.esri-attachments__item-mask{justify-content:center;align-items:center;width:64px;height:64px;display:flex;position:relative;overflow:hidden;box-shadow:0 0 0 1px var(--calcite-color-foreground-1)}.esri-attachments__item-mask--icon{background-color:var(--calcite-color-foreground-2);padding:24px 0}.esri-attachments__item-mask--icon .esri-attachments__image{width:var(--calcite-spacing-xxxl);height:var(--calcite-spacing-xxxl)}.esri-attachments__metadata{justify-content:space-between;margin-top:3px;display:flex}.esri-attachments__metadata .esri-attachments__metadata-fieldset{text-align:center;background-color:var(--calcite-color-foreground-1);border:none;flex:0 calc(50% - 1px);margin:0;padding:6px 7px;font-size:var(--calcite-font-size-sm)}.esri-attachments__file-name{white-space:pre-wrap;word-break:break-word;word-wrap:break-word;margin-bottom:3px;font-size:var(--calcite-font-size-sm);display:inline-block}.esri-attachments__file-fieldset{border:none;margin:0;padding:var(--calcite-spacing-md) 7px}.esri-attachments__file-input{opacity:0;z-index:-1;width:.1px;height:.1px;position:absolute;overflow:hidden}.esri-attachments__container--list .esri-attachments__items{flex-flow:column}.esri-attachments__container--list .esri-attachments__item-mask{flex:none;margin-right:7px;position:relative}.esri-attachments__container--list .esri-attachments__image{max-width:unset;max-height:unset;left:50%}.esri-attachments__container--list .esri-attachments__label{flex:auto;justify-content:space-between;display:flex}.esri-attachments__container--list .esri-attachments__filename{white-space:pre-wrap;word-break:break-word;word-wrap:break-word;cursor:pointer;flex:1 0 0}.esri-attachments__container--list .esri-attachments__item-chevron-icon{cursor:pointer;flex:none;padding:0 15px}.esri-attachments__container--preview .esri-attachments__items{flex-flow:wrap;align-items:center}.esri-attachments__container--preview .esri-attachments__item{width:100%;margin-bottom:var(--calcite-spacing-md)}.esri-attachments__container--preview .esri-attachments__item-mask{width:100%;height:auto}.esri-attachments__container--preview .esri-attachments__item-button{box-shadow:none;flex-flow:column}.esri-attachments__container--preview .esri-attachments__item-button .esri-attachments__label{margin:var(--calcite-spacing-md) 0}.esri-attachments__container--preview .esri-attachments__image{max-width:100%}.esri-attachments__container--preview .esri-attachments__filename{white-space:pre-wrap;word-break:break-word;word-wrap:break-word;text-align:center;text-overflow:ellipsis;width:calc(100% - 15px);margin-top:var(--calcite-spacing-md);overflow:hidden}.esri-attachments__container--preview .esri-attachments__item-mask--icon{background-color:var(--calcite-color-foreground-1)}.esri-attachments__form-node{background-color:var(--calcite-color-foreground-1);padding:6px 7px;box-shadow:var(--calcite-shadow-sm)}.esri-attachments__form-node .esri-attachments__item-mask{box-shadow:none;width:unset;height:unset}.esri-attachments__form-node .esri-attachments__image{max-width:100%}.esri-attachments__error-message{background-color:var(--calcite-color-foreground-1);border-top:3px solid var(--calcite-color-status-danger);margin:6px 7px;padding:var(--calcite-spacing-md) 15px;animation:.25s ease-in-out esri-fade-in-down;box-shadow:0 1px 2px #0000004d}.esri-attachments__progress-bar{width:100%;position:absolute}.esri-attachments__item-mask:dir(rtl){margin-left:7px;margin-right:0}.esri-widget__heading{color:var(--calcite-color-text-2);margin:0 0 .5rem;font-weight:var(--calcite-font-weight-semibold)}h1.esri-widget__heading{font-size:var(--calcite-font-size-xl)}h2.esri-widget__heading{font-size:var(--calcite-font-size-md)}h3.esri-widget__heading,h4.esri-widget__heading,h5.esri-widget__heading,h6.esri-widget__heading{font-size:var(--calcite-font-size)}.esri-widget{--esri-widget-padding-x: 15px;--esri-widget-padding-y: var(--calcite-spacing-md);--esri-widget-padding: var(--esri-widget-padding-y) var(--esri-widget-padding-x);box-sizing:border-box;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);font-size:var(--calcite-font-size);line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget *,.esri-widget :before,.esri-widget :after{box-sizing:inherit}.esri-widget.esri-widget--disabled>*{opacity:.4;pointer-events:none}.esri-widget.esri-widget--compact{--esri-widget-padding-y: 0;--esri-widget-padding-x: 0}.esri-widget__anchor{color:var(--calcite-color-text-2)}.esri-widget__anchor:hover{color:var(--calcite-color-text-3)}.esri-widget__anchor:hover,.esri-widget__anchor:focus{text-decoration:underline}.esri-widget__anchor--disabled{opacity:.4;pointer-events:none}.esri-widget__header{background-color:var(--calcite-color-foreground-1);flex:1 0 100%;justify-content:space-between;align-items:center;width:100%;min-height:48px;padding:12px 0 12px 15px;display:flex}.esri-widget__header .esri-widget__heading{width:calc(100% - 48px);text-align:initial;color:var(--calcite-color-text-1);align-items:center;margin:0;padding:0;display:flex}.esri-widget__header-button{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);border:none;flex:0 0 48px;justify-content:center;align-self:stretch;align-items:center;width:48px;padding:0;display:flex}.esri-widget__footer{background-color:var(--calcite-color-foreground-1);justify-content:center;align-items:center;width:100%;min-height:48px;display:flex}.esri-widget__footer-pagination{color:var(--calcite-color-text-2);justify-content:space-between;align-items:center;display:flex}.esri-widget__footer-pagination-previous-button,.esri-widget__footer-pagination-next-button{cursor:pointer;background-color:var(--calcite-color-foreground-1);border:0;margin:0 7px;padding:12px 15px;transition:background-color .125s ease-in-out}.esri-widget__footer-pagination-previous-button:hover,.esri-widget__footer-pagination-previous-button:focus,.esri-widget__footer-pagination-next-button:hover,.esri-widget__footer-pagination-next-button:focus{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1)}.esri-menu{visibility:hidden;z-index:1;background-clip:padding;background-color:var(--calcite-color-foreground-1);background-clip:padding-box;width:100%;max-height:0;margin:2px 0 0;padding:0;font-size:var(--calcite-font-size);line-height:var(--calcite-spacing-xl);position:absolute;top:100%;left:0;overflow:hidden;box-shadow:0 1px 2px #0000004d}.esri-menu .esri-menu__header{color:var(--calcite-color-text-inverse);background-color:var(--calcite-color-inverse);padding:6px 12px}.esri-menu__list{margin:0;padding:0;list-style:none}.esri-menu__list-item{cursor:pointer;border-top:1px solid #adadad4d;border-left:3px solid #0000;padding:.8em 1em}.esri-menu__list-item [class^=esri-icon-],.esri-menu__list-item [class*=" esri-icon-"]{padding-right:2.8px}.esri-menu__list-item:first-child{border-top:none}.esri-menu__list-item--focus,.esri-menu__list-item:hover,.esri-menu__list-item:focus{background-color:var(--calcite-color-foreground-1)}.esri-menu__list-item:active{background-color:var(--calcite-color-foreground-current)}.esri-menu__list-item--active,.esri-menu__list-item--active:hover,.esri-menu__list-item--active:focus{background-color:var(--calcite-color-foreground-1);border-left-color:var(--calcite-color-brand)}.esri-widget__table{border-collapse:collapse;color:var(--calcite-color-text-1);border:none;width:100%;line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget__table tr:nth-child(odd){background-color:var(--calcite-color-transparent)}.esri-widget__table tr:nth-child(2n){background-color:var(--calcite-color-transparent-press)}.esri-widget__table tr a{color:var(--calcite-color-text-2)}.esri-widget__table tr a:hover,.esri-widget__table tr a:focus{color:var(--calcite-color-text-1)}.esri-widget__table tr td,.esri-widget__table tr th{vertical-align:top;word-break:break-word;padding:.5em .7em;font-size:var(--calcite-font-size-sm);font-weight:var(--calcite-font-weight-regular)}.esri-widget__table tr th{text-align:left;border-right:3px solid #0000000d;width:50%}.esri-widget__table tr td{width:50%}.esri-input{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1);border:1px solid #959595;font-size:var(--calcite-font-size)}.esri-input::-ms-clear{display:none}.esri-input::placeholder{opacity:1;color:var(--calcite-color-text-2)}.esri-input:placeholder-shown{text-overflow:ellipsis}.esri-input[type=text],.esri-input[type=password],.esri-input[type=number]{height:32px;padding:0 .5em}calcite-combobox.esri-input{border:none}.esri-widget__content--empty{text-align:center;color:var(--calcite-color-border-input);flex-flow:column wrap;align-items:center;padding:18px 22px;display:flex}.esri-widget__content--empty h1.esri-widget__heading,.esri-widget__content--empty h2.esri-widget__heading,.esri-widget__content--empty h3.esri-widget__heading,.esri-widget__content--empty h4.esri-widget__heading,.esri-widget__content--empty h5.esri-widget__heading{font-weight:var(--calcite-font-weight-regular)}.esri-widget__content-illustration--empty{width:128px;padding:1rem 0}.esri-widget__content-icon--empty{width:32px;padding:.5rem 0}.esri-select{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background:var(--calcite-color-foreground-1) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='-8 -8 32 32' width='32' height='32'%3E%3Cpath d='M8 11.207l-4-4V5.793l4 4 4-4v1.414z' fill='%23adadad' fillrule='nonzero'/%3E%3C/svg%3E") 100% no-repeat;border:1px solid #959595;border-radius:0;width:100%;height:32px;margin:0;padding:0 .5em;font-family:inherit;font-size:.85em;display:block}.esri-select[disabled]{cursor:auto}.esri-select::-ms-expand{display:none}.esri-disabled a,.esri-disabled [role=menu],.esri-disabled [role=checkbox],.esri-disabled [class^=esri-icon-],.esri-disabled [class*=" esri-icon-"]{color:var(--calcite-color-text-3)}.keynav-mode .esri-widget:focus,.keynav-mode .esri-widget :focus{z-index:1;outline-offset:2px;outline:2px solid #adadad}.esri-widget__loader-animation{border:.15em solid #adadad4d;border-top-color:var(--calcite-color-border-input);border-radius:100%;width:1em;height:1em;font-size:var(--calcite-font-size-md);animation:1.25s linear infinite esri-rotate;display:block;transform:translateZ(0)}:dir(rtl) .esri-widget__table th{text-align:right;border-left:3px solid #0000000d;border-right:none}:dir(rtl) .esri-select{background-position:0}:dir(rtl) .esri-menu__list-item{border-left:none;border-right:3px solid #0000}:dir(rtl) .esri-menu__list-item [class^=esri-icon-],:dir(rtl) .esri-menu__list-item [class*=" esri-icon-"]{padding-left:2px;padding-right:0}:dir(rtl) .esri-menu__list-item--active{border-right-color:var(--calcite-color-brand)}.esri-icon-font-fallback-text{clip:rect(0 0 0 0);width:1px;height:1px;position:absolute;overflow:hidden}.esri-rotating{animation:1.25s linear infinite esri-rotate;transform:translateZ(0)}.esri-clearfix:before,.esri-clearfix:after{content:" ";display:table}.esri-clearfix:after{clear:both}.esri-interactive{cursor:pointer}.esri-hidden{display:none!important}.esri-invisible{visibility:hidden!important}.esri-offscreen{position:absolute;top:-999em;left:-999em}.esri-match-height{flex-direction:column;flex:auto;display:flex;overflow:hidden}.esri-feature-templates{background:var(--calcite-color-background);width:100%}.esri-feature-templates__list-item-icon{flex:0;justify-content:center;align-items:center;width:48px;min-width:48px;display:flex}.esri-feature-templates__list-item-icon>div{display:flex}.esri-ui .esri-feature-templates{width:300px}.esri-ui .esri-widget .esri-feature-templates{width:100%}[class^=esri-icon-],[class*=" esri-icon-"]{speak:none;font-variant:normal;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-style:normal;font-weight:var(--calcite-font-weight-normal);line-height:1;font-family:CalciteWebCoreIcons!important}.esri-icon-close:before{content:"";color:inherit}.esri-icon-drag-horizontal:before{content:"";color:inherit}.esri-icon-drag-vertical:before{content:"";color:inherit}.esri-icon-handle-horizontal:before{content:"";color:inherit}.esri-icon-handle-vertical:before{content:"";color:inherit}.esri-icon-check-mark:before{content:"";color:inherit}.esri-icon-left-triangle-arrow:before{content:"";color:inherit}.esri-icon-right-triangle-arrow:before{content:"";color:inherit}.esri-icon-down-arrow:before{content:"";color:inherit}.esri-icon-up-arrow:before{content:"";color:inherit}.esri-icon-overview-arrow-bottom-left:before{content:"";color:inherit}.esri-icon-overview-arrow-bottom-right:before{content:"";color:inherit}.esri-icon-overview-arrow-top-left:before{content:"";color:inherit}.esri-icon-overview-arrow-top-right:before{content:"";color:inherit}.esri-icon-maximize:before{content:"";color:inherit}.esri-icon-minimize:before{content:"";color:inherit}.esri-icon-checkbox-unchecked:before{content:"";color:inherit}.esri-icon-checkbox-checked:before{content:"";color:inherit}.esri-icon-radio-unchecked:before{content:"";color:inherit}.esri-icon-radio-checked:before{content:"";color:inherit}.esri-icon-up-arrow-circled:before{content:"";color:inherit}.esri-icon-down-arrow-circled:before{content:"";color:inherit}.esri-icon-left-arrow-circled:before{content:"";color:inherit}.esri-icon-right-arrow-circled:before{content:"";color:inherit}.esri-icon-zoom-out-fixed:before{content:"";color:inherit}.esri-icon-zoom-in-fixed:before{content:"";color:inherit}.esri-icon-refresh:before{content:"";color:inherit}.esri-icon-edit:before{content:"";color:inherit}.esri-icon-authorize:before{content:"";color:inherit}.esri-icon-map-pin:before{content:"";color:inherit}.esri-icon-blank-map-pin:before{content:"";color:inherit}.esri-icon-table:before{content:"";color:inherit}.esri-icon-plus:before{content:"+";color:inherit}.esri-icon-minus:before{content:"";color:inherit}.esri-icon-beginning:before{content:"";color:inherit}.esri-icon-reverse:before{content:"";color:inherit}.esri-icon-pause:before{content:"";color:inherit}.esri-icon-play:before{content:"";color:inherit}.esri-icon-forward:before{content:"";color:inherit}.esri-icon-end:before{content:"";color:inherit}.esri-icon-erase:before{content:"";color:inherit}.esri-icon-up-down-arrows:before{content:"";color:inherit}.esri-icon-left:before{content:"";color:inherit}.esri-icon-right:before{content:"";color:inherit}.esri-icon-announcement:before{content:"";color:inherit}.esri-icon-notice-round:before{content:"";color:inherit}.esri-icon-notice-triangle:before{content:"";color:inherit}.esri-icon-home:before{content:"";color:inherit}.esri-icon-locate:before{content:"";color:inherit}.esri-icon-expand:before{content:"";color:inherit}.esri-icon-collapse:before{content:"";color:inherit}.esri-icon-layer-list:before{content:"";color:inherit}.esri-icon-basemap:before{content:"";color:inherit}.esri-icon-globe:before{content:"";color:inherit}.esri-icon-applications:before{content:"";color:inherit}.esri-icon-arrow-up-circled:before{content:"";color:inherit}.esri-icon-arrow-down-circled:before{content:"";color:inherit}.esri-icon-arrow-left-circled:before{content:"";color:inherit}.esri-icon-arrow-right-circled:before{content:"";color:inherit}.esri-icon-minus-circled:before{content:"";color:inherit}.esri-icon-plus-circled:before{content:"";color:inherit}.esri-icon-add-attachment:before{content:"";color:inherit}.esri-icon-attachment:before{content:"";color:inherit}.esri-icon-calendar:before{content:"";color:inherit}.esri-icon-close-circled:before{content:"";color:inherit}.esri-icon-browser:before{content:"";color:inherit}.esri-icon-collection:before{content:"";color:inherit}.esri-icon-comment:before{content:"";color:inherit}.esri-icon-configure-popup:before{content:"";color:inherit}.esri-icon-contact:before{content:"";color:inherit}.esri-icon-dashboard:before{content:"";color:inherit}.esri-icon-deny:before{content:"";color:inherit}.esri-icon-description:before{content:"";color:inherit}.esri-icon-directions:before{content:"";color:inherit}.esri-icon-directions2:before{content:"";color:inherit}.esri-icon-documentation:before{content:"";color:inherit}.esri-icon-duplicate:before{content:"";color:inherit}.esri-icon-review:before{content:"";color:inherit}.esri-icon-environment-settings:before{content:"";color:inherit}.esri-icon-error:before{content:"";color:inherit}.esri-icon-error2:before{content:"";color:inherit}.esri-icon-experimental:before{content:"";color:inherit}.esri-icon-feature-layer:before{content:"";color:inherit}.esri-icon-filter:before{content:"";color:inherit}.esri-icon-grant:before{content:"";color:inherit}.esri-icon-group:before{content:"";color:inherit}.esri-icon-key:before{content:"";color:inherit}.esri-icon-labels:before{content:"";color:inherit}.esri-icon-tag:before{content:"";color:inherit}.esri-icon-layers:before{content:"";color:inherit}.esri-icon-left-arrow:before{content:"";color:inherit}.esri-icon-right-arrow:before{content:"";color:inherit}.esri-icon-link-external:before{content:"";color:inherit}.esri-icon-link:before{content:"";color:inherit}.esri-icon-loading-indicator:before{content:"";color:inherit}.esri-icon-maps:before{content:"";color:inherit}.esri-icon-marketplace:before{content:"";color:inherit}.esri-icon-media:before{content:"";color:inherit}.esri-icon-media2:before{content:"";color:inherit}.esri-icon-menu:before{content:"";color:inherit}.esri-icon-mobile:before{content:"";color:inherit}.esri-icon-phone:before{content:"";color:inherit}.esri-icon-navigation:before{content:"";color:inherit}.esri-icon-pan:before{content:"";color:inherit}.esri-icon-printer:before{content:"";color:inherit}.esri-icon-pie-chart:before{content:"";color:inherit}.esri-icon-chart:before{content:"";color:inherit}.esri-icon-line-chart:before{content:"";color:inherit}.esri-icon-question:before{content:"";color:inherit}.esri-icon-resend-invitation:before{content:"";color:inherit}.esri-icon-rotate:before{content:"";color:inherit}.esri-icon-save:before{content:"";color:inherit}.esri-icon-settings:before{content:"";color:inherit}.esri-icon-settings2:before{content:"";color:inherit}.esri-icon-share:before{content:"";color:inherit}.esri-icon-sign-out:before{content:"";color:inherit}.esri-icon-support:before{content:"";color:inherit}.esri-icon-user:before{content:"";color:inherit}.esri-icon-time-clock:before{content:"";color:inherit}.esri-icon-trash:before{content:"";color:inherit}.esri-icon-upload:before{content:"";color:inherit}.esri-icon-download:before{content:"";color:inherit}.esri-icon-zoom-in-magnifying-glass:before{content:"";color:inherit}.esri-icon-search:before{content:"";color:inherit}.esri-icon-zoom-out-magnifying-glass:before{content:"";color:inherit}.esri-icon-locked:before{content:"";color:inherit}.esri-icon-unlocked:before{content:"";color:inherit}.esri-icon-favorites:before{content:"";color:inherit}.esri-icon-compass:before{content:"";color:inherit}.esri-icon-down:before{content:"";color:inherit}.esri-icon-up:before{content:"";color:inherit}.esri-icon-chat:before{content:"";color:inherit}.esri-icon-dock-bottom:before{content:"";color:inherit}.esri-icon-dock-left:before{content:"";color:inherit}.esri-icon-dock-right:before{content:"";color:inherit}.esri-icon-organization:before{content:"";color:inherit}.esri-icon-north-navigation:before{content:"";color:inherit}.esri-icon-locate-circled:before{content:"";color:inherit}.esri-icon-dial:before{content:"";color:inherit}.esri-icon-polygon:before{content:"";color:inherit}.esri-icon-polyline:before{content:"";color:inherit}.esri-icon-visible:before{content:"";color:inherit}.esri-icon-non-visible:before{content:"";color:inherit}.esri-icon-link-vertical:before{content:"";color:inherit}.esri-icon-unlocked-link-vertical:before{content:"";color:inherit}.esri-icon-link-horizontal:before{content:"";color:inherit}.esri-icon-unlocked-link-horizontal:before{content:"";color:inherit}.esri-icon-swap:before{content:"";color:inherit}.esri-icon-cta-link-external:before{content:"";color:inherit}.esri-icon-reply:before{content:"";color:inherit}.esri-icon-public:before{content:"";color:inherit}.esri-icon-share2:before{content:"";color:inherit}.esri-icon-launch-link-external:before{content:"";color:inherit}.esri-icon-rotate-back:before{content:"";color:inherit}.esri-icon-pan2:before{content:"";color:inherit}.esri-icon-tracking:before{content:"";color:inherit}.esri-icon-expand2:before{content:"";color:inherit}.esri-icon-arrow-down:before{content:"";color:inherit}.esri-icon-arrow-up:before{content:"";color:inherit}.esri-icon-hollow-eye:before{content:"";color:inherit}.esri-icon-play-circled:before{content:"";color:inherit}.esri-icon-volume-off:before{content:"";color:inherit}.esri-icon-volume-on:before{content:"";color:inherit}.esri-icon-bookmark:before{content:"";color:inherit}.esri-icon-lightbulb:before{content:"";color:inherit}.esri-icon-sketch-rectangle:before{content:"";color:inherit}.esri-icon-north-navigation-filled:before{content:"";color:inherit}.esri-icon-default-action:before{content:"";color:inherit}.esri-icon-undo:before{content:"";color:inherit}.esri-icon-redo:before{content:"";color:inherit}.esri-icon-cursor:before{content:"";color:inherit}.esri-icon-cursor-filled:before{content:"";color:inherit}.esri-icon-measure:before{content:"";color:inherit}.esri-icon-measure-line:before{content:"";color:inherit}.esri-icon-measure-area:before{content:"";color:inherit}.esri-icon-legend:before{content:"";color:inherit}.esri-icon-sliders:before{content:"";color:inherit}.esri-icon-sliders-horizontal:before{content:"";color:inherit}.esri-icon-cursor-marquee:before{content:"";color:inherit}.esri-icon-lasso:before{content:"";color:inherit}.esri-icon-elevation-profile:before{content:"";color:inherit}.esri-icon-slice:before{content:"";color:inherit}.esri-icon-line-of-sight:before{content:"";color:inherit}.esri-icon-zoom-to-object:before{content:"";color:inherit}.esri-icon-urban-model:before{content:"";color:inherit}.esri-icon-measure-building-height-shadow:before{content:"";color:inherit}.esri-icon-partly-cloudy:before{content:"";color:inherit}.esri-button{box-sizing:border-box;cursor:pointer;white-space:normal;word-break:normal;color:var(--calcite-color-text-1);background-color:var(--calcite-color-status-info);border:var(--calcite-spacing-px) solid var(--calcite-color-status-info);justify-content:center;align-items:center;width:100%;min-height:var(--calcite-spacing-xxxl);padding:6px 7px;font-family:inherit;font-size:var(--calcite-font-size);transition:background-color .125s ease-in-out,border .125s ease-in-out;display:flex;overflow:hidden;&:hover{color:var(--calcite-color-text-1);background-color:var(--calcite-color-status-info-hover);border:var(--calcite-spacing-px) solid var(--calcite-color-status-info-hover)}}.esri-button:hover{color:var(--calcite-color-text-1);background-color:var(--calcite-color-text-2);border:1px solid var(--calcite-color-text-2)}.esri-button.esri-button--small{min-height:var(--calcite-spacing-xl);font-size:var(--calcite-font-size-sm)}.esri-button.esri-button--half{width:50%;display:inline-block}.esri-button.esri-button--third{width:33%;display:inline-block}.esri-button--secondary{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1)}.esri-button--tertiary{color:var(--calcite-color-brand);background-color:var(--calcite-color-transparent);border-color:var(--calcite-color-transparent)}.esri-button--tertiary:hover{color:var(--calcite-color-brand-hover);background-color:var(--calcite-color-foreground-2);border-color:var(--calcite-color-transparent)}.esri-button--disabled{opacity:.4;pointer-events:none}.esri-button--drill-in{outline-offset:-4px;cursor:pointer;text-align:unset;background-color:var(--calcite-color-foreground-1);border:none;border-radius:2px;justify-content:space-between;align-items:center;margin:var(--calcite-spacing-md) 7px;padding:var(--calcite-spacing-md) 7px;text-decoration:none;transition:background-color .125s ease-in-out;display:flex;box-shadow:0 0 0 1px #adadad4d}.esri-button--drill-in:hover,.esri-button--drill-in:focus{background-color:var(--calcite-color-foreground-2)}.esri-button--drill-in__title{font-size:var(--calcite-font-size)}.esri-button--drill-in [class^=esri-icon-],.esri-button--drill-in [class*=" esri-icon-"]{padding:0 7px}.esri-widget--button{cursor:pointer;text-align:center;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);flex-flow:row;justify-content:center;align-items:center;width:var(--calcite-spacing-xxxl);height:var(--calcite-spacing-xxxl);margin:0;padding:0;font-size:var(--calcite-font-size);transition:background-color .125s ease-in-out;display:flex;overflow:hidden}.esri-widget--button:is(calcite-button):not(:hover){--calcite-icon-color: var(--calcite-color-text-3)}.esri-widget--button:not([appearance]),.esri-widget--button[appearance=solid]{--calcite-color-foreground-3: var(--calcite-color-foreground-1)}.esri-widget--button:is(calcite-button){--calcite-offset-invert-focus: 1}.esri-widget--button calcite-loader[inline]{margin:auto}.esri-button--secondary{color:var(--calcite-color-brand);background-color:var(--calcite-color-foreground-1);&:hover{color:var(--calcite-color-text-inverse);background-color:var(--calcite-color-status-info);border:1px solid var(--calcite-color-status-info)}}.esri-item-list{width:100%}.esri-item-list__filter-container--sticky{z-index:1;position:sticky;top:0}.esri-item-list__group{margin-top:12px}.esri-item-list__scroller{overflow-y:auto}.esri-item-list__scroller{z-index:0;position:relative}.esri-item-list__scroller--enabled{max-height:420px}.esri-item-list__group__header{color:var(--calcite-color-text-2);font-weight:var(--calcite-font-weight-medium)}.esri-item-list__list-item{cursor:pointer;min-height:32px}.esri-item-list__list-item[class^=esri-icon-],.esri-item-list__list-item[class*=" esri-icon-"]{padding-inline-end:2.8px}.esri-item-list__list-item--disabled{cursor:default}.esri-item-list__list-item-icon{justify-content:center;align-items:center;min-width:32px;height:32px;display:flex}.esri-item-list__list-item-icon span{line-height:0}.esri-thumbnail-preview{background-position:50%;width:22px;height:22px}.esri-item-list__no-matches-message{justify-content:center;align-items:center;height:96px;display:flex}.esri-labeled-switch__label{--calcite-label-margin-bottom: 0}.esri-labeled-switch__label-content{text-wrap:balance;flex:1;align-items:center;gap:7px;display:flex}.esri-labeled-switch__label-content>div{flex-grow:1}.esri-labeled-switch__icon{margin-top:-1px}.esri-labeled-switch__icon_info{color:var(--calcite-color-status-info)}.esri-labeled-switch__icon_warning{color:var(--calcite-color-status-warning)}.esri-labeled-switch__tooltip{text-wrap:wrap}@keyframes esri-basemap-slide{0%{opacity:0;margin-top:0;margin-left:0}75%{opacity:0;margin-top:0;margin-left:0}to{opacity:1;margin-top:5px;margin-left:5px}}@keyframes esri-docking-animation{0%{opacity:0}25%{opacity:0}to{opacity:1}}@keyframes popup-intro-animation-down{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translate(0)}}@keyframes popup-intro-animation-up{0%{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translate(0)}}@supports (-ms-ime-align: auto){.esri-slider__anchor:focus{outline:1px dotted #000}}@keyframes esri-spinner--start-animation{0%{opacity:0;transform:scale(0)}to{opacity:1;transform:scale(1)}}@keyframes esri-spinner--finish-animation{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(0)}}@keyframes esri-spinner--rotate-animation{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (prefers-reduced-motion){.esri-utility-network-trace__reset-prompt{animation:none!important}}@media (prefers-reduced-motion){.esri-popup--aligned-top-center,.esri-popup--aligned-top-left,.esri-popup--aligned-top-right,.esri-popup--aligned-bottom-center,.esri-popup--aligned-bottom-left,.esri-popup--aligned-bottom-right,.esri-popup--is-docked{animation:none!important}}@media (prefers-reduced-motion: reduce){.esri-fov-overlay{animation:none!important}}@keyframes esri-fade-in-down{0%{opacity:0;transform:translateY(-5px)}25%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translate(0)}}@keyframes esri-fade-in-up{0%{opacity:0;transform:translateY(5px)}25%{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translate(0)}}@keyframes esri-fade-in{0%{opacity:0}25%{opacity:0}to{opacity:1}}@keyframes esri-fade-in-scale{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}@keyframes looping-progresss-bar-ani{0%{width:0;left:0}20%{width:20%;left:0}80%{width:20%;left:80%}to{width:0;left:100%}}@keyframes esri-rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes panel-advance{0%{opacity:0;transform:translate(50px) scale(.99)}to{opacity:1;transform:translate(0) scale(1)}}@keyframes panel-retreat{0%{opacity:0;transform:translate(-50px) scale(.99)}to{opacity:1;transform:translate(0) scale(1)}}@keyframes panel-advance--rtl{0%{opacity:0;transform:translate(-50px) scale(.99)}to{opacity:1;transform:translate(0) scale(1)}}@keyframes panel-retreat--rtl{0%{opacity:0;transform:translate(50px) scale(.99)}to{opacity:1;transform:translate(0) scale(1)}}.esri-feature-form{letter-spacing:0em;background:var(--calcite-color-background);padding:var(--esri-widget-padding)}.esri-feature-form__disabled-notice{margin-bottom:var(--calcite-spacing-xl)}.esri-feature-form .esri-feature-utility-network-associations,.esri-feature-form .esri-feature-form-utility-network-association-list{margin-block-end:var(--calcite-spacing-md)}.esri-feature-form .esri-feature-utility-network-associations .esri-feature-element-info__description{color:var(--calcite-color-text-2)}.esri-feature-form .esri-feature-utility-network-associations .esri-feature-element-info h5{font-size:inherit}.esri-feature-form__form{flex-direction:column;display:flex}.esri-feature-form__centered-button{align-self:center}.esri-feature-form__description-text{color:var(--calcite-color-text-2);font-size:var(--calcite-font-size-sm)}.esri-feature-form__list-observer{z-index:2;text-align:center;position:relative;bottom:var(--calcite-spacing-xxl)}.esri-feature-form__related-records_header{margin-bottom:var(--calcite-spacing-xs);display:flex}.esri-feature-form__related-records_header span{flex-grow:1}.esri-feature-form__related-records_label calcite-notice,.esri-feature-form__related-records_label .esri-feature-form__description-text{margin-bottom:var(--calcite-spacing-xs)}.esri-feature-form__related-records_list{min-height:40px;margin-bottom:var(--calcite-spacing-xs)}label.esri-feature-form__label{gap:.5em;margin-bottom:var(--calcite-spacing-md)}.esri-feature-form__label{opacity:1;flex-direction:column;justify-content:space-between;margin-bottom:var(--calcite-spacing-xs);transition:opacity .25s,margin .25s;display:flex;position:relative}.esri-feature-form__label:last-child{margin-bottom:0}.esri-feature-form__label-text-content{white-space:pre-wrap;word-break:break-word;word-wrap:break-word;align-items:center;display:flex}.esri-feature-form__form-header{margin-bottom:var(--calcite-spacing-md)}.esri-feature-form__form-header .esri-feature-form__description-text~.esri-widget__heading{margin-bottom:0}.esri-feature-form__input{width:100%}.esri-feature-form__input:focus{outline:2px solid var(--calcite-color-brand);outline-offset:-2px}textarea.esri-feature-form__input{resize:vertical}.esri-feature-form__input--disabled{background-color:var(--calcite-color-background);font-weight:var(--calcite-font-weight-medium)}.esri-feature-form__field-error-message{padding:7px 0;font-size:var(--calcite-font-size-sm)}.esri-feature-form__date-input-container{flex-direction:column;display:flex}.esri-feature-form__date-input-container .esri-feature-form__input{margin-bottom:3px}.esri-feature-form__date-input-container :last-child{margin-bottom:0}.esri-feature-form__input--radio-group{flex-direction:column;display:flex}.esri-feature-form__input--radio-label{align-items:center;display:flex}.esri-feature-form__input--switch{margin:7px 0}.esri-feature-form__group{margin:0 0 var(--calcite-spacing-md);background-color:inherit;margin-inline:-10px}.esri-feature-form__group--sequential{border-bottom:none;border-inline-start:3px solid #adadad4d}.esri-feature-form__group--active{border-inline-start-color:var(--calcite-color-status-info)}.esri-feature-form__text-element{color:var(--calcite-color-text-3);line-height:var(--calcite-font-line-height-relative-snug);font-size:var(--calcite-font-size--1);font-weight:var(--calcite-font-weight-normal)}.esri-feature-form__text-element a{transition:background-color,block-size,border-color,box-shadow,color,inset-block-end,inset-block-start,inset-inline-end,inset-inline-start inset-size,opacity,outline-color,transform var(--calcite-animation-timing) ease-in-out 0s,outline 0s,outline-offset 0s;background-color:var(--calcite-color-background);background-image:linear-gradient(currentColor,currentColor),linear-gradient(var(--calcite-color-brand-underline),var(--calcite-color-brand-underline));color:var(--calcite-color-text-link);background-position-x:0%,100%;background-position-y:min(1.5em,100%);background-repeat:no-repeat,no-repeat;background-size:0% 1px,100% 1px;border-style:none;padding:0;text-decoration:none;display:inline;position:relative}.esri-feature-form__text-element a:hover,.esri-feature-form__text-element a:focus{background-size:100% 1px,100% 1px}.esri-feature-form__text-element a:active{background-size:100% 2px,100% 2px}.esri-feature-form__text-element a.calcite--rtl{background-position:100% 100%,100% 100%}.esri-feature-form__text-element code{border:1px solid var(--calcite-color-border-3);background-color:var(--calcite-color-foreground-3);white-space:normal;word-break:break-word;color:var(--calcite-color-text-2);font-family:var(--calcite-code-family);border-radius:var(--calcite-spacing-base);padding:.25em;font-size:85%}.esri-feature-form__text-element h1,.esri-feature-form__text-element h2,.esri-feature-form__text-element h3,.esri-feature-form__text-element h4,.esri-feature-form__text-element h5{color:var(--calcite-color-text-1);line-height:var(--calcite-font-line-height-relative-snug);font-size:var(--calcite-font-size-0);font-weight:var(--calcite-font-weight-bold);margin-bottom:var(--calcite-spacing-xxs)}.esri-feature-form__text-element h5{font-weight:var(--calcite-font-weight-medium)}.esri-feature-form__text-element h6{color:var(--calcite-color-text-2);line-height:var(--calcite-font-line-height-relative-snug);font-size:var(--calcite-font-size--1);font-weight:var(--calcite-font-weight-medium);margin-bottom:var(--calcite-spacing-xxs)}.esri-feature-form__text-element p{color:var(--calcite-color-text-3);line-height:var(--calcite-font-line-height-relative-snug);font-size:var(--calcite-font-size--1);font-weight:var(--calcite-font-weight-normal);margin-bottom:var(--calcite-spacing-xl)}.esri-feature-form__text-element strong{font-weight:var(--calcite-font-weight-bold)}:dir(rtl) .esri-feature-form__date-input-part:first-child .esri-feature-form__input{border-left:none;border-right:1px solid #adadad4d}.esri-feature-form-utility-network-association-layers{background-color:var(--calcite-color-background)}.esri-feature-form-utility-network-association-layers__header>*{margin-block-end:var(--calcite-spacing-md)}.esri-feature-form-utility-network-association-layers__header>:last-child{color:var(--calcite-color-text-3)}.esri-feature-form-utility-network-association-layers__heading-content{align-items:center;display:flex}.esri-feature-form-utility-network-association-layers__heading-content calcite-icon{margin-inline-end:var(--calcite-spacing-md)}.esri-feature-form-utility-network-association-layers__list-container{min-height:var(--calcite-spacing-xxxl);margin-bottom:var(--calcite-spacing-md)}.esri-feature-form-utility-network-association-layers__feature-observer{z-index:2;text-align:center;position:relative;bottom:20px}.esri-feature-form-utility-network-association-layers__filter-container{z-index:1;margin-bottom:var(--calcite-spacing-md);top:var(--calcite-spacing-md)}.esri-feature-form-utility-network-association-layers__filter-options-container{flex-direction:column;display:flex}.esri-feature-form-utility-network-association-layers__filter-options-header{flex-direction:row;align-items:baseline;display:flex}.esri-feature-form-utility-network-association-layers__filter-options-header span{flex-grow:1}.esri-feature-form-utility-network-association-layers__spatial-select-container{flex-direction:column;align-items:flex-end;gap:6px;display:flex}.esri-feature-form-utility-network-association-layers__spatial-select-toolbar{--calcite-action-group-border-color: transparent;border-width:var(--calcite-border-width-sm, 1px);border-radius:var(--calcite-corner-radius-round, 4px);border-style:solid;border-color:var(--calcite-color-border-3, var(--calcite-color-inverse));width:100%;min-height:min-content;overflow:hidden}.esri-feature-form-utility-network-association-layers__sticky-loading-container{z-index:2;pointer-events:none;justify-content:center;align-items:center;height:var(--calcite-spacing-xxxl);margin:0;padding:0;display:flex;position:sticky;bottom:10px}.esri-feature-form-utility-network-association-layers__loading-container{justify-content:center;width:100%;padding:var(--calcite-spacing-md) 0;display:flex}.esri-feature-form-utility-network-association-list{background-color:var(--calcite-color-foreground-1)}.esri-feature-form-utility-network-association-list__header>*{margin-block-end:var(--calcite-spacing-md)}.esri-feature-form-utility-network-association-list__header>:last-child{color:var(--calcite-color-text-3)}.esri-feature-form-utility-network-association-list__header calcite-block{margin-block-start:-18px;margin-inline:-15px}.esri-feature-form-utility-network-association-list__heading-content{align-items:center;display:flex}.esri-feature-form-utility-network-association-list__heading-content calcite-icon{margin-inline-end:var(--calcite-spacing-md)}.esri-feature-form-utility-network-association-list__list-container{flex-direction:column;min-height:var(--calcite-spacing-xxxl);display:flex}.esri-feature-form-utility-network-association-list__list-container calcite-fab{margin-block:var(--calcite-spacing-md);flex-direction:row;align-self:center;display:flex}.esri-feature-form-utility-network-association-settings{--calcite-block-padding: 0;background-color:var(--calcite-color-foreground-1);flex-direction:column;display:flex}.esri-feature-form-utility-network-association-settings calcite-block{border:1px solid var(--calcite-color-border-3);margin-block:0}.esri-feature-form-utility-network-association-settings calcite-block:first-of-type{border-radius:var(--calcite-spacing-sm) var(--calcite-spacing-sm) 0 0}.esri-feature-form-utility-network-association-settings calcite-block:last-of-type{border-top:none;border-radius:0 0 var(--calcite-spacing-sm) var(--calcite-spacing-sm);margin-block-end:var(--calcite-spacing-md)}.esri-feature-form-utility-network-association-settings calcite-block calcite-label{margin-inline:var(--calcite-spacing-md)}.esri-feature-form-utility-network-association-settings__info-container{flex-direction:column;display:flex}.esri-feature-form-utility-network-association-settings__info-container>*{margin-block-end:var(--calcite-spacing-md)}.esri-feature{letter-spacing:0em;isolation:isolate;position:relative;width:100%}.esri-feature__title{word-break:break-word;word-wrap:break-word;font-size:var(--calcite-font-size);display:block}.esri-feature calcite-icon{box-sizing:content-box}.esri-feature__attachments{display:flex}.esri-feature__loading-container{justify-content:center;width:100%;padding:var(--calcite-spacing-md) 0;display:flex}.esri-feature-relationship{position:relative}.esri-feature-relationship__list{min-height:var(--calcite-spacing-xxxl)}.esri-feature-relationship__list-item--hidden{display:none}.esri-feature-utility-network-associations{position:relative}.esri-feature__filter-container{z-index:1;margin-bottom:var(--calcite-spacing-md);position:sticky;top:var(--calcite-spacing-md)}.esri-feature__feature-observer{z-index:2;text-align:center;position:relative;bottom:var(--calcite-spacing-xxl)}.esri-feature__sticky-loading-container{z-index:2;pointer-events:none;justify-content:center;align-items:center;height:var(--calcite-spacing-xxxl);margin:0;padding:0;display:flex;position:sticky;bottom:10px}.esri-icon-loading-indicator{display:inline-block}.esri-feature__content-element{margin-bottom:24px;padding:0 7px}.esri-feature__content-element .esri-widget__heading{line-height:var(--calcite-font-line-height-relative-tight)}.esri-feature__content-element:only-child,.esri-feature__content-node--text{margin-bottom:3px}.esri-feature__content-node{flex-direction:column;display:flex}.esri-feature__text{line-height:var(--calcite-font-line-height-relative-tight)}.esri-feature-attachments{flex-flow:column wrap;align-items:flex-start}.esri-feature__last-edited-info{padding-top:var(--calcite-spacing-xs);font-size:var(--calcite-font-size-sm)}:dir(rtl) .esri-feature__attachments-title{margin:0 0 0 auto}:dir(rtl) .esri-feature__attachments--list .esri-feature__attachment-item-mask{margin-left:7px;margin-right:0}.esri-feature-content__loader-container{justify-content:center;align-items:center;height:150px;padding:0;display:flex}.esri-feature-content__loader{background:url(./assets/attachments/images/loading-throb.gif) 50% no-repeat;width:100%;height:64px}.esri-feature-content{font-size:var(--calcite-font-size)}.esri-feature-content h1,.esri-feature-content h2,.esri-feature-content h3,.esri-feature-content h4,.esri-feature-content h5,.esri-feature-content h6{letter-spacing:0;color:var(--calcite-color-text-2);margin:.5em 0;font-weight:var(--calcite-font-weight-semibold);line-height:normal}.esri-feature-content h1{font-size:1.75em}.esri-feature-content h2{font-size:1.5em}.esri-feature-content h3{font-size:1.25em}.esri-feature-content h4,.esri-feature-content h5,.esri-feature-content h6{font-size:1em}.esri-widget__heading.esri-feature-element-info__title{color:var(--calcite-color-text-2);margin-top:0;margin-bottom:.2em;font-size:var(--calcite-font-size-xl);font-weight:var(--calcite-font-weight-normal)}.esri-feature-element-info__description{margin-bottom:var(--calcite-font-size-xs);font-size:var(--calcite-font-size-sm);font-weight:var(--calcite-font-weight-normal)}.esri-feature-content p{margin:0 0 1.2em;font-size:var(--calcite-font-size)}.esri-feature-content p:last-child{margin-block-end:0}.esri-feature-content img{image-orientation:from-image;max-width:100%;max-height:100%}.esri-feature-content video{max-width:100%;max-height:100%}.esri-feature-content figure{margin:0;padding:0}.esri-feature-content figcaption{margin:.2em 0 0;padding:0;font-size:var(--calcite-font-size-sm);font-style:italic;display:block}.esri-feature-content ul,.esri-feature-content ol{margin-block:1rem}.esri-feature-content ul:first-child,.esri-feature-content ol:first-child{margin-block-start:0}.esri-feature-content a{color:var(--calcite-color-text-3)}.esri-feature-content a:hover,.esri-feature-content a:focus{color:var(--calcite-color-text-2)}.esri-features{--calcite-color-background: $background-color;flex-direction:column;display:flex}.esri-features img{image-orientation:from-image}.esri-features__flow-item--collapsed{--calcite-flow-item-header-border-block-end: none}.esri-features__container{background-color:var(--calcite-color-background)}.esri-features__container:not(:empty){padding:var(--calcite-spacing-md)}.esri-features .esri-feature,.esri-features .esri-feature-relationship,.esri-features .esri-feature-utility-network-associations{background-color:#0000}.esri-features__heading{word-break:break-word;word-wrap:break-word}.esri-features__header,.esri-features__footer{background-color:var(--calcite-color-foreground-1);flex:1;justify-content:flex-end;align-items:center;display:flex}.esri-features__pagination-text{padding-inline:var(--calcite-spacing-sm);color:var(--calcite-color-text-3);font-size:var(--calcite-font-size-sm)}.esri-features__loader{align-self:center;padding-inline:1rem}.esri-features__pagination-action-bar{flex:1}.esri-features__pagination-menu-button{border-inline-start:1px solid var(--calcite-color-border-3)}.esri-features__icon{flex:0 0 var(--calcite-spacing-lg);width:var(--calcite-spacing-lg);height:var(--calcite-spacing-lg);display:inline-block}.esri-features__action-image{background-position:50%;background-repeat:no-repeat;background-size:contain;flex:0 0 var(--calcite-spacing-lg);width:var(--calcite-spacing-lg);height:var(--calcite-spacing-lg)}.esri-features__header{border-block-end:1px solid var(--calcite-color-border-3)}.esri-features__content-feature{--calcite-flow-item-footer-padding: 0}.esri-features__feature-menu-observer{z-index:2;text-align:center;position:relative;bottom:20px}.esri-features__action--exit{transform:scaleX(-1)}.esri-feature-media__container{flex-flow:wrap;align-items:center;width:100%;min-height:150px;margin-top:var(--calcite-spacing-xs);display:flex}.esri-feature-media__container .esri-feature-media__pagination-button{cursor:pointer;color:var(--calcite-color-text-3);background:0 0;border:none;justify-content:center;align-items:center;padding-block:var(--calcite-spacing-xs);padding-inline:var(--calcite-spacing-sm);display:flex}.esri-feature-media__container .esri-feature-media__pagination-button:hover,.esri-feature-media__container .esri-feature-media__pagination-button:focus{color:var(--calcite-color-text-2);fill:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-2)}.esri-feature-media__item-title{margin:0;font-size:var(--calcite-font-size-md)}.esri-feature-media__item-caption{padding-block-start:3px;font-size:var(--calcite-font-size-sm)}.esri-feature-media__item{justify-content:center;align-items:flex-start;width:100%;height:auto;margin-block:var(--calcite-spacing-xs);display:flex}.esri-feature-media__item-navigation{flex:0 100%;justify-content:space-between;align-items:flex-start;margin-block-end:var(--calcite-spacing-xs);display:flex}.esri-feature-media__item-text{margin-inline-end:var(--calcite-spacing-md)}.esri-feature-media__pagination{flex:none;align-items:center;display:flex;overflow:hidden}.esri-feature-media__pagination:only-child{margin-inline-start:auto}.esri-feature-media__pagination-text{color:var(--calcite-color-text-3);padding-inline:var(--calcite-spacing-base);font-size:var(--calcite-font-size-sm)}.esri-feature-media__item-container{flex:0 auto;width:100%}.esri-feature-media__item-container img{max-width:100%}.esri-feature-media__item-container img[src$=".SVG"],.esri-feature-media__item-container img[src$=".svg"]{width:100%}.esri-feature-media__chart{background-color:var(--calcite-color-foreground-1);width:100%;height:155px}:dir(rtl) .esri-feature-media__image-summary{margin:0 .5em 0 0}:dir(rtl) .esri-feature-media__pagination-icon{transform:rotate(180deg)}.esri-identity-modal__info,.esri-identity-modal__notice{margin:0;margin-bottom:var(--calcite-spacing-md)}.esri-ui .esri-popup{z-index:1;pointer-events:none;flex-flow:column;display:flex;position:absolute}.esri-ui .esri-popup .esri-features{flex:1;width:100%}.esri-ui .esri-popup .esri-widget__heading{margin:0}.esri-ui .esri-popup--hidden{display:none}.esri-popup--shadow{box-shadow:0 1px 4px #000c}.esri-popup--aligned-top-center{transform-origin:50% 100%}.esri-popup--aligned-bottom-center{transform-origin:50% -5%}.esri-popup--aligned-top-left,.esri-popup--aligned-bottom-left{transform-origin:100%}.esri-popup--aligned-top-right,.esri-popup--aligned-bottom-right{transform-origin:-5%}.esri-popup--aligned-top-center,.esri-popup--aligned-top-left,.esri-popup--aligned-top-right{animation:.2s ease-in-out popup-intro-animation-down}.esri-popup--aligned-bottom-center,.esri-popup--aligned-bottom-left,.esri-popup--aligned-bottom-right{animation:.2s ease-in-out popup-intro-animation-up}.esri-popup__main-container{z-index:1;pointer-events:auto;background-color:var(--calcite-color-foreground-1);width:340px;min-height:48px;max-height:340px;display:flex;position:relative;overflow:hidden}.esri-popup__pointer{width:0;height:0;position:absolute}.esri-popup__pointer-direction{content:"";background-color:var(--calcite-color-foreground-1);width:var(--calcite-spacing-md);height:var(--calcite-spacing-md);position:absolute}.esri-popup--aligned-top-center .esri-popup__pointer{margin:0 0 0 -6px;top:100%;left:50%}.esri-popup--aligned-bottom-center .esri-popup__pointer{margin:0 0 0 -6px;bottom:100%;left:50%}.esri-popup--aligned-top-left .esri-popup__pointer{bottom:var(--calcite-spacing-xs);right:var(--calcite-spacing-xs);transform:rotate(-45deg)}.esri-popup--aligned-bottom-left .esri-popup__pointer{top:var(--calcite-spacing-xs);right:var(--calcite-spacing-xs);transform:rotate(45deg)}.esri-popup--aligned-top-right .esri-popup__pointer{bottom:var(--calcite-spacing-xs);left:var(--calcite-spacing-xs);transform:rotate(45deg)}.esri-popup--aligned-bottom-right .esri-popup__pointer{top:var(--calcite-spacing-xs);left:var(--calcite-spacing-xs);transform:rotate(-45deg)}.esri-popup--aligned-top-center .esri-popup__pointer-direction,.esri-popup--aligned-bottom-center .esri-popup__pointer-direction{transform:scale(.75,2) rotate(45deg)}.esri-popup--aligned-top-left .esri-popup__pointer-direction,.esri-popup--aligned-bottom-left .esri-popup__pointer-direction,.esri-popup--aligned-top-right .esri-popup__pointer-direction,.esri-popup--aligned-bottom-right .esri-popup__pointer-direction{top:-6px;left:-6px;transform:scaleY(3.5) rotate(45deg)}.esri-popup--aligned-top-center .esri-popup__pointer-direction{top:-6px;left:0}.esri-popup--aligned-bottom-center .esri-popup__pointer-direction{bottom:-6px;left:0}.esri-view-width-xlarge .esri-popup__main-container{width:460px}.esri-view-width-large .esri-popup__main-container{width:400px}.esri-view-width-medium .esri-popup__main-container{width:340px}.esri-view-width-less-than-medium .esri-popup__main-container{width:280px}.esri-view-width-xsmall .esri-popup--is-docked-bottom-center{margin-bottom:var(--calcite-spacing-xl)}.esri-view-width-xsmall .esri-popup--is-docked-top-center,.esri-view-width-xsmall .esri-popup--is-docked-bottom-center{width:auto;margin:0}.esri-view-width-xsmall .esri-popup--is-docked-top-center .esri-popup__main-container,.esri-view-width-xsmall .esri-popup--is-docked-bottom-center .esri-popup__main-container{width:100%;max-height:75%;position:absolute;left:0;right:0}.esri-view-width-xsmall .esri-popup--is-docked-bottom-center .esri-popup__main-container{bottom:0}.esri-view-width-xsmall .esri-popup--is-docked-top-center .esri-popup__main-container{top:0}.esri-view-height-xlarge .esri-popup__main-container{max-height:460px}.esri-view-height-xlarge.esri-popup--feature-menu-open .esri-popup__feature-menu-viewport{max-height:410px}.esri-view-height-large .esri-popup__main-container{max-height:400px}.esri-view-height-large.esri-popup--feature-menu-open .esri-popup__feature-menu-viewport{max-height:350px}.esri-view-height-less-than-medium .esri-popup__main-container{max-height:300px}.esri-view-height-less-than-medium.esri-popup--feature-menu-open .esri-popup__feature-menu-viewport{max-height:250px}.esri-popup--is-docked{margin:15px 15px 30px;animation:.25s ease-out esri-docking-animation;inset:0}.esri-ui .esri-popup--is-docked{flex-flow:row}.esri-popup--is-docked-top-left,.esri-popup--is-docked-top-center,.esri-popup--is-docked-top-right{align-items:flex-start}.esri-popup--is-docked-bottom-left,.esri-popup--is-docked-bottom-center,.esri-popup--is-docked-bottom-right{align-items:flex-end}.esri-popup--is-docked-top-left,.esri-popup--is-docked-bottom-left{justify-content:flex-start}.esri-popup--is-docked-top-center,.esri-popup--is-docked-bottom-center{justify-content:center}.esri-popup--is-docked-top-right,.esri-popup--is-docked-bottom-right{justify-content:flex-end}.esri-popup--is-docked-top-left .esri-popup__main-container,.esri-popup--is-docked-top-right .esri-popup__main-container,.esri-popup--is-docked-bottom-left .esri-popup__main-container,.esri-popup--is-docked-bottom-right .esri-popup__main-container{max-height:80%}.esri-popup--is-docked-top-center .esri-popup__main-container,.esri-popup--is-docked-bottom-center .esri-popup__main-container{max-height:40%}@media (prefers-reduced-motion){.esri-popup--aligned-top-center,.esri-popup--aligned-top-left,.esri-popup--aligned-top-right,.esri-popup--aligned-bottom-center,.esri-popup--aligned-bottom-left,.esri-popup--aligned-bottom-right,.esri-popup--is-docked{animation:none}}:host{--response-toolbar-vert-width: 0;--response-toolbar-vert-height: 100%;--response-toolbar-horiz-width: 100%;--response-toolbar-horiz-height: 0}.esri-responsive-toolbar__ruler{opacity:0;pointer-events:none;position:absolute}.esri-responsive-toolbar__ruler--bar{visibility:hidden;height:0;display:block;position:absolute;top:0;left:0;right:0}.esri-responsive-toolbar__ruler--bar--vertical,.esri-responsive-toolbar__ruler--pad--vertical{width:var(--response-toolbar-vert-width);height:var(--response-toolbar-vert-height)}.esri-responsive-toolbar__ruler--pad--horizontal{width:var(--response-toolbar-horiz-width);height:var(--response-toolbar-horiz-height)}.esri-responsive-toolbar__bar>div{display:contents}.esri-responsive-toolbar__bar--horizontal{min-width:100%}.esri-responsive-toolbar__bar--vertical{min-height:100%}.esri-responsive-toolbar__pad{width:min-content;display:contents}.esri-responsive-toolbar__pad>div{display:contents}.esri-responsive-toolbar__ruler--pad--vertical{width:0;height:min(100vh - 120px,100cqh - 120px)}.esri-responsive-toolbar__ruler--pad--horizontal{width:min(100vw - 60px,100cqw - 60px);height:0}.esri-split-button--split-part--vertical--s{max-height:16px}.esri-split-button--split-part--vertical--m{max-height:24px}.esri-split-button--split-part--vertical--l{max-height:40px}.esri-split-button--split-part--horizontal--s,.esri-split-button--split-part--horizontal--m{max-width:16px}.esri-split-button--split-part--horizontal--l{max-width:24px}.esri-selection-list{flex:1 1 0;width:100%;height:100%;display:flex}.esri-selection-list__flow-item,.esri-selection-list__panel,.esri-selection-list__container{display:flex}.esri-selection-list__flow-item{overflow:auto}.esri-selection-list__flow-item[scale=s] .esri-selection-list__container{gap:var(--calcite-spacing-sm);padding:var(--calcite-spacing-sm) 0}.esri-selection-list__flow-item[scale=m] .esri-selection-list__container{gap:var(--calcite-spacing-md);padding:var(--calcite-spacing-md) 0}.esri-selection-list__flow-item[scale=l] .esri-selection-list__container{gap:var(--calcite-spacing-lg);padding:var(--calcite-spacing-lg) 0}.esri-selection-list__container{background-color:var(--calcite-color-foreground-1);flex-direction:column}.esri-selection-list__container>*{background-color:var(--calcite-color-foreground-1)}.esri-selection-list__container>[scale=s]{padding:0 var(--calcite-spacing-sm) 0 var(--calcite-spacing-sm);font-size:var(--calcite-font-size-sm)}.esri-selection-list__container>[scale=m]{padding:0 var(--calcite-spacing-md) 0 var(--calcite-spacing-md);font-size:var(--calcite-font-size-md)}.esri-selection-list__container>[scale=l]{padding:0 var(--calcite-spacing-lg) 0 var(--calcite-spacing-lg);font-size:var(--calcite-font-size-lg)}.esri-selection-list .esri-selection-list__list-item__feature-icon .esri-selection-list__list-item__icon{margin-inline-start:calc(var(--calcite-spacing-lg) * -1)}.esri-selection-list .esri-selection-list__list-item__icon{min-width:var(--calcite-spacing-xxl);height:var(--calcite-spacing-xxl)}.esri-selection-list__list-item__icon{justify-content:center;align-items:center;display:flex}.esri-selection-list__list-item__icon span{line-height:0}.esri-selection-list__total-count{margin-inline:var(--calcite-spacing-xxs);line-height:initial;align-self:center}.esri-selection-list__item-count{align-items:center;gap:.5em;display:flex}.esri-selection-toolbar{flex:1 1 0;width:100%;height:100%;display:flex}.esri-selection-toolbar calcite-action-bar{width:100%}.esri-selection-toolbar calcite-chip{margin-inline:var(--calcite-spacing-xxs);line-height:initial;align-self:center;display:flex}.esri-selection-toolbar__container{width:100%;display:flex}.esri-sketch-tooltip-controls__block{border-block-end:none;margin:0}.esri-sketch-tooltip-controls__block-content{flex-direction:column;gap:6px;display:flex}.esri-sketch-tooltip-controls calcite-label:last-child{--calcite-label-margin-bottom: 0}.esri-snapping-controls__toggle-block{min-width:100%;margin:0}.esri-snapping-controls__layer-list-block{border-bottom:none;min-width:225px}.esri-snapping-controls__layer-list-block[open]{margin-block:0}.esri-snapping-controls__layer-list{overflow:auto}.esri-snapping-controls__layer-list__filter{margin-bottom:10px}.esri-snapping-controls__layer-list__button{margin-bottom:6px}.esri-snapping-controls__layer-list__item calcite-accordion-item calcite-icon,.esri-snapping-controls__layer-list__item calcite-action calcite-icon{margin-inline-start:0}.esri-snapping-controls__layer-list__item calcite-icon{color:var(--calcite-color-brand);margin-inline-start:var(--calcite-list-item-spacing-indent)}.esri-snapping-controls{flex-flow:column wrap;display:flex}.esri-snapping-controls__container{flex-direction:column;flex:auto;display:flex}.esri-snapping-controls__container :only-child{border-block-end:none}.esri-snapping-controls__panel{width:320px}.esri-snapping-controls__item{border:1px solid #adadad4d;cursor:pointer;background-color:var(--calcite-color-foreground-2);border-color:var(--calcite-color-border-1);border-radius:2px;justify-content:space-between;margin:3px 0;padding:3px;transition:border-color .125s ease-in-out;display:flex;box-shadow:0 1px #adadad4d}.esri-snapping-controls__item-action-icon{flex:0 0 16px;width:16px;height:16px;margin-top:.1em;font-size:var(--calcite-font-size-md);display:inline-block}.esri-snapping-controls__action-toggle{opacity:1;cursor:pointer;border:1px solid var(--calcite-color-border-1);flex-flow:row-reverse;justify-content:space-between;align-items:flex-start;width:100%;margin:0;padding:6px 15px;font-size:var(--calcite-font-size-sm);transition:opacity .25s ease-in-out .25s,background-color .25s ease-in-out;display:flex}.esri-snapping-controls__action-toggle .esri-snapping-controls__item-action-title{margin-left:0}.esri-snapping-controls__action-toggle .esri-snapping-controls__item-action-icon{background-color:var(--calcite-color-foreground-1);border-radius:16px;flex:0 0 28px;width:16px;height:16px;padding:0;transition:background-color .125s ease-in-out;position:relative;overflow:hidden;box-shadow:0 0 0 1px #adadad}.esri-snapping-controls__action-toggle .esri-snapping-controls__item-action-icon:before{content:"";background-color:var(--calcite-color-foreground-2);border-radius:100%;width:12px;height:12px;margin:2px;transition:background-color .125s ease-in-out,left .125s ease-in-out;display:block;position:absolute;top:0;left:0;box-shadow:0 0 0 1px #242424}.esri-snapping-controls__action-toggle--on .esri-snapping-controls__item-action-icon{background-color:var(--calcite-color-foreground-1);box-shadow:0 0 0 1px #adadad}.esri-snapping-controls__action-toggle--on .esri-snapping-controls__item-action-icon:before{background-color:var(--calcite-color-foreground-3);left:12px}.esri-snapping-controls__nested-container{flex-direction:column;gap:6px;display:flex}.esri-snapping-controls__nested-container:not(:empty){padding-top:6px;padding-inline-start:1em}calcite-block>.esri-grid-controls{background:0 0;padding:0}.esri-grid-controls{-webkit-user-select:none;user-select:none;padding:var(--esri-widget-padding);flex-flow:column wrap;display:flex;calcite-label.esri-labeled-switch__label{margin-block-end:var(--calcite-spacing-sm, .5rem)}}.esri-grid-controls__switch--bordered{border-width:0 0 var(--calcite-spacing-px) 0;border-style:solid;border-color:var(--calcite-color-border-1)}.esri-grid-controls__container{gap:var(--calcite-spacing-sm);flex-direction:column;flex:auto;display:flex}.esri-grid-controls__tilegroup{column-gap:var(--calcite-spacing-md);align-items:start;display:flex}.esri-grid-controls__tile__content{row-gap:var(--calcite-spacing-md);padding:var(--calcite-spacing-md);color:var(--calcite-color-text-2);flex-direction:column;align-items:center;display:flex}.esri-grid-controls__tile__content calcite-label{margin-bottom:calc(0px - var(--calcite-label-margin-bottom, .75rem));font-weight:var(--calcite-font-weight-medium)}.esri-grid-controls__tile{position:relative}.esri-grid-controls__tile:focus-within{outline:2px solid var(--calcite-color-brand);outline-offset:2px}.esri-grid-controls__tile--disabled{opacity:var(--calcite-opacity-disabled)}.esri-grid-controls__tile input[type=radio]{appearance:none;opacity:.001;border:var(--calcite-spacing-px) solid transparent;cursor:pointer;position:absolute;inset:0}.esri-grid-controls__tile input[type=radio]:checked+.esri-grid-controls__tile__content{border:var(--calcite-spacing-px) solid var(--calcite-color-brand)}.esri-grid-controls__tile input[type=radio]+.esri-grid-controls__tile__content{border:var(--calcite-spacing-px) solid transparent}.esri-grid-controls__numeric-inputs__container{gap:var(--calcite-spacing-sm);grid-auto-columns:1fr;grid-auto-flow:column;display:grid}.esri-grid-controls__inline-icon{margin-left:var(--calcite-spacing-xs);vertical-align:top;color:var(--calcite-color-status-warning)}:host{height:var(--arcgis-internal-panel-height, 100%)}.esri-editor{--calcite-z-index-header: 1;background-color:var(--calcite-color-background);flex-direction:column;height:100%;width:100%;display:flex;position:relative;overflow-y:auto}.esri-editor .esri-selection-list{width:auto;max-height:max-content;margin-inline:-15px}.esri-editor__actions{flex-direction:column;row-gap:var(--calcite-spacing-xs);width:100%;display:flex}.esri-editor__actions>*{flex-direction:row;display:flex}.esri-editor__actions--notice{flex-direction:row;justify-content:center;align-items:center;gap:var(--calcite-spacing-xs);width:100%;display:flex;font-weight:var(--calcite-font-weight-medium)}.esri-editor__actions--notice calcite-icon{--calcite-icon-color: var(--calcite-color-brand)}.esri-editor__actions calcite-button{flex-grow:1}.esri-editor__update-actions-list{margin-inline:-15px}.esri-editor__help-message{justify-content:flex-start;align-items:center;width:100%;padding-inline:calc(15px - .5rem);display:flex;font-weight:var(--calcite-font-weight-normal)}.esri-editor .esri-feature-form,.esri-editor .esri-batch-attribute-form{width:100%;padding:0}.esri-editor .esri-utility-network-association-list__loading-container{display:flex;justify-content:center;padding:var(--calcite-spacing-md) 0;width:100%}.esri-editor .esri-feature-utility-network-associations,.esri-editor .esri-feature-form-utility-network-association-list,.esri-editor .esri-feature-form-utility-network-association-settings{background-color:transparent}.esri-editor .esri-feature-form-utility-network-association-layers .esri-filter-builder{display:flex;flex-direction:column;align-items:center}.esri-editor .esri-feature-form__label:last-child,.esri-editor .esri-batch-attribute-form__label:last-child{margin-bottom:12px}.esri-editor .esri-item-list{background-color:var(--calcite-color-foreground-1)}.esri-editor .esri-item-list__scroller{margin-inline:-15px}.esri-editor .esri-item-list__group{margin-inline:0}.esri-editor .esri-item-list__group:first-of-type{margin-top:0}.esri-editor .esri-item-list__group__header{padding-inline:15px}.esri-editor .esri-item-list__filter-container,.esri-editor .esri-item-list__filter-container--sticky{background-color:var(--calcite-color-background);margin-block:-12px 12px;margin-inline:-15px;padding-block:12px;padding-inline:15px}.esri-editor__template-item-content-end{margin-inline:.75rem;display:block}.esri-editor__panel-toolbar{--divider-border: 1px solid var(--calcite-color-border-2);border-bottom:var(--divider-border);background-color:var(--calcite-color-foreground-1);overflow-wrap:anywhere;flex-direction:row;display:flex}.esri-editor__settings{border:0;width:100%}.esri-editor__settings .esri-sketch-tooltip-controls:not(:only-child) calcite-block{border-block-end-width:1px;border-style:solid;border-color:var(--calcite-color-border-3)}.esri-editor__feature-templates-container .esri-feature-templates{width:100%}.esri-editor__notice{margin-bottom:var(--calcite-spacing-md)}.esri-editor__notices-panel-section{display:flex;flex-direction:column;gap:var(--calcite-spacing-md, 12px)}.esri-editor .esri-snapping-controls__layer-list{max-height:220px}.esri-editor__panel-content{flex-direction:column;gap:24px;height:auto;min-height:200px;padding-block:18px;padding-inline:15px;display:flex;position:relative}.esri-editor__panel-content__section{position:relative}.esri-editor__panel-content__section__group{flex-direction:column;flex:1 0 100%;display:flex}.esri-editor__panel-content__message{text-align:center;font-size:var(--calcite-font-size-0);flex-grow:1;flex-basis:100%;justify-content:center;align-items:center;padding-inline:15px;display:flex}.esri-editor__panel-content__scrim-container{overflow:hidden}.esri-editor__pending-feature-list-icon{display:flex}.esri-editor__pending-feature-list-icon[icon=exclamation-mark-triangle]{color:var(--calcite-color-status-warning, var(--calcite-color-status-warning-hover))}.esri-editor__sketch-container{--calcite-action-group-border-color: transparent;margin:var(--calcite-spacing-sm, 8px);border-width:var(--calcite-border-width-sm, 1px);border-radius:var(--calcite-corner-radius-round, 4px);border-style:solid;border-color:var(--calcite-color-border-3, var(--calcite-color-border-white));flex-shrink:0;min-height:min-content;position:relative;overflow:hidden}.esri-editor__sketch-container+.esri-editor__panel-content{padding-block-start:0}.esri-editor__update-actions .esri-editor__selection-toolbar-container{margin:0}.esri-editor__sketch-container,.esri-editor__selection-toolbar-container{--calcite-action-group-border-color: transparent;margin:var(--calcite-spacing-sm, 8px);border-width:var(--calcite-border-width-sm, 1px);border-radius:var(--calcite-corner-radius-round, 4px);border-style:solid;border-color:var(--calcite-color-border-3, #dfdfdf);flex-shrink:0;min-height:min-content;position:relative;overflow:hidden}.esri-editor__sketch-container+.esri-editor__panel-content,.esri-editor__selection-toolbar-container+.esri-editor__panel-content{padding-block-start:0}.esri-editor__upload-details{text-align:start;flex-direction:column;gap:24px;min-width:0;display:flex}.esri-editor__upload-details__status{flex-direction:row;align-items:flex-start;gap:15px;display:flex}.esri-editor__upload-details__title-wrapper{flex-direction:column;display:flex}.esri-editor__upload-details__title{line-height:var(--calcite-font-line-height-relative-loose);font-size:var(--calcite-font-size-0);font-weight:var(--calcite-font-weight-medium)}.esri-editor__upload-details__description{font-size:var(--calcite-font-size--1)}.esri-editor__upload-details__loader{flex-shrink:0;width:2rem;height:2rem;margin-inline:0;padding-block:0}.esri-editor__upload-details__icon--success{color:var(--calcite-color-status-success)}.esri-editor__upload-details__icon--error{color:var(--calcite-color-status-danger)}.esri-editor__upload-details__file-list{flex-direction:column;gap:4px;display:flex}.esri-editor__upload-details__file{white-space:break-spaces;word-break:break-all;align-items:center;gap:7px;width:100%;line-height:1em;display:flex;overflow:hidden}.esri-editor__upload-details__file-name{word-break:break-all;font-size:var(--calcite-font-size--3)}.esri-editor__prompt--info{border-top:solid 3px var(--calcite-color-status-info);background-color:var(--calcite-color-background);color:var(--calcite-color-text-1);flex-flow:column;max-height:85%;padding-block:var(--calcite-spacing-md);padding-inline:15px;animation:.25s ease-in-out esri-fade-in-up;display:flex;position:absolute;bottom:0;left:0;right:0;box-shadow:0 1px 2px #0000004d}.esri-editor__prompt--info .esri-editor__prompt__header{color:var(--calcite-color-status-info);flex:none;align-items:center;gap:7px;margin-bottom:var(--calcite-spacing-md);display:flex}.esri-editor__prompt--info .esri-editor__prompt__header__heading{color:var(--calcite-color-text-1);margin:0 3px}.esri-editor__prompt--info .esri-editor__prompt__message{word-break:break-word;color:inherit;flex:auto;padding:0 0 12px;font-weight:var(--calcite-font-weight-normal);overflow:hidden auto}.esri-editor__prompt--info .esri-editor__prompt__divider{color:inherit;border-color:var(--calcite-color-border-2);border-bottom-style:solid;border-bottom-width:1px;flex:none;margin:0 0 12px}.esri-editor__prompt--info .esri-editor__prompt__actions{flex-direction:row;display:flex}.esri-editor__prompt--info .esri-editor__prompt__half-width-button{width:50%}.esri-editor__prompt--warning{border-top:solid 3px var(--calcite-color-status-warning);background-color:var(--calcite-color-background);color:var(--calcite-color-text-1);flex-flow:column;max-height:85%;padding-block:var(--calcite-spacing-md);padding-inline:15px;animation:.25s ease-in-out esri-fade-in-up;display:flex;position:absolute;bottom:0;left:0;right:0;box-shadow:0 1px 2px #0000004d}.esri-editor__prompt--warning .esri-editor__prompt__header{color:var(--calcite-color-status-warning);flex:none;align-items:center;gap:7px;margin-bottom:var(--calcite-spacing-md);display:flex}.esri-editor__prompt--warning .esri-editor__prompt__header__heading{color:var(--calcite-color-text-1);margin:0 3px}.esri-editor__prompt--warning .esri-editor__prompt__message{word-break:break-word;color:inherit;flex:auto;padding:0 0 12px;font-weight:var(--calcite-font-weight-normal);overflow:hidden auto}.esri-editor__prompt--warning .esri-editor__prompt__divider{color:inherit;border-color:var(--calcite-color-border-2);border-bottom-style:solid;border-bottom-width:1px;flex:none;margin:0 0 12px}.esri-editor__prompt--warning .esri-editor__prompt__actions{flex-direction:row;display:flex}.esri-editor__prompt--warning .esri-editor__prompt__half-width-button{width:50%}.esri-editor__prompt--danger{border-top:solid 3px var(--calcite-color-status-danger);background-color:var(--calcite-color-background);color:var(--calcite-color-text-1);flex-flow:column;max-height:85%;padding-block:var(--calcite-spacing-md);padding-inline:15px;animation:.25s ease-in-out esri-fade-in-up;display:flex;position:absolute;bottom:0;left:0;right:0;box-shadow:0 1px 2px #0000004d}.esri-editor__prompt--danger .esri-editor__prompt__header{color:var(--calcite-color-status-danger);flex:none;align-items:center;gap:7px;margin-bottom:var(--calcite-spacing-md);display:flex}.esri-editor__prompt--danger .esri-editor__prompt__header__heading{color:var(--calcite-color-text-1);margin:0 3px}.esri-editor__prompt--danger .esri-editor__prompt__message{word-break:break-word;color:inherit;flex:auto;padding:0 0 12px;font-weight:var(--calcite-font-weight-normal);overflow:hidden auto}.esri-editor__prompt--danger .esri-editor__prompt__divider{color:inherit;border-color:var(--calcite-color-border-2);border-bottom-style:solid;border-bottom-width:1px;flex:none;margin:0 0 12px}.esri-editor__prompt--danger .esri-editor__prompt__actions{flex-direction:row;display:flex}.esri-editor__prompt--danger .esri-editor__prompt__half-width-button{width:50%}.esri-editor__merge-features-list-section{max-height:max(50%,150px)}.esri-editor__merge-features-list{display:flex;flex-direction:column;height:100%;calcite-list{margin-inline:-15px;overflow-y:auto;.esri-item-list__scroller{margin-inline:0}}calcite-chip{cursor:pointer;line-height:initial}}.esri-editor__merge-features-list__item--preserved{--calcite-color-foreground-2: var(--calcite-color-status-success)}.esri-expand__content .esri-editor .esri-feature-form{max-height:fit-content;overflow-y:visible}`,fp=_n(pp),Wi=class Wi extends yn{constructor(){super(...arguments),this.widget=fp(this),this.viewModel=this.widget.viewModel,this.view=this.widget.view,this.activeWorkflow=this.widget.activeWorkflow,this.autoDestroyDisabled=!1,this.headingLevel=this.widget.headingLevel,this.hideCreateFeaturesSection=this.widget.visibleElements.createFeaturesSection,this.hideEditFeaturesSection=this.widget.visibleElements.editFeaturesSection,this.hideFlow=this.widget.visibleElements.flow,this.hideLabelsToggle=this.widget.visibleElements.labelsToggle,this.hideMergeButton=this.widget.visibleElements.mergeButton,this.hideSettingsMenu=this.widget.visibleElements.settingsMenu,this.hideSketch=this.widget.visibleElements.sketch,this.hideSnappingControlsElementsEnabledToggle=this.widget.visibleElements.snappingControlsElements.enabledToggle,this.hideSnappingControlsElementsFeatureEnabledToggle=this.widget.visibleElements.snappingControlsElements.featureEnabledToggle,this.hideSnappingControlsElementsLayerList=this.widget.visibleElements.snappingControlsElements.layerList,this.hideSnappingControlsElementsSelfEnabledToggle=this.widget.visibleElements.snappingControlsElements.selfEnabledToggle,this.hideSplitButton=this.widget.visibleElements.splitButton,this.hideTooltipsToggle=this.widget.visibleElements.tooltipsToggle,this.hideUndoRedoButtons=this.widget.visibleElements.undoRedoButtons,this.hideZoomToButton=this.widget.visibleElements.zoomToButton,this.icon=this.widget.icon,this.label=this.widget.label,this.labelOptions=this.widget.labelOptions,this.layerInfos=this.widget.layerInfos,this.showSnappingControlsElementsHeader=this.widget.visibleElements.snappingControlsElements.header,this.snappingOptions=this.widget.snappingOptions,this.state=this.viewModel.state,this.supportingWidgetDefaults=this.widget.supportingWidgetDefaults,this.tooltipOptions=this.widget.tooltipOptions,this.arcgisPropertyChange=wn()("activeWorkflow","state"),this.arcgisReady=vn(),this.arcgisSketchCreate=ao(()=>this.widget,"sketch-create"),this.arcgisSketchUpdate=ao(()=>this.widget,"sketch-update")}async cancelWorkflow(){await this.widget?.cancelWorkflow()}async deleteFeatureFromWorkflow(){await this.widget?.deleteFeatureFromWorkflow()}async destroy(){await this.manager.destroy()}async startCreateFeaturesWorkflowAtFeatureCreation(t){await this.widget?.startCreateFeaturesWorkflowAtFeatureCreation(t)}async startCreateFeaturesWorkflowAtFeatureTypeSelection(){await this.widget?.startCreateFeaturesWorkflowAtFeatureTypeSelection()}async startUpdateWorkflowAtFeatureEdit(t){await this.widget?.startUpdateWorkflowAtFeatureEdit(t)}async startUpdateWorkflowAtFeatureSelection(){await this.widget?.startUpdateWorkflowAtFeatureSelection()}async startUpdateWorkflowAtMultipleFeatureSelection(t){await this.widget?.startUpdateWorkflowAtMultipleFeatureSelection(t)}};Wi.properties={view:0,activeWorkflow:0,autoDestroyDisabled:5,headingLevel:9,hideCreateFeaturesSection:5,hideEditFeaturesSection:5,hideFlow:5,hideLabelsToggle:5,hideMergeButton:5,hideSettingsMenu:5,hideSketch:5,hideSnappingControlsElementsEnabledToggle:5,hideSnappingControlsElementsFeatureEnabledToggle:5,hideSnappingControlsElementsLayerList:5,hideSnappingControlsElementsSelfEnabledToggle:5,hideSplitButton:5,hideTooltipsToggle:5,hideUndoRedoButtons:5,hideZoomToButton:5,icon:1,label:1,labelOptions:0,layerInfos:0,position:1,referenceElement:1,showSnappingControlsElementsHeader:5,snappingOptions:0,state:3,supportingWidgetDefaults:0,tooltipOptions:0},Wi.styles=hp;let Oi=Wi;kn("arcgis-editor",Oi);const Jh=Object.freeze(Object.defineProperty({__proto__:null,ArcgisEditor:Oi},Symbol.toStringTag,{value:"Module"}));export{Lt as J,Ac as T,Hd as a,Va as b,ch as c,wh as d,Ua as e,Jh as f,Oh as h,hh as i,Nt as l,$h as m,uh as o,Rd as p,Vh as u,Dd as y};
