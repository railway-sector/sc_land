import{L as $,u as L,c as k,b2 as z,f as S,b as a,d as s,i as M,n as E,e as p,l as C,g as G}from"./index-CgzAF5Ey.js";import{v as T}from"./useViewModel-C2OUFn4j.js";import{e as V}from"./AnalysisViewModel-BYdfrYef.js";import j from"./SliceAnalysis-BbjMSf9m.js";import{s as A}from"./useT9n-CtkFUew7.js";import{v as B}from"./heading-Cy1dVKkd.js";import{e as v}from"./globalCss-UPH6MMtF.js";import"./useView-CMtXgKA0.js";import"./geodesicMeasurementUtils-CD0H_C-6.js";import"./geodesicUtils-Cfv0uT1u.js";import"./async-utils-DOK6MVx8.js";import"./maybe-BQxFr9e1.js";import"./handle-YQAj7gpI.js";import"./Analysis-DLCfG2Mt.js";import"./SlicePlane-qYrw7-2F.js";const D=M`.esri-widget__heading{color:var(--calcite-color-text-2);margin:0 0 .5rem;font-weight:var(--calcite-font-weight-semibold)}h1.esri-widget__heading{font-size:var(--calcite-font-size-xl)}h2.esri-widget__heading{font-size:var(--calcite-font-size-md)}h3.esri-widget__heading,h4.esri-widget__heading,h5.esri-widget__heading,h6.esri-widget__heading{font-size:var(--calcite-font-size)}.esri-widget{--esri-widget-padding-x: 15px;--esri-widget-padding-y: var(--calcite-spacing-md);--esri-widget-padding: var(--esri-widget-padding-y) var(--esri-widget-padding-x);box-sizing:border-box;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);font-size:var(--calcite-font-size);line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget *,.esri-widget :before,.esri-widget :after{box-sizing:inherit}.esri-widget.esri-widget--disabled>*{opacity:.4;pointer-events:none}.esri-widget.esri-widget--compact{--esri-widget-padding-y: 0;--esri-widget-padding-x: 0}.esri-widget__anchor{color:var(--calcite-color-text-2)}.esri-widget__anchor:hover{color:var(--calcite-color-text-3)}.esri-widget__anchor:hover,.esri-widget__anchor:focus{text-decoration:underline}.esri-widget__anchor--disabled{opacity:.4;pointer-events:none}.esri-widget__header{background-color:var(--calcite-color-foreground-1);flex:1 0 100%;justify-content:space-between;align-items:center;width:100%;min-height:48px;padding:12px 0 12px 15px;display:flex}.esri-widget__header .esri-widget__heading{width:calc(100% - 48px);text-align:initial;color:var(--calcite-color-text-1);align-items:center;margin:0;padding:0;display:flex}.esri-widget__header-button{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background-color:var(--calcite-color-foreground-1);border:none;flex:0 0 48px;justify-content:center;align-self:stretch;align-items:center;width:48px;padding:0;display:flex}.esri-widget__footer{background-color:var(--calcite-color-foreground-1);justify-content:center;align-items:center;width:100%;min-height:48px;display:flex}.esri-widget__footer-pagination{color:var(--calcite-color-text-2);justify-content:space-between;align-items:center;display:flex}.esri-widget__footer-pagination-previous-button,.esri-widget__footer-pagination-next-button{cursor:pointer;background-color:var(--calcite-color-foreground-1);border:0;margin:0 7px;padding:12px 15px;transition:background-color .125s ease-in-out}.esri-widget__footer-pagination-previous-button:hover,.esri-widget__footer-pagination-previous-button:focus,.esri-widget__footer-pagination-next-button:hover,.esri-widget__footer-pagination-next-button:focus{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1)}.esri-menu{visibility:hidden;z-index:1;background-clip:padding;background-color:var(--calcite-color-foreground-1);background-clip:padding-box;width:100%;max-height:0;margin:2px 0 0;padding:0;font-size:var(--calcite-font-size);line-height:var(--calcite-spacing-xl);position:absolute;top:100%;left:0;overflow:hidden;box-shadow:0 1px 2px #0000004d}.esri-menu .esri-menu__header{color:var(--calcite-color-text-inverse);background-color:var(--calcite-color-inverse);padding:6px 12px}.esri-menu__list{margin:0;padding:0;list-style:none}.esri-menu__list-item{cursor:pointer;border-top:1px solid #adadad4d;border-left:3px solid #0000;padding:.8em 1em}.esri-menu__list-item [class^=esri-icon-],.esri-menu__list-item [class*=" esri-icon-"]{padding-right:2.8px}.esri-menu__list-item:first-child{border-top:none}.esri-menu__list-item--focus,.esri-menu__list-item:hover,.esri-menu__list-item:focus{background-color:var(--calcite-color-foreground-1)}.esri-menu__list-item:active{background-color:var(--calcite-color-foreground-current)}.esri-menu__list-item--active,.esri-menu__list-item--active:hover,.esri-menu__list-item--active:focus{background-color:var(--calcite-color-foreground-1);border-left-color:var(--calcite-color-brand)}.esri-widget__table{border-collapse:collapse;color:var(--calcite-color-text-1);border:none;width:100%;line-height:var(--calcite-font-line-height-relative-tight)}.esri-widget__table tr:nth-child(odd){background-color:var(--calcite-color-transparent)}.esri-widget__table tr:nth-child(2n){background-color:var(--calcite-color-transparent-press)}.esri-widget__table tr a{color:var(--calcite-color-text-2)}.esri-widget__table tr a:hover,.esri-widget__table tr a:focus{color:var(--calcite-color-text-1)}.esri-widget__table tr td,.esri-widget__table tr th{vertical-align:top;word-break:break-word;padding:.5em .7em;font-size:var(--calcite-font-size-sm);font-weight:var(--calcite-font-weight-regular)}.esri-widget__table tr th{text-align:left;border-right:3px solid #0000000d;width:50%}.esri-widget__table tr td{width:50%}.esri-input{color:var(--calcite-color-text-1);background-color:var(--calcite-color-foreground-1);border:1px solid #959595;font-size:var(--calcite-font-size)}.esri-input::-ms-clear{display:none}.esri-input::placeholder{opacity:1;color:var(--calcite-color-text-2)}.esri-input:placeholder-shown{text-overflow:ellipsis}.esri-input[type=text],.esri-input[type=password],.esri-input[type=number]{height:32px;padding:0 .5em}calcite-combobox.esri-input{border:none}.esri-widget__content--empty{text-align:center;color:var(--calcite-color-border-input);flex-flow:column wrap;align-items:center;padding:18px 22px;display:flex}.esri-widget__content--empty h1.esri-widget__heading,.esri-widget__content--empty h2.esri-widget__heading,.esri-widget__content--empty h3.esri-widget__heading,.esri-widget__content--empty h4.esri-widget__heading,.esri-widget__content--empty h5.esri-widget__heading{font-weight:var(--calcite-font-weight-regular)}.esri-widget__content-illustration--empty{width:128px;padding:1rem 0}.esri-widget__content-icon--empty{width:32px;padding:.5rem 0}.esri-select{appearance:none;cursor:pointer;color:var(--calcite-color-text-2);background:var(--calcite-color-foreground-1) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='-8 -8 32 32' width='32' height='32'%3E%3Cpath d='M8 11.207l-4-4V5.793l4 4 4-4v1.414z' fill='%23adadad' fillrule='nonzero'/%3E%3C/svg%3E") 100% no-repeat;border:1px solid #959595;border-radius:0;width:100%;height:32px;margin:0;padding:0 .5em;font-family:inherit;font-size:.85em;display:block}.esri-select[disabled]{cursor:auto}.esri-select::-ms-expand{display:none}.esri-disabled a,.esri-disabled [role=menu],.esri-disabled [role=checkbox],.esri-disabled [class^=esri-icon-],.esri-disabled [class*=" esri-icon-"]{color:var(--calcite-color-text-3)}.keynav-mode .esri-widget:focus,.keynav-mode .esri-widget :focus{z-index:1;outline-offset:2px;outline:2px solid #adadad}.esri-widget__loader-animation{border:.15em solid #adadad4d;border-top-color:var(--calcite-color-border-input);border-radius:100%;width:1em;height:1em;font-size:var(--calcite-font-size-md);animation:1.25s linear infinite esri-rotate;display:block;transform:translateZ(0)}:dir(rtl) .esri-widget__table th{text-align:right;border-left:3px solid #0000000d;border-right:none}:dir(rtl) .esri-select{background-position:0}:dir(rtl) .esri-menu__list-item{border-left:none;border-right:3px solid #0000}:dir(rtl) .esri-menu__list-item [class^=esri-icon-],:dir(rtl) .esri-menu__list-item [class*=" esri-icon-"]{padding-left:2px;padding-right:0}:dir(rtl) .esri-menu__list-item--active{border-right-color:var(--calcite-color-brand)}.esri-icon-font-fallback-text{clip:rect(0 0 0 0);width:1px;height:1px;position:absolute;overflow:hidden}.esri-rotating{animation:1.25s linear infinite esri-rotate;transform:translateZ(0)}.esri-clearfix:before,.esri-clearfix:after{content:" ";display:table}.esri-clearfix:after{clear:both}.esri-interactive{cursor:pointer}.esri-hidden{display:none!important}.esri-invisible{visibility:hidden!important}.esri-offscreen{position:absolute;top:-999em;left:-999em}.esri-match-height{flex-direction:column;flex:auto;display:flex;overflow:hidden}.esri-widget--panel{min-width:300px;min-height:32px;padding:var(--esri-widget-padding);transition:max-height .25s ease-in-out;overflow-y:auto}.arcgis-slice__container{display:flex;overflow-y:auto;--layer-item-background: var(--calcite-color-foreground-2);flex-direction:column;flex-shrink:0;flex-basis:auto;justify-content:space-between;gap:var(--calcite-spacing-md)}.arcgis-slice__error{color:var(--calcite-color-status-danger)}.arcgis-slice__container,.arcgis-slice__hint{display:flex;flex-direction:column;gap:var(--calcite-spacing-md)}.arcgis-slice__error,.arcgis-slice__hint{overflow:hidden;animation:arcgis-slice-fade-in .25s ease-in-out}.arcgis-slice__error p,.arcgis-slice__hint p{margin:0;padding:0}.arcgis-slice__hint:not(:has(*)){display:none}.arcgis-slice__layer-item{--calcite-color-foreground-2: var(--layer-item-background);--calcite-color-foreground-1: var(--layer-item-background)}.arcgis-slice__actions{display:flex;flex-flow:column;gap:var(--calcite-spacing-xxs);justify-content:center}.arcgis-slice__actions:not(:has(*)){display:none}@keyframes arcgis-slice-fade-in{0%{opacity:0}25%{opacity:0}to{opacity:1}}`;var H=Object.defineProperty,P=Object.getOwnPropertyDescriptor,c=(e,i,t,d)=>{for(var l=d>1?void 0:d?P(i,t):i,g=e.length-1,u;g>=0;g--)(u=e[g])&&(l=(d?u(i,t,l):u(l))||l);return d&&l&&H(i,t,l),l};const x=new Set;let n=class extends V{constructor(){super(...arguments),this.supportedViewType="3d",this.unsupportedErrorMessage="SliceViewModel is only supported in 3D views."}async pickLayerToExclude(){const e=this.analysisView;if(e){const i=super.start({operation:t=>e.pickLayerToExclude(t),clear:!1});this._excludingLayers=i,i.finally(()=>{this._excludingLayers===i&&(this._excludingLayers=void 0)}),await i.catch()}}async place(e){await this.analysisView?.place(e)}clearAnalysis(){this.analysis.shape=null}initialize(){x.add(this)}destroy(){x.delete(this)}get state(){return this.disabled||!this.ready?"disabled":this._excludingLayers?"excludingLayer":this.operationState==="active"?"slicing":this.analysis.valid?"sliced":"ready"}get shape(){return this.analysis.shape}set shape(e){this.analysis.shape=e}get tiltEnabled(){return this.analysis.tiltEnabled}set tiltEnabled(e){this.analysis.tiltEnabled=e}get excludedLayers(){return this.analysis.excludedLayers}set excludedLayers(e){this.analysis.excludedLayers=e}get excludeGroundSurface(){return this.analysis.excludeGroundSurface}set excludeGroundSurface(e){this.analysis.excludeGroundSurface=e}async start(){x.forEach(e=>{e.view===this.view&&e!==this&&e.clear()}),await super.start()}onConnectToAnalysisView(e){e.active=!0}constructAnalysis(){return new j}};c([p()],n.prototype,"_excludingLayers",2);c([p({readOnly:!0})],n.prototype,"state",1);c([p()],n.prototype,"shape",1);c([p()],n.prototype,"tiltEnabled",1);c([p()],n.prototype,"excludedLayers",1);c([p()],n.prototype,"excludeGroundSurface",1);n=c([G("esri.components.Slice.SliceViewModel")],n);const o="arcgis-slice",r={base:o,actions:`${o}__actions`,cancelButton:`${o}__cancel-button`,container:`${o}__container`,error:`${o}__error`,excludeButton:`${o}__exclude-button`,hint:`${o}__hint`,hintText:`${o}__hint-text`,layerItem:`${o}__layer-item`,layerList:`${o}__layer-list`,layerListHeading:`${o}__layer-list-title`,newSliceButton:`${o}__clear-button`},I=T(n),h=class h extends ${constructor(){super(...arguments),this.viewModel=I(this),this._messages=A(),this.view=this.viewModel.view,this.analysis=this.viewModel.analysis,this.autoDestroyDisabled=!1,this.excludeGroundSurface=this.viewModel.excludeGroundSurface,this.excludedLayers=this.viewModel.excludedLayers,this.headingLevel=3,this.icon="slice",this.shape=this.viewModel.shape,this.state=this.viewModel.state,this.tiltEnabled=this.viewModel.tiltEnabled,this.arcgisPropertyChange=L()("analysis","state"),this.arcgisReady=k()}get _hasVoxelLayers(){const i=this.viewModel?.view;return i!=null?i.allLayerViews.some(t=>t.type==="voxel-3d"):!1}async clear(){this.viewModel.clear()}async destroy(){await this.manager.destroy()}async start(){z(this.viewModel.start())}load(){this.manager.onLifecycle(()=>[S(()=>this._renderContainerNode(),()=>this.requestUpdate())])}render(){return s`<div class=${a({[r.base]:!0,[v.widget]:!0,[v.panel]:!0})} role=presentation>${this._renderContainerNode()}</div>`}_renderContainerNode(){const i=this._messages,{state:t,visible:d,supported:l}=this.viewModel,g=t==="slicing"||t==="excludingLayer";if(!d||!l)return null;l||s`<div class=${a(r.container)}><div class=${a(r.error)}><p>${this._messages.unsupported}</p></div></div>`;const{excludedLayers:u}=this.viewModel,m=this.excludeGroundSurface,w=u.length>0||m,_=t==="disabled";return s`<div class=${a(r.container)}><div class=${a(r.hint)}>${t==="excludingLayer"?s`<p class=${a(r.hintText)}>${i.excludeHint}</p>`:null}${t==="slicing"?s`<p class=${a(r.hintText)}>${this._hasVoxelLayers?i.voxelHint:i.hint}</p><p class=${a(r.hintText)}>${i.verticalHint}</p>`:null}</div>${!g&&w?s`<div class=${a(r.layerList)}>${B({class:r.layerListHeading,level:this.headingLevel,children:i.excludedLayers})}${N({layers:u.toArray(),excludeGroundSurface:m,onLayerClick:b=>{this.excludedLayers.remove(b)},onGroundClick:()=>{this.excludeGroundSurface=!1},listLabel:i.excludedLayers,layerActionLabel:i.includeLayer,groundItemTitle:i.ground})}</div>`:null}<div class=${a(r.actions)}>${g?null:s`<calcite-button class=${a(r.newSliceButton)} .disabled=${_} @click=${this.start}>${i.newSlice}</calcite-button>`}${t==="sliced"?s`<calcite-button appearance=outline-fill class=${a(r.excludeButton)} .disabled=${_} @click=${()=>this.viewModel.pickLayerToExclude()}>${i.excludeLayer}</calcite-button>`:null}${t==="excludingLayer"?s`<calcite-button appearance=outline-fill class=${a(r.cancelButton)} .disabled=${_} @click=${()=>this.viewModel.stop()}>${i.cancel}</calcite-button>`:null}</div></div>`}};h.properties={_hasVoxelLayers:16,view:0,analysis:0,autoDestroyDisabled:5,excludeGroundSurface:5,excludedLayers:0,headingLevel:9,icon:3,label:1,messageOverrides:0,position:1,referenceElement:1,shape:0,state:35,tiltEnabled:5},h.styles=D;let f=h;function y(e){return s`<calcite-list-item class=${a(r.layerItem)} data-testid=${`list-item-${e.uid}`} .label=${e.title??""}><calcite-action icon=x @click=${e.onClick} scale=s slot=actions-end .text=${e.actionLabel} title=${e.actionLabel??E}></calcite-action></calcite-list-item>`}function N(e){const i=e.layers.map(t=>y({uid:t.uid,title:t.title??"",onClick:()=>e.onLayerClick(t),actionLabel:e.layerActionLabel}));return e.excludeGroundSurface&&i.push(y({uid:"ground",title:e.groundItemTitle,onClick:e.onGroundClick,actionLabel:e.layerActionLabel})),s`<calcite-list .label=${e.listLabel} selection-mode=none>${i}</calcite-list>`}C("arcgis-slice",f);export{f as ArcgisSlice};
