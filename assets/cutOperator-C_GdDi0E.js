import{aQ as F}from"./index-BrQW8HOS.js";import{a as D,c as U,n as H}from"./Point2D-DNXcsliy.js";import{d as w,aU as K,H as N,u as g,ad as x,aV as b,aW as I,aX as P,aY as R,aZ as Q,aO as j,a_ as W}from"./ProjectionTransformation-BjD312Kq.js";import"./Envelope2D-CUWyosZh.js";import"./jsonConverter-BHYd2kGf.js";import{t as X}from"./SimpleGeometryCursor-B92kdZ15.js";import{getSpatialReference as Y,fromSpatialReference as q,fromPolyline as B,fromGeometry as J,toGeometry as L}from"./apiConverter---8F7iZ4.js";var V=W;function f(l,e){return{m_geometry:l,m_side:e}}function tt(l,e,o,t,u,n){if(e.isEmpty()){const i=f(e,0);return void u.push(i)}if(o.isEmpty()){const i=f(e,0);return void u.push(i)}const s=[],r=new x;{const i=r.createGeometryUserIndex(),C=r.addGeometry(e),S=r.addGeometry(o),d=new R(n);let p=0,c=null;if(r.hasCurves()){c=new V;const h=r.getEnvelope2D(n);p=b(t.total());const _=I(t.total(),h);P(r,_,t.total(),12e3,c,null,n)}r.dbgVerifyCurves(),d.setEditShapeCrackAndCluster(r,t),d.cut(l,i,C,S,s);for(const h of s){c!==null&&c.stitchCurves(r,h,p,!1);const _=f(r.getGeometry(h),Q(r.getGeometryUserIndex(h,i)));u.push(_)}c!==null&&c.clearStitcher(r)}}function et(l,e,o,t,u,n){if(e.isEmpty()){const i=f(e,0);return void u.push(i)}if(o.isEmpty()){const i=f(e,0);return void u.push(i)}const s=[],r=new x;{const i=r.createGeometryUserIndex(),C=r.addGeometry(e),S=r.addGeometry(o),d=new R(n);let p=0,c=null;if(r.hasCurves()){c=new V;const a=r.getEnvelope2D(n);p=b(t.total());const y=I(t.total(),a);P(r,y,t.total(),12e3,c,null,n)}r.dbgVerifyCurves(),d.setEditShapeCrackAndCluster(r,t),d.cut(!1,i,C,S,s),c!==null&&c.stitchCurves(r,j,p,!0);let h=r.getGeometry(C);const _=new g,E=new g,v=[];for(let a=0;a<s.length;a++){let y=null;{const m=new x,k=m.addGeometry(h),T=m.addGeometry(r.getGeometry(s[a]));if(m.hasCurves()){const A=m.getEnvelope2D(n);p=b(t.total());const Z=I(t.total(),A);P(m,Z,t.total(),12e3,c,null,n)}d.setEditShapeCrackAndCluster(m,t);const O=d.intersection(k,T);if(c!==null&&c.stitchCurves(m,j,p,!0),y=m.getGeometry(O),y.isEmpty())continue;const G=r.getGeometryUserIndex(s[a],i);G===2?_.add(y,!1):G===1?E.add(y,!1):v.push(y)}{const m=new x,k=m.addGeometry(h),T=m.addGeometry(r.getGeometry(s[a]));if(m.hasCurves()){const G=m.getEnvelope2D(n);p=b(t.total());const A=I(t.total(),G);P(m,A,t.total(),12e3,c,null,n)}d.setEditShapeCrackAndCluster(m,t);const O=d.difference(k,T);c!==null&&c.stitchCurves(m,j,p,!0),h=m.getGeometry(O)}}if(!h.isEmpty()&&s.length>0&&v.push(h),_.isEmpty()&&E.isEmpty())return;if(!_.isEmpty()){const a=f(_,1);u.push(a)}if(!E.isEmpty()){const a=f(E,2);u.push(a)}for(let a=0,y=v.length;a<y;++a){const m=f(v[a],3);u.push(m)}}}class st{getOperatorType(){return 10005}accelerateGeometry(e,o,t){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,o,t,u,n){return new rt(e,o,t,u,n)}}class rt extends X{constructor(e,o,t,u,n){super(),this.m_cutIndex=-1,this.m_cuts=[],this.m_progressTracker=n,this.m_cuttee=o.clone(),this.m_cutter=new w({copy:t}),this.m_bConsiderTouch=e;const s=K(o,t);this.m_tolerance=N(u,s,!0)}next(){return this.m_cutIndex===-1&&this.generateCuts(),++this.m_cutIndex<this.m_cuts.length?this.m_cuts[this.m_cutIndex]:null}getGeometryID(){return this.m_cutIndex}tock(){return!0}getRank(){return 1}generateCuts(){switch(this.m_cuttee.getGeometryType()){case D.enumPolyline:this.generatePolylineCuts();break;case D.enumPolygon:this.generatePolygonCuts()}}generatePolylineCuts(){const e=new w,o=new w,t=new w;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(o);const u=[];tt(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,u,this.m_progressTracker);for(let n=0;n<u.length;n++){const s=u[n];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2||s.m_side===4?o.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):U("")}t.isEmpty()||e.isEmpty()&&o.isEmpty()&&!(this.m_cuts.length>=3)||this.m_cuts.push(t),e.isEmpty()&&o.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}generatePolygonCuts(){const e=new g,o=new g,t=new g;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(o);const u=[];et(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,u,this.m_progressTracker);for(let n=0;n<u.length;n++){const s=u[n];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2?o.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):U("")}H(t.isEmpty()||u.length===1),e.isEmpty()&&o.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}}const $=new st;function ot(l,e,o){const t=$.execute(!0,l,e,o,null);return Array.from(t)}function nt(){return $.supportsCurves()}function z(l,e){const o=Y(l);return ot(J(l),B(e),q(o)).map(t=>L(t,o)).filter(F)}const M=nt(),dt=Object.freeze(Object.defineProperty({__proto__:null,execute:z,supportsCurves:M},Symbol.toStringTag,{value:"Module"})),pt=Object.freeze(Object.defineProperty({__proto__:null,execute:z,supportsCurves:M},Symbol.toStringTag,{value:"Module"}));export{pt as c,dt as i};
