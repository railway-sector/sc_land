import{Y as dt,O as ee,_ as c,e as f,g as Se,ch as yt,dh as $e,$ as Ut,iA as Xt,tQ as Yt,aY as Fe,BR as Qt,C$ as gt,jc as Le,aE as be,tP as en,f as tn,Z as nn,D0 as st,ot as rn,kz as Pe,eX as sn,cI as an,D1 as on,x2 as un,ba as ln,by as ne,am as X,bn as cn,bl as ye,ar as h,gC as T,be as M,gE as L,aC as B,aq as U,bh as me,D2 as Ze,em as W,gL as fn,bo as _e,bf as Ce,bp as ve,kM as Me,D3 as He,D4 as $t,aI as bt,D5 as mt,az as te,aK as ge,aL as pn,kK as E,gM as vt,kw as hn,D6 as dn,bb as w,p1 as yn,aJ as gn,aQ as $n,D7 as bn,D8 as mn,u2 as vn,D9 as xt,kL as wt,oA as St,bB as xn,p3 as wn,qG as Sn,Da as Ln,Db as _n,Dc as Mn,Dd as Tn,bg as zn,De as it,aw as Nn,Df as kn,a7 as En,b9 as re,tt as k,ad as Rn,pK as Dn,pL as jn,e5 as On,ab as qn,pB as Pn,Dg as Zn,pM as Hn,tO as An,tM as Lt,fK as De}from"./index-BrQW8HOS.js";import{r as In}from"./utils-D_VO_1nP.js";import{j as Ae,q as Ge,b as Be,R as Vn}from"./geodesicUtils-BJZXB7Hp.js";import{g as Fn}from"./geometry2dUtils-kADrF-iP.js";import{m as Cn,l as _t}from"./geodeticLengthOperator-DifrZujk.js";import{t as Mt}from"./geodesicMeasurementUtils-CQw8IWGR.js";let F=class extends dt{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new ee}};c([f({constructOnly:!0})],F.prototype,"layer",void 0),c([f()],F.prototype,"enabled",void 0),c([f()],F.prototype,"updating",void 0),c([f()],F.prototype,"availability",void 0),c([f()],F.prototype,"sublayerSources",void 0),F=c([Se("esri.views.interactive.snapping.FeatureSnappingLayerSource")],F);let j=class extends yt{constructor(){super(...arguments),this.enabled=!0}};c([f({type:Boolean})],j.prototype,"enabled",void 0),j=c([Se("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],j);let g=class extends yt{constructor(e){super(e),this.lineSnapper=new j,this.parallelLineSnapper=new j,this.rightAngleSnapper=new j,this.rightAngleTriangleSnapper=new j,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new $e([255,127,0]),this.orangeTransparent=new $e([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};c([f({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"lineSnapper",void 0),c([f({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"parallelLineSnapper",void 0),c([f({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleSnapper",void 0),c([f({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleTriangleSnapper",void 0),c([f({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"shortLineThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"distance",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"intersectionParallelLineThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"parallelLineThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"verticalLineThresholdMeters",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"touchSensitivityMultiplier",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointOnLineThreshold",void 0),c([f({type:$e,nonNullable:!0})],g.prototype,"orange",void 0),c([f({type:$e,nonNullable:!0})],g.prototype,"orangeTransparent",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthReference",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthTarget",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"lineHintFadedExtensions",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"parallelLineHintWidth",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],g.prototype,"parallelLineHintLength",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"parallelLineHintOffset",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],g.prototype,"rightAngleHintSize",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],g.prototype,"rightAngleHintOutlineSize",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"satisfiesConstraintScreenThreshold",void 0),g=c([Se("esri.views.interactive.snapping.Settings.Defaults")],g);const at=new g;let S=class extends dt{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new ee,this.distance=at.distance,this.touchSensitivityMultiplier=at.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){const e=this.featureSources;e.some(ot)&&Ut.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const n=e.filter(Bn),r=this._get("_effectiveFeatureSources")?.filter(ot)??new ee;for(const u of n){const l=r.find(p=>p.layer===u.layer.parent);if(l)l.sublayerSources.includes(u)||l.sublayerSources.add(u);else if(u.layer.parent){const p=new F({layer:u.layer.parent});p.sublayerSources.add(u),r.add(p)}}for(const u of r){const l=u.sublayerSources.filter(p=>!n.includes(p));u.sublayerSources.removeMany(l)}r.removeMany(r.filter(u=>u.sublayerSources.length===0));const i=e.filter(Gn),s=this._get("_effectiveFeatureSources")??new ee,{added:a,removed:o}=Xt(s.toArray(),[...i,...r]);return s.removeMany(o),s.addMany(a),s}};function ot(t){return t.layer.type==="subtype-group"}function Gn(t){return t.layer.type!=="subtype-group"}function Bn(t){return t.layer.type==="subtype-sublayer"}c([f()],S.prototype,"enabled",void 0),c([f()],S.prototype,"enabledToggled",void 0),c([f()],S.prototype,"forceDisabled",void 0),c([f()],S.prototype,"selfEnabled",void 0),c([f()],S.prototype,"featureEnabled",void 0),c([f()],S.prototype,"gridEnabled",void 0),c([f()],S.prototype,"attributeRulesEnabled",void 0),c([f({type:ee.ofType(F)})],S.prototype,"featureSources",void 0),c([f()],S.prototype,"distance",void 0),c([f()],S.prototype,"touchSensitivityMultiplier",void 0),c([f({readOnly:!0})],S.prototype,"effectiveEnabled",null),c([f({readOnly:!0})],S.prototype,"effectiveGridEnabled",null),c([f({readOnly:!0})],S.prototype,"effectiveSelfEnabled",null),c([f({readOnly:!0})],S.prototype,"effectiveFeatureEnabled",null),c([f({readOnly:!0})],S.prototype,"_effectiveFeatureSources",null),S=c([Se("esri.views.interactive.snapping.SnappingOptions")],S);function Tt(t,e,n){return z(t,e,n)}function z(t=0,e=0,n=0){return be(t,e,n)}function rs(t){return t}function ss(t){return t}function K(t,e,n){return be(t,e,n)}function Y(t){const[e,n,r]=t;return t.length>3?[e,n,r,t[3]]:[e,n,r]}function is(t){return t[3]=1|((t.length>3?t[3]:void 0)??0),t}function as(t){return!!(1&((t.length>3?t[3]:void 0)??0))}function ut(t,e,{coordinateHelper:n,elevationInfo:r},i){return t?Wn(n.vectorToDehydratedPoint(t,Kn),e,r,i):null}function Wn(t,e,n,r=z()){return r[0]=t.x,r[1]=t.y,r[2]=t.z??0,e==null||(e.type==="2d"?r[2]=0:r[2]=Yt(e,t,n,Fe)??0),r}function os(t,e,n){return n?(gt(n,t[0],t[1],t[2],e),n):Le(t[0],t[1],t[2],e)}function us(t,e,{z:n,m:r},i,s){const{spatialReference:a,elevationInfo:o}=i;let u;n==null&&r==null?u=void 0:e==null||e.type==="2d"?u=n??void 0:u=Qt(e,t,a,Fe,o)??0;const[l,p]=t;return s?gt(s,l,p,u,a):s=Le(l,p,u,a),r!=null&&(s.m=r,s.hasM=!0),s}function ls(t,e,n,r,i=z()){const[s,a]=t;return i[0]=s,i[1]=a,t.length>3&&(i[3]=t[3]??0),n?.type!=="3d"?(i[2]=e.value,i):(i[2]=en(n,s,a,e.value,r,e.elevationInfo,Fe)??0,i)}const Kn=Le(0,0,0,null),cs=Symbol("grid-placement-graphic");function Jn(t,e){const n=t.x-e.x,r=t.y-e.y;return n*n+r*r}function fs(t,e){return Math.sqrt(Jn(t,e))}function ps(t,e){e.sort((n,r)=>Pe(n.targetPoint,t)-Pe(r.targetPoint,t))}function hs({parameters:{point:t,distance:e,returnEdge:n,vertexMode:r,coordinateHelper:{spatialReference:i},filter:s},mode:a,returnZ:o,filter:u}){const l=u?.clone()??new sn({where:"1=1"});return l.returnZ=o??a==="3d",s&&(l.geometry=s.geometry,l.distance=s.distance,l.spatialRelationship=s.spatialRelationship,l.where=an(l.where,s.where),l.timeExtent=on(l.timeExtent,s.timeExtent),l.objectIds=Un(l.objectIds,s.objectIds)),{point:Le(t[0],t[1],t[2],i.toJSON()),mode:a,distance:e,returnEdge:n,vertexMode:r,query:l.toJSON()}}function Un(t,e){return t||e?e?t?Array.from(un(new Set(t),new Set(e))):e:t:null}function ds(t,e,n){return{left:ut(t.leftVertex.pos,e,n),right:ut(t.rightVertex.pos,e,n)}}const lt=Symbol("snapping-toggle");function ys(t,e=()=>{}){const n=tn(()=>({view:t.view,snappingOptions:t.snappingOptions}),({view:r,snappingOptions:i})=>{if(t.removeHandles(lt),!r||!i)return;const s=rn.TOOL,a=[r.on("key-down",o=>{o.key!==st.toggle||o.repeat||(i.enabledToggled=!0,e())},s),r.on("key-up",o=>{o.key===st.toggle&&(i.enabledToggled=!1,e())},s),r.on("pointer-move",o=>{const u=o.native.ctrlKey;i.enabledToggled!==u&&(i.enabledToggled=u,e())},s)];t.addHandles(a,lt)},nn);t.addHandles(n)}function gs(t){return In(t)&&"utilityNetworks"in t&&!!t.utilityNetworks?.length}function $s(t){return t?.type==="line"}function We({start:t,end:e,type:n},r,i){const s=[],a=X(se,e,t),o=X(Te,t,r),u=ve(a),l=2*_e(a,o),p=l*l-4*u*(ve(o)-i*i);if(p===0){const d=-l/(2*u);(n===0||d>=0)&&s.push(ye(U(),t,a,d))}else if(p>0){const d=Math.sqrt(p),b=(-l+d)/(2*u);(n===0||b>=0)&&s.push(ye(U(),t,a,b));const $=(-l-d)/(2*u);(n===0||$>=0)&&s.push(ye(U(),t,a,$))}return s}function zt(t,e){const n=t.start,r=t.end,i=X(se,r,n),s=B(Ne,-i[1],i[0],0),a=e.start,o=e.end,u=T(Je,o,a),l=M(u,s),p=B(qt,n[0],n[1],0),d=T(Pt,p,a),b=M(d,s),$=ne();if(Math.abs(l)<$)return[];const x=L(Zt,a,u,b/l);if(e.type===0){const _=T(Ie,x,a);if(M(_,u)<-$)return[]}if(t.type===1){const _=fn(Te,x,n);if(_e(_,i)<-$)return[]}return[W(x)]}function Xn(t,e){return Qn(xe(Ue,e[2],t),e)}function Nt(t,e){return jt(xe(Ue,0,t),xe(rr,0,e)).map(([r,i])=>ge(r,i))}function kt(t,e,n){return Rt(t,xe(Ue,t[2],e),n)}function Et(t,e,n,r=h()){const i=X(se,t,e),s=cn(i);return ye(r,e,i,s===0?1:n/s),r[2]=t[2],r}function Rt(t,{start:e,end:n,type:r},i=h()){const s=T(ze,t,e),a=T(Ne,n,e),o=M(s,a)/M(a,a);return L(i,e,a,r===0?Math.max(o,0):o)}const Yn=(()=>{const t=h(),e=h(),n=h();return({start:r,end:i},{center:s,radius:a,normal:o,slicePlane:u})=>{const l=Me(s,o,nr);if(y(He(l,r),0)&&y(He(l,i),0)){$t(o,t,e);const d=(x,_)=>(Ce(n,_,s),vt(x,M(n,t),M(n,e)),x),b=Fn({start:d(se,r),end:d(Te,i)},hn,a),$=[];for(const[x,_]of b){const N=bt(h(),s);L(N,N,t,x),L(N,N,e,_),u&&!G(u,N)||$.push(N)}return $}const p=h();return mt(l,r,i,p)?!y(te(p,s),a)||u&&!G(u,p)?[]:[p]:[]}})();function Dt({start:t,end:e,type:n},r,i){const s=[],a=Ce(ze,e,t),o=X(Te,t,r),u=ve(a),l=2*_e(a,o),p=l*l-4*u*(ve(o)-i*i);if(p===0){const d=-l/(2*u);(n===1||d>=0)&&s.push(L(h(),t,a,d))}else if(p>0){const d=Math.sqrt(p),b=(-l+d)/(2*u);(n===1||b>=0)&&s.push(L(h(),t,a,b));const $=(-l-d)/(2*u);(n===1||$>=0)&&s.push(L(h(),t,a,$))}return s}function jt(t,e){const n=t.start,r=t.end,i=e.start,s=e.end,a=T(ze,r,n),o=T(Ne,s,i),u=T(Je,i,n),l=me(qt,a,o);if(!y(M(u,l),0))return[];const p=Ze(l);if(y(p,0))return[];const d=me(Pt,u,o),b=M(d,l)/p,$=L(Zt,n,a,b);if(t.type===0){const x=T(Ie,$,n);if(M(a,x)<-ne())return[]}if(e.type===0){const x=T(Ie,$,i);if(M(o,x)<-ne())return[]}return[W($)]}function Qn({start:t,end:e,type:n},r){const i=T(ze,r,t),s=T(Ne,e,t),a=me(Je,s,i),o=Ze(a)/Ze(s),u=ne();if(o<u)switch(n){case 1:return[W(r)];case 0:return M(s,i)<-u?[]:[W(r)]}return[]}function Ke(t,e,n,r){const[i,s]=t,[a,o]=n,u=a-i,l=o-s,p=u*u+l*l,d=Math.sqrt(p);if(d>e+r)return[];if(d<Math.abs(e-r))return[];if(y(d,0)&&y(e,r))return[];const b=(e*e-r*r+p)/(2*d),$=Math.sqrt(e*e-b*b),x=$*l/d,_=$*u/d,[N,J]=pn(se,t,n,b/d);return y(x,_)?[ge(N,J)]:[ge(N+x,J-_),ge(N-x,J+_)]}function xe(t,e,{start:n,end:r,type:i}){return B(t.start,n[0],n[1],e),B(t.end,r[0],r[1],e),t.type=tr[i],t}function Ot(t,e){return y(t[2],e[2])}function y(t,e){return ln(Math.abs(t-e),0,ne())}function er(t,e){return e.filter(n=>G(t,n))}function G(t,e){return dn(t,e)}const tr={0:1,1:0},se=U(),Te=U(),ze=h(),Ne=h(),Je=h(),qt=h(),Pt=h(),Zt=h(),Ie=h(),nr=E(),Ue={start:h(),end:h(),type:1},rr={start:h(),end:h(),type:1};class R{intersect(e){return H(this,e)}closestPoints(e){return[this.closestTo(e)]}}class ie extends R{constructor(e){super(),this.point=e}equals(e){return this===e||D(e)&&w(this.point,e.point)}closestTo(){return Y(this.point)}}class Xe extends R{constructor(e,n,r){super(),this.start=e,this.end=n,this.lineLike={start:e,end:n,type:r}}equals(e){return this===e||q(e)&&this.lineLike.type===e.lineLike.type&&w(this.start,e.start)&&w(this.end,e.end)}closestTo(e){const n=z();return Rt(e,this.lineLike,n),n}}class Ht extends Xe{constructor(e,n){super(e,n,1)}}class sr extends Xe{constructor(e,n){super(e,n,0)}}class At extends R{constructor(e){super(),this.constraints=e}equals(e){return this===e||Ve(e)&&xn(this.constraints,e.constraints,(n,r)=>n.equals(r))}closestTo(e){let n,r=1/0;for(const i of this.constraints){const s=i.closestTo(e),a=Pe(e,s);a<r&&(r=a,n=s)}return Y(n??e)}closestPoints(e){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(e))}}class ir extends R{constructor(e,n){super(),this.center=e,this.radius=n}equals(e){return this===e||Z(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const n=z();return Et(e,this.center,this.radius,n),n}}class Ye extends R{constructor(e,n){super(),this.center=e,this.radius=n}equals(e){return this===e||I(e)&&w(this.center,e.center)&&this.radius===e.radius}closestTo(e){const n=z();return Et(e,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new Qe(Y(this.center),this.radius,K(0,0,1))}}class Qe extends R{constructor(e,n,r,i=void 0){super(),this.center=e,this.radius=n,this.normal=r,this.slicePlane=i}equals(e){return this===e||C(e)&&w(this.center,e.center)&&w(this.normal,e.normal)&&this.radius===e.radius}closestTo(e){const{center:n,radius:r}=this;xt(this.getPlane(ar),e,je);const i=T(je,je,n),s=wn(i);if(y(s,0))return Y(e);const a=r/Math.sqrt(s),o=z();L(o,n,i,a);const{slicePlane:u}=this;return u&&!G(u,o)?tt(u,this)?.closestTo(e)??Y(e):o}getPlane(e=E()){return Me(this.center,this.normal,e)}}const je=h(),ar=E();class or extends R{constructor(e){super(),this.z=e}equals(e){return this===e||A(e)&&this.z===e.z}closestTo(e){return K(e[0],e[1],this.z)}getPlane(e=E()){return B(ct,0,0,this.z),Me(ct,bn,e)}}const ct=h();class et extends R{constructor(e,n,r){super(),this.start=e,this.end=n,this.planeLike={start:e,end:n,type:r}}equals(e){return this===e||P(e)&&this.planeLike.type===e.planeLike.type&&w(this.start,e.start)&&w(this.end,e.end)}closestTo(e){const n=z();return kt(e,this.planeLike,n),n}closestEndTo(e){const{start:n,end:r}=this.planeLike;return Math.sign(_e(X(ur,r,n),X(lr,e,n)))>0?this.end:this.start}getPlane(e=E()){const n=bt(ft,this.end);return n[2]+=1,yn(this.start,this.end,n,e)}getSlicePlane(e=E()){const{start:n,end:r,type:i}=this.planeLike;if(i===0)return;const s=B(ft,n[0],n[1],0),a=B(pt,r[0],r[1],0),o=Ce(pt,a,s);return Me(s,o,e),e}}const ur=U(),lr=U(),ft=h(),pt=h();class bs extends et{constructor(e,n){super(e,n,1)}}class ms extends et{constructor(e,n){super(e,n,0)}}class cr extends R{constructor(e,n){super(),this.sphere=Sn(e,n),this._center=W(e)}equals(e){return this===e||V(e)&&Ln(this.sphere,e.sphere)}closestTo(e){const n=z();return _n(this.sphere,e,n),n}get center(){return this._center}get radius(){return this.sphere[3]}}class fr extends R{constructor(e,n,r){super(),this.start=e,this.end=n,this.getZ=r,this.planeLike={start:e,end:n,type:0}}equals(e){return this===e||we(e)&&w(this.start,e.start)&&w(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return $r(this,e)}addIfOnTheGround(e,n){for(const r of n){const i=this.getZ(r[0],r[1])??0;y(r[2],i)&&(r[2]=i,e.push(r))}}}class pr extends R{constructor(e,n,r){super(),this._x=e,this._y=n,this._z=r}equals(e){return this===e||Dr(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,n,r]){return Tt(this._x??e,this._y??n,this._z??r)}}class hr extends R{constructor(e,n,r,i,s){super(),this._origin=e,this._spatialReference=n,this._distanceMeters=r,this._z=i,this._directionDegrees=s}equals(e){return this===e||Rr(e)&&it(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._z===e._z&&this._directionDegrees===e._directionDegrees}closestTo([e,n,r]){return vt(Q,e,n),it(Q,this._origin)||this._applyDirectionAndDistance(Q),Tt(Q[0],Q[1],this._z??r)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)Ae(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)yr(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:n}=Ge(dr,this._origin,e,this._spatialReference);Ae(e,this._origin,n??0,this._distanceMeters,this._spatialReference)}}}const Q=[0,0],dr=new Be;function yr(t,e,n,r,i){let{azimuth:s,distance:a}=Ge(gr,e,r,i);s??=0;let o=a*Math.cos((s-n)*En);o=Math.max(0,o),Ae(t,e,n,o,i)}const gr=new Be;function $r(t,e){const n=z();return kt(e,t.planeLike,n),n[2]=t.getZ(n[0],n[1])??Vt,n}function H(t,e){if(Ve(t)){const n=[];for(const r of t.constraints){const i=r.intersect(e);i&&n.push(i)}return nt(n)}if(Ve(e))return H(e,t);if(we(t))return ht(t,e);if(we(e))return ht(e,t);if(D(t)){const{point:n}=t;if(D(e))return w(n,e.point)?t:void 0;const r=e.closestTo(n);return gn(r,n)?t:void 0}if(q(t)){if(D(e))return H(e,t);if(q(e))return O(jt(t.lineLike,e.lineLike));if(A(e))return br(t,e);if(P(e))return O(zt(e.planeLike,t.lineLike));if(Z(e))return O(Dt(t.lineLike,e.center,e.radius));if(C(e))return O(Yn(t.lineLike,e));if(I(e))return mr(t,e);if(V(e))return vr(t,e)}else if(A(t)){if(D(e)||q(e))return H(e,t);if(A(e))return xr(t,e);if(P(e))return wr(t,e);if(Z(e))return Sr(t,e);if(C(e))return _r(t,e);if(I(e))return Lr(t,e);if(V(e))return Mr(t,e)}else if(P(t)){if(D(e)||q(e)||A(e))return H(e,t);if(P(e))return Oe(Nt(t.planeLike,e.planeLike));if(Z(e))return Oe(We(t.planeLike,e.center,e.radius));if(C(e))return zr(t,e);if(I(e))return Tr(t,e);if(V(e))return Nr(t,e)}else if(Z(t)){if(D(e)||q(e)||A(e)||P(e))return H(e,t);if(Z(e))return Oe(Ke(t.center,t.radius,e.center,e.radius));if(C(e))return void 0;if(I(e))return kr(t,e);if(V(e))return void 0}else if(C(t)){if(D(e)||q(e)||A(e)||P(e)||Z(e))return H(e,t);if(C(e))return void 0;if(I(e))return e.asCircle(),void 0;if(V(e))return void 0}else if(I(t)){if(D(e)||q(e)||A(e)||P(e)||Z(e)||C(e))return H(e,t);if(I(e))return Er(e,t);if(V(e))return void 0}else if(V(t)){if(D(e)||q(e)||A(e)||P(e)||Z(e)||I(e))return H(e,t);if(V(e))return void 0}}const br=(()=>{const t=E();return(e,n)=>{const{start:r,end:i}=e;if(Ot(r,i)&&y(r[2],n.z))return e;const s=z();return mt(n.getPlane(t),r,i,s)?new ie(s):void 0}})();function mr({lineLike:t},{center:e,radius:n}){const r=e[2];return O(Dt(t,e,n).filter(i=>y(i[2],r)))}function vr({lineLike:t},{sphere:e}){return O(mn(e,t.start,t.end))}const tt=(()=>{const t=Nn(),e=h(),n=h();return(r,i,s)=>{const{normal:a,center:o,radius:u}=i;$t(a,e,n);const l=wt(r),p=u*M(l,e),d=u*M(l,n);Mn(t,o[0],o[1],o[2],1);const b=Tn(r,t),$=Math.hypot(p,d),x=y($,0);if(y(He(r,o),0)){if(x)return i;if(y(u,0))return!s||G(s,o)?new ie(Y(o)):void 0;me(e,l,a),zn(e,e);const Re=new Array,le=W(o);L(le,le,e,u),s&&!G(s,le)||Re.push(le);const ce=W(o);return L(ce,ce,e,-u),s&&!G(s,ce)||Re.push(ce),O(Re)}if(x)return;const _=-b/$;if(Math.abs(_)>1||y(_,1))return;const N=Math.atan(p/d),J=kn(_)-N,rt=Math.PI-J,ae=new Array,oe=h();L(oe,o,e,u*Math.cos(J)),L(oe,oe,n,u*Math.sin(J)),ae.push(oe);const ue=h();return L(ue,o,e,u*Math.cos(rt)),L(ue,ue,n,u*Math.sin(rt)),ae.push(ue),O(s?er(s,ae):ae)}})();function xr(t,e){return y(t.z,e.z)?t:void 0}function wr({z:t},{planeLike:e}){const[n,r]=e.start,[i,s]=e.end,a=K(n,r,t),o=K(i,s,t);return e.type===0?new Ht(a,o):new sr(a,o)}function Sr(t,e){const[n,r]=e.center;return new Ye(K(n,r,t.z),e.radius)}function Lr(t,e){return y(e.center[2],t.z)?e:void 0}const _r=(()=>{const t=E();return(e,n)=>tt(e.getPlane(t),n,n.slicePlane)})();function Mr(t,{center:e,radius:n}){const r=Math.abs(e[2]-t.z);if(r>n&&!y(r,n))return;const i=K(e[0],e[1],t.z),s=Math.sqrt(n**2-r**2);return y(s,0)?void 0:new Ye(i,s)}const Tr=(()=>{const t=E();return(e,{center:n,radius:r})=>{const i=We(e.planeLike,n,r),s=n[2];e.getSlicePlane(t);const a=new Array;for(const[o,u]of i){const l=[o,u,s];G(t,l)&&a.push(l)}return O(a)}})(),zr=(()=>{const t=E(),e=E();return(n,r)=>tt(n.getPlane(t),r,n.getSlicePlane(e))})(),Nr=(()=>{const t=E();return(e,{center:n,radius:r})=>{const i=e.getPlane(t),s=vn(i,n),a=Math.abs(s);if(a>r&&!y(a,r))return;const o=Math.sqrt(r**2-s**2);if(y(o,0)){const p=z();return xt(i,n,p),new ie(p)}const u=z(),l=W(wt(i));return L(u,n,l,s),new Qe(u,o,l,e.getSlicePlane())}})();function kr(t,e){const n=St(t.center,e.center);return y(n,0)&&y(t.radius,e.radius)?e:It(Ke(t.center,t.radius,e.center,e.radius),e.center[2])}function Er(t,e){if(!Ot(t.center,e.center))return;const n=St(t.center,e.center);return y(n,0)&&y(t.radius,e.radius)?t:It(Ke(t.center,t.radius,e.center,e.radius),t.center[2])}function ht(t,e){const{planeLike:n,getZ:r}=t,i=new Array;if(D(e))t.addIfOnTheGround(i,Xn(n,e.point));else if(q(e))t.addIfOnTheGround(i,zt(n,e.lineLike));else if(Z(e))for(const[s,a]of We(n,e.center,e.radius)){const o=r(s,a);o!=null&&i.push(be(s,a,o))}else if(P(e)||we(e))for(const[s,a]of Nt(n,e.planeLike)){const o=r(s,a)??Vt;i.push(be(s,a,o))}return O(i)}function Oe(t){return nt(t.map(([e,n])=>{const r=K(e,n,0),i=K(e,n,1);return new Ht(r,i)}))}function O(t){return nt(t.map(e=>e?new ie(e):void 0))}function It(t,e){return O(t.map(([n,r])=>[n,r,e]))}function nt(t){if(t.length!==0)return t.length===1?t[0]??void 0:new At(t.filter($n))}function Ve(t){return t instanceof At}function D(t){return t instanceof ie}function q(t){return t instanceof Xe}function A(t){return t instanceof or}function P(t){return t instanceof et}function Z(t){return t instanceof ir}function I(t){return t instanceof Ye}function C(t){return t instanceof Qe}function V(t){return t instanceof cr}function we(t){return t instanceof fr}function Rr(t){return t instanceof hr}function Dr(t){return t instanceof pr}const Vt=0;let ke=class{constructor(e,n){this.isDraped=e,this.domain=n}};class Ft extends ke{constructor(e,n,r,i,s=3,a=!0,o=!0){super(i,s),this.type=e,this.lineStart=n,this.lineEnd=r,this.fadeLeft=a,this.fadeRight=o}equals(e){return e instanceof Ft&&this.type===e.type&&w(this.lineStart,e.lineStart)&&w(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}get length(){return te(this.lineStart,this.lineEnd)}}class Ct extends ke{constructor(e,n,r=3){super(n,r),this.intersectionPoint=e}equals(e){return e instanceof Ct&&w(this.intersectionPoint,e.intersectionPoint)}}let xs=class Gt extends ke{constructor(e,n,r,i=3){super(r,i),this.lineStart=e,this.lineEnd=n}equals(e){return e instanceof Gt&&w(this.lineStart,e.lineStart)&&w(this.lineEnd,e.lineEnd)}},ws=class Bt extends ke{constructor(e,n,r,i,s=3){super(i,s),this.previousVertex=e,this.centerVertex=n,this.nextVertex=r}equals(e){return e instanceof Bt&&w(this.previousVertex,e.previousVertex)&&w(this.centerVertex,e.centerVertex)&&w(this.nextVertex,e.nextVertex)}};function jr(t){const{spatialReference:e}=t;return Mt(e,Hr,Ar,t)}function Or(t,e){if(!re(t.spatialReference,e.spatialReference))return null;const{spatialReference:n}=t;return fe[0]=t.x,fe[1]=t.y,fe[2]=t.hasZ?t.z:0,pe[0]=e.x,pe[1]=e.y,pe[2]=e.hasZ?e.z:0,Wt(fe,pe,n)}function Wt(t,e,n){return Mt(n,Pr,Zr,t,e,n)}const qr={geodesicLength:jr,geodesicDistanceBetweenPoints:Or,geodesicDistance:Wt};async function Ss(){return await Cn(),qr}function Pr(t,e,n){return k(Ge(Vr,t,e,n).distance,"meters")}function Zr(t,e,n){return k(_t(Ir(t,e,n),{unit:"meters"}),"meters")}function Hr(t){return k(Vn([t],"meters")[0],"meters")}function Ar(t){return k(_t(t,{unit:"meters"}),"meters")}function Ir(t,e,n){return new Rn({spatialReference:n,paths:[[[...t],[...e]]]})}const Vr=new Be,fe=h(),pe=h();function Kt(t){return jn(t)?On(t)||qn(t)||Pn(t)||Zn(t)?Dn:t:Hn(t)}function Ls(t){return Fr(t)}function Fr(t,e){const{hasZ:n,spatialReference:r}=t,i=Kt(r);let s=0;const a=Lt(i);if(a==null)return null;const o=Jt;for(const u of t.paths){if(u.length<2)continue;const l=u.length-1;for(let p=0;p<l;++p){const d=u[p];m[0]=d[0],m[1]=d[1],m[2]=n?d[2]:0;const b=u[p+1];v[0]=b[0],v[1]=b[1],v[2]=n?b[2]:0;const $=o(m,v,r);if($==null)return null;s+=$.value}}return k(s,a)}function _s(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Gr(m,v,n)):null}function Ms(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Br(m,v,n)):null}function Ts(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Jt(m,v,n)):null}function zs(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Wr(m,v,n)):null}function Ns(t){return t!=null?Cr(t.hasZ?t.z:0,t.spatialReference):null}function Cr(t,e){const n=An(e);return n!=null?k(t??0,n):null}function Gr(t,e,n){const r=Ee(t,e,n);return r!=null?{direct:k(r.direct,r.unit),horizontal:k(r.horizontal,r.unit),vertical:k(r.vertical,r.unit)}:null}function Br(t,e,n){const r=Ee(t,e,n,0);return r!=null?k(r.direct,r.unit):null}function Jt(t,e,n){const r=Ee(t,e,n,1);return r!=null?k(r.horizontal,r.unit):null}function Wr(t,e,n){const r=Ee(t,e,n,2);return r!=null?k(r.verticalSigned,r.unit):null}function Ee(t,e,n,r){const i=Kt(n),s=Lt(i);if(s==null)return null;const a=e[2]-t[2];if(r===2)return{verticalSigned:a,unit:s};if(!De(t,n,qe,i)||!De(e,n,he,i))return null;if(r===0)return{direct:te(he,qe),unit:s};if(B(de,t[0],t[1],e[2]),!De(de,n,de,i))return null;const o=te(de,he);return r===1?{horizontal:o,unit:s}:{direct:te(he,qe),horizontal:o,vertical:Math.abs(a),unit:s}}const m=h(),v=h(),qe=h(),he=h(),de=h();export{as as A,rs as B,Wn as C,bs as D,us as E,pr as F,ir as G,nt as H,ls as I,D as J,Ns as K,Jn as L,or as M,$s as N,ds as O,Rt as P,fr as Q,Ht as R,ms as S,Cr as T,hr as U,Ms as V,Br as W,zs as X,Wr as Y,Jt as Z,_s as _,Ft as a,ws as b,ke as c,Ls as d,F as e,cs as f,Ss as g,z as h,Ct as i,is as j,K as k,Tt as l,Ts as m,ie as n,hs as o,at as p,Kt as q,xs as r,ss as s,ut as t,S as u,fs as v,ys as w,gs as x,ps as y,os as z};
