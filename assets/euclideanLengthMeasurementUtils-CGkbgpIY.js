import{Z as dt,O as ee,_ as c,e as f,g as Se,ch as yt,df as $e,a0 as Xt,iR as Kt,tX as Yt,aZ as Fe,BY as Qt,D6 as gt,jt as Le,aF as be,tW as en,f as tn,$ as nn,D7 as st,oA as rn,lS as Pe,eX as sn,cG as an,D8 as on,xL as un,bb as ln,bz as ne,an as K,bo as cn,bm as ye,as as h,gC as M,bf as T,gE as L,aD as W,ar as X,bi as me,D9 as Ze,em as B,gL as fn,bp as _e,bg as Ce,bq as ve,m3 as Te,Da as He,Db as $t,aJ as bt,Dc as mt,aA as te,aL as ge,aM as pn,m1 as R,gM as vt,lP as hn,Dd as dn,bc as w,p8 as yn,aK as gn,aR as $n,De as bn,Df as mn,u9 as vn,Dg as xt,m2 as wt,oH as St,bC as xn,pa as wn,qU as Sn,Dh as Ln,Di as _n,Dj as Tn,Dk as Mn,bh as zn,Dl as it,ax as Nn,Dm as Dn,a8 as Rn,ba as re,tD as D,ae as En,pR as jn,pS as kn,e5 as qn,ac as On,pI as Pn,Dn as Zn,pT as Hn,tV as An,tT as Lt,fK as je}from"./index-CgzAF5Ey.js";import{r as In}from"./utils-DN_jc3_L.js";import{j as Ae,q as Ge,b as We,R as Vn}from"./geodesicUtils-Cfv0uT1u.js";import{g as Fn}from"./geometry2dUtils-DamFhDZI.js";import{m as Cn,l as _t}from"./geodeticLengthOperator-CCmu1UCP.js";import{t as Tt}from"./geodesicMeasurementUtils-CD0H_C-6.js";let F=class extends dt{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new ee}};c([f({constructOnly:!0})],F.prototype,"layer",void 0),c([f()],F.prototype,"enabled",void 0),c([f()],F.prototype,"updating",void 0),c([f()],F.prototype,"availability",void 0),c([f()],F.prototype,"sublayerSources",void 0),F=c([Se("esri.views.interactive.snapping.FeatureSnappingLayerSource")],F);let k=class extends yt{constructor(){super(...arguments),this.enabled=!0}};c([f({type:Boolean})],k.prototype,"enabled",void 0),k=c([Se("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],k);let g=class extends yt{constructor(e){super(e),this.lineSnapper=new k,this.parallelLineSnapper=new k,this.rightAngleSnapper=new k,this.rightAngleTriangleSnapper=new k,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new $e([255,127,0]),this.orangeTransparent=new $e([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};c([f({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"lineSnapper",void 0),c([f({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"parallelLineSnapper",void 0),c([f({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleSnapper",void 0),c([f({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleTriangleSnapper",void 0),c([f({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"shortLineThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"distance",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"intersectionParallelLineThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"parallelLineThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"verticalLineThresholdMeters",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"touchSensitivityMultiplier",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointOnLineThreshold",void 0),c([f({type:$e,nonNullable:!0})],g.prototype,"orange",void 0),c([f({type:$e,nonNullable:!0})],g.prototype,"orangeTransparent",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthReference",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthTarget",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"lineHintFadedExtensions",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"parallelLineHintWidth",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],g.prototype,"parallelLineHintLength",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"parallelLineHintOffset",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],g.prototype,"rightAngleHintSize",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],g.prototype,"rightAngleHintOutlineSize",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"satisfiesConstraintScreenThreshold",void 0),g=c([Se("esri.views.interactive.snapping.Settings.Defaults")],g);const at=new g;let S=class extends dt{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new ee,this.distance=at.distance,this.touchSensitivityMultiplier=at.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){const e=this.featureSources;e.some(ot)&&Xt.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const n=e.filter(Wn),r=this._get("_effectiveFeatureSources")?.filter(ot)??new ee;for(const u of n){const l=r.find(p=>p.layer===u.layer.parent);if(l)l.sublayerSources.includes(u)||l.sublayerSources.add(u);else if(u.layer.parent){const p=new F({layer:u.layer.parent});p.sublayerSources.add(u),r.add(p)}}for(const u of r){const l=u.sublayerSources.filter(p=>!n.includes(p));u.sublayerSources.removeMany(l)}r.removeMany(r.filter(u=>u.sublayerSources.length===0));const i=e.filter(Gn),s=this._get("_effectiveFeatureSources")??new ee,{added:a,removed:o}=Kt(s.toArray(),[...i,...r]);return s.removeMany(o),s.addMany(a),s}};function ot(t){return t.layer.type==="subtype-group"}function Gn(t){return t.layer.type!=="subtype-group"}function Wn(t){return t.layer.type==="subtype-sublayer"}c([f()],S.prototype,"enabled",void 0),c([f()],S.prototype,"enabledToggled",void 0),c([f()],S.prototype,"forceDisabled",void 0),c([f()],S.prototype,"selfEnabled",void 0),c([f()],S.prototype,"featureEnabled",void 0),c([f()],S.prototype,"gridEnabled",void 0),c([f()],S.prototype,"attributeRulesEnabled",void 0),c([f({type:ee.ofType(F)})],S.prototype,"featureSources",void 0),c([f()],S.prototype,"distance",void 0),c([f()],S.prototype,"touchSensitivityMultiplier",void 0),c([f({readOnly:!0})],S.prototype,"effectiveEnabled",null),c([f({readOnly:!0})],S.prototype,"effectiveGridEnabled",null),c([f({readOnly:!0})],S.prototype,"effectiveSelfEnabled",null),c([f({readOnly:!0})],S.prototype,"effectiveFeatureEnabled",null),c([f({readOnly:!0})],S.prototype,"_effectiveFeatureSources",null),S=c([Se("esri.views.interactive.snapping.SnappingOptions")],S);function Mt(t,e,n){return z(t,e,n)}function z(t=0,e=0,n=0){return be(t,e,n)}function rs(t){return t}function ss(t){return t}function J(t,e,n){return be(t,e,n)}function Y(t){const[e,n,r]=t;return t.length>3?[e,n,r,t[3]]:[e,n,r]}function is(t){return t[3]=1|((t.length>3?t[3]:void 0)??0),t}function as(t){return!!(1&((t.length>3?t[3]:void 0)??0))}function ut(t,e,{coordinateHelper:n,elevationInfo:r},i){return t?Bn(n.vectorToDehydratedPoint(t,Jn),e,r,i):null}function Bn(t,e,n,r=z()){return r[0]=t.x,r[1]=t.y,r[2]=t.z??0,e==null||(e.type==="2d"?r[2]=0:r[2]=Yt(e,t,n,Fe)??0),r}function os(t,e,n){return n?(gt(n,t[0],t[1],t[2],e),n):Le(t[0],t[1],t[2],e)}function us(t,e,{z:n,m:r},i,s){const{spatialReference:a,elevationInfo:o}=i;let u;n==null&&r==null?u=void 0:e==null||e.type==="2d"?u=n??void 0:u=Qt(e,t,a,Fe,o)??0;const[l,p]=t;return s?gt(s,l,p,u,a):s=Le(l,p,u,a),r!=null&&(s.m=r,s.hasM=!0),s}function ls(t,e,n,r,i=z()){const[s,a]=t;return i[0]=s,i[1]=a,t.length>3&&(i[3]=t[3]??0),n?.type!=="3d"?(i[2]=e.value,i):(i[2]=en(n,s,a,e.value,r,e.elevationInfo,Fe)??0,i)}const Jn=Le(0,0,0,null),cs=Symbol("grid-placement-graphic");function Un(t,e){const n=t.x-e.x,r=t.y-e.y;return n*n+r*r}function fs(t,e){return Math.sqrt(Un(t,e))}function ps(t,e){e.sort((n,r)=>Pe(n.targetPoint,t)-Pe(r.targetPoint,t))}function hs({parameters:{point:t,distance:e,returnEdge:n,vertexMode:r,coordinateHelper:{spatialReference:i},filter:s},mode:a,returnZ:o,filter:u}){const l=u?.clone()??new sn({where:"1=1"});return l.returnZ=o??a==="3d",s&&(l.geometry=s.geometry,l.distance=s.distance,l.spatialRelationship=s.spatialRelationship,l.where=an(l.where,s.where),l.timeExtent=on(l.timeExtent,s.timeExtent),l.objectIds=Xn(l.objectIds,s.objectIds)),{point:Le(t[0],t[1],t[2],i.toJSON()),mode:a,distance:e,returnEdge:n,vertexMode:r,query:l.toJSON()}}function Xn(t,e){return t||e?e?t?Array.from(un(new Set(t),new Set(e))):e:t:null}function ds(t,e,n){return{left:ut(t.leftVertex.pos,e,n),right:ut(t.rightVertex.pos,e,n)}}const lt=Symbol("snapping-toggle");function ys(t,e=()=>{}){const n=tn(()=>({view:t.view,snappingOptions:t.snappingOptions}),({view:r,snappingOptions:i})=>{if(t.removeHandles(lt),!r||!i)return;const s=rn.TOOL,a=[r.on("key-down",o=>{o.key!==st.toggle||o.repeat||(i.enabledToggled=!0,e())},s),r.on("key-up",o=>{o.key===st.toggle&&(i.enabledToggled=!1,e())},s),r.on("pointer-move",o=>{const u=o.native.ctrlKey;i.enabledToggled!==u&&(i.enabledToggled=u,e())},s)];t.addHandles(a,lt)},nn);t.addHandles(n)}function gs(t){return In(t)&&"utilityNetworks"in t&&!!t.utilityNetworks?.length}function $s(t){return t?.type==="line"}function Be({start:t,end:e,type:n},r,i){const s=[],a=K(se,e,t),o=K(Me,t,r),u=ve(a),l=2*_e(a,o),p=l*l-4*u*(ve(o)-i*i);if(p===0){const d=-l/(2*u);(n===0||d>=0)&&s.push(ye(X(),t,a,d))}else if(p>0){const d=Math.sqrt(p),b=(-l+d)/(2*u);(n===0||b>=0)&&s.push(ye(X(),t,a,b));const $=(-l-d)/(2*u);(n===0||$>=0)&&s.push(ye(X(),t,a,$))}return s}function zt(t,e){const n=t.start,r=t.end,i=K(se,r,n),s=W(Ne,-i[1],i[0],0),a=e.start,o=e.end,u=M(Ue,o,a),l=T(u,s),p=W(Ot,n[0],n[1],0),d=M(Pt,p,a),b=T(d,s),$=ne();if(Math.abs(l)<$)return[];const x=L(Zt,a,u,b/l);if(e.type===0){const _=M(Ie,x,a);if(T(_,u)<-$)return[]}if(t.type===1){const _=fn(Me,x,n);if(_e(_,i)<-$)return[]}return[B(x)]}function Kn(t,e){return Qn(xe(Xe,e[2],t),e)}function Nt(t,e){return kt(xe(Xe,0,t),xe(rr,0,e)).map(([r,i])=>ge(r,i))}function Dt(t,e,n){return Et(t,xe(Xe,t[2],e),n)}function Rt(t,e,n,r=h()){const i=K(se,t,e),s=cn(i);return ye(r,e,i,s===0?1:n/s),r[2]=t[2],r}function Et(t,{start:e,end:n,type:r},i=h()){const s=M(ze,t,e),a=M(Ne,n,e),o=T(s,a)/T(a,a);return L(i,e,a,r===0?Math.max(o,0):o)}const Yn=(()=>{const t=h(),e=h(),n=h();return({start:r,end:i},{center:s,radius:a,normal:o,slicePlane:u})=>{const l=Te(s,o,nr);if(y(He(l,r),0)&&y(He(l,i),0)){$t(o,t,e);const d=(x,_)=>(Ce(n,_,s),vt(x,T(n,t),T(n,e)),x),b=Fn({start:d(se,r),end:d(Me,i)},hn,a),$=[];for(const[x,_]of b){const N=bt(h(),s);L(N,N,t,x),L(N,N,e,_),u&&!G(u,N)||$.push(N)}return $}const p=h();return mt(l,r,i,p)?!y(te(p,s),a)||u&&!G(u,p)?[]:[p]:[]}})();function jt({start:t,end:e,type:n},r,i){const s=[],a=Ce(ze,e,t),o=K(Me,t,r),u=ve(a),l=2*_e(a,o),p=l*l-4*u*(ve(o)-i*i);if(p===0){const d=-l/(2*u);(n===1||d>=0)&&s.push(L(h(),t,a,d))}else if(p>0){const d=Math.sqrt(p),b=(-l+d)/(2*u);(n===1||b>=0)&&s.push(L(h(),t,a,b));const $=(-l-d)/(2*u);(n===1||$>=0)&&s.push(L(h(),t,a,$))}return s}function kt(t,e){const n=t.start,r=t.end,i=e.start,s=e.end,a=M(ze,r,n),o=M(Ne,s,i),u=M(Ue,i,n),l=me(Ot,a,o);if(!y(T(u,l),0))return[];const p=Ze(l);if(y(p,0))return[];const d=me(Pt,u,o),b=T(d,l)/p,$=L(Zt,n,a,b);if(t.type===0){const x=M(Ie,$,n);if(T(a,x)<-ne())return[]}if(e.type===0){const x=M(Ie,$,i);if(T(o,x)<-ne())return[]}return[B($)]}function Qn({start:t,end:e,type:n},r){const i=M(ze,r,t),s=M(Ne,e,t),a=me(Ue,s,i),o=Ze(a)/Ze(s),u=ne();if(o<u)switch(n){case 1:return[B(r)];case 0:return T(s,i)<-u?[]:[B(r)]}return[]}function Je(t,e,n,r){const[i,s]=t,[a,o]=n,u=a-i,l=o-s,p=u*u+l*l,d=Math.sqrt(p);if(d>e+r)return[];if(d<Math.abs(e-r))return[];if(y(d,0)&&y(e,r))return[];const b=(e*e-r*r+p)/(2*d),$=Math.sqrt(e*e-b*b),x=$*l/d,_=$*u/d,[N,U]=pn(se,t,n,b/d);return y(x,_)?[ge(N,U)]:[ge(N+x,U-_),ge(N-x,U+_)]}function xe(t,e,{start:n,end:r,type:i}){return W(t.start,n[0],n[1],e),W(t.end,r[0],r[1],e),t.type=tr[i],t}function qt(t,e){return y(t[2],e[2])}function y(t,e){return ln(Math.abs(t-e),0,ne())}function er(t,e){return e.filter(n=>G(t,n))}function G(t,e){return dn(t,e)}const tr={0:1,1:0},se=X(),Me=X(),ze=h(),Ne=h(),Ue=h(),Ot=h(),Pt=h(),Zt=h(),Ie=h(),nr=R(),Xe={start:h(),end:h(),type:1},rr={start:h(),end:h(),type:1};class E{intersect(e){return H(this,e)}closestPoints(e){return[this.closestTo(e)]}}class ie extends E{constructor(e){super(),this.point=e}equals(e){return this===e||j(e)&&w(this.point,e.point)}closestTo(){return Y(this.point)}}class Ke extends E{constructor(e,n,r){super(),this.start=e,this.end=n,this.lineLike={start:e,end:n,type:r}}equals(e){return this===e||O(e)&&this.lineLike.type===e.lineLike.type&&w(this.start,e.start)&&w(this.end,e.end)}closestTo(e){const n=z();return Et(e,this.lineLike,n),n}}class Ht extends Ke{constructor(e,n){super(e,n,1)}}class sr extends Ke{constructor(e,n){super(e,n,0)}}class At extends E{constructor(e){super(),this.constraints=e}equals(e){return this===e||Ve(e)&&xn(this.constraints,e.constraints,(n,r)=>n.equals(r))}closestTo(e){let n,r=1/0;for(const i of this.constraints){const s=i.closestTo(e),a=Pe(e,s);a<r&&(r=a,n=s)}return Y(n??e)}closestPoints(e){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(e))}}class ir extends E{constructor(e,n){super(),this.center=e,this.radius=n}equals(e){return this===e||Z(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const n=z();return Rt(e,this.center,this.radius,n),n}}class Ye extends E{constructor(e,n){super(),this.center=e,this.radius=n}equals(e){return this===e||I(e)&&w(this.center,e.center)&&this.radius===e.radius}closestTo(e){const n=z();return Rt(e,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new Qe(Y(this.center),this.radius,J(0,0,1))}}class Qe extends E{constructor(e,n,r,i=void 0){super(),this.center=e,this.radius=n,this.normal=r,this.slicePlane=i}equals(e){return this===e||C(e)&&w(this.center,e.center)&&w(this.normal,e.normal)&&this.radius===e.radius}closestTo(e){const{center:n,radius:r}=this;xt(this.getPlane(ar),e,ke);const i=M(ke,ke,n),s=wn(i);if(y(s,0))return Y(e);const a=r/Math.sqrt(s),o=z();L(o,n,i,a);const{slicePlane:u}=this;return u&&!G(u,o)?tt(u,this)?.closestTo(e)??Y(e):o}getPlane(e=R()){return Te(this.center,this.normal,e)}}const ke=h(),ar=R();class or extends E{constructor(e){super(),this.z=e}equals(e){return this===e||A(e)&&this.z===e.z}closestTo(e){return J(e[0],e[1],this.z)}getPlane(e=R()){return W(ct,0,0,this.z),Te(ct,bn,e)}}const ct=h();class et extends E{constructor(e,n,r){super(),this.start=e,this.end=n,this.planeLike={start:e,end:n,type:r}}equals(e){return this===e||P(e)&&this.planeLike.type===e.planeLike.type&&w(this.start,e.start)&&w(this.end,e.end)}closestTo(e){const n=z();return Dt(e,this.planeLike,n),n}closestEndTo(e){const{start:n,end:r}=this.planeLike;return Math.sign(_e(K(ur,r,n),K(lr,e,n)))>0?this.end:this.start}getPlane(e=R()){const n=bt(ft,this.end);return n[2]+=1,yn(this.start,this.end,n,e)}getSlicePlane(e=R()){const{start:n,end:r,type:i}=this.planeLike;if(i===0)return;const s=W(ft,n[0],n[1],0),a=W(pt,r[0],r[1],0),o=Ce(pt,a,s);return Te(s,o,e),e}}const ur=X(),lr=X(),ft=h(),pt=h();class bs extends et{constructor(e,n){super(e,n,1)}}class ms extends et{constructor(e,n){super(e,n,0)}}class cr extends E{constructor(e,n){super(),this.sphere=Sn(e,n),this._center=B(e)}equals(e){return this===e||V(e)&&Ln(this.sphere,e.sphere)}closestTo(e){const n=z();return _n(this.sphere,e,n),n}get center(){return this._center}get radius(){return this.sphere[3]}}class fr extends E{constructor(e,n,r){super(),this.start=e,this.end=n,this.getZ=r,this.planeLike={start:e,end:n,type:0}}equals(e){return this===e||we(e)&&w(this.start,e.start)&&w(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return $r(this,e)}addIfOnTheGround(e,n){for(const r of n){const i=this.getZ(r[0],r[1])??0;y(r[2],i)&&(r[2]=i,e.push(r))}}}class pr extends E{constructor(e,n,r){super(),this._x=e,this._y=n,this._z=r}equals(e){return this===e||jr(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,n,r]){return Mt(this._x??e,this._y??n,this._z??r)}}class hr extends E{constructor(e,n,r,i,s){super(),this._origin=e,this._spatialReference=n,this._distanceMeters=r,this._z=i,this._directionDegrees=s}equals(e){return this===e||Er(e)&&it(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._z===e._z&&this._directionDegrees===e._directionDegrees}closestTo([e,n,r]){return vt(Q,e,n),it(Q,this._origin)||this._applyDirectionAndDistance(Q),Mt(Q[0],Q[1],this._z??r)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)Ae(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)yr(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:n}=Ge(dr,this._origin,e,this._spatialReference);Ae(e,this._origin,n??0,this._distanceMeters,this._spatialReference)}}}const Q=[0,0],dr=new We;function yr(t,e,n,r,i){let{azimuth:s,distance:a}=Ge(gr,e,r,i);s??=0;let o=a*Math.cos((s-n)*Rn);o=Math.max(0,o),Ae(t,e,n,o,i)}const gr=new We;function $r(t,e){const n=z();return Dt(e,t.planeLike,n),n[2]=t.getZ(n[0],n[1])??Vt,n}function H(t,e){if(Ve(t)){const n=[];for(const r of t.constraints){const i=r.intersect(e);i&&n.push(i)}return nt(n)}if(Ve(e))return H(e,t);if(we(t))return ht(t,e);if(we(e))return ht(e,t);if(j(t)){const{point:n}=t;if(j(e))return w(n,e.point)?t:void 0;const r=e.closestTo(n);return gn(r,n)?t:void 0}if(O(t)){if(j(e))return H(e,t);if(O(e))return q(kt(t.lineLike,e.lineLike));if(A(e))return br(t,e);if(P(e))return q(zt(e.planeLike,t.lineLike));if(Z(e))return q(jt(t.lineLike,e.center,e.radius));if(C(e))return q(Yn(t.lineLike,e));if(I(e))return mr(t,e);if(V(e))return vr(t,e)}else if(A(t)){if(j(e)||O(e))return H(e,t);if(A(e))return xr(t,e);if(P(e))return wr(t,e);if(Z(e))return Sr(t,e);if(C(e))return _r(t,e);if(I(e))return Lr(t,e);if(V(e))return Tr(t,e)}else if(P(t)){if(j(e)||O(e)||A(e))return H(e,t);if(P(e))return qe(Nt(t.planeLike,e.planeLike));if(Z(e))return qe(Be(t.planeLike,e.center,e.radius));if(C(e))return zr(t,e);if(I(e))return Mr(t,e);if(V(e))return Nr(t,e)}else if(Z(t)){if(j(e)||O(e)||A(e)||P(e))return H(e,t);if(Z(e))return qe(Je(t.center,t.radius,e.center,e.radius));if(C(e))return void 0;if(I(e))return Dr(t,e);if(V(e))return void 0}else if(C(t)){if(j(e)||O(e)||A(e)||P(e)||Z(e))return H(e,t);if(C(e))return void 0;if(I(e))return e.asCircle(),void 0;if(V(e))return void 0}else if(I(t)){if(j(e)||O(e)||A(e)||P(e)||Z(e)||C(e))return H(e,t);if(I(e))return Rr(e,t);if(V(e))return void 0}else if(V(t)){if(j(e)||O(e)||A(e)||P(e)||Z(e)||I(e))return H(e,t);if(V(e))return void 0}}const br=(()=>{const t=R();return(e,n)=>{const{start:r,end:i}=e;if(qt(r,i)&&y(r[2],n.z))return e;const s=z();return mt(n.getPlane(t),r,i,s)?new ie(s):void 0}})();function mr({lineLike:t},{center:e,radius:n}){const r=e[2];return q(jt(t,e,n).filter(i=>y(i[2],r)))}function vr({lineLike:t},{sphere:e}){return q(mn(e,t.start,t.end))}const tt=(()=>{const t=Nn(),e=h(),n=h();return(r,i,s)=>{const{normal:a,center:o,radius:u}=i;$t(a,e,n);const l=wt(r),p=u*T(l,e),d=u*T(l,n);Tn(t,o[0],o[1],o[2],1);const b=Mn(r,t),$=Math.hypot(p,d),x=y($,0);if(y(He(r,o),0)){if(x)return i;if(y(u,0))return!s||G(s,o)?new ie(Y(o)):void 0;me(e,l,a),zn(e,e);const Ee=new Array,le=B(o);L(le,le,e,u),s&&!G(s,le)||Ee.push(le);const ce=B(o);return L(ce,ce,e,-u),s&&!G(s,ce)||Ee.push(ce),q(Ee)}if(x)return;const _=-b/$;if(Math.abs(_)>1||y(_,1))return;const N=Math.atan(p/d),U=Dn(_)-N,rt=Math.PI-U,ae=new Array,oe=h();L(oe,o,e,u*Math.cos(U)),L(oe,oe,n,u*Math.sin(U)),ae.push(oe);const ue=h();return L(ue,o,e,u*Math.cos(rt)),L(ue,ue,n,u*Math.sin(rt)),ae.push(ue),q(s?er(s,ae):ae)}})();function xr(t,e){return y(t.z,e.z)?t:void 0}function wr({z:t},{planeLike:e}){const[n,r]=e.start,[i,s]=e.end,a=J(n,r,t),o=J(i,s,t);return e.type===0?new Ht(a,o):new sr(a,o)}function Sr(t,e){const[n,r]=e.center;return new Ye(J(n,r,t.z),e.radius)}function Lr(t,e){return y(e.center[2],t.z)?e:void 0}const _r=(()=>{const t=R();return(e,n)=>tt(e.getPlane(t),n,n.slicePlane)})();function Tr(t,{center:e,radius:n}){const r=Math.abs(e[2]-t.z);if(r>n&&!y(r,n))return;const i=J(e[0],e[1],t.z),s=Math.sqrt(n**2-r**2);return y(s,0)?void 0:new Ye(i,s)}const Mr=(()=>{const t=R();return(e,{center:n,radius:r})=>{const i=Be(e.planeLike,n,r),s=n[2];e.getSlicePlane(t);const a=new Array;for(const[o,u]of i){const l=[o,u,s];G(t,l)&&a.push(l)}return q(a)}})(),zr=(()=>{const t=R(),e=R();return(n,r)=>tt(n.getPlane(t),r,n.getSlicePlane(e))})(),Nr=(()=>{const t=R();return(e,{center:n,radius:r})=>{const i=e.getPlane(t),s=vn(i,n),a=Math.abs(s);if(a>r&&!y(a,r))return;const o=Math.sqrt(r**2-s**2);if(y(o,0)){const p=z();return xt(i,n,p),new ie(p)}const u=z(),l=B(wt(i));return L(u,n,l,s),new Qe(u,o,l,e.getSlicePlane())}})();function Dr(t,e){const n=St(t.center,e.center);return y(n,0)&&y(t.radius,e.radius)?e:It(Je(t.center,t.radius,e.center,e.radius),e.center[2])}function Rr(t,e){if(!qt(t.center,e.center))return;const n=St(t.center,e.center);return y(n,0)&&y(t.radius,e.radius)?t:It(Je(t.center,t.radius,e.center,e.radius),t.center[2])}function ht(t,e){const{planeLike:n,getZ:r}=t,i=new Array;if(j(e))t.addIfOnTheGround(i,Kn(n,e.point));else if(O(e))t.addIfOnTheGround(i,zt(n,e.lineLike));else if(Z(e))for(const[s,a]of Be(n,e.center,e.radius)){const o=r(s,a);o!=null&&i.push(be(s,a,o))}else if(P(e)||we(e))for(const[s,a]of Nt(n,e.planeLike)){const o=r(s,a)??Vt;i.push(be(s,a,o))}return q(i)}function qe(t){return nt(t.map(([e,n])=>{const r=J(e,n,0),i=J(e,n,1);return new Ht(r,i)}))}function q(t){return nt(t.map(e=>e?new ie(e):void 0))}function It(t,e){return q(t.map(([n,r])=>[n,r,e]))}function nt(t){if(t.length!==0)return t.length===1?t[0]??void 0:new At(t.filter($n))}function Ve(t){return t instanceof At}function j(t){return t instanceof ie}function O(t){return t instanceof Ke}function A(t){return t instanceof or}function P(t){return t instanceof et}function Z(t){return t instanceof ir}function I(t){return t instanceof Ye}function C(t){return t instanceof Qe}function V(t){return t instanceof cr}function we(t){return t instanceof fr}function Er(t){return t instanceof hr}function jr(t){return t instanceof pr}const Vt=0;let De=class{constructor(e,n){this.isDraped=e,this.domain=n}};class Ft extends De{constructor(e,n,r,i,s=3,a=!0,o=!0){super(i,s),this.type=e,this.lineStart=n,this.lineEnd=r,this.fadeLeft=a,this.fadeRight=o}equals(e){return e instanceof Ft&&this.type===e.type&&w(this.lineStart,e.lineStart)&&w(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}get length(){return te(this.lineStart,this.lineEnd)}}class Ct extends De{constructor(e,n,r=3){super(n,r),this.intersectionPoint=e}equals(e){return e instanceof Ct&&w(this.intersectionPoint,e.intersectionPoint)}}let xs=class Gt extends De{constructor(e,n,r,i=3){super(r,i),this.lineStart=e,this.lineEnd=n}equals(e){return e instanceof Gt&&w(this.lineStart,e.lineStart)&&w(this.lineEnd,e.lineEnd)}},ws=class Wt extends De{constructor(e,n,r,i,s=3){super(i,s),this.previousVertex=e,this.centerVertex=n,this.nextVertex=r}equals(e){return e instanceof Wt&&w(this.previousVertex,e.previousVertex)&&w(this.centerVertex,e.centerVertex)&&w(this.nextVertex,e.nextVertex)}};function kr(t){const{spatialReference:e}=t;return Tt(e,Hr,Ar,t)}function qr(t,e){if(!re(t.spatialReference,e.spatialReference))return null;const{spatialReference:n}=t;return fe[0]=t.x,fe[1]=t.y,fe[2]=t.hasZ?t.z:0,pe[0]=e.x,pe[1]=e.y,pe[2]=e.hasZ?e.z:0,Bt(fe,pe,n)}function Bt(t,e,n){return Tt(n,Pr,Zr,t,e,n)}const Or={geodesicLength:kr,geodesicDistanceBetweenPoints:qr,geodesicDistance:Bt};async function Ss(){return await Cn(),Or}function Pr(t,e,n){return D(Ge(Vr,t,e,n).distance,"meters")}function Zr(t,e,n){return D(_t(Ir(t,e,n),{unit:"meters"}),"meters")}function Hr(t){return D(Vn([t],"meters")[0],"meters")}function Ar(t){return D(_t(t,{unit:"meters"}),"meters")}function Ir(t,e,n){return new En({spatialReference:n,paths:[[[...t],[...e]]]})}const Vr=new We,fe=h(),pe=h();function Jt(t){return kn(t)?qn(t)||On(t)||Pn(t)||Zn(t)?jn:t:Hn(t)}function Ls(t){return Fr(t)}function Fr(t,e){const{hasZ:n,spatialReference:r}=t,i=Jt(r);let s=0;const a=Lt(i);if(a==null)return null;const o=Ut;for(const u of t.paths){if(u.length<2)continue;const l=u.length-1;for(let p=0;p<l;++p){const d=u[p];m[0]=d[0],m[1]=d[1],m[2]=n?d[2]:0;const b=u[p+1];v[0]=b[0],v[1]=b[1],v[2]=n?b[2]:0;const $=o(m,v,r);if($==null)return null;s+=$.value}}return D(s,a)}function _s(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Gr(m,v,n)):null}function Ts(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Wr(m,v,n)):null}function Ms(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Ut(m,v,n)):null}function zs(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Br(m,v,n)):null}function Ns(t){return t!=null?Cr(t.hasZ?t.z:0,t.spatialReference):null}function Cr(t,e){const n=An(e);return n!=null?D(t??0,n):null}function Gr(t,e,n){const r=Re(t,e,n);return r!=null?{direct:D(r.direct,r.unit),horizontal:D(r.horizontal,r.unit),vertical:D(r.vertical,r.unit)}:null}function Wr(t,e,n){const r=Re(t,e,n,0);return r!=null?D(r.direct,r.unit):null}function Ut(t,e,n){const r=Re(t,e,n,1);return r!=null?D(r.horizontal,r.unit):null}function Br(t,e,n){const r=Re(t,e,n,2);return r!=null?D(r.verticalSigned,r.unit):null}function Re(t,e,n,r){const i=Jt(n),s=Lt(i);if(s==null)return null;const a=e[2]-t[2];if(r===2)return{verticalSigned:a,unit:s};if(!je(t,n,Oe,i)||!je(e,n,he,i))return null;if(r===0)return{direct:te(he,Oe),unit:s};if(W(de,t[0],t[1],e[2]),!je(de,n,de,i))return null;const o=te(de,he);return r===1?{horizontal:o,unit:s}:{direct:te(he,Oe),horizontal:o,vertical:Math.abs(a),unit:s}}const m=h(),v=h(),Oe=h(),he=h(),de=h();export{as as A,rs as B,Bn as C,bs as D,us as E,pr as F,ir as G,nt as H,ls as I,j as J,Ns as K,Un as L,or as M,$s as N,ds as O,Et as P,fr as Q,Ht as R,ms as S,Cr as T,hr as U,Ts as V,Wr as W,zs as X,Br as Y,Ut as Z,_s as _,Ft as a,ws as b,De as c,Ls as d,F as e,cs as f,Ss as g,z as h,Ct as i,is as j,J as k,Mt as l,Ms as m,ie as n,hs as o,at as p,Jt as q,xs as r,ss as s,ut as t,S as u,fs as v,ys as w,gs as x,ps as y,os as z};
