import{tU as Qt,Co as Kt,DF as dt,hT as Se,az as $e,tT as Xt,aT as Ve,ce as yt,eB as be,Z as c,$ as f,a0 as _e,a2 as gt,Q as ee,a4 as Yt,is as en,k as tn,a3 as nn,DG as st,nt as rn,kp as Pe,tN as sn,e3 as an,cj as on,DH as un,xF as ln,b6 as cn,qG as ne,ah as K,bm as fn,bk as ye,am as h,fk as M,bd as T,fm as _,ax as C,al as Q,bg as me,DI as He,dQ as B,DJ as pn,bn as Le,be as Ge,bo as ve,kC as Te,DK as Ze,DL as $t,aD as bt,DM as mt,au as te,aF as ge,aG as hn,kA as D,gH as vt,i_ as dn,DN as yn,b7 as w,oh as gn,aE as $n,aK as bn,DO as mn,ud as vn,DP as xt,kB as wt,nW as St,eF as xn,DQ as wn,oj as Sn,qe as _n,DR as Ln,DS as Tn,DT as Mn,DU as zn,bf as Nn,ar as kn,DV as Dn,DW as it,eW as Ae,f4 as We,f5 as Ce,DX as En,on as _t,b5 as re,to as k,ow as Rn,ae as jn,oZ as On,o_ as qn,dy as Pn,dz as Hn,oQ as Zn,DY as An,o$ as Fn,tQ as Lt,f3 as Re,tS as In}from"./index-Bp3GeDhQ.js";import{g as Vn}from"./geometry2dUtils-2tpfJ_8-.js";import{m as Gn,l as Tt}from"./geodeticLengthOperator-i8Sfrrr_.js";function Mt(t,e,n){return z(t,e,n)}function z(t=0,e=0,n=0){return $e(t,e,n)}function Kr(t){return t}function Xr(t){return t}function U(t,e,n){return $e(t,e,n)}function X(t){const[e,n,r]=t;return t.length>3?[e,n,r,t[3]]:[e,n,r]}function Yr(t){return t[3]=1|((t.length>3?t[3]:void 0)??0),t}function es(t){return!!(1&((t.length>3?t[3]:void 0)??0))}function at(t,e,{coordinateHelper:n,elevationInfo:r},i){return t?Wn(n.vectorToDehydratedPoint(t,Cn),e,r,i):null}function Wn(t,e,n,r=z()){return r[0]=t.x,r[1]=t.y,r[2]=t.z??0,e==null||(e.type==="2d"?r[2]=0:r[2]=Qt(e,t,n,Ve)??0),r}function ts(t,e,n){return n?(dt(n,t[0],t[1],t[2],e),n):Se(t[0],t[1],t[2],e)}function ns(t,e,{z:n,m:r},i,s){const{spatialReference:a,elevationInfo:o}=i;let u;n==null&&r==null?u=void 0:e==null||e.type==="2d"?u=n??void 0:u=Kt(e,t,a,Ve,o)??0;const[l,p]=t;return s?dt(s,l,p,u,a):s=Se(l,p,u,a),r!=null&&(s.m=r,s.hasM=!0),s}function rs(t,e,n,r,i=z()){const[s,a]=t;return i[0]=s,i[1]=a,t.length>3&&(i[3]=t[3]??0),n?.type!=="3d"?(i[2]=e.value,i):(i[2]=Xt(n,s,a,e.value,r,e.elevationInfo,Ve)??0,i)}const Cn=Se(0,0,0,null);let j=class extends yt{constructor(){super(...arguments),this.enabled=!0}};c([f({type:Boolean})],j.prototype,"enabled",void 0),j=c([_e("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],j);let g=class extends yt{constructor(e){super(e),this.lineSnapper=new j,this.parallelLineSnapper=new j,this.rightAngleSnapper=new j,this.rightAngleTriangleSnapper=new j,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new be([255,127,0]),this.orangeTransparent=new be([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};c([f({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"lineSnapper",void 0),c([f({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"parallelLineSnapper",void 0),c([f({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleSnapper",void 0),c([f({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],g.prototype,"rightAngleTriangleSnapper",void 0),c([f({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"shortLineThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],g.prototype,"distance",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"intersectionParallelLineThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"parallelLineThreshold",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"verticalLineThresholdMeters",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"touchSensitivityMultiplier",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],g.prototype,"pointOnLineThreshold",void 0),c([f({type:be,nonNullable:!0})],g.prototype,"orange",void 0),c([f({type:be,nonNullable:!0})],g.prototype,"orangeTransparent",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthReference",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"lineHintWidthTarget",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"lineHintFadedExtensions",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],g.prototype,"parallelLineHintWidth",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],g.prototype,"parallelLineHintLength",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"parallelLineHintOffset",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],g.prototype,"rightAngleHintSize",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],g.prototype,"rightAngleHintOutlineSize",void 0),c([f({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],g.prototype,"satisfiesConstraintScreenThreshold",void 0),g=c([_e("esri.views.interactive.snapping.Settings.Defaults")],g);const ot=new g;let V=class extends gt{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new ee}};c([f({constructOnly:!0})],V.prototype,"layer",void 0),c([f()],V.prototype,"enabled",void 0),c([f()],V.prototype,"updating",void 0),c([f()],V.prototype,"availability",void 0),c([f()],V.prototype,"sublayerSources",void 0),V=c([_e("esri.views.interactive.snapping.FeatureSnappingLayerSource")],V);let S=class extends gt{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new ee,this.distance=ot.distance,this.touchSensitivityMultiplier=ot.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){const e=this.featureSources;e.some(ut)&&Yt.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const n=e.filter(Un),r=this._get("_effectiveFeatureSources")?.filter(ut)??new ee;for(const u of n){const l=r.find(p=>p.layer===u.layer.parent);if(l)l.sublayerSources.includes(u)||l.sublayerSources.add(u);else if(u.layer.parent){const p=new V({layer:u.layer.parent});p.sublayerSources.add(u),r.add(p)}}for(const u of r){const l=u.sublayerSources.filter(p=>!n.includes(p));u.sublayerSources.removeMany(l)}r.removeMany(r.filter(u=>u.sublayerSources.length===0));const i=e.filter(Bn),s=this._get("_effectiveFeatureSources")??new ee,{added:a,removed:o}=en(s.toArray(),[...i,...r]);return s.removeMany(o),s.addMany(a),s}};function ut(t){return t.layer.type==="subtype-group"}function Bn(t){return t.layer.type!=="subtype-group"}function Un(t){return t.layer.type==="subtype-sublayer"}c([f()],S.prototype,"enabled",void 0),c([f()],S.prototype,"enabledToggled",void 0),c([f()],S.prototype,"forceDisabled",void 0),c([f()],S.prototype,"selfEnabled",void 0),c([f()],S.prototype,"featureEnabled",void 0),c([f()],S.prototype,"gridEnabled",void 0),c([f()],S.prototype,"attributeRulesEnabled",void 0),c([f({type:ee.ofType(V)})],S.prototype,"featureSources",void 0),c([f()],S.prototype,"distance",void 0),c([f()],S.prototype,"touchSensitivityMultiplier",void 0),c([f({readOnly:!0})],S.prototype,"effectiveEnabled",null),c([f({readOnly:!0})],S.prototype,"effectiveGridEnabled",null),c([f({readOnly:!0})],S.prototype,"effectiveSelfEnabled",null),c([f({readOnly:!0})],S.prototype,"effectiveFeatureEnabled",null),c([f({readOnly:!0})],S.prototype,"_effectiveFeatureSources",null),S=c([_e("esri.views.interactive.snapping.SnappingOptions")],S);const os=Symbol("grid-placement-graphic");function Jn(t,e){const n=t.x-e.x,r=t.y-e.y;return n*n+r*r}function us(t,e){return Math.sqrt(Jn(t,e))}function ls(t,e){e.sort((n,r)=>Pe(n.targetPoint,t)-Pe(r.targetPoint,t))}function cs({parameters:{point:t,distance:e,returnEdge:n,vertexMode:r,coordinateHelper:{spatialReference:i},filter:s},mode:a,returnZ:o,filter:u}){const l=u?.clone()??new an({where:"1=1"});return l.returnZ=o??a==="3d",s&&(l.geometry=s.geometry,l.distance=s.distance,l.spatialRelationship=s.spatialRelationship,l.where=on(l.where,s.where),l.timeExtent=un(l.timeExtent,s.timeExtent),l.objectIds=Qn(l.objectIds,s.objectIds)),{point:Se(t[0],t[1],t[2],i.toJSON()),mode:a,distance:e,returnEdge:n,vertexMode:r,query:l.toJSON()}}function Qn(t,e){return t||e?e?t?Array.from(ln(new Set(t),new Set(e))):e:t:null}function fs(t,e,n){return{left:at(t.leftVertex.pos,e,n),right:at(t.rightVertex.pos,e,n)}}const lt=Symbol("snapping-toggle");function ps(t,e=()=>{}){const n=tn(()=>({view:t.view,snappingOptions:t.snappingOptions}),({view:r,snappingOptions:i})=>{if(t.removeHandles(lt),!r||!i)return;const s=rn.TOOL,a=[r.on("key-down",o=>{o.key!==st.toggle||o.repeat||(i.enabledToggled=!0,e())},s),r.on("key-up",o=>{o.key===st.toggle&&(i.enabledToggled=!1,e())},s),r.on("pointer-move",o=>{const u=o.native.ctrlKey;i.enabledToggled!==u&&(i.enabledToggled=u,e())},s)];t.addHandles(a,lt)},nn);t.addHandles(n)}function hs(t){return sn(t)&&"utilityNetworks"in t&&!!t.utilityNetworks?.length}function ds(t){return t?.type==="line"}function Be({start:t,end:e,type:n},r,i){const s=[],a=K(se,e,t),o=K(Me,t,r),u=ve(a),l=2*Le(a,o),p=l*l-4*u*(ve(o)-i*i);if(p===0){const d=-l/(2*u);(n===0||d>=0)&&s.push(ye(Q(),t,a,d))}else if(p>0){const d=Math.sqrt(p),b=(-l+d)/(2*u);(n===0||b>=0)&&s.push(ye(Q(),t,a,b));const $=(-l-d)/(2*u);(n===0||$>=0)&&s.push(ye(Q(),t,a,$))}return s}function zt(t,e){const n=t.start,r=t.end,i=K(se,r,n),s=C(Ne,-i[1],i[0],0),a=e.start,o=e.end,u=M(Je,o,a),l=T(u,s),p=C(qt,n[0],n[1],0),d=M(Pt,p,a),b=T(d,s),$=ne();if(Math.abs(l)<$)return[];const x=_(Ht,a,u,b/l);if(e.type===0){const L=M(Fe,x,a);if(T(L,u)<-$)return[]}if(t.type===1){const L=pn(Me,x,n);if(Le(L,i)<-$)return[]}return[B(x)]}function Kn(t,e){return Yn(xe(Qe,e[2],t),e)}function Nt(t,e){return jt(xe(Qe,0,t),xe(rr,0,e)).map(([r,i])=>ge(r,i))}function kt(t,e,n){return Et(t,xe(Qe,t[2],e),n)}function Dt(t,e,n,r=h()){const i=K(se,t,e),s=fn(i);return ye(r,e,i,s===0?1:n/s),r[2]=t[2],r}function Et(t,{start:e,end:n,type:r},i=h()){const s=M(ze,t,e),a=M(Ne,n,e),o=T(s,a)/T(a,a);return _(i,e,a,r===0?Math.max(o,0):o)}const Xn=(()=>{const t=h(),e=h(),n=h();return({start:r,end:i},{center:s,radius:a,normal:o,slicePlane:u})=>{const l=Te(s,o,nr);if(y(Ze(l,r),0)&&y(Ze(l,i),0)){$t(o,t,e);const d=(x,L)=>(Ge(n,L,s),vt(x,T(n,t),T(n,e)),x),b=Vn({start:d(se,r),end:d(Me,i)},dn,a),$=[];for(const[x,L]of b){const N=bt(h(),s);_(N,N,t,x),_(N,N,e,L),u&&!W(u,N)||$.push(N)}return $}const p=h();return mt(l,r,i,p)?!y(te(p,s),a)||u&&!W(u,p)?[]:[p]:[]}})();function Rt({start:t,end:e,type:n},r,i){const s=[],a=Ge(ze,e,t),o=K(Me,t,r),u=ve(a),l=2*Le(a,o),p=l*l-4*u*(ve(o)-i*i);if(p===0){const d=-l/(2*u);(n===1||d>=0)&&s.push(_(h(),t,a,d))}else if(p>0){const d=Math.sqrt(p),b=(-l+d)/(2*u);(n===1||b>=0)&&s.push(_(h(),t,a,b));const $=(-l-d)/(2*u);(n===1||$>=0)&&s.push(_(h(),t,a,$))}return s}function jt(t,e){const n=t.start,r=t.end,i=e.start,s=e.end,a=M(ze,r,n),o=M(Ne,s,i),u=M(Je,i,n),l=me(qt,a,o);if(!y(T(u,l),0))return[];const p=He(l);if(y(p,0))return[];const d=me(Pt,u,o),b=T(d,l)/p,$=_(Ht,n,a,b);if(t.type===0){const x=M(Fe,$,n);if(T(a,x)<-ne())return[]}if(e.type===0){const x=M(Fe,$,i);if(T(o,x)<-ne())return[]}return[B($)]}function Yn({start:t,end:e,type:n},r){const i=M(ze,r,t),s=M(Ne,e,t),a=me(Je,s,i),o=He(a)/He(s),u=ne();if(o<u)switch(n){case 1:return[B(r)];case 0:return T(s,i)<-u?[]:[B(r)]}return[]}function Ue(t,e,n,r){const[i,s]=t,[a,o]=n,u=a-i,l=o-s,p=u*u+l*l,d=Math.sqrt(p);if(d>e+r)return[];if(d<Math.abs(e-r))return[];if(y(d,0)&&y(e,r))return[];const b=(e*e-r*r+p)/(2*d),$=Math.sqrt(e*e-b*b),x=$*l/d,L=$*u/d,[N,J]=hn(se,t,n,b/d);return y(x,L)?[ge(N,J)]:[ge(N+x,J-L),ge(N-x,J+L)]}function xe(t,e,{start:n,end:r,type:i}){return C(t.start,n[0],n[1],e),C(t.end,r[0],r[1],e),t.type=tr[i],t}function Ot(t,e){return y(t[2],e[2])}function y(t,e){return cn(Math.abs(t-e),0,ne())}function er(t,e){return e.filter(n=>W(t,n))}function W(t,e){return yn(t,e)}const tr={0:1,1:0},se=Q(),Me=Q(),ze=h(),Ne=h(),Je=h(),qt=h(),Pt=h(),Ht=h(),Fe=h(),nr=D(),Qe={start:h(),end:h(),type:1},rr={start:h(),end:h(),type:1};class E{intersect(e){return Z(this,e)}closestPoints(e){return[this.closestTo(e)]}}class ie extends E{constructor(e){super(),this.point=e}equals(e){return this===e||R(e)&&w(this.point,e.point)}closestTo(){return X(this.point)}}class Ke extends E{constructor(e,n,r){super(),this.start=e,this.end=n,this.lineLike={start:e,end:n,type:r}}equals(e){return this===e||q(e)&&this.lineLike.type===e.lineLike.type&&w(this.start,e.start)&&w(this.end,e.end)}closestTo(e){const n=z();return Et(e,this.lineLike,n),n}}class Zt extends Ke{constructor(e,n){super(e,n,1)}}class sr extends Ke{constructor(e,n){super(e,n,0)}}class At extends E{constructor(e){super(),this.constraints=e}equals(e){return this===e||Ie(e)&&xn(this.constraints,e.constraints,(n,r)=>n.equals(r))}closestTo(e){let n,r=1/0;for(const i of this.constraints){const s=i.closestTo(e),a=Pe(e,s);a<r&&(r=a,n=s)}return X(n??e)}closestPoints(e){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(e))}}class ir extends E{constructor(e,n){super(),this.center=e,this.radius=n}equals(e){return this===e||H(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const n=z();return Dt(e,this.center,this.radius,n),n}}class Xe extends E{constructor(e,n){super(),this.center=e,this.radius=n}equals(e){return this===e||F(e)&&w(this.center,e.center)&&this.radius===e.radius}closestTo(e){const n=z();return Dt(e,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new Ye(X(this.center),this.radius,U(0,0,1))}}class Ye extends E{constructor(e,n,r,i=void 0){super(),this.center=e,this.radius=n,this.normal=r,this.slicePlane=i}equals(e){return this===e||G(e)&&w(this.center,e.center)&&w(this.normal,e.normal)&&this.radius===e.radius}closestTo(e){const{center:n,radius:r}=this;xt(this.getPlane(ar),e,je);const i=M(je,je,n),s=Sn(i);if(y(s,0))return X(e);const a=r/Math.sqrt(s),o=z();_(o,n,i,a);const{slicePlane:u}=this;return u&&!W(u,o)?tt(u,this)?.closestTo(e)??X(e):o}getPlane(e=D()){return Te(this.center,this.normal,e)}}const je=h(),ar=D();class or extends E{constructor(e){super(),this.z=e}equals(e){return this===e||A(e)&&this.z===e.z}closestTo(e){return U(e[0],e[1],this.z)}getPlane(e=D()){return C(ct,0,0,this.z),Te(ct,wn,e)}}const ct=h();class et extends E{constructor(e,n,r){super(),this.start=e,this.end=n,this.planeLike={start:e,end:n,type:r}}equals(e){return this===e||P(e)&&this.planeLike.type===e.planeLike.type&&w(this.start,e.start)&&w(this.end,e.end)}closestTo(e){const n=z();return kt(e,this.planeLike,n),n}closestEndTo(e){const{start:n,end:r}=this.planeLike;return Math.sign(Le(K(ur,r,n),K(lr,e,n)))>0?this.end:this.start}getPlane(e=D()){const n=bt(ft,this.end);return n[2]+=1,gn(this.start,this.end,n,e)}getSlicePlane(e=D()){const{start:n,end:r,type:i}=this.planeLike;if(i===0)return;const s=C(ft,n[0],n[1],0),a=C(pt,r[0],r[1],0),o=Ge(pt,a,s);return Te(s,o,e),e}}const ur=Q(),lr=Q(),ft=h(),pt=h();class ys extends et{constructor(e,n){super(e,n,1)}}class gs extends et{constructor(e,n){super(e,n,0)}}class cr extends E{constructor(e,n){super(),this.sphere=_n(e,n),this._center=B(e)}equals(e){return this===e||I(e)&&Ln(this.sphere,e.sphere)}closestTo(e){const n=z();return Tn(this.sphere,e,n),n}get center(){return this._center}get radius(){return this.sphere[3]}}class fr extends E{constructor(e,n,r){super(),this.start=e,this.end=n,this.getZ=r,this.planeLike={start:e,end:n,type:0}}equals(e){return this===e||we(e)&&w(this.start,e.start)&&w(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return $r(this,e)}addIfOnTheGround(e,n){for(const r of n){const i=this.getZ(r[0],r[1])??0;y(r[2],i)&&(r[2]=i,e.push(r))}}}class pr extends E{constructor(e,n,r){super(),this._x=e,this._y=n,this._z=r}equals(e){return this===e||Rr(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,n,r]){return Mt(this._x??e,this._y??n,this._z??r)}}class hr extends E{constructor(e,n,r,i,s){super(),this._origin=e,this._spatialReference=n,this._distanceMeters=r,this._z=i,this._directionDegrees=s}equals(e){return this===e||Er(e)&&it(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._z===e._z&&this._directionDegrees===e._directionDegrees}closestTo([e,n,r]){return vt(Y,e,n),it(Y,this._origin)||this._applyDirectionAndDistance(Y),Mt(Y[0],Y[1],this._z??r)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)Ae(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)yr(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:n}=We(dr,this._origin,e,this._spatialReference);Ae(e,this._origin,n??0,this._distanceMeters,this._spatialReference)}}}const Y=[0,0],dr=new Ce;function yr(t,e,n,r,i){let{azimuth:s,distance:a}=We(gr,e,r,i);s??=0;let o=a*Math.cos((s-n)*En);o=Math.max(0,o),Ae(t,e,n,o,i)}const gr=new Ce;function $r(t,e){const n=z();return kt(e,t.planeLike,n),n[2]=t.getZ(n[0],n[1])??It,n}function Z(t,e){if(Ie(t)){const n=[];for(const r of t.constraints){const i=r.intersect(e);i&&n.push(i)}return nt(n)}if(Ie(e))return Z(e,t);if(we(t))return ht(t,e);if(we(e))return ht(e,t);if(R(t)){const{point:n}=t;if(R(e))return w(n,e.point)?t:void 0;const r=e.closestTo(n);return $n(r,n)?t:void 0}if(q(t)){if(R(e))return Z(e,t);if(q(e))return O(jt(t.lineLike,e.lineLike));if(A(e))return br(t,e);if(P(e))return O(zt(e.planeLike,t.lineLike));if(H(e))return O(Rt(t.lineLike,e.center,e.radius));if(G(e))return O(Xn(t.lineLike,e));if(F(e))return mr(t,e);if(I(e))return vr(t,e)}else if(A(t)){if(R(e)||q(e))return Z(e,t);if(A(e))return xr(t,e);if(P(e))return wr(t,e);if(H(e))return Sr(t,e);if(G(e))return Lr(t,e);if(F(e))return _r(t,e);if(I(e))return Tr(t,e)}else if(P(t)){if(R(e)||q(e)||A(e))return Z(e,t);if(P(e))return Oe(Nt(t.planeLike,e.planeLike));if(H(e))return Oe(Be(t.planeLike,e.center,e.radius));if(G(e))return zr(t,e);if(F(e))return Mr(t,e);if(I(e))return Nr(t,e)}else if(H(t)){if(R(e)||q(e)||A(e)||P(e))return Z(e,t);if(H(e))return Oe(Ue(t.center,t.radius,e.center,e.radius));if(G(e))return void 0;if(F(e))return kr(t,e);if(I(e))return void 0}else if(G(t)){if(R(e)||q(e)||A(e)||P(e)||H(e))return Z(e,t);if(G(e))return void 0;if(F(e))return e.asCircle(),void 0;if(I(e))return void 0}else if(F(t)){if(R(e)||q(e)||A(e)||P(e)||H(e)||G(e))return Z(e,t);if(F(e))return Dr(e,t);if(I(e))return void 0}else if(I(t)){if(R(e)||q(e)||A(e)||P(e)||H(e)||F(e))return Z(e,t);if(I(e))return void 0}}const br=(()=>{const t=D();return(e,n)=>{const{start:r,end:i}=e;if(Ot(r,i)&&y(r[2],n.z))return e;const s=z();return mt(n.getPlane(t),r,i,s)?new ie(s):void 0}})();function mr({lineLike:t},{center:e,radius:n}){const r=e[2];return O(Rt(t,e,n).filter(i=>y(i[2],r)))}function vr({lineLike:t},{sphere:e}){return O(mn(e,t.start,t.end))}const tt=(()=>{const t=kn(),e=h(),n=h();return(r,i,s)=>{const{normal:a,center:o,radius:u}=i;$t(a,e,n);const l=wt(r),p=u*T(l,e),d=u*T(l,n);Mn(t,o[0],o[1],o[2],1);const b=zn(r,t),$=Math.hypot(p,d),x=y($,0);if(y(Ze(r,o),0)){if(x)return i;if(y(u,0))return!s||W(s,o)?new ie(X(o)):void 0;me(e,l,a),Nn(e,e);const Ee=new Array,le=B(o);_(le,le,e,u),s&&!W(s,le)||Ee.push(le);const ce=B(o);return _(ce,ce,e,-u),s&&!W(s,ce)||Ee.push(ce),O(Ee)}if(x)return;const L=-b/$;if(Math.abs(L)>1||y(L,1))return;const N=Math.atan(p/d),J=Dn(L)-N,rt=Math.PI-J,ae=new Array,oe=h();_(oe,o,e,u*Math.cos(J)),_(oe,oe,n,u*Math.sin(J)),ae.push(oe);const ue=h();return _(ue,o,e,u*Math.cos(rt)),_(ue,ue,n,u*Math.sin(rt)),ae.push(ue),O(s?er(s,ae):ae)}})();function xr(t,e){return y(t.z,e.z)?t:void 0}function wr({z:t},{planeLike:e}){const[n,r]=e.start,[i,s]=e.end,a=U(n,r,t),o=U(i,s,t);return e.type===0?new Zt(a,o):new sr(a,o)}function Sr(t,e){const[n,r]=e.center;return new Xe(U(n,r,t.z),e.radius)}function _r(t,e){return y(e.center[2],t.z)?e:void 0}const Lr=(()=>{const t=D();return(e,n)=>tt(e.getPlane(t),n,n.slicePlane)})();function Tr(t,{center:e,radius:n}){const r=Math.abs(e[2]-t.z);if(r>n&&!y(r,n))return;const i=U(e[0],e[1],t.z),s=Math.sqrt(n**2-r**2);return y(s,0)?void 0:new Xe(i,s)}const Mr=(()=>{const t=D();return(e,{center:n,radius:r})=>{const i=Be(e.planeLike,n,r),s=n[2];e.getSlicePlane(t);const a=new Array;for(const[o,u]of i){const l=[o,u,s];W(t,l)&&a.push(l)}return O(a)}})(),zr=(()=>{const t=D(),e=D();return(n,r)=>tt(n.getPlane(t),r,n.getSlicePlane(e))})(),Nr=(()=>{const t=D();return(e,{center:n,radius:r})=>{const i=e.getPlane(t),s=vn(i,n),a=Math.abs(s);if(a>r&&!y(a,r))return;const o=Math.sqrt(r**2-s**2);if(y(o,0)){const p=z();return xt(i,n,p),new ie(p)}const u=z(),l=B(wt(i));return _(u,n,l,s),new Ye(u,o,l,e.getSlicePlane())}})();function kr(t,e){const n=St(t.center,e.center);return y(n,0)&&y(t.radius,e.radius)?e:Ft(Ue(t.center,t.radius,e.center,e.radius),e.center[2])}function Dr(t,e){if(!Ot(t.center,e.center))return;const n=St(t.center,e.center);return y(n,0)&&y(t.radius,e.radius)?t:Ft(Ue(t.center,t.radius,e.center,e.radius),t.center[2])}function ht(t,e){const{planeLike:n,getZ:r}=t,i=new Array;if(R(e))t.addIfOnTheGround(i,Kn(n,e.point));else if(q(e))t.addIfOnTheGround(i,zt(n,e.lineLike));else if(H(e))for(const[s,a]of Be(n,e.center,e.radius)){const o=r(s,a);o!=null&&i.push($e(s,a,o))}else if(P(e)||we(e))for(const[s,a]of Nt(n,e.planeLike)){const o=r(s,a)??It;i.push($e(s,a,o))}return O(i)}function Oe(t){return nt(t.map(([e,n])=>{const r=U(e,n,0),i=U(e,n,1);return new Zt(r,i)}))}function O(t){return nt(t.map(e=>e?new ie(e):void 0))}function Ft(t,e){return O(t.map(([n,r])=>[n,r,e]))}function nt(t){if(t.length!==0)return t.length===1?t[0]??void 0:new At(t.filter(bn))}function Ie(t){return t instanceof At}function R(t){return t instanceof ie}function q(t){return t instanceof Ke}function A(t){return t instanceof or}function P(t){return t instanceof et}function H(t){return t instanceof ir}function F(t){return t instanceof Xe}function G(t){return t instanceof Ye}function I(t){return t instanceof cr}function we(t){return t instanceof fr}function Er(t){return t instanceof hr}function Rr(t){return t instanceof pr}const It=0;let ke=class{constructor(e,n){this.isDraped=e,this.domain=n}};class Vt extends ke{constructor(e,n,r,i,s=3,a=!0,o=!0){super(i,s),this.type=e,this.lineStart=n,this.lineEnd=r,this.fadeLeft=a,this.fadeRight=o}equals(e){return e instanceof Vt&&this.type===e.type&&w(this.lineStart,e.lineStart)&&w(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}get length(){return te(this.lineStart,this.lineEnd)}}class Gt extends ke{constructor(e,n,r=3){super(n,r),this.intersectionPoint=e}equals(e){return e instanceof Gt&&w(this.intersectionPoint,e.intersectionPoint)}}let bs=class Wt extends ke{constructor(e,n,r,i=3){super(r,i),this.lineStart=e,this.lineEnd=n}equals(e){return e instanceof Wt&&w(this.lineStart,e.lineStart)&&w(this.lineEnd,e.lineEnd)}},ms=class Ct extends ke{constructor(e,n,r,i,s=3){super(i,s),this.previousVertex=e,this.centerVertex=n,this.nextVertex=r}equals(e){return e instanceof Ct&&w(this.previousVertex,e.previousVertex)&&w(this.centerVertex,e.centerVertex)&&w(this.nextVertex,e.nextVertex)}};function jr(t){const{spatialReference:e}=t;return _t(e,Zr,Ar,t)}function Or(t,e){if(!re(t.spatialReference,e.spatialReference))return null;const{spatialReference:n}=t;return fe[0]=t.x,fe[1]=t.y,fe[2]=t.hasZ?t.z:0,pe[0]=e.x,pe[1]=e.y,pe[2]=e.hasZ?e.z:0,Bt(fe,pe,n)}function Bt(t,e,n){return _t(n,Pr,Hr,t,e,n)}const qr={geodesicLength:jr,geodesicDistanceBetweenPoints:Or,geodesicDistance:Bt};async function vs(){return await Gn(),qr}function Pr(t,e,n){return k(We(Ir,t,e,n).distance,"meters")}function Hr(t,e,n){return k(Tt(Fr(t,e,n),{unit:"meters"}),"meters")}function Zr(t){return k(Rn([t],"meters")[0],"meters")}function Ar(t){return k(Tt(t,{unit:"meters"}),"meters")}function Fr(t,e,n){return new jn({spatialReference:n,paths:[[[...t],[...e]]]})}const Ir=new Ce,fe=h(),pe=h();function Ut(t){return qn(t)?Pn(t)||Hn(t)||Zn(t)||An(t)?On:t:Fn(t)}function xs(t){return Vr(t)}function Vr(t,e){const{hasZ:n,spatialReference:r}=t,i=Ut(r);let s=0;const a=Lt(i);if(a==null)return null;const o=Jt;for(const u of t.paths){if(u.length<2)continue;const l=u.length-1;for(let p=0;p<l;++p){const d=u[p];m[0]=d[0],m[1]=d[1],m[2]=n?d[2]:0;const b=u[p+1];v[0]=b[0],v[1]=b[1],v[2]=n?b[2]:0;const $=o(m,v,r);if($==null)return null;s+=$.value}}return k(s,a)}function ws(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Wr(m,v,n)):null}function Ss(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Cr(m,v,n)):null}function _s(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Jt(m,v,n)):null}function Ls(t,e){const{spatialReference:n}=t;return re(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,v[0]=e.x,v[1]=e.y,v[2]=e.hasZ?e.z:0,Br(m,v,n)):null}function Ts(t){return t!=null?Gr(t.hasZ?t.z:0,t.spatialReference):null}function Gr(t,e){const n=In(e);return n!=null?k(t??0,n):null}function Wr(t,e,n){const r=De(t,e,n);return r!=null?{direct:k(r.direct,r.unit),horizontal:k(r.horizontal,r.unit),vertical:k(r.vertical,r.unit)}:null}function Cr(t,e,n){const r=De(t,e,n,0);return r!=null?k(r.direct,r.unit):null}function Jt(t,e,n){const r=De(t,e,n,1);return r!=null?k(r.horizontal,r.unit):null}function Br(t,e,n){const r=De(t,e,n,2);return r!=null?k(r.verticalSigned,r.unit):null}function De(t,e,n,r){const i=Ut(n),s=Lt(i);if(s==null)return null;const a=e[2]-t[2];if(r===2)return{verticalSigned:a,unit:s};if(!Re(t,n,qe,i)||!Re(e,n,he,i))return null;if(r===0)return{direct:te(he,qe),unit:s};if(C(de,t[0],t[1],e[2]),!Re(de,n,de,i))return null;const o=te(de,he);return r===1?{horizontal:o,unit:s}:{direct:te(he,qe),horizontal:o,vertical:Math.abs(a),unit:s}}const m=h(),v=h(),qe=h(),he=h(),de=h();export{es as A,Kr as B,Wn as C,ys as D,ns as E,pr as F,ir as G,nt as H,rs as I,R as J,Ts as K,Jn as L,or as M,ds as N,fs as O,Et as P,fr as Q,Zt as R,gs as S,Gr as T,hr as U,Ss as V,Cr as W,Ls as X,Br as Y,Jt as Z,ws as _,Vt as a,ms as b,ke as c,xs as d,V as e,os as f,vs as g,z as h,Gt as i,Yr as j,U as k,Mt as l,_s as m,ie as n,cs as o,ot as p,Ut as q,bs as r,Xr as s,at as t,S as u,us as v,ps as w,hs as x,ls as y,ts as z};
