import{oZ as T,o_ as V,kT as E,eS as f,db as L,aR as O,c0 as y,c1 as j,bU as R,o$ as w,c5 as I,a0 as U,p0 as Z,I as g,p1 as C,p2 as M,p3 as S}from"./index-CgzAF5Ey.js";import{U as k}from"./utils-CAdwX-R_.js";import{R as A,T as D,F}from"./dateUtils-DYfP5vP8.js";const ee=(e,t)=>{if(!e)return!0;const{operations:n}=e;switch(t){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};function te(e,t){const{dataType:n,domain:i,field:r,maxLength:a,minLength:o,range:l,required:u}=t;if(e==null)return u?"input-validation-error::cannot-be-empty":null;if(n==="text"&&typeof e=="string"){if(o>-1&&e.length<o)return"length-validation-error::too-short";if(a>-1&&e.length>a)return"length-validation-error::too-long"}return n!=="date"||A({type:r.type,range:l,value:e})?i?V(r,e,i):E(r,e):"numeric-range-validation-error::out-of-range"}function ne(e,t){return!(!b(e)||!b(t))||e===t}function b(e){return e==null||e===""}function re({dataType:e,field:t,input:n}){if(e==="date")return-1;const r=p(t.length);if(!n||!T(n))return r;const a=p(n.maxLength);return a===-1?r:r===-1?a:Math.min(r,a)}function ie({dataType:e,field:t,input:n}){if(e==="date"||!n||!T(n))return-1;const r=p(n.minLength);if(r<0)return-1;const a=p(t.length);return a>-1&&a<r?-1:r}function p(e){return typeof e=="number"&&e>-1?e:-1}const h={type:"number"},v={type:"number",intlOptions:{notation:"scientific"}};function $(e){return e>=1e7||e<=-1e7}function W(e,t){return e.max!=null&&e.min!=null?t.outsideRange:e.max!=null?t.outsideRangeMax:t.outsideRangeMin}const oe=e=>e&&!Number.isNaN(e.valueOf()),q=e=>e?.type==="field",N=e=>e?.type==="group",z=e=>e?.type==="relationship",ae=e=>e.type==="text",B=e=>e.type==="utilityNetworkAssociations",K=e=>!N(e)&&e.group!=null,ue=(e,t)=>K(e)&&e.group===t,c=e=>e.reduce((t,n)=>N(n)?[...t,...n.inputs]:[...t,n],[]),le=e=>c(e).filter(q),se=e=>c(e).filter(z),pe=e=>c(e).filter(B),de=e=>e!=null&&(x(e,"combo-box")||x(e,"radio-buttons")),x=(e,t)=>e!=null&&e.input?.type===t,me=({domain:e,inputType:t="text-box",dataType:n})=>n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value");function fe(e){const{attributes:t,layer:n,label:i,timeZone:r}=e;if(!t||typeof t!="object")return i;const a=Object.keys(t).filter(u=>f(i,u)),o=a.map(u=>t[u]),l=a.map(u=>n.fieldsIndex.get(u)).filter(O);return J(i,G({fields:l,layer:n,timeZone:r,values:o}))}const d="expression/",P="expr/",_="field/";function ce(e){const[t,n]=e.split(d);return t===""&&n?n:(U.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${d}/expressionName'`),"")}function ye(e){return`${d}${e}`}function ge(e){return`${_}${e}`}function be(e){return e.startsWith(d)}function he(e){return e.startsWith(P)}function G(e){const{layer:t,values:n}=e,i=e.fields??t.fields??[],r=e.timeZone??void 0,a=i.map((o,l)=>{let u=n[l];if(o.domain&&o.domain.type==="coded-value"){const s=o.domain.codedValues.find(m=>m.code===u);s?.name&&(u=s.name)}return(k(o)||j(o))&&(u=D(o,u,{timeZone:r,...H(t,o)})),[o.name,u]});return Object.fromEntries(a)}function H(e,t){if(R(e)){const n=e.getFieldConfiguration(t.name)?.fieldFormat??w(t);if(n?.type==="date-time")return I(n)}return F(t)}function J(e,t){return y(y(e,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(t).map(([n,i])=>[n.toLowerCase(),i])))}const ve=e=>{const t={typeFieldName:null,types:[]};return e&&(L(e)?(t.typeFieldName=e.parent?.subtypeField,t.types=e.parent?.subtypes??[]):e.type==="subtype-group"||e.type==="feature"&&e.subtypes?.length?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map(({id:n,name:i,domains:r})=>({code:n,name:i,domains:r}))),t.typeFieldName!=null&&(t.typeFieldName=e.getField(t.typeFieldName)?.name??t.typeFieldName)),t},$e=(e,t,n)=>{const{dataType:i,error:r,minLength:a}=e,o=t?.validationErrors;if(!o||!r)return null;if(r==="input-validation-error::cannot-be-empty")return o.cannotBeNull;if(r==="domain-validation-error::value-out-of-range"||r==="numeric-range-validation-error::out-of-range"){const{field:l,range:u}=e,s={type:"date",intlOptions:{timeZone:l.type==="date"&&n?n:void 0,...F(l)}},m=W(u,o);return g(m,u,{format:{max:i==="date"?s:u.max!=null&&$(u.max)?v:h,min:i==="date"?s:u.min!=null&&$(u.min)?v:h}})}return r==="domain-validation-error::invalid-coded-value"?o.invalidCodedValue:r==="type-validation-error::invalid-type"?o.invalidType:r==="length-validation-error::too-short"?g(o.tooShort,{min:a}):null},xe=e=>{if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,i=e.geometry?.type;return i==="polyline"||n==="polyline"?"line":i==="mesh"||n==="mesh"||n==="multipatch"?"cube":i==="multipoint"||n==="multipoint"?"point":i||n||"table"},Te=e=>{const t=[];if(e.formTemplate){const{description:n,title:i}=e.formTemplate;e.fields?.forEach(r=>{const a=i&&f(i,r.name),o=n&&f(n,r.name);(a||o)&&t.push(r.name)})}return t};function Fe(e,t){const n=t??("formTemplate"in e&&e.formTemplate);return n?(n.elements?.filter(S)??[]).some(({fieldName:i})=>!e.fieldsIndex.get(i)):!1}function Ne(e,t){return e==null||t.onValue!==e&&t.offValue!==e}function Ve(e,t){switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===t.codedValue?.code;case"range":return e!=null&&t.minValue!=null&&t.maxValue!=null&&+e>=t.minValue&&+e<=t.maxValue;default:return Z(t.objectType),!1}}function Ee(e,t,n){const i=C(e),r=i?.find(o=>o.code===n);if(!r)return!1;const a=i?.find(o=>o.code===t);return!M(r.defaultValues,a?.defaultValues)&&Object.values(r.defaultValues).some(o=>o!=null)}export{ue as $,ce as B,x as C,he as D,se as E,q as F,G,me as I,ve as K,pe as L,ye as M,z as N,c as O,$e as P,xe as Q,Te as R,ae as T,K as U,B as V,Fe as X,Ne as Y,de as Z,Ve as _,b as a,v as c,W as d,Ee as e,oe as g,N as h,te as i,fe as k,ie as l,$ as m,ee as o,h as p,ge as q,re as s,ne as u,le as w,be as z};
