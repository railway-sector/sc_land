import{o7 as T,o8 as V,lI as E,o9 as f,O as y,oa as L,ob as O,aK as j,cN as w,oc as I,bT as g,bU as R,bV as U,od as Z,bK as C,oe as M,of as A,a4 as K}from"./index-CVzGOCNQ.js";import{R as S,F,T as k}from"./dateUtils-CPMrUQV3.js";const _=(e,t)=>{if(!e)return!0;const{operations:n}=e;switch(t){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};function ee(e,t){const{dataType:n,domain:i,field:r,maxLength:a,minLength:o,range:l,required:u}=t;if(e==null)return u?"input-validation-error::cannot-be-empty":null;if(n==="text"&&typeof e=="string"){if(o>-1&&e.length<o)return"length-validation-error::too-short";if(a>-1&&e.length>a)return"length-validation-error::too-long"}return n!=="date"||S({type:r.type,range:l,value:e})?i?V(r,e,i):E(r,e):"numeric-range-validation-error::out-of-range"}function te(e,t){return!(!b(e)||!b(t))||e===t}function b(e){return e==null||e===""}function ne({dataType:e,field:t,input:n}){if(e==="date")return-1;const r=d(t.length);if(!n||!T(n))return r;const a=d(n.maxLength);return a===-1?r:r===-1?a:Math.min(r,a)}function re({dataType:e,field:t,input:n}){if(e==="date"||!n||!T(n))return-1;const r=d(n.minLength);if(r<0)return-1;const a=d(t.length);return a>-1&&a<r?-1:r}function d(e){return typeof e=="number"&&e>-1?e:-1}const h={type:"number"},v={type:"number",intlOptions:{notation:"scientific"}};function x(e){return e>=1e7||e<=-1e7}function D(e,t){return e.max!=null&&e.min!=null?t.outsideRange:e.max!=null?t.outsideRangeMax:t.outsideRangeMin}const ie=e=>e&&!Number.isNaN(e.valueOf()),W=e=>e?.type==="field",N=e=>e?.type==="group",q=e=>e?.type==="relationship",oe=e=>e.type==="text",z=e=>e.type==="utilityNetworkAssociations",B=e=>!N(e)&&e.group!=null,ae=(e,t)=>B(e)&&e.group===t,c=e=>e.reduce((t,n)=>N(n)?[...t,...n.inputs]:[...t,n],[]),ue=e=>c(e).filter(W),le=e=>c(e).filter(q),se=e=>c(e).filter(z),de=e=>e!=null&&($(e,"combo-box")||$(e,"radio-buttons")),$=(e,t)=>e!=null&&e.input?.type===t,pe=({domain:e,inputType:t="text-box",dataType:n})=>n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value");function me(e){const{attributes:t,layer:n,label:i,timeZone:r}=e;if(!t||typeof t!="object")return i;const a=Object.keys(t).filter(u=>f(i,u)),o=a.map(u=>t[u]),l=a.map(u=>n.fieldsIndex.get(u)).filter(j);return Q(i,H({fields:l,layer:n,timeZone:r,values:o}))}const p="expression/",P="expr/",G="field/";function fe(e){const[t,n]=e.split(p);return t===""&&n?n:(K.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${p}/expressionName'`),"")}function ce(e){return`${p}${e}`}function ye(e){return`${G}${e}`}function ge(e){return e.startsWith(p)}function be(e){return e.startsWith(P)}function H(e){const{layer:t,values:n}=e,i=e.fields??t.fields??[],r=e.timeZone??void 0,a=i.map((o,l)=>{let u=n[l];if(o.domain&&o.domain.type==="coded-value"){const s=o.domain.codedValues.find(m=>m.code===u);s?.name&&(u=s.name)}return(R(o)||U(o))&&(u=k(o,u,{timeZone:r,...J(t,o)})),[o.name,u]});return Object.fromEntries(a)}function J(e,t){if(C(e)){const n=e.getFieldConfiguration(t.name)?.fieldFormat??M(t);if(n?.type==="date-time")return A(n)}return F(t)}function Q(e,t){return g(g(e,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(t).map(([n,i])=>[n.toLowerCase(),i])))}const he=e=>{const t={typeFieldName:null,types:[]};return e&&(w(e)?(t.typeFieldName=e.parent?.subtypeField,t.types=e.parent?.subtypes??[]):e.type==="subtype-group"||e.type==="feature"&&e.subtypes?.length?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map(({id:n,name:i,domains:r})=>({code:n,name:i,domains:r}))),t.typeFieldName!=null&&(t.typeFieldName=e.getField(t.typeFieldName)?.name??t.typeFieldName)),t},ve=(e,t,n)=>{const{dataType:i,error:r,minLength:a}=e,o=t?.validationErrors;if(!o||!r)return null;if(r==="input-validation-error::cannot-be-empty")return o.cannotBeNull;if(r==="domain-validation-error::value-out-of-range"||r==="numeric-range-validation-error::out-of-range"){const{field:l,range:u}=e,s={type:"date",intlOptions:{timeZone:l.type==="date"&&n?n:void 0,...F(l)}},m=D(u,o);return y(m,u,{format:{max:i==="date"?s:u.max!=null&&x(u.max)?v:h,min:i==="date"?s:u.min!=null&&x(u.min)?v:h}})}return r==="domain-validation-error::invalid-coded-value"?o.invalidCodedValue:r==="type-validation-error::invalid-type"?o.invalidType:r==="length-validation-error::too-short"?y(o.tooShort,{min:a}):null},xe=e=>{if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,i=e.geometry?.type;return i==="polyline"||n==="polyline"?"line":i==="mesh"||n==="mesh"||n==="multipatch"?"cube":i==="multipoint"||n==="multipoint"?"point":i||n||"table"},$e=e=>{const t=[];if(e.formTemplate){const{description:n,title:i}=e.formTemplate;e.fields?.forEach(r=>{const a=i&&f(i,r.name),o=n&&f(n,r.name);(a||o)&&t.push(r.name)})}return t};function Te(e,t){const n=t??("formTemplate"in e&&e.formTemplate);return n?(n.elements?.filter(Z)??[]).some(({fieldName:i})=>!e.fieldsIndex.get(i)):!1}function Fe(e,t){return e==null||t.onValue!==e&&t.offValue!==e}function Ne(e,t){switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===t.codedValue?.code;case"range":return e!=null&&t.minValue!=null&&t.maxValue!=null&&+e>=t.minValue&&+e<=t.maxValue;default:return I(t.objectType),!1}}function Ve(e,t,n){const i=L(e),r=i?.find(o=>o.code===n);if(!r)return!1;const a=i?.find(o=>o.code===t);return!O(r.defaultValues,a?.defaultValues)&&Object.values(r.defaultValues).some(o=>o!=null)}export{ae as $,fe as B,$ as C,be as D,le as E,W as F,H as G,pe as I,he as K,se as L,ce as M,q as N,c as O,ve as P,xe as Q,$e as R,oe as T,B as U,z as V,Te as X,Fe as Y,de as Z,Ne as _,b as a,v as c,D as d,Ve as e,ie as g,N as h,ee as i,me as k,re as l,x as m,_ as o,h as p,ye as q,ne as s,te as u,ue as w,ge as z};
