import{oS as T,oT as V,lt as E,eS as f,dd as L,aQ as O,b$ as y,c0 as j,bT as w,oU as R,c4 as U,$ as I,oV as S,oW as Z,oX as C,oY as M}from"./index-BrQW8HOS.js";import{U as A}from"./utils-BJ7fw6dI.js";import{R as W,T as k,F}from"./dateUtils-DCwqoPkL.js";import{s as g}from"./substitute-D-eLZ17Q.js";const te=(e,t)=>{if(!e)return!0;const{operations:n}=e;switch(t){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};function ne(e,t){const{dataType:n,domain:i,field:r,maxLength:a,minLength:o,range:l,required:u}=t;if(e==null)return u?"input-validation-error::cannot-be-empty":null;if(n==="text"&&typeof e=="string"){if(o>-1&&e.length<o)return"length-validation-error::too-short";if(a>-1&&e.length>a)return"length-validation-error::too-long"}return n!=="date"||W({type:r.type,range:l,value:e})?i?V(r,e,i):E(r,e):"numeric-range-validation-error::out-of-range"}function re(e,t){return!(!b(e)||!b(t))||e===t}function b(e){return e==null||e===""}function ie({dataType:e,field:t,input:n}){if(e==="date")return-1;const r=d(t.length);if(!n||!T(n))return r;const a=d(n.maxLength);return a===-1?r:r===-1?a:Math.min(r,a)}function oe({dataType:e,field:t,input:n}){if(e==="date"||!n||!T(n))return-1;const r=d(n.minLength);if(r<0)return-1;const a=d(t.length);return a>-1&&a<r?-1:r}function d(e){return typeof e=="number"&&e>-1?e:-1}const h={type:"number"},v={type:"number",intlOptions:{notation:"scientific"}};function $(e){return e>=1e7||e<=-1e7}function D(e,t){return e.max!=null&&e.min!=null?t.outsideRange:e.max!=null?t.outsideRangeMax:t.outsideRangeMin}const ae=e=>e&&!Number.isNaN(e.valueOf()),q=e=>e?.type==="field",N=e=>e?.type==="group",z=e=>e?.type==="relationship",ue=e=>e.type==="text",B=e=>e.type==="utilityNetworkAssociations",K=e=>!N(e)&&e.group!=null,le=(e,t)=>K(e)&&e.group===t,c=e=>e.reduce((t,n)=>N(n)?[...t,...n.inputs]:[...t,n],[]),se=e=>c(e).filter(q),de=e=>c(e).filter(z),pe=e=>c(e).filter(B),me=e=>e!=null&&(x(e,"combo-box")||x(e,"radio-buttons")),x=(e,t)=>e!=null&&e.input?.type===t,fe=({domain:e,inputType:t="text-box",dataType:n})=>n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value");function ce(e){const{attributes:t,layer:n,label:i,timeZone:r}=e;if(!t||typeof t!="object")return i;const a=Object.keys(t).filter(u=>f(i,u)),o=a.map(u=>t[u]),l=a.map(u=>n.fieldsIndex.get(u)).filter(O);return G(i,X({fields:l,layer:n,timeZone:r,values:o}))}const p="expression/",P="expr/",Q="field/";function ye(e){const[t,n]=e.split(p);return t===""&&n?n:(I.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${p}/expressionName'`),"")}function ge(e){return`${p}${e}`}function be(e){return`${Q}${e}`}function he(e){return e.startsWith(p)}function ve(e){return e.startsWith(P)}function X(e){const{layer:t,values:n}=e,i=e.fields??t.fields??[],r=e.timeZone??void 0,a=i.map((o,l)=>{let u=n[l];if(o.domain&&o.domain.type==="coded-value"){const s=o.domain.codedValues.find(m=>m.code===u);s?.name&&(u=s.name)}return(A(o)||j(o))&&(u=k(o,u,{timeZone:r,...Y(t,o)})),[o.name,u]});return Object.fromEntries(a)}function Y(e,t){if(w(e)){const n=e.getFieldConfiguration(t.name)?.fieldFormat??R(t);if(n?.type==="date-time")return U(n)}return F(t)}function G(e,t){return y(y(e,n=>`{${n.toLowerCase()}}`),Object.fromEntries(Object.entries(t).map(([n,i])=>[n.toLowerCase(),i])))}const $e=e=>{const t={typeFieldName:null,types:[]};return e&&(L(e)?(t.typeFieldName=e.parent?.subtypeField,t.types=e.parent?.subtypes??[]):e.type==="subtype-group"||e.type==="feature"&&e.subtypes?.length?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map(({id:n,name:i,domains:r})=>({code:n,name:i,domains:r}))),t.typeFieldName!=null&&(t.typeFieldName=e.getField(t.typeFieldName)?.name??t.typeFieldName)),t},xe=(e,t,n)=>{const{dataType:i,error:r,minLength:a}=e,o=t?.validationErrors;if(!o||!r)return null;if(r==="input-validation-error::cannot-be-empty")return o.cannotBeNull;if(r==="domain-validation-error::value-out-of-range"||r==="numeric-range-validation-error::out-of-range"){const{field:l,range:u}=e,s={type:"date",intlOptions:{timeZone:l.type==="date"&&n?n:void 0,...F(l)}},m=D(u,o);return g(m,u,{format:{max:i==="date"?s:u.max!=null&&$(u.max)?v:h,min:i==="date"?s:u.min!=null&&$(u.min)?v:h}})}return r==="domain-validation-error::invalid-coded-value"?o.invalidCodedValue:r==="type-validation-error::invalid-type"?o.invalidType:r==="length-validation-error::too-short"?g(o.tooShort,{min:a}):null},Te=e=>{if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,i=e.geometry?.type;return i==="polyline"||n==="polyline"?"line":i==="mesh"||n==="mesh"||n==="multipatch"?"cube":i==="multipoint"||n==="multipoint"?"point":i||n||"table"},Fe=e=>{const t=[];if(e.formTemplate){const{description:n,title:i}=e.formTemplate;e.fields?.forEach(r=>{const a=i&&f(i,r.name),o=n&&f(n,r.name);(a||o)&&t.push(r.name)})}return t};function Ne(e,t){const n=t??("formTemplate"in e&&e.formTemplate);return n?(n.elements?.filter(M)??[]).some(({fieldName:i})=>!e.fieldsIndex.get(i)):!1}function Ve(e,t){return e==null||t.onValue!==e&&t.offValue!==e}function Ee(e,t){switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===t.codedValue?.code;case"range":return e!=null&&t.minValue!=null&&t.maxValue!=null&&+e>=t.minValue&&+e<=t.maxValue;default:return S(t.objectType),!1}}function Le(e,t,n){const i=Z(e),r=i?.find(o=>o.code===n);if(!r)return!1;const a=i?.find(o=>o.code===t);return!C(r.defaultValues,a?.defaultValues)&&Object.values(r.defaultValues).some(o=>o!=null)}export{le as $,ye as B,x as C,ve as D,de as E,q as F,X as G,fe as I,$e as K,pe as L,ge as M,z as N,c as O,xe as P,Te as Q,Fe as R,ue as T,K as U,B as V,Ne as X,Ve as Y,me as Z,Ee as _,b as a,v as c,D as d,Le as e,ae as g,N as h,ne as i,ce as k,oe as l,$ as m,te as o,h as p,be as q,ie as s,re as u,se as w,he as z};
