import{iD as f}from"./index-BrQW8HOS.js";import{t as i}from"./requestPresets-CKwN6OUr.js";const L=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function w(e,r){const{loadContext:a,...t}=r||{},n=a?await a.fetchServiceMetadata(e,t):await i(e,t),u=f();l(n),y(n);const o={serviceJSON:n,preferredHost:u};if((n.currentVersion??0)<10.5)return o;const c=`${e}/layers`,s=a?await a.fetchServiceMetadata(c,t):await i(c,t);return l(s),y(s),o.layersJSON={layers:s.layers,tables:s.tables},o}function b(e){const{type:r}=e;return!!r&&L.has(r)}function p(e){return e.type==="Table"}function y(e){e.layers=e.layers?.filter(b),e.tables=e.tables?.filter(p)}function d(e){e.type||="Feature Layer"}function m(e){e.type||="Table"}function l(e){e.layers?.forEach(d),e.tables?.forEach(m)}function F(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}export{F as l,w as n};
