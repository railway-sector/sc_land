const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/unitConversion-FJJcJ7aj.js","assets/index-CgzAF5Ey.js","assets/index-ni9qn0ie.css"])))=>i.map(i=>d[i]);
import{gQ as w,e6 as o,dY as h,hm as S,om as O,b4 as F,ae as R,V as Y,am as A,af as I,b5 as U,bC as G,a3 as Z}from"./index-CgzAF5Ey.js";import{e as v,D as b,x as X,z as B,O as $,I as nn,R as tn,h as en,t as k}from"./arcade-DatBe7Ao.js";import{p as D}from"./Dictionary-DmxwmAmt.js";import{J as d,o as m,n as q,i as V,r as H,g as K,t as J,D as z,B as x,j as E,U as C,k as T,l as M,S as P,A as rn,m as L,u as j}from"./languageUtils-Ci9pGmfc.js";import{l as Q}from"./portalUtils-B1BkQdOz.js";import{a as f}from"./operatorsWorkerConnection-C7Kdcfz-.js";import{r as W}from"./utils-705cvpPF.js";import"./arcadeEnvironment-BHBb-4Qi.js";import"./Feature-Bz8IFxKW.js";import"./deepClone-zSvyy7Jt.js";import"./aiServices-BY86vgJn.js";import"./commonProperties-DHiB1uzW.js";import"./ImmutableArray-BPVd6ESQ.js";import"./shared-DpUtm4ff.js";import"./WhereClause-DRNQT3uq.js";import"./streamLayerUtils-DFlbJ4P1.js";import"./measures-B3mvfQRY.js";import"./splitCurveAtPoint-eQ1swr03.js";import"./unitConversion-FJJcJ7aj.js";import"./number-BNHbRH9q.js";import"./hash-CcEbRgUF.js";function p(a){if(a==null)return a;switch(typeof a){case"string":case"number":return a;default:throw new o(null,"InvalidParameter",null)}}function In(a){a.mode==="async"&&(a.functions.disjoint=function(t,e){return a.standardFunctionAsync(t,e,(c,s,n)=>(n=d(n),v(n,t,e),n[0]===null||n[1]===null||f("disjoint",[n[0].toJSON(),n[1].toJSON()])))},a.functions.intersects=function(t,e){return a.standardFunctionAsync(t,e,(c,s,n)=>(n=d(n),v(n,t,e),n[0]!==null&&n[1]!==null&&f("intersects",[n[0].toJSON(),n[1].toJSON()])))},a.functions.touches=function(t,e){return a.standardFunctionAsync(t,e,(c,s,n)=>(n=d(n),v(n,t,e),n[0]!==null&&n[1]!==null&&f("touches",[n[0].toJSON(),n[1].toJSON()])))},a.functions.crosses=function(t,e){return a.standardFunctionAsync(t,e,(c,s,n)=>(n=d(n),v(n,t,e),n[0]!==null&&n[1]!==null&&f("crosses",[n[0].toJSON(),n[1].toJSON()])))},a.functions.within=function(t,e){return a.standardFunctionAsync(t,e,(c,s,n)=>(n=d(n),v(n,t,e),n[0]!==null&&n[1]!==null&&f("within",[n[0].toJSON(),n[1].toJSON()])))},a.functions.contains=function(t,e){return a.standardFunctionAsync(t,e,(c,s,n)=>(n=d(n),v(n,t,e),n[0]!==null&&n[1]!==null&&f("contains",[n[0].toJSON(),n[1].toJSON()])))},a.functions.overlaps=function(t,e){return a.standardFunctionAsync(t,e,(c,s,n)=>(n=d(n),v(n,t,e),n[0]!==null&&n[1]!==null&&f("overlaps",[n[0].toJSON(),n[1].toJSON()])))},a.functions.equals=function(t,e){return a.standardFunctionAsync(t,e,(c,s,n)=>(m(n,2,2,t,e),n[0]===n[1]||(n[0]instanceof w&&n[1]instanceof w?f("equals",[n[0].toJSON(),n[1].toJSON()]):(q(n[0])&&q(n[1])||!!(V(n[0])&&V(n[1])||H(n[0])&&H(n[1])))&&n[0].equals(n[1]))))},a.functions.relate=function(t,e){return a.standardFunctionAsync(t,e,(c,s,n)=>{if(n=d(n),m(n,3,3,t,e),n[0]instanceof w&&n[1]instanceof w)return f("relate",[n[0].toJSON(),n[1].toJSON(),K(n[2])]);if(n[0]instanceof w&&n[1]===null||n[1]instanceof w&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new o(t,"InvalidParameter",e)})},a.functions.intersection=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>(n=d(n),v(n,t,e),n[0]===null||n[1]===null?null:h(await f("intersection",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.union=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if((n=d(n)).length===0)throw new o(t,"WrongNumberOfParameters",e);const r=[];if(n.length===1)if(S(n[0])){for(const i of d(n[0]))if(i!==null){if(!(i instanceof w))throw new o(t,"InvalidParameter",e);r.push(i.toJSON())}}else{if(!J(n[0])){if(n[0]instanceof w)return z(O(n[0]),t.spatialReference);if(n[0]===null)return null;throw new o(t,"InvalidParameter",e)}for(const i of d(n[0].toArray()))if(i!==null){if(!(i instanceof w))throw new o(t,"InvalidParameter",e);r.push(i.toJSON())}}else for(const i of n)if(i!==null){if(!(i instanceof w))throw new o(t,"InvalidParameter",e);r.push(i.toJSON())}return r.length===0?null:h(await f("union",[r]))})},a.functions.difference=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>(n=d(n),v(n,t,e),n[0]===null?null:n[1]===null?O(n[0]):h(await f("difference",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.symmetricdifference=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>(n=d(n),v(n,t,e),n[0]===null&&n[1]===null?null:n[0]===null?O(n[1]):n[1]===null?O(n[0]):h(await f("symmetricDifference",[n[0].toJSON(),n[1].toJSON()]))))},a.functions.clip=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,2,2,t,e),!(n[1]instanceof F)&&n[1]!==null)throw new o(t,"InvalidParameter",e);if(n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);return n[1]===null?null:h(await f("clip",[n[0].toJSON(),n[1].toJSON()]))})},a.functions.cut=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,2,2,t,e),!(n[1]instanceof R)&&n[1]!==null)throw new o(t,"InvalidParameter",e);if(n[0]===null)return[];if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);return n[1]===null?[O(n[0])]:(await f("cut",[n[0].toJSON(),n[1].toJSON()])).map(r=>h(r))})},a.functions.area=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(m(n,1,2,t,e),n=d(n),x(n[0])){const i=await n[0].sumArea(p(n[1]),null,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,"Cancelled",e);return i}let r=n[0];if((S(r)||J(r))&&(r=E(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,"InvalidParameter",e);return f("area",[r.toJSON(),p(n[1])])})},a.functions.areageodetic=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{m(n,1,3,t,e);let r=(n=d(n))[0];(S(r)||J(r))&&(r=E(r,t.spatialReference));const i=p(n[1]),l=b(n[2]);if(x(r)){const u=await r.sumArea(i,l,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,"Cancelled",e);return u}if(r==null)return 0;if(!C(r))throw new o(t,"InvalidParameter",e);return f("geodeticArea",[r.toJSON(),i,l])})},a.functions.length=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(m(n,1,2,t,e),n=d(n),x(n[0])){const i=await n[0].sumLength(p(n[1]),null,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,"Cancelled",e);return i}let r=n[0];if((S(n[0])||J(n[0]))&&(r=T(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,"InvalidParameter",e);return f("length",[r.toJSON(),p(n[1])])})},a.functions.length3d=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(m(n,1,2,t,e),(n=d(n))[0]===null)return 0;let r=n[0];if((S(n[0])||J(n[0]))&&(r=T(n[0],t.spatialReference)),r===null)return 0;if(!(r instanceof w))throw new o(t,"InvalidParameter",e);if(r.hasZ===!0){const{convertFromSpatialReferenceUnit:i,toLengthUnit:l}=await Y(()=>import("./unitConversion-FJJcJ7aj.js"),__vite__mapDeps([0,1,2])),u=X(r);return i(r.spatialReference,l(n[1]),u)}return f("length",[r.toJSON(),p(n[1])])})},a.functions.lengthgeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{m(n,1,3,t,e);let r=(n=d(n))[0];(S(n[0])||J(n[0]))&&(r=T(n[0],t.spatialReference));const i=p(n[1]),l=b(n[2]);if(x(r)){const u=await r.sumLength(i,l,t.abortSignal);if(t.abortSignal.aborted)throw new o(t,"Cancelled",e);return u}if(r===null)return 0;if(!C(r))throw new o(t,"InvalidParameter",e);return f("geodeticLength",[r.toJSON(),i,l])})},a.functions.distance=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{n=d(n),m(n,2,3,t,e);let r=n[0];if((S(n[0])||J(n[0]))&&(r=M(n[0],t.spatialReference)),!(r instanceof w))throw new o(t,"InvalidParameter",e);let i=n[1];if((S(n[1])||J(n[1]))&&(i=M(n[1],t.spatialReference)),!(i instanceof w))throw new o(t,"InvalidParameter",e);return f("distance",[r.toJSON(),i.toJSON(),p(n[2])])})},a.functions.distancegeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{n=d(n),m(n,2,4,t,e);const r=n[0];if(!(r instanceof A))throw new o(t,"InvalidParameter",e);const i=n[1];if(!(i instanceof A))throw new o(t,"InvalidParameter",e);const l=new R({paths:[],spatialReference:r.spatialReference});return l.addPath([r,i]),f("geodeticLength",[l.toJSON(),p(n[2]),b(n[3])])})},a.functions.densify=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);const r=P(n[1]);if(isNaN(r))throw new o(t,"InvalidParameter",e);if(r<=0)throw new o(t,"InvalidParameter",e);switch(n[0].type){case"polygon":case"polyline":case"extent":return h(await f("densify",[n[0].toJSON(),r,p(n[2])]));default:return n[0]}})},a.functions.densifygeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{n=d(n),m(n,2,4,t,e);const r=n[0];if(r==null)return null;if(!C(r))throw new o(t,"InvalidParameter",e);const i=P(n[1]);if(isNaN(i))throw new o(t,"InvalidParameter",e);if(i<=0)throw new o(t,"InvalidParameter",e);const l=p(n[2]),u=b(n[3]);switch(r.type){case"polygon":case"polyline":case"extent":return h(await f("geodeticDensify",[r.toJSON(),i,l,u]));default:return r}})},a.functions.generalize=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,2,4,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);const r=P(n[1]);if(isNaN(r))throw new o(t,"InvalidParameter",e);const i=rn(L(n[2],!0));return h(await f("generalize",[n[0].toJSON(),r,p(n[3]),{removeDegenerateParts:i}]))})},a.functions.buffer=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);const r=P(n[1]);if(isNaN(r))throw new o(t,"InvalidParameter",e);return r===0?O(n[0]):h(await f("buffer",[n[0].toJSON(),r,p(n[2])]))})},a.functions.buffergeodetic=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{n=d(n),m(n,2,4,t,e);const r=n[0];if(r==null)return null;if(!C(r))throw new o(t,"InvalidParameter",e);const i=P(n[1]);if(isNaN(i))throw new o(t,"InvalidParameter",e);if(i===0)return O(r);const l=p(n[2]),u=b(n[3]);return h(await f("geodesicBuffer",[r.toJSON(),i,l,u]))})},a.functions.offset=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{n=d(n),m(n,2,6,t,e);const r=n[0];if(r===null)return null;if(!(r instanceof I||r instanceof R))throw new o(t,"InvalidParameter",e);const i=P(n[1]);if(isNaN(i))throw new o(t,"InvalidParameter",e);const l=n[2],u=B(n[3]),y=P(L(n[4],10));if(isNaN(y))throw new o(t,"InvalidParameter",e);const g=P(L(n[5],0));if(isNaN(g))throw new o(t,"InvalidParameter",e);return h(await f("offset",[r.toJSON(),i,p(l),u,y,g]))})},a.functions.rotate=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,2,3,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);const r=n[0]instanceof F?I.fromExtent(n[0]):n[0],i=P(n[1]);if(isNaN(i))throw new o(t,"InvalidParameter",e);const l=L(n[2],null);if(l===null){const u=r.type==="point"?r:r.extent?.center;return h(await f("rotate",[r.toJSON(),i,u?.x,u?.y]))}if(l instanceof A)return h(await f("rotate",[r.toJSON(),i,l.x,l.y]));throw new o(t,"InvalidParameter",e)})},a.functions.centroid=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,1,2,t,e),n[0]===null)return null;const r=$(n[1]);let i=n[0];if((S(n[0])||J(n[0]))&&(i=r==="geometric"?M(n[0],t.spatialReference):E(n[0],t.spatialReference),i===null))return null;if(!(i instanceof w))throw new o(t,"InvalidParameter",e);return h(r==="geometric"?await f("centroid",[i.toJSON()]):await f("labelPoint",[i.toJSON()]))})},a.functions.measuretocoordinate=function(t,e){return a.standardFunctionAsync(t,e,nn)},a.functions.pointtocoordinate=function(t,e){return a.standardFunctionAsync(t,e,tn)},a.functions.distancetocoordinate=function(t,e){return a.standardFunctionAsync(t,e,en)},a.functions.multiparttosinglepart=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,1,1,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);if(n[0]instanceof A)return[z(O(n[0]),t.spatialReference)];if(n[0]instanceof F)return[z(O(n[0]),t.spatialReference)];const r=h(await f("simplify",[n[0].toJSON()]));if(r instanceof I){const i=[],l=[];for(let u=0;u<r.rings.length;u++)if(r.isClockwise(r.rings[u])){const y=h({rings:[r.rings[u]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});i.push(y)}else l.push({ring:r.rings[u],pt:r.getPoint(u,0)});for(let u=0;u<l.length;u++)for(let y=0;y<i.length;y++)if(i[y].contains(l[u].pt)){i[y].addRing(l[u].ring);break}return i}if(r instanceof R){const i=[];for(let l=0;l<r.paths.length;l++){const u=h({paths:[r.paths[l]],hasZ:r.hasZ===!0,hasM:r.hasM===!0,spatialReference:r.spatialReference.toJSON()});i.push(u)}return i}if(n[0]instanceof U){const i=[],l=z(O(n[0]),t.spatialReference);for(let u=0;u<l.points.length;u++)i.push(l.getPoint(u));return i}return null})},a.functions.isselfintersecting=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{m(n,1,1,c,s);let r=(n=d(n))[0];if((S(n[0])||J(n[0]))&&(r=T(n[0],c.spatialReference)),r instanceof U){const i=r.points;for(let l=0;l<i.length;l++)for(let u=l+1;u<i.length;u++)if(G(i[l],i[u]))return!0;return!1}return(r instanceof R||r instanceof I)&&await f("isSelfIntersecting",[r.toJSON()])})},a.functions.issimple=function(t,e){return a.standardFunctionAsync(t,e,(c,s,n)=>{if(n=d(n),m(n,1,1,t,e),n[0]===null)return!0;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);return f("isSimple",[n[0].toJSON()])})},a.functions.simplify=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,1,1,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);return h(await f("simplify",[n[0].toJSON()]))})},a.functions.convexhull=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,1,1,t,e),n[0]===null)return null;if(!(n[0]instanceof w))throw new o(t,"InvalidParameter",e);return h(await f("convexHull",[n[0].toJSON()]))})},a.functions.getuser=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{m(n,0,2,t,e);let r=L(n[1],""),i=r===!0;if(r=r===!0||r===!1?"":K(r),n.length===0||n[0]instanceof k){let u;u=t.services?.portal?t.services.portal:Z.getDefault(),n.length>0&&(u=Q(n[0],u));const y=await W(u,r,i);if(y){const g=JSON.parse(JSON.stringify(y));for(const N of["lastLogin","created","modified"])g[N]!==void 0&&g[N]!==null&&(g[N]=new Date(g[N]));return D.convertObjectToArcadeDictionary(g,j(t))}return null}let l=null;if(x(n[0])&&(l=n[0]),l){if(i=!1,r)return null;await l.load();const u=await l.getOwningSystemUrl();if(!u){if(!r){const N=await l.getIdentityUser();return N?D.convertObjectToArcadeDictionary({username:N},j(t)):null}return null}let y;y=t.services?.portal?t.services.portal:Z.getDefault(),y=Q(new k(u),y);const g=await W(y,r,i);if(g){const N=JSON.parse(JSON.stringify(g));for(const _ of["lastLogin","created","modified"])N[_]!==void 0&&N[_]!==null&&(N[_]=new Date(N[_]));return D.convertObjectToArcadeDictionary(N,j(t))}return null}throw new o(t,"InvalidParameter",e)})},a.functions.nearestcoordinate=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,2,2,t,e),!(n[0]instanceof w||n[0]===null))throw new o(t,"InvalidParameter",e);if(!(n[1]instanceof A||n[1]===null))throw new o(t,"InvalidParameter",e);if(n[0]===null||n[1]===null)return null;const r=n[0]instanceof F?I.fromExtent(n[0]):n[0],i=await f("getNearestCoordinate",[r.toJSON(),n[1].toJSON(),{calculateLeftRightSide:!0}]);return i===null?null:D.convertObjectToArcadeDictionary({coordinate:h(i.coordinate),distance:i.distance,sideOfLine:i.distance===0?"straddle":i.isRightSide?"right":"left"},j(t),!1,!0)})},a.functions.nearestvertex=function(t,e){return a.standardFunctionAsync(t,e,async(c,s,n)=>{if(n=d(n),m(n,2,2,t,e),!(n[0]instanceof w||n[0]===null))throw new o(t,"InvalidParameter",e);if(!(n[1]instanceof A||n[1]===null))throw new o(t,"InvalidParameter",e);if(n[0]===null||n[1]===null)return null;const r=n[0]instanceof F?I.fromExtent(n[0]):n[0],i=await f("getNearestVertex",[r.toJSON(),n[1].toJSON()]);return i===null?null:D.convertObjectToArcadeDictionary({coordinate:h(i.coordinate),distance:i.distance,sideOfLine:i.distance===0?"straddle":i.isRightSide?"right":"left"},j(t),!1,!0)})})}export{In as registerFunctions};
