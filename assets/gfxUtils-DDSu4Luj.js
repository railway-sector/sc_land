import{dg as g,dh as w,di as r,bR as b,cv as x}from"./index-BrQW8HOS.js";import{u as k}from"./cimSymbolUtils-CmFYUdpV.js";const f="picture-fill",m="simple-fill",$="simple-line",y="simple-marker",j="text",v="cim",u=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),p=new g(1e3);function M(t){const e=t.style;let o=null;if(t)switch(t.type){case y:e!=="cross"&&e!=="x"&&(o=t.color);break;case m:e&&e!=="solid"?e!=="none"&&(o={type:"pattern",x:0,y:0,src:b(`esri/symbols/patterns/${e}.png`),width:5,height:5}):o=t.color;break;case f:o={type:"pattern",src:t.url,width:r(t.width)*t.xscale,height:r(t.height)*t.yscale,x:r(t.xoffset),y:r(t.yoffset)};break;case j:o=t.color;break;case v:o=k(t)}return o}function D(t,e){const o=t+"-"+e,l=p.get(o);return l!=null?Promise.resolve(l):x(t,{responseType:"image"}).then(a=>{const n=a.data,s=n.naturalWidth,i=n.naturalHeight,c=document.createElement("canvas");c.width=s,c.height=i;const d=c.getContext("2d");d.fillStyle=e,d.fillRect(0,0,s,i),d.globalCompositeOperation="destination-in",d.drawImage(n,0,0);const h=c.toDataURL();return p.put(o,h),h})}function A(t){if(!t)return null;let e=null;switch(t.type){case m:case f:case y:e=A(t.outline);break;case $:{const o=r(t.width);t.style!=null&&t.style!=="none"&&o!==0&&(e={color:t.color,style:C(t.style),width:o,cap:t.cap,join:t.join==="miter"?r(t.miterLimit):t.join},e.dashArray=R(e).join(",")||"none");break}default:e=null}return e}function R(t){if(!t?.style)return[];const{dashArray:e,style:o,width:l}=t;if(typeof e=="string"&&e!=="none")return e.split(",").map(s=>Number(s));const a=l??0,n=u.has(o)?u.get(o).map(s=>s*a):[];if(t.cap!=="butt")for(const[s,i]of n.entries())n[s]=s%2==1?i+a:Math.max(i-a,1);return n}const C=(()=>{const t={};return e=>{if(t[e])return t[e];const o=e.replaceAll("-","");return t[e]=o,o}})(),E=new w([128,128,128]);export{E as b,D as f,R as g,M as u,C as w,A as y};
