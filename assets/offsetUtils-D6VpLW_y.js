import{u as G,y as R}from"./customElement-BuzDI1C0.js";import{u as L}from"./builderUtils-CK1pFOrX.js";import{g as b,y as q,Z as S,R as O,f as E}from"./shapeUtils-4K3S1INp.js";import{n as z}from"./createTemplateExecutor-Bo0hr3wT.js";import{fY as F,g7 as w,nQ as D}from"./index-aRi8Xk-b.js";import{w as Q,D as Y}from"./operatorOffset-BnhEHmGh.js";import{getSpatialReference as k,toGeometry as A,fromSpatialReference as H,fromGeometry as I}from"./apiConverter-FnkTMlaa.js";const J={round:0,bevel:1,miter:2,square:3};function K(p,a,c={}){const{miterLimit:g=10,flattenError:i=0,joins:u="round",unit:n}=c,f=k(p);return n&&(a=F(a,n,f)),A(Q(I(p),H(f),a,J[u],g,i),f)}Y();function j({templatePart:p,edits:a,relationships:c,shape:g,distance:i,isProportional:u,offsetDistance:n,vertexBeforeOffset:f,vertexPlacement:r,mode:Z}){const t=f||n===0?g:C(g,n);if(t===null||!w(t))return;const d=G(t.spatialReference);n=f?n:0;let h=0,l=null,o=0;for(let s=0;s<t.paths.length;s++){if(a.length>z&&Z==="digitizing")return;const m=t.paths[s].length,V=s===t.paths.length-1;for(let e=0;e<m;e++){if(a.length>z&&Z==="digitizing")return;if(e>0&&i!==0&&(h+=t.hasZ?R(t.paths[s][e-1],t.paths[s][e],d):D(t.paths[s][e-1],t.paths[s][e])),(e!==0||r!==1)&&!(e===m-1&&r===2&&V||(e===0||e===m-1&&V)&&r===3||e===0&&i<0&&u||e===m-1&&i>0&&u)){if(i!==0){let v=1;if(u){const y=i<0?e-1:e+1;if(y>=m||y<0)continue;v=t.hasZ?R(t.paths[s][e],t.paths[s][y],d):D(t.paths[s][e],t.paths[s][y])}const $=h+v*i;l=t.hasZ?b(t,$,n,d):q(t,$,0)}else l=S(t,s,e),n!==0&&(l=O(l,e===m-1?[t.paths[s][e-1],t.paths[s][e]]:[t.paths[s][e],t.paths[s][e+1]],n));l&&L({templatePart:p,shape:l,edits:a,relationships:c,mode:Z},`V${(o+e).toString()}`)}}o+=m}}function C(p,a){return K(p,a,{unit:"meters",joins:"miter",miterLimit:2})}function B(p){let a=0;for(const c of p.paths)a+=c.length;return a}function x({templatePart:p,edits:a,relationships:c,shape:g,distance:i,isProportional:u,offsetDistance:n,vertexBeforeOffset:f,vertexPlacement:r,mode:Z}){const t=f||n===0?g:C(g,n);if(t===null||!w(t))return;const d=G(t.spatialReference);n=f?n:0;let h=null,l="";if(i!==0){const o=r===4?0:t.paths.length-1,s=r===4?0:t.paths[t.paths.length-1].length-1,m=r===4?0:E(t),V=r===4?t.paths[0].length:t.paths[t.paths.length-1].length;let e=1;if(u){const $=i<0?s-1:s+1;if($>=V||$<0)return;e=t.hasZ?R(t.paths[o][s],t.paths[o][$],d):D(t.paths[o][s],t.paths[o][$])}const v=m+e*i;h=t.hasZ?b(t,v,n,d):q(t,v,n),l=r===4?"V0":`V${(B(t)-1).toString()}`}else{if(h=r===4?S(t,0,0):S(t,t.paths.length-1,t.paths[t.paths.length-1].length-1),n!==0)if(r===4)h=O(h,[t.paths[0][0],t.paths[0][1]],n);else{const o=t.paths[t.paths.length-1];h=O(h,[o[o.length-2],o[o.length-1]],n)}l=r===4?"V0":`V${(B(t)-1).toString()}`}h&&L({templatePart:p,shape:h,edits:a,relationships:c,mode:Z},l)}export{C as g,j as m,x as u};
