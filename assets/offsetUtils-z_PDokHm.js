import{u as B,y as R}from"./customElement-aPQS1Oaw.js";import{u as G}from"./builderUtils-CC4vqkGu.js";import{g as L,y as q,Z as S,R as O,f as E}from"./shapeUtils-DrlzOUXa.js";import{n as b}from"./createTemplateExecutor-C42KBRsu.js";import{hn as F,gb as w,os as D}from"./index-BrQW8HOS.js";import{w as k,D as A}from"./operatorOffset-Dh_0wl36.js";import{getSpatialReference as H,toGeometry as I,fromSpatialReference as J,fromGeometry as K}from"./apiConverter---8F7iZ4.js";const M={round:0,bevel:1,miter:2,square:3};function N(p,a,c={}){const{miterLimit:g=10,flattenError:i=0,joins:u="round",unit:n}=c,f=H(p);return n&&(a=F(a,n,f)),I(k(K(p),J(f),a,M[u],g,i),f)}A();function j({templatePart:p,edits:a,relationships:c,shape:g,distance:i,isProportional:u,offsetDistance:n,vertexBeforeOffset:f,vertexPlacement:r,mode:Z}){const t=f||n===0?g:C(g,n);if(t===null||!w(t))return;const d=B(t.spatialReference);n=f?n:0;let h=0,l=null,o=0;for(let s=0;s<t.paths.length;s++){if(a.length>b&&Z==="digitizing")return;const m=t.paths[s].length,V=s===t.paths.length-1;for(let e=0;e<m;e++){if(a.length>b&&Z==="digitizing")return;if(e>0&&i!==0&&(h+=t.hasZ?R(t.paths[s][e-1],t.paths[s][e],d):D(t.paths[s][e-1],t.paths[s][e])),(e!==0||r!==1)&&!(e===m-1&&r===2&&V||(e===0||e===m-1&&V)&&r===3||e===0&&i<0&&u||e===m-1&&i>0&&u)){if(i!==0){let v=1;if(u){const y=i<0?e-1:e+1;if(y>=m||y<0)continue;v=t.hasZ?R(t.paths[s][e],t.paths[s][y],d):D(t.paths[s][e],t.paths[s][y])}const $=h+v*i;l=t.hasZ?L(t,$,n,d):q(t,$,0)}else l=S(t,s,e),n!==0&&(l=O(l,e===m-1?[t.paths[s][e-1],t.paths[s][e]]:[t.paths[s][e],t.paths[s][e+1]],n));l&&G({templatePart:p,shape:l,edits:a,relationships:c,mode:Z},`V${(o+e).toString()}`)}}o+=m}}function C(p,a){return N(p,a,{unit:"meters",joins:"miter",miterLimit:2})}function z(p){let a=0;for(const c of p.paths)a+=c.length;return a}function x({templatePart:p,edits:a,relationships:c,shape:g,distance:i,isProportional:u,offsetDistance:n,vertexBeforeOffset:f,vertexPlacement:r,mode:Z}){const t=f||n===0?g:C(g,n);if(t===null||!w(t))return;const d=B(t.spatialReference);n=f?n:0;let h=null,l="";if(i!==0){const o=r===4?0:t.paths.length-1,s=r===4?0:t.paths[t.paths.length-1].length-1,m=r===4?0:E(t),V=r===4?t.paths[0].length:t.paths[t.paths.length-1].length;let e=1;if(u){const $=i<0?s-1:s+1;if($>=V||$<0)return;e=t.hasZ?R(t.paths[o][s],t.paths[o][$],d):D(t.paths[o][s],t.paths[o][$])}const v=m+e*i;h=t.hasZ?L(t,v,n,d):q(t,v,n),l=r===4?"V0":`V${(z(t)-1).toString()}`}else{if(h=r===4?S(t,0,0):S(t,t.paths.length-1,t.paths[t.paths.length-1].length-1),n!==0)if(r===4)h=O(h,[t.paths[0][0],t.paths[0][1]],n);else{const o=t.paths[t.paths.length-1];h=O(h,[o[o.length-2],o[o.length-1]],n)}l=r===4?"V0":`V${(z(t)-1).toString()}`}h&&G({templatePart:p,shape:h,edits:a,relationships:c,mode:Z},l)}export{C as g,j as m,x as u};
