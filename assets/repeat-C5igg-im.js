import{hR as w,hS as A,hT as E,hU as M,hV as p,hW as v,hX as $,hY as b,hZ as j}from"./index-CgzAF5Ey.js";const m=(r,h,f)=>{const d=new Map;for(let e=h;e<=f;e++)d.set(r[e],e);return d},D=w(class extends A{constructor(r){if(super(r),r.type!==E.CHILD)throw Error("repeat() can only be used in text expressions")}dt(r,h,f){let d;f===void 0?f=h:h!==void 0&&(d=h);const e=[],i=[];let l=0;for(const u of r)e[l]=d?d(u,l):l,i[l]=f(u,l),l++;return{values:i,keys:e}}render(r,h,f){return this.dt(r,h,f).values}update(r,[h,f,d]){const e=M(r),{values:i,keys:l}=this.dt(h,f,d);if(!Array.isArray(e))return this.ut=l,i;const u=this.ut??=[],a=[];let y,g,t=0,n=e.length-1,s=0,o=i.length-1;for(;t<=n&&s<=o;)if(e[t]===null)t++;else if(e[n]===null)n--;else if(u[t]===l[s])a[s]=p(e[t],i[s]),t++,s++;else if(u[n]===l[o])a[o]=p(e[n],i[o]),n--,o--;else if(u[t]===l[o])a[o]=p(e[t],i[o]),v(r,a[o+1],e[t]),t++,o--;else if(u[n]===l[s])a[s]=p(e[n],i[s]),v(r,e[t],e[n]),n--,s++;else if(y===void 0&&(y=m(l,s,o),g=m(u,t,n)),y.has(u[t]))if(y.has(u[n])){const c=g.get(l[s]),x=c!==void 0?e[c]:null;if(x===null){const k=v(r,e[t]);p(k,i[s]),a[s]=k}else a[s]=p(x,i[s]),v(r,e[t],x),e[c]=null;s++}else $(e[n]),n--;else $(e[t]),t++;for(;s<=o;){const c=v(r,a[o+1]);p(c,i[s]),a[s++]=c}for(;t<=n;){const c=e[t++];c!==null&&$(c)}return this.ut=l,j(r,a),b}});export{D as c};
