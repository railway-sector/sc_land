const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/lclayout-6cdRR6IH.js","assets/_commonjsHelpers-DCkdB7M8.js"])))=>i.map(i=>d[i]);
import{a3 as nt,bR as at,cB as K,bI as it,as as lt,aj as st,ao as F,ey as ct,b5 as ut,hM as yt,ai as mt}from"./index-Brd6-W-v.js";import{n as pt}from"./GraphicsLayer-CjG4lAYI.js";import{i as X}from"./knowledgeGraphService-jE3al_K7.js";import{p as tt}from"./GraphQueryStreaming-x4Fpv_du.js";let U,a=null;function vt(){return U||(U=nt(()=>import("./lclayout-6cdRR6IH.js"),__vite__mapDeps([0,1])).then(o=>o.l).then(({default:o})=>o({locateFile:e=>at(`esri/libs/linkchartlayout/${e}`)})).then(o=>{dt(o)}),U)}function dt(o){a=o}const R={right:0,left:1,top:2,bottom:3},z={none:0,"start-only":1,"start-and-end":2};function ft(o){const e={timeDirection:"right",timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:"start-and-end",showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0,...o?.toJSON(),eventsTicksVisualization:o?.eventsTicksVisualization??"start-and-end"};return{...e,timeDirection:{value:R[e.timeDirection]??R.right},eventsTicksVisualization:{value:z[e.eventsTicksVisualization]??z["start-and-end"]}}}function w(o,e,c,t,s,i){const r=c.length,n=s.length,m=Float64Array.BYTES_PER_ELEMENT,d=Uint32Array.BYTES_PER_ELEMENT,y=Uint8Array.BYTES_PER_ELEMENT,u=16,l=u+r*(y+2*m)+n*(2*d),f=a._malloc(l);try{const p=f+u-f%u,b=p+r*m,E=b+r*m,L=E+n*d,g=L+n*d,S=()=>[a.HEAPF64.subarray(p>>3,(p>>3)+r),a.HEAPF64.subarray(b>>3,(b>>3)+r),a.HEAPU32.subarray(E>>2,(E>>2)+n),a.HEAPU32.subarray(L>>2,(L>>2)+n),a.HEAPU8.subarray(g,g+r)],[k,A,h,T,P]=S();k.set(c),A.set(t),h.set(s),T.set(i),P.set(e);const v=o(r,g,p,b,n,E,L);let _=null,M=null;if(v.value===0){const I=a.getLayoutLinksTypes(),H=a.getLayoutLinksVerticesEndIndices(),N=a.getLayoutLinksVertices(),O=a.countLayoutLinksVertices();!n||I&&H?O&&!N?v.value=1:(_={types:new Uint8Array(a.HEAPU8.subarray(I,I+n)),vertexEndIndex:new Uint32Array(a.HEAPU32.subarray(H>>2,(H>>2)+n)),vertices:new Float64Array(a.HEAPF64.subarray(N>>3,(N>>3)+2*O))},M=a.getAuxiliaryGraphicElements()):v.value=1}const[x,$,C,ot,rt]=S();return c.set(x),t.set($),s.set(C),i.set(ot),e.set(rt),{status:v.value,links:_,graphics:M}}finally{a._free(f),a.cleanupLayout()}}const D=2,V=1,G=-1;var W,Y,j,q,Q,Z,J;(function(o){function e(){return a.getMinIdealEdgeLength()}function c(t,s,i,r,n,m,d=D,y=V,u=G){return w((l,f,p,b,E,L,g)=>a.applyForceDirectedLayout(t,l,f,p,b,E,L,g,d,y,u),s,i,r,n,m)}o.getMinIdealEdgeLength=e,o.apply=c})(W||(W={})),(function(o){function e(c,t,s,i,r,n,m=D,d=V,y=G){return w((u,l,f,p,b,E,L)=>a.applyCommunityLayout(c,u,l,f,p,b,E,L,m,d,y),t,s,i,r,n)}o.apply=e})(Y||(Y={})),(function(o){function e(c,t,s,i,r,n){return w((m,d,y,u,l,f,p)=>a.applySimpleLayout(c,m,d,y,u,l,f,p),t,s,i,r,n)}o.apply=e})(j||(j={})),(function(o){function e(c,t,s,i,r,n){return w((m,d,y,u,l,f,p)=>a.applyHierarchicalLayout(c,m,d,y,u,l,f,p),t,s,i,r,n)}o.apply=e})(q||(q={})),(function(o){function e(c,t,s,i,r,n){return w((m,d,y,u,l,f,p)=>a.applyRadialTreeLayout(c,m,d,y,u,l,f,p),t,s,i,r,n)}o.apply=e})(Q||(Q={})),(function(o){function e(c,t,s,i,r,n){return w((m,d,y,u,l,f,p)=>a.applySmartTreeLayout(c,m,d,y,u,l,f,p),t,s,i,r,n)}o.apply=e})(Z||(Z={})),(function(o){function e(c,t,s,i,r,n,m,d,y,u,l,f){return w((p,b,E,L,g,S,k)=>{if(r.length!==p)return{value:1};if(n.length!==p)return{value:1};if(y.length!==g)return{value:1};if(u.length!==g)return{value:1};const A=Float64Array.BYTES_PER_ELEMENT,h=16,T=a._malloc(h+p*A),P=a._malloc(h+p*A),v=a._malloc(h+g*A),_=a._malloc(h+g*A),M=T+h-T%h,x=P+h-P%h,$=v+h-v%h,C=_+h-_%h;try{return a.HEAPF64.subarray(M>>3,(M>>3)+p).set(r),a.HEAPF64.subarray(x>>3,(x>>3)+p).set(n),a.HEAPF64.subarray($>>3,($>>3)+g).set(y),a.HEAPF64.subarray(C>>3,(C>>3)+g).set(u),a.applyChronologicalLayout(c,p,b,E,L,M,x,g,S,k,$,C,l,ft(f))}finally{a._free(T),a._free(P),a._free(v),a._free(_)}},t,s,i,m,d)}o.apply=e})(J||(J={}));const wt=K()({none:"none",startAndEnd:"start-and-end",startOnly:"start-only"}),At=K()({absoluteValue:"absolute-value",multiplier:"multiplier"}),_t=["basic-grid","chronological-mono-timeline","chronological-multi-timeline","geographic-organic-standard","hierarchical-bottom-to-top","hierarchical-top-to-bottom","organic-community","organic-fusiform","organic-leaf-circle","organic-standard","radial-node-centric","radial-root-centric","tree-bottom-to-top","tree-left-to-right","tree-right-to-left","tree-top-to-bottom"],ht=new Map([["basic-grid","basic-grid"],["geographic-organic-standard","geographic-organic-standard"],["hierarchical-bottom-to-top","hierarchical-bottom-to-top"],["hierarchical-top-to-bottom","hierarchical-bottom-to-top"],["organic-community","organic-community"],["organic-fusiform","organic-standard"],["organic-leaf-circle","organic-standard"],["organic-standard","organic-standard"],["radial-node-centric","radial-root-centric"],["radial-root-centric","radial-root-centric"],["tree-bottom-to-top","tree-left-to-right"],["tree-left-to-right","tree-left-to-right"],["tree-right-to-left","tree-left-to-right"],["tree-top-to-bottom","tree-left-to-right"],["chronological-mono-timeline","chronological-mono-timeline"],["chronological-multi-timeline","chronological-multi-timeline"]]);function et(o,e){const c=new Map;if(e.dataModel?.relationshipTypes)for(const t of e.dataModel.relationshipTypes)t.name&&c.set(t.name,[]);for(const t of o)c.has(t.typeName)&&c.get(t.typeName)?.push(t.id);return c}async function Mt(o,e,c){const t=[],s=et(o,e),i={},r=[];for(const[y,u]of s){if(u.length<1)continue;const l=`${y}_ids`;i[l]=u,r.push(`MATCH (n)-[r:${y}]->(m) WHERE id(r) in $${l} RETURN id(n), labels(n)[0], id(m), labels(m)[0]`)}if(r.length===0)return[];const n=r.join(" UNION "),m=new tt({openCypherQuery:n,bindParameters:i}),d=(await X(e,m,c?.requestOptions)).resultRowsStream.getReader();for(;;){const{done:y,value:u}=await d.read();if(y)break;for(const l of u)t.push({id:l[0],typeName:l[1]}),t.push({id:l[2],typeName:l[3]})}return t}async function Tt(o,e,c){const t=new Map,s=et(o,e),i={},r=[];for(const[y,u]of s){if(u.length<1)continue;const l=`${y}_ids`;i[l]=u,r.push(`MATCH (n)-[r:${y}]->(m) WHERE id(r) in $${l} RETURN id(r), id(n), id(m)`)}if(r.length===0)return t;const n=r.join(" UNION "),m=new tt({openCypherQuery:n,bindParameters:i}),d=(await X(e,m,c?.requestOptions)).resultRowsStream.getReader();for(;;){const{done:y,value:u}=await d.read();if(y)break;for(const l of u)t.set(l[0],[l[1],l[2]])}return t}const B="ESRI__ChronologicalLayoutOverlay",Pt=()=>B,xt=o=>{const e=[],c={type:"CIMGeometricEffectCut",beginCut:3,endCut:3};for(const t of o.chronologicalAuxiliaryGraphics?.lines??[]){const s={type:"CIMSolidStroke",enable:!0,width:t.width,color:[t.color.r,t.color.g,t.color.b,Math.round(t.color.a/100*255)],effects:t.dashPattern.length>0?[{type:"CIMGeometricEffectDashes",dashTemplate:t.dashPattern,lineDashEnding:"NoConstraint"},c]:void 0},i={type:"CIMVectorMarker",enable:!0,size:10,frame:{xmin:-5,ymin:-5,xmax:0,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[-12,-3.47],[-12,3.6],[-2.06,-.03],[-12,-3.47]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[t.color.r,t.color.g,t.color.b,Math.round(t.color.a/100*255)]}]}}],markerPlacement:{type:"CIMMarkerPlacementOnLine",angleToLine:!0,relativeTo:"LineEnd",offsetAlongLine:0}},r=new lt({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:t.arrowheadSizeAtEnd?[s,i]:[s]}}});for(const n of t.elements){const m=new st({paths:[[[n.origin.x,n.origin.y],[n.destination.x,n.destination.y]]]});e.push(new F({geometry:m,symbol:r}))}}for(const t of o.chronologicalAuxiliaryGraphics?.polygons??[]){const s=new ct({color:[t.color.r,t.color.g,t.color.b,t.color.a/100],style:"solid",outline:null});for(const i of t.elements){const r=new ut({rings:[i.points.map(n=>[n.x,n.y])]});e.push(new F({geometry:r,symbol:s}))}}for(const t of o.chronologicalAuxiliaryGraphics?.texts??[]){let s="middle",i="center";switch(t.direction?.value){case R.left:i="right";break;case R.right:i="left";break;case R.bottom:s="bottom"}for(const r of t.elements){const n=new yt({color:[t.color.r,t.color.g,t.color.b,t.color.a/100],text:r.str,font:{size:t.height,weight:"bold"},verticalAlignment:s,horizontalAlignment:i}),m=new mt({x:r.anchor.x,y:r.anchor.y});e.push(new F({geometry:m,symbol:n}))}}return new pt({graphics:e,listMode:"hide",title:B,id:B})},$t=o=>ht.get(o)??"radial-root-centric";function Ct(o){if(!o.spatialReference.isWGS84)throw new it("knowledge-graph:layer-support-utils","The utilsExtentToInBoundsRings function only supports WGS84 spatial references.");return o.clone().normalize().map(e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]])}export{j as A,$t as C,Q as L,q as P,Ct as S,At as a,J as b,Z as d,Y as f,Mt as g,_t as i,wt as o,W as p,vt as r,Tt as u,Pt as w,xt as x};
