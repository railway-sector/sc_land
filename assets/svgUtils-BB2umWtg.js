import{c3 as C,V as a,o$ as I,dh as B,di as X,o_ as tt}from"./index-BrQW8HOS.js";import{n as O}from"./mat2df32-Dpt2CT5P.js";import{e as G,c as et,a as F,i as nt,s as it}from"./mat2d-BbBq4Byx.js";import{g as ot}from"./gfxUtils-DDSu4Luj.js";let rt=0;function st(){return rt++}let at=0;function lt(){return at++}let ht=0;function ft(){return ht++}const ct="http://www.w3.org/2000/svg",T=C("android"),ut=C("chrome")||T&&T>=4?"auto":"optimizeLegibility",dt={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},yt=/([A-DF-Za-df-z])|([-+]?\d*\.?\d+(?:[eE][-+]?\d+)?)/g;let l={},s={};const pt=Math.PI;function b(t,e){const n=t*(pt/180);return Math.abs(e*Math.sin(n))+Math.abs(e*Math.cos(n))}function q(t){return t.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function _(t,e,n,i,o){if(t){if(t.type==="circle")return a("circle",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",r:t.r,stroke:n.color,"stroke-dasharray":n.dashArray,"stroke-dashoffset":n.dashOffset,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-miterlimit":"4","stroke-width":n.width});if(t.type==="ellipse")return a("ellipse",{cx:t.cx,cy:t.cy,fill:e,"fill-rule":"evenodd",rx:t.rx,ry:t.ry,stroke:n.color,"stroke-dasharray":n.dashArray,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-miterlimit":"4","stroke-width":n.width});if(t.type==="rect")return a("rect",{fill:e,"fill-rule":"evenodd",height:t.height,stroke:n.color,"stroke-dasharray":n.dashArray,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-miterlimit":"4","stroke-width":n.width,width:t.width,x:t.x,y:t.y});if(t.type==="image")return a("image",{alt:o||"image",height:t.height,href:t.src,preserveAspectRatio:"none",width:t.width,x:t.x,y:t.y});if(t.type==="path"){const r=typeof t.path!="string"?q(t.path):t.path;return a("path",{d:r,fill:e,"fill-rule":"evenodd",stroke:n.color,"stroke-dasharray":n.dashArray,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-miterlimit":"4","stroke-width":n.width})}if(t.type==="text")return I(i),a("text",{"dominant-baseline":i.dominantBaseline,fill:e,"fill-rule":"evenodd","font-family":i.font.family,"font-size":i.font.size,"font-style":i.font.style,"font-variant":i.font.variant,"font-weight":i.font.weight,kerning:i.kerning,rotate:i.rotate,stroke:n.color,"stroke-dasharray":n.dashArray,"stroke-linecap":n.cap,"stroke-linejoin":n.join,"stroke-miterlimit":"4","stroke-width":n.width,"text-anchor":i.align,"text-decoration":i.decoration,"text-rendering":ut,x:t.x,y:t.y},t.text)}return null}function P(t){if(!t)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in t))return{fill:new B(t).toString(),pattern:null,linearGradient:null};if(t.type==="pattern"){const n=`patternId-${st()}`;return{fill:`url(#${n})`,pattern:{id:n,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}},linearGradient:null}}const e=`linearGradientId-${lt()}`;return{fill:`url(#${e})`,pattern:null,linearGradient:{id:e,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map(n=>({offset:n.offset,color:n.color&&new B(n.color).toString()}))}}}function Y(t){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};return t&&(t.width!=null&&(e.width=t.width),t.cap&&(e.cap=t.cap),t.join&&(e.join=t.join.toString()),t.color&&(e.color=new B(t.color).toString()),t.dashArray&&(e.dashArray=t.dashArray),t.dashoffset&&(e.dashOffset=t.dashoffset),t.style&&!t.dashArray&&(e.dashArray=ot(t).join(",")||"none")),e}function H(t,e){const n={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const i=t.alignBaseline,o=i==="baseline"?"auto":i==="top"?"text-top":i==="bottom"?"hanging":i;n.align=t.align,n.dominantBaseline=o,n.decoration=t.decoration,n.kerning=t.kerning?"auto":"0",n.rotate=t.rotated?"90":"0",I(e),n.font.style=e.style||"normal",n.font.variant=e.variant||"normal",n.font.weight=e.weight||"normal",n.font.size=e.size&&e.size.toString()||"10pt",n.font.family=e.family||"serif"}return n}function gt(t){const{pattern:e,linearGradient:n}=t;if(e)return a("pattern",{height:e.height,id:e.id,patternUnits:"userSpaceOnUse",width:e.width,x:e.x,y:e.y},a("image",{height:e.image.height,href:e.image.href,width:e.image.width,x:e.image.x,y:e.image.y}));if(n){const i=n.stops.map((o,r)=>a("stop",{key:`${r}-stop`,offset:o.offset,"stop-color":o.color}));return a("linearGradient",{gradientUnits:"userSpaceOnUse",id:n.id,x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2},i)}return null}function mt(t,e){if(!t||t.length===0)return null;const n=[];for(const i of t){const{shape:o,fill:r,stroke:h,font:d}=i,u=P(r),g=Y(h),k=o.type==="text"?H(o,d):null,w=_(o,u.fill,g,k);w&&n.push(w)}return a("mask",{id:e,maskUnits:"userSpaceOnUse"},a("g",null,n))}function L(t,e,n){return nt(t,F(t),[e,n])}function R(t,e,n,i,o){return et(t,F(t),[e,n]),t[4]=t[4]*e-i*e+i,t[5]=t[5]*n-o*n+o,t}function xt(t,e,n,i){const o=e%360*Math.PI/180;it(t,F(t),o);const r=Math.cos(o),h=Math.sin(o),d=t[4],u=t[5];return t[4]=d*r-u*h+i*h-n*r+n,t[5]=u*r+d*h-n*h-i*r+i,t}function p(t,e){l&&"left"in l?(l.left!=null&&l.left>t&&(l.left=t),(l.right==null||l.right<t)&&(l.right=t),(l.top==null||l.top>e)&&(l.top=e),(l.bottom==null||l.bottom<e)&&(l.bottom=e)):l={left:t,bottom:e,right:t,top:e}}function D(t){const e=t.args,n=e.length;let i;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(i=0;i<n;i+=2)p(e[i],e[i+1]);s.x=e[n-2],s.y=e[n-1];break;case"H":for(i=0;i<n;++i)p(e[i],s.y);s.x=e[n-1];break;case"V":for(i=0;i<n;++i)p(s.x,e[i]);s.y=e[n-1];break;case"m":{let o=0;for(("x"in s)||(p(s.x=e[0],s.y=e[1]),o=2),i=o;i<n;i+=2)p(s.x+=e[i],s.y+=e[i+1]);break}case"l":case"t":for(i=0;i<n;i+=2)p(s.x+=e[i],s.y+=e[i+1]);break;case"h":for(i=0;i<n;++i)p(s.x+=e[i],s.y);break;case"v":for(i=0;i<n;++i)p(s.x,s.y+=e[i]);break;case"c":for(i=0;i<n;i+=6)p(s.x+e[i],s.y+e[i+1]),p(s.x+e[i+2],s.y+e[i+3]),p(s.x+=e[i+4],s.y+=e[i+5]);break;case"s":case"q":for(i=0;i<n;i+=4)p(s.x+e[i],s.y+e[i+1]),p(s.x+=e[i+2],s.y+=e[i+3]);break;case"A":for(i=0;i<n;i+=7)p(e[i+5],e[i+6]);s.x=e[n-2],s.y=e[n-1];break;case"a":for(i=0;i<n;i+=7)p(s.x+=e[i+5],s.y+=e[i+6])}}function V(t,e,n){const i=dt[t.toLowerCase()];let o;typeof i=="number"&&(i?e.length>=i&&(o={action:t,args:e.slice(0,e.length-e.length%i)},n.push(o),D(o)):(o={action:t,args:[]},n.push(o),D(o)))}function wt(t){const e=(typeof t.path!="string"?q(t.path):t.path).match(yt),n=[];if(l={},s={},!e)return null;let i="",o=[];const r=e.length;for(let d=0;d<r;++d){const u=e[d],g=parseFloat(u);isNaN(g)?(i&&V(i,o,n),o=[],i=u):o.push(g)}V(i,o,n);const h={x:0,y:0,width:0,height:0};return l&&"left"in l&&(h.x=l.left,h.y=l.top,h.width=l.right-l.left,h.height=l.bottom-l.top),h}function kt(t){const e={x:0,y:0,width:0,height:0};if(t.type==="circle")e.x=t.cx-t.r,e.y=t.cy-t.r,e.width=2*t.r,e.height=2*t.r;else if(t.type==="ellipse")e.x=t.cx-t.rx,e.y=t.cy-t.ry,e.width=2*t.rx,e.height=2*t.ry;else if(t.type==="image"||t.type==="rect")e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height;else if(t.type==="path"){const n=wt(t);e.x=n.x,e.y=n.y,e.width=n.width,e.height=n.height}return e}function bt(t){const e={x:0,y:0,width:0,height:0};let n=null,i=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(const r of t)n?(n.x=Math.min(n.x,r.x),n.y=Math.min(n.y,r.y),i=Math.max(i,r.x+r.width),o=Math.max(o,r.y+r.height)):(n=e,n.x=r.x,n.y=r.y,i=r.x+r.width,o=r.y+r.height);return n&&(n.width=i-n.x,n.height=o-n.y),n}function Mt(t,e,n,i,o,r,h,d,u){let g=(h&&r?b(r,e):e)/2,k=(h&&r?b(r,n):n)/2;if(u){const x=u[0],y=u[1];g=(h&&r?b(r,x):x)/2,k=(h&&r?b(r,y):y)/2}const w=t.width+i,f=t.height+i,m=O(),c=O();let M=!1;if(o&&w!==0&&f!==0){const x=e!==n?e/n:w/f,y=e>n?e:n;let S=1,j=1;isNaN(y)||(x>1?(S=y/w,j=y/x/f):(j=y/f,S=y*x/w)),G(c,c,R(m,S,j,g,k)),M=!0}const N=t.x+(w-i)/2,v=t.y+(f-i)/2;if(G(c,c,L(m,g-N,k-v)),!M&&(w>e||f>n)){const x=w/e>f/n,y=(x?e:n)/(x?w:f);G(c,c,R(m,y,y,N,v))}return d&&G(c,c,L(m,d[0],d[1])),r&&G(c,c,xt(m,r,N,v)),`matrix(${c[0]},${c[1]},${c[2]},${c[3]},${c[4]},${c[5]})`}function Q(t){const e=t?.match(/bloom\(\s*([^\s]+)\s+([^\s]+)\s+([^\s]+)\s*\)/i);if(!e)return null;const[,n,i,o]=e;return{strength:Number(n),radius:X(tt(i)),threshold:Number(o)}}function vt(t,e,n){const i=Q(t);if(!i)return null;const{strength:o,radius:r}=i,h=o>0?r:0,d=(o+h)*e,u=4*o+1;return a("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${n}`,width:"300%",x:"-100%",y:"-100%"},a("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(o+.5*h)*(5**(e/100)*(.4+e/100)),result:"dilate"}),a("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:d/25}),a("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:d/50}),a("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},a("feFuncR",{slope:u,type:"linear"}),a("feFuncG",{slope:u,type:"linear"}),a("feFuncB",{slope:u,type:"linear"})),a("feMerge",null,a("feMergeNode",{in:"intensityBlur"}),a("feMergeNode",{in:"intensityBrightness"}),a("feGaussianBlur",{stdDeviation:o/10})))}function Gt(t,e,n,i={}){const o=[],r=[],h=ft(),d=vt(i.cssEffectFilter,e,h);let u=null;if(d){const f=Q(i.cssEffectFilter),m=i.clipBloomEffect||!f?.strength?0:(f.strength+f.radius/2)/3,c=e+e*m,M=n+n*m;u=[Math.max(c,10),Math.max(M,10)]}let g=e,k=n;if(i.useRotationSize)for(let f=0;f<t.length;f++){const m=i.rotations?.[f]??0;g=Math.max(b(m,e),g),k=Math.max(b(m,n),k)}for(let f=0;f<t.length;f++){const m=t[f],c=[],M=[];let N=0,v=0,x=0;for(const $ of m){const{shape:A,fill:W,stroke:E,font:Z,offset:z}=$;i.ignoreStrokeWidth||A.type==="text"||(N+=E?.width||0);const U=P(W),J=Y(E),K=A.type==="text"?H(A,Z):null;o.push(gt(U)),c.push(_(A,U.fill,J,K,i.ariaLabel)),M.push(kt(A)),z&&(v+=z[0],x+=z[1])}const y=i.rotations?.[f]??0;i.useRotationSize&&(v+=(g-b(y,e))/2,x+=(k-b(y,n))/2);const S=Mt(bt(M),e,n,N,i.scale??!1,y,i.useRotationSize??!1,[v,x],u);let j=null;if(i.masking){const $=`mask-${f}`,A=i.masking[f];o.push(mt(A,$)),j=`url(#${$})`}r.push(j?a("g",{mask:j},a("g",{transform:S},c)):a("g",{transform:S},c))}return d&&(I(u),g=u[0],k=u[1]),a("svg",{"aria-label":i.ariaLabel,focusable:!1,height:k,role:"img",style:"display: block;",width:g,xmlns:ct},d,a("defs",null,o),d?a("g",{filter:`url(#bloom${h})`},r):r)}export{P as $,Y as A,Mt as C,kt as L,gt as N,bt as R,_ as S,Gt as q};
