const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/previewWebStyleSymbol-I5QTVeHj.js","assets/index-CgzAF5Ey.js","assets/index-ni9qn0ie.css","assets/webStyleAcceptedFormats-CG7ZQ6BV.js","assets/previewSymbol3D-xRDRpg6O.js","assets/gfxUtils-B1R76T6S.js","assets/cimSymbolUtils-D8zbHeXT.js","assets/previewUtils-m-R88IBt.js","assets/utils-BxeCvIiv.js","assets/webStyleSymbolUtils-onUVZ_RA.js","assets/devEnvironmentUtils-8WtPGj6h.js","assets/svgUtils-smkwubCy.js","assets/mat2df32-Dpt2CT5P.js","assets/mat2d-DWPHXQcf.js","assets/previewSymbol2D-DeiEgbTs.js","assets/densifyCurvedGeometry-xrty2FpW.js","assets/previewCIMSymbol-Ct8s9f2u.js","assets/CIMSymbolHelper-Bd9SO2qF.js","assets/BidiEngine-BvER9tXK.js","assets/labelPoint-DZLJ2eV0.js","assets/rasterizingUtils-DPK9f2Iy.js","assets/Rect-CUzevAry.js","assets/BoundingBox-RIlEJuyl.js","assets/CIMSymbolRasterizer-DB9Xymz-.js","assets/CIMResourceManager-KvxbKRQg.js","assets/OverrideHelper-DgkHuzVT.js","assets/callExpressionWithFeature-Lt9Or9I8.js"])))=>i.map(i=>d[i]);
import{p4 as $,c4 as A,fX as V,du as D,cv as F,a5 as I,fY as P,c3 as O,V as x,dh as z,dg as T,p5 as U}from"./index-CgzAF5Ey.js";import{y as q}from"./gfxUtils-B1R76T6S.js";import{q as W}from"./svgUtils-smkwubCy.js";import{L as R,M as j,N as G}from"./utils-BxeCvIiv.js";const E=$();function B(e,t){E.append(e,t),E.detach(t)}function H(e,t,i){const o=Math.ceil(t[0]),n=Math.ceil(t[1]);if(!e.some(a=>!!a.length))return null;const l=i?.node||document.createElement("div");return i.opacity!=null&&(l.style.opacity=i.opacity.toString()),i.cssEffectFilter!=null&&(l.style.filter=i.cssEffectFilter),B(l,()=>W(e,o,n,i)),l}function N(e,t){e=Math.ceil(e),t=Math.ceil(t);const i=document.createElement("canvas");i.width=e,i.height=t,i.style.width=e+"px",i.style.height=t+"px";const o=i.getContext("2d");return o.clearRect(0,0,e,t),o}function X(e,t,i){return e?F(e,{responseType:"image"}).then(o=>{const n=o.data,l=n.width,a=n.height,c=l/a;let h=t;if(i){const g=Math.max(l,a);h=Math.min(h,g)}return{image:n,width:c<=1?Math.ceil(h*c):h,height:c<=1?h:Math.ceil(h/c)}}):Promise.reject(new I("renderUtils: imageDataSize","href not provided."))}function Y(e,t){return!(!e||t==="ignore")&&(t!=="multiply"||e.r!==255||e.g!==255||e.b!==255||e.a!==1)}function J(e,t,i,o,n){if(n==="multiply")e[t]*=i[0],e[t+1]*=i[1],e[t+2]*=i[2],e[t+3]*=i[3];else{const l=V({r:e[t],g:e[t+1],b:e[t+2]});l.h=o.h,l.s=o.s,l.v=l.v/100*o.v;const a=P(l);e[t]=a.r,e[t+1]=a.g,e[t+2]=a.b,e[t+3]*=i[3]}}function ne(e,t,i,o,n){return X(e,t,n).then(l=>{const a=l.width??t,c=l.height??t;if(l.image&&Y(i,o)){let h=l.image.width,g=l.image.height;A("edge")&&/\.svg$/i.test(e)&&(h-=1,g-=1);const f=N(a,c);f.drawImage(l.image,0,0,h,g,0,0,a,c);const u=f.getImageData(0,0,a,c),s=[i.r/255,i.g/255,i.b/255,i.a],p=V(i);for(let r=0;r<u.data.length;r+=4)J(u.data,r,s,p,o);f.putImageData(u,0,0),e=f.canvas.toDataURL("image/png")}else{const h=D?.findCredential(e);if(h?.token){const g=e.includes("?")?"&":"?";e=`${e}${g}token=${h.token}`}}return{url:e,width:a,height:c}}).catch(()=>({url:e,width:t,height:t}))}let S=null;const L=[255,255,255];function M(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function oe(e,t,i){const{backgroundColor:o,outline:n,dotSize:l}=e,a=22,c=.8,h=Math.round(a*a/Math.max(l,.5)**2*c),g=window.devicePixelRatio,f=document.createElement("canvas"),u=a*g;f.width=u,f.height=u,f.style.width=f.width/g+"px",f.style.height=f.height/g+"px";const s=f.getContext("2d");if(o&&(s.fillStyle=o.toCss(!0),s.fillRect(0,0,u,u),s.fill()),s.fillStyle=t?.toCss(!0)??"",S&&S.length/2===h)for(let r=0;r<2*h;r+=2){const y=S[r],m=S[r+1];s.fillRect(y,m,l*g,l*g),s.fill()}else{S=[];for(let r=0;r<2*h;r+=2){const y=M(0,u),m=M(0,u);S.push(y,m),s.fillRect(y,m,l*g,l*g),s.fill()}}n&&(n.color&&(s.strokeStyle=n.color.toCss(!0)),s.lineWidth=n.width,s.strokeRect(0,0,u,u));const p=new Image(a,a);return p.src=f.toDataURL(),p.ariaLabel=null,p.alt="",p}function se(e,t={}){const i=t.radius||40,o=2*Math.PI*i,n=e.length,l=o/n,a=[],c=q(t.outline);c?.width!=null&&(c.width*=2),(c||t.backgroundColor)&&a.push({shape:{type:"circle",cx:i,cy:i,r:i},fill:t.backgroundColor,stroke:c,offset:[0,0]});const h=t.values,g=h&&h.length===n&&h.reduce((r,y)=>r+y,0)===100,f=[0];for(let r=0;r<n;r++){let y=null;g&&(y=h[r]*o/100,f.push(y+f[r])),a.push({shape:{type:"circle",cx:i,cy:i,r:i/2},fill:[0,0,0,0],stroke:{width:i,dashArray:`${(y??l)/2} ${o}`,dashoffset:"-"+(g?f[r]/2:r*(l/2)),color:e[r]},offset:[0,0]})}let u=null;const s=2*i+(c?.width||0),p=t.holePercentage;if(p){c&&a.push({shape:{type:"circle",cx:i,cy:i,r:i*p},fill:null,stroke:c,offset:[0,0]});const r=s/2;u=[[{shape:{type:"circle",cx:r,cy:r,r},fill:L,stroke:c?{...c,color:L}:null,offset:[0,0]},{shape:{type:"circle",cx:r,cy:r,r:i*p},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return H([a],[s,s],{cssEffectFilter:t.cssEffectFilter,ignoreStrokeWidth:!0,masking:u,rotations:[-90],ariaLabel:t.ariaLabel})}function ce(e,t={}){const n=t.align==="horizontal",l=n?75:24,a=n?24:75,c=t.width??l,h=t.height??a,g=t.gradient??!0,f=window.devicePixelRatio,u=c*f,s=h*f,p=document.createElement("canvas");p.width=u,p.height=s,p.ariaLabel=t.ariaLabel??null,p.style.width=`${c}px`,p.style.height=`${h}px`;const r=p.getContext("2d"),y=n?u:0,m=n?0:s;if(g){const w=r.createLinearGradient(0,0,y,m),v=e.length,d=v===1?0:1/(v-1);e.forEach((_,k)=>w.addColorStop(k*d,_.toString())),r.fillStyle=w,r.fillRect(0,0,u,s)}else{const w=n?u/e.length:u,v=n?s:s/e.length;let d=0,_=0;for(const k of e)r.fillStyle=k.toString(),r.fillRect(d,_,w,v),d=n?d+w:0,_=n?0:_+v}const b=document.createElement("div");return b.style.width=`${c}px`,b.style.height=`${h}px`,Q(b,t?.cssEffectFilter),b.appendChild(p),b}function K(e){const t=e.match(/drop-shadow\(\s*([^\s]+)\s+[^\s]+\s+[^\s]+\s+.+?\)/);return t?t[1]:null}function Q(e,t){if(!t)return;e.style.filter=t;const i=K(t);if(i){const o=T(U(i));o<0?e.style.marginLeft=`${Math.abs(o)}px`:e.style.marginRight=`${o}px`}}async function Z(e,t){switch(e.type){case"web-style":{const{previewWebStyleSymbol:i}=await x(()=>import("./previewWebStyleSymbol-I5QTVeHj.js"),__vite__mapDeps([0,1,2,3]));return i(e,Z,t)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await x(()=>import("./previewSymbol3D-xRDRpg6O.js"),__vite__mapDeps([4,1,2,5,6,7,8,9,10,3,11,12,13]));return i(e,t)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await x(()=>import("./previewSymbol2D-DeiEgbTs.js"),__vite__mapDeps([14,1,2,15,5,6,7,11,12,13,8]));return i(e,t)}case"cim":{const{previewCIMSymbol:i}=await x(()=>import("./previewCIMSymbol-Ct8s9f2u.js"),__vite__mapDeps([16,1,2,17,18,19,20,13,12,21,22,23,24,25,26,5,6,11,8]));return i(e,t)}default:return}}function C(e){return e&&e.opacity!==void 0?e.opacity*("parent"in e?C(e.parent):1):1}async function he(e,t){if(!e)return;const i=e.sourceLayer,o=(t!=null&&t.useSourceLayer?i:e.layer)??i,n=t?.ignoreOpacity?1:C(o);if(e.symbol!=null&&(t==null||t.ignoreGraphicSymbol!==!0)){const d=e.symbol.type==="web-style"?await e.symbol.fetchSymbol({...t,acceptedFormats:t?.webStyleAcceptedFormats,cache:t?.webStyleCache}):e.symbol.clone();return R(d,null,{add:n}),d}const l=t?.renderer??te(o);let a=l&&"getSymbolAsync"in l?await l.getSymbolAsync(e,t):null;if(!a)return;if(a=a.type==="web-style"?await a.fetchSymbol({...t,acceptedFormats:t?.webStyleAcceptedFormats,cache:t?.webStyleCache}):a.clone(),!(l&&"visualVariables"in l&&l.visualVariables?.length&&ee(a)))return R(a,null,{add:n}),a;if("arcadeRequiredForVisualVariables"in l&&l.arcadeRequiredForVisualVariables&&t?.arcade==null){const d={...t};d.arcade=await O(),t=d}const{getColor:c,getOpacity:h,getAllSizes:g,getRotationAngle:f}=await x(()=>import("./index-CgzAF5Ey.js").then(d=>d.ML),__vite__mapDeps([1,2])),u=[],s=[],p=[],r=[];for(const d of l.visualVariables)switch(d.type){case"color":u.push(d);break;case"opacity":s.push(d);break;case"rotation":r.push(d);break;case"size":d.target||p.push(d)}const y=!!u.length&&u[u.length-1],m=y?c(y,e,t):null,b=!!t?.ignoreOpacity,w=!!s.length&&s[s.length-1],v=w?h(w,e,t):null;if(R(a,m,b?void 0:{override:v,add:n}),p.length&&t?.ignoreSizeVariables!==!0){const d=g(p,e,t);await j(a,d)}if(t?.ignoreRotationVariables!==!0)for(const d of r)G(a,f(d,e,t),d.axis);return a}function ee(e){return!z(e)||e.symbolLayers.at(0)?.type!=="water"}function te(e){if(e)return"renderer"in e?e.renderer:void 0}export{he as F,Z as L,se as S,ce as V,ne as d,H as l,oe as w};
