const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/previewWebStyleSymbol-BiD76lBz.js","assets/index-BrQW8HOS.js","assets/index-lUE0m221.css","assets/webStyleAcceptedFormats-CG7ZQ6BV.js","assets/previewSymbol3D-D79fd6qD.js","assets/gfxUtils-DDSu4Luj.js","assets/cimSymbolUtils-CmFYUdpV.js","assets/previewUtils-ZcsefAEI.js","assets/utils-6_NAbAK3.js","assets/webStyleSymbolUtils-UgSam_rJ.js","assets/devEnvironmentUtils-8WtPGj6h.js","assets/svgUtils-BB2umWtg.js","assets/mat2df32-Dpt2CT5P.js","assets/mat2d-BbBq4Byx.js","assets/previewSymbol2D-CgirjzO0.js","assets/densifyCurvedGeometry-B2pHq9-y.js","assets/previewCIMSymbol-DvFqDqA7.js","assets/CIMSymbolHelper-BlfMWOZ7.js","assets/BidiEngine-BvER9tXK.js","assets/labelPoint-CgDrQQb-.js","assets/rasterizingUtils-Bv-DctWv.js","assets/Rect-CUzevAry.js","assets/BoundingBox-BuUpzzb5.js","assets/CIMSymbolRasterizer-Cscg1bz_.js","assets/CIMResourceManager-CKLYpEab.js","assets/OverrideHelper-Dz66q1dD.js","assets/callExpressionWithFeature-DHWn7DZ3.js"])))=>i.map(i=>d[i]);
import{oZ as D,c3 as $,fX as C,cD as A,cv as F,a4 as I,fY as P,c2 as O,U as x,dj as z,di as T,o_ as U}from"./index-BrQW8HOS.js";import{y as j}from"./gfxUtils-DDSu4Luj.js";import{q}from"./svgUtils-BB2umWtg.js";import{L as E,M as W,N as G}from"./utils-6_NAbAK3.js";const R=D();function B(e,t){R.append(e,t),R.detach(t)}function H(e,t,i){const o=Math.ceil(t[0]),n=Math.ceil(t[1]);if(!e.some(a=>!!a.length))return null;const l=i?.node||document.createElement("div");return i.opacity!=null&&(l.style.opacity=i.opacity.toString()),i.cssEffectFilter!=null&&(l.style.filter=i.cssEffectFilter),B(l,()=>q(e,o,n,i)),l}function N(e,t){e=Math.ceil(e),t=Math.ceil(t);const i=document.createElement("canvas");i.width=e,i.height=t,i.style.width=e+"px",i.style.height=t+"px";const o=i.getContext("2d");return o.clearRect(0,0,e,t),o}function X(e,t,i){return e?F(e,{responseType:"image"}).then(o=>{const n=o.data,l=n.width,a=n.height,s=l/a;let h=t;if(i){const g=Math.max(l,a);h=Math.min(h,g)}return{image:n,width:s<=1?Math.ceil(h*s):h,height:s<=1?h:Math.ceil(h/s)}}):Promise.reject(new I("renderUtils: imageDataSize","href not provided."))}function Y(e,t){return!(!e||t==="ignore")&&(t!=="multiply"||e.r!==255||e.g!==255||e.b!==255||e.a!==1)}function Z(e,t,i,o,n){if(n==="multiply")e[t]*=i[0],e[t+1]*=i[1],e[t+2]*=i[2],e[t+3]*=i[3];else{const l=C({r:e[t],g:e[t+1],b:e[t+2]});l.h=o.h,l.s=o.s,l.v=l.v/100*o.v;const a=P(l);e[t]=a.r,e[t+1]=a.g,e[t+2]=a.b,e[t+3]*=i[3]}}function ne(e,t,i,o,n){return X(e,t,n).then(l=>{const a=l.width??t,s=l.height??t;if(l.image&&Y(i,o)){let h=l.image.width,g=l.image.height;$("edge")&&/\.svg$/i.test(e)&&(h-=1,g-=1);const f=N(a,s);f.drawImage(l.image,0,0,h,g,0,0,a,s);const u=f.getImageData(0,0,a,s),c=[i.r/255,i.g/255,i.b/255,i.a],p=C(i);for(let r=0;r<u.data.length;r+=4)Z(u.data,r,c,p,o);f.putImageData(u,0,0),e=f.canvas.toDataURL("image/png")}else{const h=A?.findCredential(e);if(h?.token){const g=e.includes("?")?"&":"?";e=`${e}${g}token=${h.token}`}}return{url:e,width:a,height:s}}).catch(()=>({url:e,width:t,height:t}))}let S=null;const L=[255,255,255];function M(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function oe(e,t,i){const{backgroundColor:o,outline:n,dotSize:l}=e,a=22,s=.8,h=Math.round(a*a/Math.max(l,.5)**2*s),g=window.devicePixelRatio,f=document.createElement("canvas"),u=a*g;f.width=u,f.height=u,f.style.width=f.width/g+"px",f.style.height=f.height/g+"px";const c=f.getContext("2d");if(o&&(c.fillStyle=o.toCss(!0),c.fillRect(0,0,u,u),c.fill()),c.fillStyle=t?.toCss(!0)??"",S&&S.length/2===h)for(let r=0;r<2*h;r+=2){const y=S[r],m=S[r+1];c.fillRect(y,m,l*g,l*g),c.fill()}else{S=[];for(let r=0;r<2*h;r+=2){const y=M(0,u),m=M(0,u);S.push(y,m),c.fillRect(y,m,l*g,l*g),c.fill()}}n&&(n.color&&(c.strokeStyle=n.color.toCss(!0)),c.lineWidth=n.width,c.strokeRect(0,0,u,u));const p=new Image(a,a);return p.src=f.toDataURL(),p.ariaLabel=null,p.alt="",p}function ce(e,t={}){const i=t.radius||40,o=2*Math.PI*i,n=e.length,l=o/n,a=[],s=j(t.outline);s?.width!=null&&(s.width*=2),(s||t.backgroundColor)&&a.push({shape:{type:"circle",cx:i,cy:i,r:i},fill:t.backgroundColor,stroke:s,offset:[0,0]});const h=t.values,g=h&&h.length===n&&h.reduce((r,y)=>r+y,0)===100,f=[0];for(let r=0;r<n;r++){let y=null;g&&(y=h[r]*o/100,f.push(y+f[r])),a.push({shape:{type:"circle",cx:i,cy:i,r:i/2},fill:[0,0,0,0],stroke:{width:i,dashArray:`${(y??l)/2} ${o}`,dashoffset:"-"+(g?f[r]/2:r*(l/2)),color:e[r]},offset:[0,0]})}let u=null;const c=2*i+(s?.width||0),p=t.holePercentage;if(p){s&&a.push({shape:{type:"circle",cx:i,cy:i,r:i*p},fill:null,stroke:s,offset:[0,0]});const r=c/2;u=[[{shape:{type:"circle",cx:r,cy:r,r},fill:L,stroke:s?{...s,color:L}:null,offset:[0,0]},{shape:{type:"circle",cx:r,cy:r,r:i*p},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return H([a],[c,c],{cssEffectFilter:t.cssEffectFilter,ignoreStrokeWidth:!0,masking:u,rotations:[-90],ariaLabel:t.ariaLabel})}function se(e,t={}){const n=t.align==="horizontal",l=n?75:24,a=n?24:75,s=t.width??l,h=t.height??a,g=t.gradient??!0,f=window.devicePixelRatio,u=s*f,c=h*f,p=document.createElement("canvas");p.width=u,p.height=c,p.ariaLabel=t.ariaLabel??null,p.style.width=`${s}px`,p.style.height=`${h}px`;const r=p.getContext("2d"),y=n?u:0,m=n?0:c;if(g){const w=r.createLinearGradient(0,0,y,m),v=e.length,d=v===1?0:1/(v-1);e.forEach((_,k)=>w.addColorStop(k*d,_.toString())),r.fillStyle=w,r.fillRect(0,0,u,c)}else{const w=n?u/e.length:u,v=n?c:c/e.length;let d=0,_=0;for(const k of e)r.fillStyle=k.toString(),r.fillRect(d,_,w,v),d=n?d+w:0,_=n?0:_+v}const b=document.createElement("div");return b.style.width=`${s}px`,b.style.height=`${h}px`,K(b,t?.cssEffectFilter),b.appendChild(p),b}function J(e){const t=e.match(/drop-shadow\(\s*([^\s]+)\s+[^\s]+\s+[^\s]+\s+.+?\)/);return t?t[1]:null}function K(e,t){if(!t)return;e.style.filter=t;const i=J(t);if(i){const o=T(U(i));o<0?e.style.marginLeft=`${Math.abs(o)}px`:e.style.marginRight=`${o}px`}}async function Q(e,t){switch(e.type){case"web-style":{const{previewWebStyleSymbol:i}=await x(()=>import("./previewWebStyleSymbol-BiD76lBz.js"),__vite__mapDeps([0,1,2,3]));return i(e,Q,t)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await x(()=>import("./previewSymbol3D-D79fd6qD.js"),__vite__mapDeps([4,1,2,5,6,7,8,9,10,3,11,12,13]));return i(e,t)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await x(()=>import("./previewSymbol2D-CgirjzO0.js"),__vite__mapDeps([14,1,2,15,5,6,7,11,12,13,8]));return i(e,t)}case"cim":{const{previewCIMSymbol:i}=await x(()=>import("./previewCIMSymbol-DvFqDqA7.js"),__vite__mapDeps([16,1,2,17,18,19,20,13,12,21,22,23,24,25,26,5,6,11,8]));return i(e,t)}default:return}}function V(e){return e&&e.opacity!==void 0?e.opacity*("parent"in e?V(e.parent):1):1}async function he(e,t){if(!e)return;const i=e.sourceLayer,o=(t!=null&&t.useSourceLayer?i:e.layer)??i,n=t?.ignoreOpacity?1:V(o);if(e.symbol!=null&&(t==null||t.ignoreGraphicSymbol!==!0)){const d=e.symbol.type==="web-style"?await e.symbol.fetchSymbol({...t,acceptedFormats:t?.webStyleAcceptedFormats,cache:t?.webStyleCache}):e.symbol.clone();return E(d,null,{add:n}),d}const l=t?.renderer??te(o);let a=l&&"getSymbolAsync"in l?await l.getSymbolAsync(e,t):null;if(!a)return;if(a=a.type==="web-style"?await a.fetchSymbol({...t,acceptedFormats:t?.webStyleAcceptedFormats,cache:t?.webStyleCache}):a.clone(),!(l&&"visualVariables"in l&&l.visualVariables?.length&&ee(a)))return E(a,null,{add:n}),a;if("arcadeRequiredForVisualVariables"in l&&l.arcadeRequiredForVisualVariables&&t?.arcade==null){const d={...t};d.arcade=await O(),t=d}const{getColor:s,getOpacity:h,getAllSizes:g,getRotationAngle:f}=await x(()=>import("./index-BrQW8HOS.js").then(d=>d.ME),__vite__mapDeps([1,2])),u=[],c=[],p=[],r=[];for(const d of l.visualVariables)switch(d.type){case"color":u.push(d);break;case"opacity":c.push(d);break;case"rotation":r.push(d);break;case"size":d.target||p.push(d)}const y=!!u.length&&u[u.length-1],m=y?s(y,e,t):null,b=!!t?.ignoreOpacity,w=!!c.length&&c[c.length-1],v=w?h(w,e,t):null;if(E(a,m,b?void 0:{override:v,add:n}),p.length&&t?.ignoreSizeVariables!==!0){const d=g(p,e,t);await W(a,d)}if(t?.ignoreRotationVariables!==!0)for(const d of r)G(a,f(d,e,t),d.axis);return a}function ee(e){return!z(e)||e.symbolLayers.at(0)?.type!=="water"}function te(e){if(e)return"renderer"in e?e.renderer:void 0}export{he as F,Q as L,ce as S,se as V,ne as d,H as l,oe as w};
