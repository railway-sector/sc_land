import{dg as v,ce as y,Z as a,$ as d,ad as g,b0 as L,ae as c,a0 as P,b$ as E,fL as h,rK as F,rL as C}from"./index-Bp3GeDhQ.js";let l=class extends v(y){constructor(r){super(r),this.frameCenter=null,this.frameOutline=null,this.lineOfSight=null,this.sensorLocation=null,this.sensorTrail=null}};a([d({type:g})],l.prototype,"frameCenter",void 0),a([d({type:L})],l.prototype,"frameOutline",void 0),a([d({type:c})],l.prototype,"lineOfSight",void 0),a([d({type:g})],l.prototype,"sensorLocation",void 0),a([d({type:c})],l.prototype,"sensorTrail",void 0),l=a([P("esri.layers.support.TelemetryData")],l);let s=class extends v(y){constructor(e){super(e),this.duration=null,this.end=null,this.start=null,this.timezone="UTC"}readEnd(e,r){return r.end!=null?new Date(r.end):null}writeEnd(e,r){r.end=e?e.getTime():null}readStart(e,r){return r.start!=null?new Date(r.start):null}writeStart(e,r){r.start=e?e.getTime():null}};a([d({type:Number,json:{write:{allowNull:!0}}})],s.prototype,"duration",void 0),a([d({type:Date,json:{write:{allowNull:!0}}})],s.prototype,"end",void 0),a([E("end")],s.prototype,"readEnd",null),a([h("end")],s.prototype,"writeEnd",null),a([d({type:Date,json:{write:{allowNull:!0}}})],s.prototype,"start",void 0),a([E("start")],s.prototype,"readStart",null),a([h("start")],s.prototype,"writeStart",null),a([d({type:String})],s.prototype,"timezone",void 0),s=a([P("esri.layers.support.VideoTimeExtent")],s);const b=s,p="application/x-mpegURL",z="video/mp4",A="video/webm",t={PrecisionTimeStamp:10002,MissionId:10003,PlatformTailNumber:10004,PlatformHeadingAngle:10005,PlatformPitchAngle:10006,PlatformRollAngle:10007,PlatformTrueAirspeed:10008,PlatformDesignation:10010,SensorLatitude:10013,SensorLongitude:10014,SensorTrueAltitude:10015,SensorHorizontalFOV:10016,SensorVerticalFOV:10017,SensorAzimuthAngle:10018,SensorElevationAngle:10019,SensorRollAngle:10020,FrameCenterLatitude:10023,FrameCenterLongitude:10024,FrameCenterElevation:10025,OffsetCorner1Latitude:10026,OffsetCorner1Longitude:10027,OffsetCorner2Latitude:10028,OffsetCorner2Longitude:10029,OffsetCorner3Latitude:10030,OffsetCorner3Longitude:10031,OffsetCorner4Latitude:10032,OffsetCorner4Longitude:10033,PlatformGroundRange:10057,PlatformCallSign:10059,SensorEllipsoidHeight:10075,FrameCenterAboveEllipsoid:10078,EsriVideoWidth:90001,EsriVideoHeight:90002,EsriFrameCenterLatitude:90050,EsriFrameCenterLongitude:90051,EsriCornerLatitudePt1:90052,EsriCornerLongitudePt1:90053,EsriCornerLatitudePt2:90054,EsriCornerLongitudePt2:90055,EsriCornerLatitudePt3:90056,EsriCornerLongitudePt3:90057,EsriCornerLatitudePt4:90058,EsriCornerLongitudePt4:90059,EsriFrameOutline:90060,EsriSensorPosition:90061,EsriHorizonPixelPack:90063,EsriGroundControlPoints:90064};function U(e,r=1e4){if(!e||!e.length)return[];let n=[],o=[];for(let u=0;u<e.length;u++){const f=e[u],m=f?.text?JSON.parse(f.text):null;m?.source==="EsriVideoServer"&&(n=[...m.data])}const i=n.find(u=>u.tagId===r);return Array.isArray(i?.value)&&(o=[...i.value]),o}function j(e){const{duration:r,end:n,start:o,timezone:i="UTC"}=e||{};return typeof r!="number"?null:new b({duration:r||null,end:typeof n=="number"?new Date(n):null,start:typeof o=="number"?new Date(o):null,timezone:i})}function G(e,r){const n=[...r],o=n.findIndex(i=>i.equals(e));return o>-1&&n.splice(o),n.push(e),n}function J(e){if(!e?.size)return new l;const r=k(e),n=T(e),o=D(e),i=V(r,n);return new l({frameCenter:n,frameOutline:o,lineOfSight:i,sensorLocation:r})}function M(e){return e?.size?e.get(t.EsriGroundControlPoints)?.value??null??null:null}function _(e){return e?.size?e.get(t.EsriHorizonPixelPack)?.value??null:null}function T(e){return x(e)??$(e)}function q(e){if(!e)return p;const r=e.match(/\.(\w{3,4})(?:$|\?)/i);if(!r)return p;switch(r[1].toLowerCase()){case"mp4":return z;case"webm":return A;default:return p}}function K(e){const r=e?.layers;return r?.length?r.map(n=>({layerId:n.id,posterUrl:n.poster,sourceType:n.serviceType,title:n.name,type:n.type||"Video Layer"})):[]}function W(e,r,n){if(!e)return null;const o=e.clone();switch(o.type){case"simple-fill":C(o,n),o.outline.color=r;break;case"simple-line":C(o,r);break;case"simple-marker":C(o,r),o?.outline?.color&&(o.outline.color=r);break;case"cim":F(o,r)}return o}function Z(e){const{cameraAzimuth:r,platformHeading:n,source:o=null,symbolOffset:i=0}=e||{};let u=0;if(!o)return u;u=o==="platformHeading"?n+i:n+r+i;const f=u>360?u-360:u;return Math.round(Math.abs(f))}function x(e){return e&&e.has(t.EsriFrameCenterLatitude)&&e.has(t.EsriFrameCenterLongitude)?new g({x:e.get(t.EsriFrameCenterLongitude).value,y:e.get(t.EsriFrameCenterLatitude).value,z:e.get(t.FrameCenterAboveEllipsoid)?.value??e.get(t.FrameCenterElevation)?.value}):null}function $(e){return e&&e.has(t.FrameCenterLatitude)&&e.has(t.FrameCenterLongitude)?new g({x:e.get(t.FrameCenterLongitude)?.value,y:e.get(t.FrameCenterLatitude)?.value,z:e.get(t.FrameCenterElevation)?.value}):null}function D(e){if(!e)return null;const r=e.get(t.EsriFrameOutline)?.value;return r?L.fromJSON(r.geometry):H(e)??N(e)}function H(e){if(!(e.has(t.EsriCornerLatitudePt1)&&e.has(t.EsriCornerLongitudePt1)&&e.has(t.EsriCornerLatitudePt2)&&e.has(t.EsriCornerLongitudePt2)&&e.has(t.EsriCornerLatitudePt3)&&e.has(t.EsriCornerLongitudePt3)&&e.has(t.EsriCornerLatitudePt4)&&e.has(t.EsriCornerLongitudePt4)))return null;const r=[e.get(t.EsriCornerLongitudePt1)?.value,e.get(t.EsriCornerLatitudePt1)?.value],n=[e.get(t.EsriCornerLongitudePt2)?.value,e.get(t.EsriCornerLatitudePt2)?.value],o=[e.get(t.EsriCornerLongitudePt3)?.value,e.get(t.EsriCornerLatitudePt3)?.value],i=[e.get(t.EsriCornerLongitudePt4)?.value,e.get(t.EsriCornerLatitudePt4)?.value];return new L({rings:[[r,n,o,i]]})}function N(e){if(!(e.has(t.OffsetCorner1Latitude)&&e.has(t.OffsetCorner1Longitude)&&e.has(t.OffsetCorner2Latitude)&&e.has(t.OffsetCorner2Longitude)&&e.has(t.OffsetCorner3Latitude)&&e.has(t.OffsetCorner3Longitude)&&e.has(t.OffsetCorner4Latitude)&&e.has(t.OffsetCorner4Longitude)&&e.has(t.FrameCenterLatitude)&&e.has(t.FrameCenterLongitude)))return null;const r=e.get(t.FrameCenterLatitude)?.value,n=e.get(t.FrameCenterLongitude)?.value,o=r+e.get(t.OffsetCorner1Latitude)?.value,i=n+e.get(t.OffsetCorner1Longitude)?.value,u=r+e.get(t.OffsetCorner2Latitude)?.value,f=n+e.get(t.OffsetCorner2Longitude)?.value,m=r+e.get(t.OffsetCorner3Latitude)?.value,O=n+e.get(t.OffsetCorner3Longitude)?.value,S=r+e.get(t.OffsetCorner4Latitude)?.value,w=n+e.get(t.OffsetCorner4Longitude)?.value;return new L({rings:[[[i,o],[f,u],[O,m],[w,S]]]})}function V(e,r){if(!e||!r)return null;const n=[e.x,e.y,e.z??0],o=[r.x,r.y,r.z??0];return new c({paths:[[n,o]]})}function k(e){if(!e?.size)return null;if(e.has(t.EsriSensorPosition)){const r=e.get(t.EsriSensorPosition)?.value;if(r)return g.fromJSON(r.geometry)}return e.has(t.SensorLongitude)&&e.has(t.SensorLatitude)?new g({x:e.get(t.SensorLongitude)?.value,y:e.get(t.SensorLatitude)?.value,z:e.get(t.SensorTrueAltitude)?.value}):null}export{J as C,q as E,M as L,b as a,l as b,_ as c,t as d,U as f,j as g,Z as h,G as m,K as p,W as v};
